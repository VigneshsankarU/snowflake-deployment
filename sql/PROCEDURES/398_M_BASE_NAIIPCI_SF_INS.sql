-- Object Type: PROCEDURES
CREATE OR REPLACE PROCEDURE ALFA_EDW_DEV.PUBLIC.M_BASE_NAIIPCI_SF_INS("RUN_ID" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS '
DECLARE start_dttm TIMESTAMP;
end_dttm TIMESTAMP;
PRCS_ID INTEGER;
cc_EOY TIMESTAMP;
cc_BOY TIMESTAMP;
pc_EOY TIMESTAMP;
pc_BOY TIMESTAMP;
BEGIN 
start_dttm := CURRENT_TIMESTAMP();
end_dttm := CURRENT_TIMESTAMP();
PRCS_ID := 1; 
cc_EOY:=CURRENT_TIMESTAMP();
cc_BOY:=CURRENT_TIMESTAMP();
pc_EOY:=CURRENT_TIMESTAMP();
pc_BOY:=CURRENT_TIMESTAMP();

  -- PIPELINE START FOR 1
  -- Component SQ_cc_claim, Type SOURCE
  CREATE
  OR
  replace TEMPORARY TABLE sq_cc_claim AS
  (
         SELECT
                /* adding column aliases to ensure proper downstream column references */
                $1  AS companynumber,
                $2  AS lineofbusinesscode,
                $3  AS statecode,
                $4  AS callyear,
                $5  AS accountingyear,
                $6  AS expperiodyear,
                $7  AS expperiodmonth,
                $8  AS expeperiodday,
                $9  AS occupancycode,
                $10 AS classificationcode,
                $11 AS territorycode,
                $12 AS stateexceptionind,
                $13 AS zipcode,
                $14 AS policyeffectiveyear,
                $15 AS newrecordformat,
                $16 AS aslob,
                $17 AS itemcode,
                $18 AS sublinecode,
                $19 AS policyprogramcode,
                $20 AS policyformcode,
                $21 AS no_of_family_codes,
                $22 AS construction,
                $23 AS protectioncode,
                $24 AS exceptioncode,
                $25 AS typeofdeductiblecode,
                $26 AS policytermcode,
                $27 AS typeoflosscode,
                $28 AS stateexceptionb,
                $29 AS amountofinsurance,
                $30 AS yeaofmanufacture,
                $31 AS coveragecodeb,
                $32 AS exposurecodes,
                $33 AS leadpoisioning,
                $34 AS dedindicator,
                $35 AS dedamount,
                $36 AS deductibleindicatorws,
                $37 AS deductibleamountws,
                $38 AS claimidentifier,
                $39 AS claimantidentifier,
                $40 AS writtenexposure,
                $41 AS writtenpremium,
                $42 AS paidlosses,
                $43 AS paidnumberofclaims,
                $44 AS outstandinglosses,
                $45 AS outstandingnoofclaims,
                $46 AS policynumber,
                $47 AS policyperiodid,
                $48 AS policysystemperiodid,
                $49 AS effectivedate,
                $50 AS territorycode_pc,
                $51 AS zipcode_pc,
                $52 AS itemcode_pc,
                $53 AS sublinecode_pc,
                $54 AS occupancy_code_pc,
                $55 AS buildingcontents_pc,
                $56 AS constructioncode_pc,
                $57 AS protectionclasscode_pc,
                $58 AS typeofdeductiblecode_pc,
                $59 AS amountofinsurance_pc,
                $60 AS yeaofconstructionliablt_pc,
                $61 AS deductibleindicator_pc,
                $62 AS deductibleamount_pc,
                $63 AS deductibleindicatorws_pc,
                $64 AS deductibleamountws_pc,
                $65 AS policynumber_pc,
                $66 AS policyidentifier_pc,
                $67 AS territorycode_lkppc,
                $68 AS zipcode_lkppc,
                $69 AS itemcode_lkppc,
                $70 AS sublinecode_lkppc,
                $71 AS occupancycode_lkppc,
                $72 AS buildingcontents_lkppc,
                $73 AS construction_lkppc,
                $74 AS protectionclass_lkppc,
                $75 AS typeofdeductible_lkppc,
                $76 AS amountofinsurance_lkppc,
                $77 AS yearofmanufacutre_lkppc,
                $78 AS ded_ind_lkppc,
                $79 AS ded_amt_lkppc,
                $80 AS ded_wind_ind_lkppc,
                $81 AS ded_wind_amt_lkppc,
                $82 AS policyperiodid_lkppc,
                $83 AS policynumber_lkppc,
                $84 AS source_record_id
         FROM   (
                         SELECT   src.*,
                                  row_number() over (ORDER BY 1) AS source_record_id
                         FROM     (
                                                  SELECT          sq_clm.companynumber,
                                                                  sq_clm.lob AS lineofbusinesscode,
                                                                  sq_clm.statecode,
                                                                  sq_clm.callyear,
                                                                  sq_clm.accountingyear,
                                                                  sq_clm.expperiodyear,
                                                                  sq_clm.expperiodmonth,
                                                                  sq_clm.expperiodday,
                                                                  sq_clm.occupancycode,
                                                                  sq_clm.classificationcode,
                                                                  sq_clm.territorycode,
                                                                  sq_clm.stateexceptionind,
                                                                  sq_clm.zipcode,
                                                                  sq_clm.policy_eff_yr AS policyeffectiveyear,
                                                                  sq_clm.newrecordformat,
                                                                  sq_clm.aslob,
                                                                  sq_clm.itemcode,
                                                                  sq_clm.sublinecode,
                                                                  sq_clm.policyprogramcode,
                                                                  sq_clm.policy_form_code AS policyformcode,
                                                                  sq_clm.no_of_family_codes,
                                                                  sq_clm.construction_new    AS construction,
                                                                  sq_clm.protectionclasscode AS protectioncode,
                                                                  sq_clm.exceptioncode,
                                                                  sq_clm.typeofdeductiblecode,
                                                                  sq_clm.policytermcode,
                                                                  sq_clm.losscode AS typeoflosscode,
                                                                  sq_clm.stateexceptionb,
                                                                  sq_clm.amountofinsurance,
                                                                  sq_clm.yearofmanufacture,
                                                                  sq_clm.coveragecodeordlaw AS coveragecodeb,
                                                                  sq_clm.exposurecodes,
                                                                  sq_clm.leadpoisoningliability AS leadpoisioning,
                                                                  sq_clm.ded_ind                AS dedindicator,
                                                                  sq_clm.ded_amount             AS dedamount,
                                                                  sq_clm.deductibleindicatorws,
                                                                  sq_clm.deductibleamountws,
                                                                  sq_clm.claimidentifier,
                                                                  sq_clm.claimantidentifier,
                                                                  sq_clm.writtenexposure,
                                                                  sq_clm.writtenpremium,
                                                                  sq_clm.paidlosses,
                                                                  sq_clm.paidnumberofclaims,
                                                                  sq_clm.outstandinglosses,
                                                                  sq_clm.outstandingclaims AS outstandingnoofclaims,
                                                                  sq_clm.policynumber,
                                                                  sq_clm.policyperiodid,
                                                                  sq_clm.policyidentifier AS policysystemperiodid,
                                                                  sq_clm.effectivedate,
                                                                  sq_pc.territorycode         AS territorycode_pc,
                                                                  sq_pc.zipcode               AS zipcode_pc,
                                                                  sq_pc.itemcode              AS itemcode_pc,
                                                                  sq_pc.sublinecode           AS sublinecode_pc,
                                                                  sq_pc.occupancy_code        AS occupancy_code_pc,
                                                                  sq_pc.buildingcontents      AS buildingcontents_pc,
                                                                  sq_pc.construction          AS constructioncode_pc,
                                                                  sq_pc.protectionclasscode   AS protectionclasscode_pc,
                                                                  sq_pc.typeofdeductiblecode  AS typeofdeductiblecode_pc,
                                                                  sq_pc.amountofinsurance     AS amountofinsurance_pc,
                                                                  sq_pc.yearofmanufacture     AS yeaofconstructionliablt_pc,
                                                                  sq_pc.ded_ind               AS deductibleindicator_pc,
                                                                  sq_pc.ded_amount            AS deductibleamount_pc,
                                                                  sq_pc.deductibleindicatorws AS deductibleindicatorws_pc,
                                                                  sq_pc.deductibleamountws    AS deductibleamountws_pc,
                                                                  sq_pc.policynumber          AS policynumber_pc,
                                                                  sq_pc.policyperiodid        AS policyidentifier_pc,
                                                                  lkp_pc.territorycode        AS territorycode_lkppc,
                                                                  lkp_pc.zipcode              AS zipcode_lkppc,
                                                                  lkp_pc.itemcode             AS itemcode_lkppc ,
                                                                  lkp_pc.sublinecode          AS sublinecode_lkppc,
                                                                  lkp_pc.occupancycode        AS occupancycode_lkppc,
                                                                  lkp_pc.buildingcontents     AS buildingcontents_lkppc,
                                                                  lkp_pc.construction         AS construction_lkppc,
                                                                  lkp_pc.protectionclass      AS protectionclass_lkppc,
                                                                  lkp_pc.typeofdeductible     AS typeofdeductible_lkppc,
                                                                  lkp_pc.amountofinsurance    AS amountofinsurance_lkppc,
                                                                  lkp_pc.yearofmanufacutre    AS yearofmanufacutre_lkppc,
                                                                  lkp_pc.ded_ind              AS ded_ind_lkppc,
                                                                  lkp_pc.ded_amt              AS ded_amt_lkppc,
                                                                  lkp_pc.ded_wind_ind         AS ded_wind_ind_lkppc,
                                                                  lkp_pc.ded_wind_amt         AS ded_wind_amt_lkppc,
                                                                  lkp_pc.policyperiodid       AS policyperiodid_lkppc,
                                                                  lkp_pc.policynumber         AS policynumber_lkppc
                                                  FROM            (
                                                                                  SELECT DISTINCT companynumber_stg  AS companynumber,
                                                                                                  lob_stg            AS lob,
                                                                                                  statecode_stg      AS statecode,
                                                                                                  callyear_stg       AS callyear,
                                                                                                  accountingyear_stg AS accountingyear,
                                                                                                  expperiodyear_stg  AS expperiodyear,
                                                                                                  expperiodmonth_stg AS expperiodmonth,
                                                                                                  expperiodday_stg   AS expperiodday,
                                                                                                  occupancycode_stg  AS occupancycode,
                                                                                                  ''00''                  classificationcode,
                                                                                                  naiipcitc_alfa_stg AS territorycode,
                                                                                                  ''0''                   stateexceptionind,
                                                                                                  postalcode_stg        zipcode,
                                                                                                  policy_eff_yr_stg  AS policy_eff_yr,
                                                                                                  ''D''                   newrecordformat,
                                                                                                  CASE
                                                                                                                  WHEN losscode_stg=''01'' THEN ''010''
                                                                                                                  ELSE ''021''
                                                                                                  END                                                                 aslob,
                                                                                                  ''03''                                                                itemcode,
                                                                                                  subline                                                             sublinecode,
                                                                                                  ''0''                                                                 policyprogramcode,
                                                                                                  policy_form_code_stg                                                AS policy_form_code,
                                                                                                  ''0''                                                                    no_of_family_codes,
                                                                                                  ''0''                                                                    construction_new,
                                                                                                  ''0''                                                                    protectionclasscode,
                                                                                                  ''00''                                                                   exceptioncode,
                                                                                                  0                                                                      typeofdeductiblecode,
                                                                                                  ''00''                                                                   policytermcode,
                                                                                                  losscode_stg                                                        AS losscode,
                                                                                                  ''00''                                                                   stateexceptionb,
                                                                                                  0                                                                      amountofinsurance,
                                                                                                  0                                                                      yearofmanufacture,
                                                                                                  ''0''                                                                    coveragecodeordlaw,
                                                                                                  ''0''                                                                    exposurecodes,
                                                                                                  ''0''                                                                    leadpoisoningliability,
                                                                                                  0                                                                      ded_ind,
                                                                                                  0                                                                      ded_amount,
                                                                                                  0                                                                      deductibleindicatorws,
                                                                                                  0                                                                      deductibleamountws,
                                                                                                  claimidentifier_stg                                                 AS claimidentifier,
                                                                                                  claimantidentifier_stg                                              AS claimantidentifier,
                                                                                                  0                                                                      writtenexposure,
                                                            ''0'' writtenpremium,
                                                                                                  to_char(paidlosses_stg )         AS paidlosses,
                                                                                                  paidnumberofclaims_stg                                              AS paidnumberofclaims,
                                                                                                  to_char(outstandinglosses_stg ) outstandinglosses,
                                                                                                  outstandingclaims_stg                                               AS outstandingclaims,
                                                                                                  policynumber_stg                                                    AS policynumber,
                                                                                                  policyperiodid_stg                                                  AS policyperiodid,
                                                                                                  coalesce(policyperiodid_stg, policynumber_stg)    policyidentifier,
                                                                                                  effectivedate_stg                                                   AS effectivedate
                                                                                  FROM            (
                                                                                                           SELECT   policysystemperiodid_stg policyperiodid_stg,
                                                                                                                    companynumber_stg,
                                                                                                                    lob_stg,
                                                                                                                    statecode_stg,
                                                                                                                    callyear_stg,
                                                                                                                    accountingyear_stg,
                                                                                                                    exp_yr_stg        expperiodyear_stg,
                                                                                                                    exp_mth_stg       expperiodmonth_stg,
                                                                                                                    exp_day_stg       expperiodday_stg,
                                                                                                                    occupancycode_stg occupancycode_stg,
                                                                                                                    territorycode_stg,
                                                                                                                    zipcode_stg,
                                                                                                                    policyeffectiveyear_stg policy_eff_yr_stg,
                                                                                                                    CASE
                                                                                                                             WHEN policysubtype_stg IN (''SF2'',
                                                                                                                                                        ''SF3'') THEN ''28''
                                                                                                                             ELSE ''10''
                                                                                                                    END subline,
                                                                                                                    claimidentifier_stg,
                                                                                                                    policynumber_stg,
                                                                                                                    city_stg,
                                                                                                                    ann_stmt_lob_stg,
                                                                                                                    CASE
                                                                                                                             WHEN policysubtype_stg=''SF3'' THEN ''03''
                                                                                                                             WHEN policysubtype_stg=''SF2'' THEN ''02''
                                                                                                                             ELSE ''01''
                                                                                                                    END                  policy_form_code_stg,
                                                                                                                    losscause_stg        losscode_stg,
                                                                                                                    claimantdenormid_stg claimantidentifier_stg,
                                                                                                                    SUM(paidloss_stg)    paidlosses_stg,
                                                                                                                    CASE
                                                                                                                             WHEN(
                                                                                                                                               max(closedate_stg) > cast(:cc_boy AS timestamp)
                                                                                                                                      AND      max(closedate_stg) < cast(:cc_eoy AS timestamp)
                                                                                                                                      AND      SUM(paidloss_stg) > 0
                                                                                                                                      AND      max(covrank_stg) >= 1) THEN 1
                                                                                                                             ELSE 0
                                                                                                                    END             AS paidnumberofclaims_stg,
                                                                                                                    SUM(outres_stg)    outstandinglosses_stg,
                                                                                                                    CASE
                                                                                                                             WHEN(
                                                                                                                                               max(closedate_stg) IS NULL
                                                                                                                                      OR       max(closedate_stg) > cast(:cc_boy AS timestamp) )
                                                                                                                             AND      SUM (outres_stg)>0
                                                                                                                             AND      max(covrank_stg) >= 1 THEN 1
                                                                                                                             ELSE 0
                                                                                                                    END AS outstandingclaims_stg,
                                                                                                                    effectivedate_stg,
                                                                                                                    legacypolind_alfa_stg ,
                                                                                                                    yearbuilt_alfa_stg,
                                                                                                                    no_of_family_codes_stg,
                                                                                                                    construction_stg,
                                                                                                                    protectionclasscode_stg,
                                                                                                                    naiipcitc_alfa_stg,
                                                                                                                    postalcode_stg
                                                                                                           FROM     (
                                                                                                                             SELECT   policysystemperiodid_stg,
                                                                                                                                      companynumber_stg,
                                                                                                                                      lob_stg,
                                                                                                                                      statecode_stg,
                                                                                                                                      callyear_stg,
                                                                                                                                      accountingyear_stg,
                                                                                                                                      exp_yr_stg,
                                                                                                                                      exp_mth_stg,
                                                                                                                                      exp_day_stg,
                                                                                                                                      occupancycode_stg,
                                                                                                                                      territorycode_stg,
                                                                                                                                      zipcode_stg,
                                                                                                                                      policyeffectiveyear_stg,
                                                                                                                                      claimidentifier_stg,
                                                                                                                                      covrank_stg,
                                                                                                                                      closedate_stg,
                                                                                                                                      SUM(acct500104_stg - acct500204_stg + acct500214_stg - acct500304_stg + acct500314_stg) AS paidloss_stg,
                                                                                                                                      SUM(acct521004_stg)                                                                     AS paidalae_stg,
                                                                                                                                      SUM(a.losspaymentscurrmo_stg+a.eoq_stg)                    AS outres_stg ,
                                                                                                                                      legacypolind_alfa_stg,
                                                                                                                                      policynumber_stg,
                                                                                                                                      losscause_stg,
                                                                                                                                      city_stg,
                                                                                                                                      ''040'' AS ann_stmt_lob_stg,
                                                                                                                                      policysubtype_stg,
                                                                                                                                      claimantdenormid_stg,
                                                                                                                                      effectivedate_stg,
                                                                                                                                      yearbuilt_alfa_stg,
                                                                                                                                      no_of_family_codes_stg,
                                                                                                                                      construction_stg,
                                                                                                                                      protectionclasscode_stg,
                                                                                                                                      naiipcitc_alfa_stg,
                                                                                                                                      postalcode_stg
                                                                                                                             FROM     (
                                                                                                                                                      SELECT DISTINCT pol.policysystemperiodid_stg,
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN uwc.typecode_stg=''AMI'' THEN ''0005''
                                                                                                                                                                                      WHEN uwc.typecode_stg=''AMF'' THEN ''0006''
                                                                                                                                                                                      WHEN uwc.typecode_stg=''AMG'' THEN ''0196''
                                                                                                                                                                                      WHEN uwc.typecode_stg=''AIC'' THEN ''0050''
                                                                                                                                                                                      WHEN uwc.typecode_stg=''AGI'' THEN ''0318''
                                                                                                                                                                      END  AS companynumber_stg,
                                                                                                                                                                      ''18'' AS lob_stg,
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL'' THEN ''01''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA'' THEN ''10''
                                                                                                                                                                                      WHEN jd.typecode_stg=''MS'' THEN ''23''
                                                                                                                                                                      END                                                 AS statecode_stg,
                                                                                                                                                                      extract(year FROM (cast(:cc_eoy AS timestamp))) + 1 AS callyear_stg,
                                                                                                                                                                      extract(year FROM (cast(:cc_eoy AS timestamp)))     AS accountingyear_stg,
                                                                                                                                                                      extract(year FROM clm.lossdate_stg)                 AS exp_yr_stg,
                                                                                                                                                                      LPAD (
  TO_CHAR (DATE_PART (MONTH, clm.lossdate_stg)),
  2,
  ''0''
) AS exp_mth_stg,
LPAD (
  TO_CHAR (DATE_PART (DAY, clm.lossdate_stg)),
  2,
  ''0''
) AS exp_day_stg,
                                                                                                                                                                      ''00''                                                                            occupancycode_stg,
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        lc.name_stg LIKE ''%Fire%''
                                                                                                                                                                                                      OR              lc.name_stg LIKE ''%Lightning%'')
                                                                                                                                                                                      AND             psttl.typecode_stg =''SF1'' THEN ''01''
                                                                                                                                                                                      WHEN lc.name_stg IN ( ''Water / Frozen Pipes'',
                                                                                                                                                                                                        ''Water / Other'')
                                                                                                                                                                                      AND             psttl.typecode_stg IN (''SF2'',
                                                                                                                                                                                                        ''SF3'')THEN ''03''
                                                                                                                                                                                      WHEN lc.name_stg IN (''PD'',
                                                                                                                                                                                                        ''Other Perils'',
                                                                                                                                                                                                        ''EC'',
                                                                                                                                                                                                        ''Earthquake'',
                                                                                                                                                                                                        ''WEATH (Other weather)'')
                                                                                                                                                                                      AND             psttl.typecode_stg IN (''SF2'',
                                                                                                                                                                                                        ''SF3'') THEN ''05''
                                                                                                                                                                                      WHEN psttl.typecode_stg =''SF1'' THEN ''01''
                                                                                                                                                                                      ELSE ''05''
                                                                                                                                                                      END losscause_stg , (
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''BIRMINGHAM''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''JEFFERSON'' THEN ''32''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''HUNTSVILLE''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''MADISON'' THEN ''35''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''MONTGOMERY''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''MONTGOMERY'' THEN ''37''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''MOBILE''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''MOBILE'' THEN ''30''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''AUTAUGA'',
                                                                                                                                                                                                        ''ELMORE'',
                                                                                                                                                                                                        ''MONTGOMERY'') THEN ''38''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''BALDWIN'' THEN ''41''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''BARBOUR'',
                                                                                                                                                                                                        ''BIBB'',
                                                                                                                                                                                                        ''BLOUNT'',
                                                                                                                                                                                                        ''BULLOCK'',
                                                                                                                                                                                                        ''BUTLER'',
                                                                                                                                                                                                        ''CHAMBERS'',
                                                                                                                                                                                                        ''CHEROKEE'',
                                                                                                                                                                                                        ''CHILTON'',
                                                                                                                                                                                                        ''CHOCTAW'',
                                                                                                                                                                                                        ''CLARKE'',
                                                                                                                                                                                                        ''CLAY'',
                                                                                                                                                                                                        ''CLEBURNE'',
                                                                                                                                                                                                        ''COFFEE'',
                                                                                                                                                                                                        ''CONECUH'',
                                                                                                                                                                                                        ''COOSA'',
                                                                                                                                                                                                        ''COVINGTON'',
                                                                                                                                                                                                        ''CRENSHAW'',
                                                                                                                                                                                                        ''CULLMAN'',
                                                                                                                                                                                                        ''DALE'',
                                                                                                                                                                                                        ''DALLAS'',
                                                                                                                                                                                                        ''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''ESCAMBIA'',
                                                                                                                                                                                                        ''FAYETTE'',
                                                                                                                                                                                                        ''FRANKLIN'',
                                                                                                                                                                                                        ''GENEVA'',
                                                                                                                                                                                                        ''GREENE'',
                                                                                                                                                                                                        ''HALE'',
                                                                                                                                                                                                        ''HENRY'',
                                                                                                                                                                                                        ''HOUSTON'',
                                                                                                                                                                                                        ''JACKSON'',
                                                                                                                                                                                                        ''LAMAR'',
                                                                                                                                                                                                        ''LAWRENCE'',
                                                                                                                                                                                                        ''LEE'',
                                                                                                                                                                                                        ''LOWNDES'',
                                                                                                                                                                                                        ''MACON'',
                                                                                                                                                                                                        ''MONROE'',
                                                                                                                                                                                                        ''MARENGO'',
                                                                                                                                                                                                        ''MARION'',
                                                                                                                                                                                                        ''MARSHALL'',
                                                                                                                                                                                                        ''PERRY'',
                                                                                                                                                                                                        ''PICKENS'',
                                                                                                                                                                                                        ''PIKE'',
                                                                                                                                                                                                        ''RANDOLPH'',
                                                                                                                                                                                                        ''RUSSELL'',
                                                                                                                                                                                                        ''SAINT CLAIR'',
                                                                                                                                                                                                        ''ST. CLAIR'',
                                                                                                                                                                                                        ''SUMTER'',
                                                                                                                                                                                                        ''TALLADEGA'',
                                                                                                                                                                                                        ''TALLAPOOSA'',
                                                                                                                                                                                                        ''WASHINGTON'',
                                                                                                                                                                                                        ''WILCOX'',
                                                                                                                                                                                                        ''WINSTON'') THEN ''41''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''CALHOUN'',
                                                                                                                                                                                                        ''ETOWAH'') THEN ''40''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''COLBERT'',
                                                                                                                                                                                                        ''LAUDERDALE'',
                                                                                                                                                                                                        ''LIMESTONE'',
                                                                                                                                                                                                        ''MADISON'',
                                                                                                                                                                                                        ''MORGAN'') THEN ''36''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''JEFFERSON'' THEN ''33''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''MOBILE'' THEN ''41''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''SHELBY'',
                                                                                                                                                                                                        ''WALKER'') THEN ''34''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''TUSCALOOSA'' THEN ''39''
                                                                                                                                                                                      /*WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        substring (addr.postalcode_stg,0,INDEX(addr.postalcode_stg, ''-''))=''36511''
                                                                                                                                                                                                      OR              addr.postalcode_stg=''36511'')
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''BON SECOUR'' THEN ''6''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        substring (addr.postalcode_stg,0,INDEX(addr.postalcode_stg, ''-''))=''36528''
                                                                                                                                                                                                      OR              addr.postalcode_stg=''36528'')
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''DAUPHIN ISLAND'' THEN ''6''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        substring (addr.postalcode_stg,0,INDEX(addr.postalcode_stg, ''-'')) IN (''36542'',
                                                                                                                                                                                                        ''36547'')
                                                                                                                                                                                                      OR              addr.postalcode_stg IN (''36542'',
                                                                                                                                                                                                        ''36547''))
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''GULF SHORES'' THEN ''6''
                                                                                                                                                                                      WHEN jd.typecode_stg=''AL''
                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        substring (addr.postalcode_stg,0,INDEX(addr.postalcode_stg, ''-''))=''36561''
                                                                                                                                                                                                      OR              addr.postalcode_stg=''36561'')
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''ORANGE BEACH'' THEN ''6''*/
                                                                                                                                                                                      WHEN jd.typecode_stg = ''AL''
                                                                                                                                                                                      AND (
                                                                                                                                                                                      IFF(POSITION(''-'' IN addr.postalcode_stg) > 0,
                                                                                                                                                                                             SUBSTRING(addr.postalcode_stg, 1, POSITION(''-'' IN addr.postalcode_stg) - 1),
                                                                                                                                                                                             addr.postalcode_stg
                                                                                                                                                                                      ) = ''36511''
                                                                                                                                                                                      OR addr.postalcode_stg = ''36511''
                                                                                                                                                                                      )
                                                                                                                                                                                      AND UPPER(addr.city_stg) = ''BON SECOUR'' THEN ''6''

                                                                                                                                                                                      WHEN jd.typecode_stg = ''AL''
                                                                                                                                                                                      AND (
                                                                                                                                                                                      IFF(POSITION(''-'' IN addr.postalcode_stg) > 0,
                                                                                                                                                                                             SUBSTRING(addr.postalcode_stg, 1, POSITION(''-'' IN addr.postalcode_stg) - 1),
                                                                                                                                                                                             addr.postalcode_stg
                                                                                                                                                                                      ) = ''36528''
                                                                                                                                                                                      OR addr.postalcode_stg = ''36528''
                                                                                                                                                                                      )
                                                                                                                                                                                      AND UPPER(addr.city_stg) = ''DAUPHIN ISLAND'' THEN ''6''

                                                                                                                                                                                      WHEN jd.typecode_stg = ''AL''
                                                                                                                                                                                      AND (
                                                                                                                                                                                      IFF(POSITION(''-'' IN addr.postalcode_stg) > 0,
                                                                                                                                                                                             SUBSTRING(addr.postalcode_stg, 1, POSITION(''-'' IN addr.postalcode_stg) - 1),
                                                                                                                                                                                             addr.postalcode_stg
                                                                                                                                                                                      ) IN (''36542'', ''36547'')
                                                                                                                                                                                      OR addr.postalcode_stg IN (''36542'', ''36547'')
                                                                                                                                                                                      )
                                                                                                                                                                                      AND UPPER(addr.city_stg) = ''GULF SHORES'' THEN ''6''

                                                                                                                                                                                      WHEN jd.typecode_stg = ''AL''
                                                                                                                                                                                      AND (
                                                                                                                                                                                      IFF(POSITION(''-'' IN addr.postalcode_stg) > 0,
                                                                                                                                                                                             SUBSTRING(addr.postalcode_stg, 1, POSITION(''-'' IN addr.postalcode_stg) - 1),
                                                                                                                                                                                             addr.postalcode_stg
                                                                                                                                                                                      ) = ''36561''
                                                                                                                                                                                      OR addr.postalcode_stg = ''36561''
                                                                                                                                                                                      )
                                                                                                                                                                                      AND UPPER(addr.city_stg) = ''ORANGE BEACH'' THEN ''6''

                                                                                                                                                                                      WHEN jd.typecode_stg=''MS''
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''JACKSON''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''HINDS'',
                                                                                                                                                                                                        ''RANKIN'') THEN ''30''
                                                                                                                                                                                      WHEN jd.typecode_stg=''MS''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''AMITE'',
                                                                                                                                                                                                        ''FORREST'',
                                                                                                                                                                                                        ''GREENE'',
                                                                                                                                                                                                        ''LAMAR'',
                                                                                                                                                                                                        ''MARION'',
                                                                                                                                                                                                        ''PERRY'',
                                                                                                                                                                                                        ''PIKE'',
                                                                                                                                                                                                        ''WALTHALL'',
                                                                                                                                                                                                        ''WILKINSON'') THEN ''3''
                                                                                                                                                                                      WHEN jd.typecode_stg=''MS''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''GEORGE'',
                                                                                                                                                                                                        ''PEARL RIVER'',
                                                                                                                                                                                                        ''STONE'') THEN ''5''
                                                                                                                                                                                      WHEN jd.typecode_stg=''MS''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''HANCOCK'',
                                                                                                                                                                                                        ''HARRISON'',
                                                                                                                                                                                                        ''JACKSON'') THEN ''6''
                                                                                                                                                                                      WHEN jd.typecode_stg=''MS''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''HINDS'',
                                                                                                                                                                                                        ''MADISON'',
                                                                                                                                                                                                        ''RANKIN'') THEN ''31''
                                                                                                                                                                                      WHEN jd.typecode_stg=''MS''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''ADAMS'',
                                                                                                                                                                                                        ''ALCORN'',
                                                                                                                                                                                                        ''ATTALA'',
                                                                                                                                                                                                        ''BENTON'',
                                                                                                                                                                                                        ''BOLIVAR'',
                                                                                                                                                                                                        ''CALHOUN'',
                                                                                                                                                                                                        ''CARROLL'',
                                                                                                                                                                                                        ''CHICKASAW'',
                                                                                                                                                                                                        ''CHOCTAW'',
                                                                                                                                                                                                        ''CLAIBORNE'',
                                                                                                                                                                                                        ''CLARKE'',
                                                                                                                                                                                                        ''CLAY'',
                                                                                                                                                                                                        ''COAHOMA'',
                                                                                                                                                                                                        ''COPIAH'',
                                                                                                                                                                                                        ''COVINGTON'',
                                                                                                                                                                                                        ''DESOTO'',
                                                                                                                                                                                                        ''FRANKLIN'',
                                                                                                                                                                                                        ''GRENADA'',
                                                                                                                                                                                                        ''HOLMES'',
                                                                                                                                                                                                        ''HUMPHREYS'',
                                                                                                                                                                                                        ''ISSAQUENA'',
                                                                                                                                                                                                        ''ITAWAMBA'',
                                                                                                                                                                                                        ''JASPER'',
                                                                                                                                                                                                        ''JEFFERSON'',
                                                                                                                                                                                                        ''JEFFERSON DAVIS'',
                                                                                                                                                                                                        ''JONES'',
                                                                                                                                                                                                        ''KEMPER'',
                                                                                                                                                                                                        ''LAFAYETTE'',
                                                                                                                                                                                                        ''LAUDERDALE'',
                                                                                                                                                                                                        ''LAWRENCE'',
                                                                                                                                                                                                        ''LEAKE'',
                                                                                                                                                                                                        ''LEE'',
                                                                                                                                                                                                        ''LEFLORE'',
                                                                                                                                                                                                        ''LINCOLN'',
                                                                                                                                                                                                        ''LOWNDES'',
                                                                                                                                                                                                        ''MARSHALL'',
                                                                                                                                                                                                        ''MONROE'',
                                                                                                                                                                                                        ''MONTGOMERY'',
                                                                                                                                                                                                        ''NESHOBA'',
                                                                                                                                                                                                        ''NEWTON'',
                                                                                                                                                                                                        ''NOXUBEE'',
                                                                                                                                                                                                        ''OKTIBBEHA'',
                                                                                                                                                                                                        ''PANOLA'',
                                                                                                                                                                                                        ''PONTOTOC'',
                                                                                                                                                                                                        ''PRENTISS'',
                                                                                                                                                                                                        ''QUITMAN'',
                                                                                                                                                                                                        ''SCOTT'',
                                                                                                                                                                                                        ''SHARKEY'',
                                                                                                                                                                                                        ''SIMPSON'',
                                                                                                                                                                                                        ''SMITH'',
                                                                                                                                                                                                        ''SUNFLOWER'',
                                                                                                                                                                                                        ''TALLAHATCHIE'',
                                                                                                                                                                                                        ''TATE'',
                                                                                                                                                                                                        ''TIPPAH'',
                                                                                                                                                                                                        ''TISHOMINGO'',
                                                                                                                                                                                                        ''TUNICA'',
                                                                                                                                                                                                        ''UNION'',
                                                                                                                                                                                                        ''WARREN'',
                                                                                                                                                                                                        ''WASHINGTON'',
                                                                                                                                                                                                        ''WAYNE'',
                                                                                                                                                                                                        ''WEBSTER'',
                                                                                                                                                                                                        ''WINSTON'',
                                                                                                                                                                                                        ''YALOBUSHA'',
                                                                                                                                                                                                        ''YAZOO'') THEN ''32''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''ATLANTA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''FULTON'') THEN ''32''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''MACON''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''BIBB'' THEN ''35''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.city_stg)= ''SAVANNAH''
                                                                                                                                                                                      AND             upper(addr.county_stg)=''CHATHAM'' THEN ''30''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''BRYAN'',
                                                                                                                                                                                                        ''CAMDEN'',
                                                                                                                                                                                                        ''CHATHAM'',
                                                                                                                                                                                                        ''GLYNN'',
                                                                                                                                                                                                        ''LIBERTY'',
                                                                                                                                                                                                        ''MCINTOSH'') THEN ''31''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''FULTON'') THEN ''33''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''CLAYTON'',
                                                                                                                                                                                                        ''COBB'',
                                                                                                                                                                                                        ''GWINNETT'') THEN ''34''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''CATOOSA'',
                                                                                                                                                                                                        ''WALKER'',
                                                                                                                                                                                                        ''WHITFIELD'') THEN ''36''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) =''RICHMOND'' THEN ''37''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''CHATTAHOOCHEE'',
                                                                                                                                                                                                        ''MUSCOGEE'') THEN ''38''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''BUTTS'',
                                                                                                                                                                                                        ''CHEROKEE'',
                                                                                                                                                                                                        ''DOUGLAS'',
                                                                                                                                                                                                        ''FAYETTE'',
                                                                                                                                                                                                        ''FORSYTH'',
                                                                                                                                                                                                        ''HENRY'',
                                                                                                                                                                                                        ''NEWTON'',
                                                                                                                                                                                                        ''PAULDING'',
                                                                                                                                                                                                        ''ROCKDALE'',
                                                                                                                                                                                                        ''WALTON'') THEN ''39''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''BALDWIN'',
                                                                                                                                                                                                        ''BANKS'',
                                                                                                                                                                                                        ''BARROW'',
                                                                                                                                                                                                        ''BARTOW'',
                                                                                                                                                                                                        ''CARROLL'',
                                                                                                                                                                                                        ''CHATTOOGA'',
                                                                                                                                                                                                        ''CLARKE'',
                                                                                                                                                                                                        ''COLUMBIA'',
                                                                                                                                                                                                        ''COWETA'',
                                                                                                                                                                                                        ''DADE'',
                                                                                                                                                                                                        ''DAWSON'',
                                                                                                                                                                                                        ''ELBERT'',
                                                                                                                                                                                                        ''FANNIN'',
                                                                                                                                                                                                        ''FLOYD'',
                                                                                                                                                                                                        ''FRANKLIN'',
                                                                                                                                                                                                        ''GILMER'',
                                                                                                                                                                                                        ''GORDON'',
                                                                                                                                                                                                        ''GREENE'',
                                                                                                                                                                                                        ''HABERSHAM'',
                                                                                                                                                                                                        ''HALL'',
                                                                                                                                                                                                        ''HANCOCK'',
                                                                                                                                                                                                        ''HARALSON'',
                                                                                                                                                                                                        ''HART'',
                                                                                                                                                                                                        ''HEARD'',
                                                                                                                                                                                                        ''JACKSON'',
                                                                                                                                                                                                        ''JASPER'',
                                                                                                                                                                                                        ''JONES'',
                                                                                                                                                                                                        ''LAMAR'',
                                                                                                                                                                                                        ''LINCOLN'',
                                                                                                                                                                                                        ''LUMPKIN'',
                                                                                                                                                                                                        ''MADISON'',
                                                                                                                                                                                                        ''MCDUFFIE'',
                                                                                                                                                                                                        ''MERIWETHER'',
                                                                                                                                                                                                        ''MONROE'',
                                                                                                                                                                                                        ''MORGAN'',
                                                                                                                                                                                                        ''MURRAY'',
                                                                                                                                                                                                        ''OCONEE'',
                                                                                                                                                                                                        ''OGLETHORPE'',
                                                                                                                                                                                                        ''PICKENS'',
                                                                                                                                                                                                        ''PIKE'',
                                                                                                                                                                                                        ''POLK'',
                                                                                                                                                                                                        ''PUTNAM'',
                                                                                                                                                                                                        ''RABUN'',
                                                                                                                                                                                                        ''SPALDING'',
                                                                                                                                                                                                        ''STEPHENS'',
                                                                                                                                                                                                        ''TALIAFERRO'',
                                                                                                                                                                                                        ''TOWNS'',
                                                                                                                                                                                                        ''TROUP'',
                                                                                                                                                                                                        ''UNION'',
                                                                                                                                                                                                        ''WARREN'',
                                                                                                                                                                                                        ''WHITE'',
                                                                                                                                                                                                        ''WILKES'') THEN ''40''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''BAKER'',
                                                                                                                                                                                                        ''BIBB'',
                                                                                                                                                                                                        ''BROOKS'',
                                                                                                                                                                                                        ''CALHOUN'',
                                                                                                                                                                                                        ''CLAY'',
                                                                                                                                                                                                        ''COLQUITT'',
                                                                                                                                                                                                        ''CRAWFORD'',
                                                                                                                                                                                                        ''CRISP'',
                                                                                                                                                                                                        ''DECATUR'',
                                                                                                                                                                                                        ''DOOLY'',
                                                                                                                                                                                                        ''DOUGHERTY'',
                                                                                                                                                                                                        ''EARLY'',
                                                                                                                                                                                                        ''GRADY'',
                                                                                                                                                                                                        ''HARRIS'',
                                                                                                                                                                                                        ''HOUSTON'',
                                                                                                                                                                                                        ''LEE'',
                                                                                                                                                                                                        ''MACON'',
                                                                                                                                                                                                        ''MARION'',
                                                                                                                                                                                                        ''MILLER'',
                                                                                                                                                                                                        ''MITCHELL'',
                                                                                                                                                                                                        ''PEACH'',
                                                                                                                                                                                                        ''QUITMAN'',
                                                                                                                                                                                                        ''RANDOLPH'',
                                                                                                                                                                                                        ''SCHLEY'',
                                                                                                                                                                                                        ''SEMINOLE'',
                                                                                                                                                                                                        ''STEWART'',
                                                                                                                                                                                                        ''SUMTER'',
                                                                                                                                                                                                        ''TALBOT'',
                                                                                                                                                                                                        ''TAYLOR'',
                                                                                                                                                                                                        ''TERRELL'',
                                                                                                                                                                                                        ''THOMAS'',
                                                                                                                                                                                                        ''TIFT'',
                                                                                                                                                                                                        ''TURNER'',
                                                                                                                                                                                                        ''UPSON'',
                                                                                                                                                                                                        ''WEBSTER'',
                                                                                                                                                                                                        ''WORTH'') THEN ''41''
                                                                                                                                                                                      WHEN jd.typecode_stg=''GA''
                                                                                                                                                                                      AND             upper(addr.county_stg) IN (''APPLING'',
                                                                                                                                                                                                        ''ATKINSON'',
                                                                                                                                                                                                        ''BACON'',
                                                                                                                                                                                                        ''BEN HILL'',
                                                                                                                                                                                                        ''BERRIEN'',
                                                                                                                                                                                                        ''BLECKLEY'',
                                                                                                                                                                                                        ''BRANTLEY'',
                                                                                                                                                                                                        ''BULLOCH'',
                                                                                                                                                                                                        ''BURKE'',
                                                                                                                                                                                                        ''CANDLER'',
                                                                                                                                                                                                        ''CHARLTON'',
                                                                                                                                                                                                        ''CLINCH'',
                                                                                                                                                                                                        ''COFFEE'',
                                                                                                                                                                                                        ''COOK'',
                                                                                                                                                                                                        ''DODGE'',
                                                                                                                                                                                                        ''ECHOLS'',
                                                                                                                                                                                                        ''EFFINGHAM'',
                                                                                                                                                                                                        ''EMANUEL'',
                                                                                                                                                                                                        ''EVANS'',
                                                                                                                                                                                                        ''GLASCOCK'',
                                                                                                                                                                                                        ''IRWIN'',
                                                                                                                                                                                                        ''JEFF DAVIS'',
                                                                                                                                                                                                        ''JEFFERSON'',
                                                                                                                                                                                                        ''JENKINS'',
                                                                                                                                                                                                        ''JOHNSON'',
                                                                                                                                                                                                        ''LANIER'',
                                                                                                                                                                                                        ''LAURENS'',
                                                                                                                                                                                                        ''LONG'',
                                                                                                                                                                                                        ''LOWNDES'',
                                                                                                                                                                                                        ''MONTGOMERY'',
                                                                                                                                                                                                        ''PIERCE'',
                                                                                                                                                                                                        ''PULASKI'',
                                                                                                                                                                                                        ''SCREVEN'',
                                                                                                                                                                                                        ''TATTNALL'',
                                                                                                                                                                                                        ''TELFAIR'',
                                                                                                                                                                                                        ''TOOMBS'',
                                                                                                                                                                                                        ''TREUTLEN'',
                                                                                                                                                                                                        ''TWIGGS'',
                                                                                                                                                                                                        ''WARE'',
                                                                                                                                                                                                        ''WASHINGTON'',
                                                                                                                                                                                                        ''WAYNE'',
                                                                                                                                                                                                        ''WHEELER'',
                                                                                                                                                                                                        ''WILCOX'',
                                                                                                                                                                                                        ''WILKINSON'') THEN ''42''
                                                                                                                                                                      END)                                                  AS territorycode_stg,
                                                                                                                                                                    LPAD (TO_CHAR (addr.postalcodedenorm_stg), 5, ''0'') AS zipcode_stg,
                                                                                                                                                                      DATE_PART (YEAR, pol.effectivedate_stg) AS policyeffectiveyear_stg,
                                                                                                                                                                      clm.claimnumber_stg                                   AS claimidentifier_stg,
                                                                                                                                                                      legacypolind_alfa_stg,
                                                                                                                                                                      /* ---Amy''s query for metrics-----------start-------*/
                                                                                                                                                                      rank() over( PARTITION BY clm.claimnumber_stg ORDER BY cov.typecode_stg ASC) AS covrank_stg,
                                                                                                                                                                      clm.closedate_stg                                                               AS closedate_stg, 
                                                                                                                                                                      (
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Deductible''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        (
                                                                                                                                                                                                        txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp))
                                                                                                                                                                                                        OR              (
                                                                                                                                                                                                        ch.issuedate_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)))) THEN txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Deductible Refund''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        (
                                                                                                                                                                                                        txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp))
                                                                                                                                                                                                        OR              (
                                                                                                                                                                                                        ch.issuedate_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)))) THEN txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Former Deductible''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        (
                                                                                                                                                                                                        txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp))
                                                                                                                                                                                                        OR              (
                                                                                                                                                                                                        ch.issuedate_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)))) THEN txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Loss''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        (
                                                                                                                                                                                                        txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp))
                                                                                                                                                                                                        OR              (
                                                                                                                                                                                                        ch.issuedate_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)))) THEN txli.transactionamount_stg
                                                                                                                                                                                                      /* Added as part of ticket EIM-46304 */
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Diminished Value''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        (
                                                                                                                                                                                                        txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp))
                                                                                                                                                                                                        OR              (
                                                                                                                                                                                                        ch.issuedate_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)))) THEN txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Credit to loss''
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Deductible''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Credit to loss''
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Loss''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Credit to loss''
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Recovery''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      ELSE ''0''
                                                                                                                                                                      END) AS acct500104_stg, (
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Salvage''
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Recovery''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg
                                                                                                                                                                                      ELSE 0
                                                                                                                                                                      END) AS acct500204_stg, (
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Salvage Expense''
                                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        (
                                                                                                                                                                                                        txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp))
                                                                                                                                                                                                        OR              (
                                                                                                                                                                                                        cast(ch.updatetime_stg AS DATE) >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             cast(ch.updatetime_stg AS DATE) <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                        AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)))) THEN txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Credit to Expense''
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Salvage Expense''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Salvage''
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Salvage Expense''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Salvage''
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Recovery''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      ELSE 0
                                                                                                                                                                      END) AS acct500214_stg, (
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Subrogation''
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Recovery''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg
                                                                                                                                                                                      ELSE 0
                                                                                                                                                                      END) AS acct500304_stg, (
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Subrogation Expense''
                                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        (
                                                                                                                                                                                                        txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp))
                                                                                                                                                                                                        OR              (
                                                                                                                                                                                                        ch.issuedate_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)))) THEN txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Credit to Expense''
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Subrogation Expense''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Subrogation''
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Subrogation Expense''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Subrogation''
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Recovery''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      ELSE 0
                                                                                                                                                                      END) AS acct500314_stg, (
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Legal - Defense''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             (
                                                                                                                                                                                                        (
                                                                                                                                                                                                        txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp))
                                                                                                                                                                                                        OR              (
                                                                                                                                                                                                        ch.issuedate_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                        AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                        AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)))) THEN txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Recovery''
                                                                                                                                                                                                      AND             rctl.name_stg = ''Credit to Expense''
                                                                                                                                                                                                      AND             cctl.name_stg=''Expense''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Expense''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Legal - Defense''
                                                                                                                                                                                                      AND             txli.createtime_stg >= cast(:cc_boy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN txli.transactionamount_stg*-1
                                                                                                                                                                                      ELSE 0
                                                                                                                                                                      END) AS acct521004_stg,
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Deductible''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp) ) THEN (tx.doesnoterodereserves_stg-1)*txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Deductible Refund''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp) ) THEN (tx.doesnoterodereserves_stg-1)*txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Former Deductible''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp) ) THEN (tx.doesnoterodereserves_stg-1)*txli.transactionamount_stg
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Loss''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN (tx.doesnoterodereserves_stg-1)*txli.transactionamount_stg
                                                                                                                                                                                                      /* Added as part of ticket EIM-46304 */
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Payment''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             cttl.name_stg = ''Paid Loss''
                                                                                                                                                                                                      AND             pmtl.name_stg <> ''Expense Withheld''
                                                                                                                                                                                                      AND             lctl.name_stg = ''Diminished Value''
                                                                                                                                                                                                      AND             ch.issuedate_stg <= cast(:cc_eoy AS timestamp)
                                                                                                                                                                                                      AND             txli.createtime_stg <= cast(:cc_eoy AS timestamp)) THEN (tx.doesnoterodereserves_stg-1)*txli.transactionamount_stg
                                                                                                                                                                                      ELSE 0
                                                                                                                                                                      END AS losspaymentscurrmo_stg,
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN (
                                                                                                                                                                                                        txtl.name_stg=''Reserve''
                                                                                                                                                                                                      AND             rctl.name_stg IS NULL
                                                                                                                                                                                                      AND             cctl.name_stg=''Loss''
                                                                                                                                                                                                      AND             txli.createtime_stg <=cast(:cc_eoy AS timestamp) ) THEN txli.transactionamount_stg
                                                                                                                                                                                      ELSE 0
                                                                                                                                                                      END AS eoq_stg ,
                                                                                                                                                                      /* ---Amy''s query for metrics-----------end-------*/
                                                                                                                                                                      pol.policynumber_stg,
                                                                                                                                                                      txli.id_stg,
                                                                                                                                                                      addr.city_stg,
                                                                                                                                                                      psttl.typecode_stg                                    AS policysubtype_stg,
                                                                                                                                                                      left(cast(exps.claimantdenormid_stg AS VARCHAR(3)),3)    claimantdenormid_stg,
                                                                                                                                                                      pol.effectivedate_stg                                    effectivedate_stg,
                                                                                                                                                                      yearbuilt_alfa_stg,
                                                                                                                                                                      '''' no_of_family_codes_stg,
                                                                                                                                                                      CASE
                                                                                                                                                                                      WHEN cc_ct.typecode_stg IN (''ADB'',
                                                                                                                                                                                                        ''AOD'',
                                                                                                                                                                                                        ''CLP'',
                                                                                                                                                                                                        ''COM'',
                                                                                                                                                                                                        ''CUS'',
                                                                                                                                                                                                        ''DOM'',
                                                                                                                                                                                                        ''F'',
                                                                                                                                                                                                        ''FRM'',
                                                                                                                                                                                                        ''FST'',
                                                                                                                                                                                                        ''GLA'',
                                                                                                                                                                                                        ''HEA'',
                                                                                                                                                                                                        ''L'',
                                                                                                                                                                                                        ''LOG'',
                                                                                                                                                                                                        ''LIG'',
                                                                                                                                                                                                        ''NON'',
                                                                                                                                                                                                        ''OTH'',
                                                                                                                                                                                                        ''OTHER'',
                                                                                                                                                                                                        ''PFR'',
                                                                                                                                                                                                        ''STU'',
                                                                                                                                                                                                        ''STW'',
                                                                                                                                                                                                        ''TLU'',
                                                                                                                                                                                                        ''UNK'',
                                                                                                                                                                                                        ''WOO'',
                                                                                                                                                                                                        ''WSC'') THEN ''1''
                                                                                                                                                                                      WHEN cc_ct.typecode_stg IN (''BCB'',
                                                                                                                                                                                                        ''BLB'',
                                                                                                                                                                                                        ''BRC'',
                                                                                                                                                                                                        ''BRF'',
                                                                                                                                                                                                        ''BRS'',
                                                                                                                                                                                                        ''BST'',
                                                                                                                                                                                                        ''FRY'',
                                                                                                                                                                                                        ''SRO'',
                                                                                                                                                                                                        ''STV'',
                                                                                                                                                                                                        ''TBM'',
                                                                                                                                                                                                        ''WBR'',
                                                                                                                                                                                                        ''WCB'',
                                                                                                                                                                                                        ''WSN'') THEN ''2''
                                                                                                                                                                                      WHEN cc_ct.typecode_stg IN (''BRK'',
                                                                                                                                                                                                        ''CCM'',
                                                                                                                                                                                                        ''CNB'',
                                                                                                                                                                                                        ''CND'',
                                                                                                                                                                                                        ''CRE'',
                                                                                                                                                                                                        ''FLX'',
                                                                                                                                                                                                        ''M'',
                                                                                                                                                                                                        ''MAS'',
                                                                                                                                                                                                        ''MTU'',
                                                                                                                                                                                                        ''TUC'',
                                                                                                                                                                                                        ''SFM'') THEN ''3''
                                                                                                                                                                                      WHEN cc_ct.typecode_stg IN (''BLM'',
                                                                                                                                                                                                        ''BLS'',
                                                                                                                                                                                                        ''BRL'',
                                                                                                                                                                                                        ''BRM'',
                                                                                                                                                                                                        ''CCS'',
                                                                                                                                                                                                        ''MET'',
                                                                                                                                                                                                        ''PRM'',
                                                                                                                                                                                                        ''S'',
                                                                                                                                                                                                        ''STE'',
                                                                                                                                                                                                        ''STS'') THEN ''4''
                                                                                                                                                                                      WHEN cc_ct.typecode_stg IN (''ALF'',
                                                                                                                                                                                                        ''ALS'',
                                                                                                                                                                                                        ''ALV'',
                                                                                                                                                                                                        ''FRS'',
                                                                                                                                                                                                        ''WMT'',
                                                                                                                                                                                                        ''WSL'',
                                                                                                                                                                                                        ''MAN'') THEN ''5''
                                                                                                                                                                      END                                    construction_stg,
                                                                                                                                                                      rsk.dwellingprotectionclasscode_stg AS protectionclasscode_stg,
                                                                                                                                                                      naiipcitc_alfa_stg,
                                                                                                                                                                      postalcode_stg
                                                                                                                                                      FROM            db_t_prod_stag.cc_claim clm
                                                                                                                                                      join            db_t_prod_stag.cc_policy pol
                                                                                                                                                      ON              clm.policyid_stg=pol.id_stg
                                                                                                                                                      AND             ((
                                                                                                                                                                                                      clm.reporteddate_stg >= cast(cast(:cc_eoy AS timestamp) AS DATE) - interval ''5 YEAR''
                                                                                                                                                                                      AND             clm.reporteddate_stg <= cast(:cc_eoy AS timestamp))
                                                                                                                                                                      AND             (
                                                                                                                                                                                                      clm.lossdate_stg >= cast(cast(:cc_eoy AS timestamp) AS DATE) - interval ''5 YEAR''
                                                                                                                                                                                      AND             clm.lossdate_stg <= cast(:cc_eoy AS timestamp)))
                                                                                                                                                      AND             clm.claimnumber_stg LIKE ''F%''
                                                                                                                                                      join            db_t_prod_stag.cctl_claimstate sts
                                                                                                                                                      ON              clm.state_stg= sts.id_stg
                                                                                                                                                      AND             sts.name_stg <> ''Draft''
                                                                                                                                                      join            db_t_prod_stag.cctl_underwritingcompanytype uwc
                                                                                                                                                      ON              pol.underwritingco_stg=uwc.id_stg
                                                                                                                                                      join            db_t_prod_stag.cctl_jurisdiction jd
                                                                                                                                                      ON              pol.basesate_alfa_stg=jd.id_stg
                                                                                                                                                      join            db_t_prod_stag.cctl_policytype pttl
                                                                                                                                                      ON              pttl.id_stg = pol.policytype_stg
                                                                                                                                                      join            db_t_prod_stag.cctl_policysubtype_alfa psttl
                                                                                                                                                      ON              psttl.id_stg = pol.policysubtype_alfa_stg
                                                                                                                                                      AND             psttl.typecode_stg IN (''SF1'',
                                                                                                                                                                                             ''SF2'',
                                                                                                                                                                                             ''SF3'')
                                                                                                                                                      join            db_t_prod_stag.cc_incident inc
                                                                                                                                                      ON              clm.id_stg=inc.claimid_stg
                                                                                                                                                      join            db_t_prod_stag.cc_exposure exps
                                                                                                                                                      ON              inc.id_stg=exps.incidentid_stg
                                                                                                                                                      AND             exps.retired_stg = 0
                                                                                                                                                      left join       db_t_prod_stag.cc_coverage cc_cov
                                                                                                                                                      ON              cc_cov.id_stg=exps.coverageid_stg
                                                                                                                                                      join            db_t_prod_stag.cctl_coveragesubtype cov
                                                                                                                                                      ON              cov.id_stg=exps.coveragesubtype_stg
                                                                                                                                                      left join       db_t_prod_stag.cc_riskunit rsk
                                                                                                                                                      ON              rsk.policyid_stg=clm.policyid_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_constructiontype_alfa cc_ct
                                                                                                                                                      ON              cc_ct.id_stg=constructiontype_alfa_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_dwellingusage_alfa cc_dt
                                                                                                                                                      ON              cc_dt.id_stg=dwellingusage_alfa_stg
                                                                                                                                                      join            db_t_prod_stag.cctl_coveragetype tl3
                                                                                                                                                      ON              tl3.id_stg = exps.primarycoverage_stg
                                                                                                                                                      join            db_t_prod_stag.cc_transaction tx
                                                                                                                                                      ON              tx.exposureid_stg = exps.id_stg
                                                                                                                                                      AND             tx.retired_stg = 0
                                                                                                                                                      join            db_t_prod_stag.cc_transactionlineitem txli
                                                                                                                                                      ON              txli.transactionid_stg = tx.id_stg
                                                                                                                                                      join            db_t_prod_stag.cctl_transactionstatus tl4
                                                                                                                                                      ON              tl4.id_stg = tx.status_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_transaction txtl
                                                                                                                                                      ON              txtl.id_stg = tx.subtype_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_linecategory lctl
                                                                                                                                                      ON              lctl.id_stg = txli.linecategory_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_recoverycategory rctl
                                                                                                                                                      ON              rctl.id_stg = tx.recoverycategory_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_costcategory cctl
                                                                                                                                                      ON              cctl.id_stg = tx.costcategory_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_costtype cttl
                                                                                                                                                      ON              cttl.id_stg = tx.costtype_stg
                                                                                                                                                      left join       db_t_prod_stag.cc_catastrophe cat
                                                                                                                                                      ON              cat.id_stg = clm.catastropheid_stg
                                                                                                                                                      left join       db_t_prod_stag.cc_check ch
                                                                                                                                                      ON              ch.id_stg = tx.checkid_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_paymentmethod pmtl
                                                                                                                                                      ON              pmtl.id_stg = ch.paymentmethod_stg
                                                                                                                                                      left join       db_t_prod_stag.cc_vehicle ccv
                                                                                                                                                      ON              inc.vehicleid_stg=ccv.id_stg
                                                                                                                                                      join            db_t_prod_stag.cctl_losscause lc
                                                                                                                                                      ON              lc.id_stg = clm.losscause_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_residencetype_alfa cctl_rt
                                                                                                                                                      ON              cctl_rt.id_stg=residencetype_alfa_stg
                                                                                                                                                                      /*  Territory Code*/
                                                                                                                                                                     
                                                                                                                                                      left join       db_t_prod_stag.cc_policylocation cc_pl
                                                                                                                                                      ON              pol.id_stg=cc_pl.policyid_stg
                                                                                                                                                                      /* Zip Code*/
                                                                                                                                                                      
                                                                                                                                                      left join       db_t_prod_stag.cc_address addr
                                                                                                                                                      ON              addr.id_stg=cc_pl.addressid_stg
                                                                                                                                                      left join       db_t_prod_stag.cctl_state c_st
                                                                                                                                                      ON              jd.id_stg=addr.state_stg
                                                                                                                                                      AND             jd.typecode_stg IN (''al'',
                                                                                                                                                                                          ''ga'',
                                                                                                                                                                                          ''ms'')
                                                                                                                                                      left join
                                                                                                                                                                      (
                                                                                                                                                                               SELECT   policyid_stg,
                                                                                                                                                                                        max(
                                                                                                                                                                                        CASE
                                                                                                                                                                                                 WHEN naiipcidetailtype_stg=''HODW_OtherPerils_Ded_HOE'' THEN (
                                                                                                                                                                                                        CASE
                                                                                                                                                                                                        WHEN description_stg=''PERCENTAGE VALUE'' THEN ''F''
                                                                                                                                                                                                        ELSE ''D''
                                                                                                                                                                                                        END)
                                                                                                                                                                                        END)AS perils_limit_ind_stg,
                                                                                                                                                                                        max(
                                                                                                                                                                                        CASE
                                                                                                                                                                                                 WHEN naiipcidetailtype_stg=''HODW_OtherPerils_Ded_HOE'' THEN (
                                                                                                                                                                                                        CASE
                                                                                                                                                                                                        WHEN substring(value_stg,length(value_stg),1) IN (''%'',
                                                                                                                                                                                                        ''k'') THEN substring(value_stg,1, length(value_stg)-1)
                                                                                                                                                                                                        ELSE value_stg
                                                                                                                                                                                                        END)
                                                                                                                                                                                        END) AS perils_limit_stg,
                                                                                                                                                                                        max(
                                                                                                                                                                                        CASE
                                                                                                                                                                                                 WHEN naiipcidetailtype_stg =''HODW_Earthquake_HOE'' THEN naiipcidetailtype_stg
                                                                                                                                                                                        END) earthquake,
                                                                                                                                                                                        max(
                                                                                                                                                                                        CASE
                                                                                                                                                                                                 WHEN naiipcidetailtype_stg =''HODW_PersonalPropertyReplacementCost_alfa'' THEN naiipcidetailtype_stg
                                                                                                                                                                                        END) replacement,
                                                                                                                                                                                        max(
                                                                                                                                                                                        CASE
                                                                                                                                                                                                 WHEN (
                                                                                                                                                                                                        naiipcidetailtype_stg =''HODW_WindHail_Ded_HOE'') THEN naiipcidetailtype_stg
                                                                                                                                                                                        END )windhail,
                                                                                                                                                                                        max(
                                                                                                                                                                                        CASE
                                                                                                                                                                                                 WHEN (
                                                                                                                                                                                                        naiipcidetailtype_stg =''HODW_Hurricane_Ded_HOE'' ) THEN naiipcidetailtype_stg
                                                                                                                                                                                        END )hurricane,
                                                                                                                                                                                        max(
                                                                                                                                                                                        CASE
                                                                                                                                                                                                 WHEN (
                                                                                                                                                                                                        naiipcidetailtype_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'') THEN naiipcidetailtype_stg
                                                                                                                                                                                        END )windstormhailexcl,
                                                                                                                                                                                        max(
                                                                                                                                                                                        CASE
                                                                                                                                                                                                 WHEN (
                                                                                                                                                                                                        naiipcidetailtype_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'') THEN value_stg
                                                                                                                                                                                        END )windstormhailexcl_amt
                                                                                                                                                                               FROM     db_t_prod_stag.ccx_naiipcidetail_alfa
                                                                                                                                                                               WHERE    naiipcidetailtype_stg LIKE ''HODW%''
                                                                                                                                                                               GROUP BY policyid_stg) ded
                                                                                                                                                      ON              ded.policyid_stg=pol.id_stg
                                                                                                                                                      WHERE           tl4.name_stg NOT IN (''Awaiting submission'',
                                                                                                                                                                                           ''Rejected'',
                                                                                                                                                                                           ''Submitting'',
                                                                                                                                                                                           ''Pending approval'') 
                                                                                                                              ) a
                                                                                                                             GROUP BY policysystemperiodid_stg,
                                                                                                                                      companynumber_stg,
                                                                                                                                      lob_stg,
                                                                                                                                      statecode_stg,
                                                                                                                                      occupancycode_stg,
                                                                                                                                      covrank_stg,
                                                                                                                                      closedate_stg,
                                                                                                                                      callyear_stg,
                                                                                                                                      accountingyear_stg,
                                                                                                                                      exp_yr_stg,
                                                                                                                                      exp_mth_stg,
                                                                                                                                      exp_day_stg,
                                                                                                                                      /*Losscause,*/
                                                                                                                                      territorycode_stg,
                                                                                                                                      zipcode_stg,
                                                                                                                                      policyeffectiveyear_stg,
                                                                                                                                      a.policysubtype_stg,
                                                                                                                                      claimidentifier_stg,
                                                                                                                                      city_stg,
                                                                                                                                      policynumber_stg,
                                                                                                                                      claimantdenormid_stg,
                                                                                                                                      losscause_stg,
                                                                                                                                      effectivedate_stg,
                                                                                                                                      legacypolind_alfa_stg,
                                                                                                                                      yearbuilt_alfa_stg,
                                                                                                                                      no_of_family_codes_stg,
                                                                                                                                      construction_stg,
                                                                                                                                      protectionclasscode_stg,
                                                                                                                                      naiipcitc_alfa_stg ,
                                                                                                                                      postalcode_stg
                                                                                                                ) b
                                                                                                           GROUP BY policysystemperiodid_stg,
                                                                                                                    effectivedate_stg,
                                                                                                                    legacypolind_alfa_stg,
                                                                                                                    companynumber_stg,
                                                                                                                    lob_stg,
                                                                                                                    statecode_stg,
                                                                                                                    callyear_stg,
                                                                                                                    accountingyear_stg,
                                                                                                                    exp_yr_stg,
                                                                                                                    exp_mth_stg,
                                                                                                                    exp_day_stg,
                                                                                                                    occupancycode_stg,
                                                                                                                    territorycode_stg,
                                                                                                                    zipcode_stg,
                                                                                                                    policyeffectiveyear_stg,
                                                                                                                    claimidentifier_stg,
                                                                                                                    policynumber_stg,
                                                                                                                    city_stg,
                                                                                                                    losscause_stg,
                                                                                                                    ann_stmt_lob_stg,
                                                                                                                    policysubtype_stg,
                                                                                                                    claimantdenormid_stg,
                                                                                                                    yearbuilt_alfa_stg,
                                                                                                                    no_of_family_codes_stg,
                                                                                                                    construction_stg,
                                                                                                                    protectionclasscode_stg,
                                                                                                                    naiipcitc_alfa_stg ,
                                                                                                                    postalcode_stg,
                                                                                                                    CASE
                                                                                                                             WHEN policysubtype_stg IN (''SF2'',
                                                                                                                                                        ''SF3'')THEN''28''
                                                                                                                             ELSE ''10''
                                                                                                                    END
                                                                                                           HAVING   SUM(outres_stg)<>0.00
                                                                                                           OR       SUM(paidloss_stg)<>0.00 )a ) sq_clm
                                                  left outer join
                                                                  (
                                                                         SELECT territorycode_stg         AS territorycode,
                                                                                zipcode_stg               AS zipcode,
                                                                                itemcode_stg              AS itemcode,
                                                                                sublinecode_stg           AS sublinecode,
                                                                                occupancy_code_stg        AS occupancy_code,
                                                                                buildingcontents_stg      AS buildingcontents,
                                                                                construction_stg          AS construction,
                                                                                protectionclasscode_stg   AS protectionclasscode,
                                                                                typeofdeductiblecode_stg  AS typeofdeductiblecode,
                                                                                amountofinsurance_stg     AS amountofinsurance,
                                                                                yearofmanufacture_stg     AS yearofmanufacture,
                                                                                ded_ind_stg               AS ded_ind,
                                                                                ded_amount_stg            AS ded_amount,
                                                                                deductibleindicatorws_stg AS deductibleindicatorws,
                                                                                deductibleamountws_stg    AS deductibleamountws,
                                                                                policynumber_stg          AS policynumber,
                                                                                policyperiodid_stg        AS policyperiodid
                                                                         FROM   (
                                                                                                SELECT DISTINCT row_number() over( PARTITION BY pp.id_stg, policynumber_stg ORDER BY pp.updatetime_stg DESC) rnk_stg,
                                                                                                                CASE
                                                                                                                                WHEN occ_type.typecode_stg =''tenant'' THEN ''06''
                                                                                                                                ELSE ''01''
                                                                                                                END                                                            occupancy_code_stg ,
                                                                                                                cast(cast(terr.code_stg AS NUMBER) AS VARCHAR(255))            AS territorycode_stg,
                                                                                                                coalesce(substring( terr.postalcodeinternal_stg,1,5) , ''00000'')AS zipcode_stg,
                                                                                                                ''03''                                                              itemcode_stg,
                                                                                                                CASE
                                                                                                                                WHEN ph.typecode_stg IN (''SF1'') THEN ''10''
                                                                                                                                ELSE ''28''
                                                                                                                END AS sublinecode_stg,
                                                                                                                CASE
                                                                                                                                WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireDwellingPolicySubtype_alfa''
                                                                                                                                AND             pr.typecode_stg=''Fam1'' THEN ''1''
                                                                                                                                WHEN pcdh.typecode_stg=''seas'' THEN ''1''
                                                                                                                                WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireContentsPolicySubtype_alfa''
                                                                                                                                AND             pr.typecode_stg=''Fam1'' THEN ''2''
                                                                                                                                WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireDwellingPolicySubtype_alfa''
                                                                                                                                AND             pr.typecode_stg=''Fam2'' THEN ''3''
                                                                                                                                WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireContentsPolicySubtype_alfa''
                                                                                                                                AND             pr.typecode_stg=''Fam2'' THEN ''4''
                                                                                                                                WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireDwellingPolicySubtype_alfa''
                                                                                                                                AND             pr.typecode_stg=''Fam3To4_alfa'' THEN ''7''
                                                                                                                                WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireContentsPolicySubtype_alfa''
                                                                                                                                AND             pr.typecode_stg=''Fam3To4_alfa'' THEN ''8''
                                                                                                                                WHEN choiceanswerchoicecode_alfa_stg =''HOStandardFireOtherStructurePolicySubtype_alfa'' THEN ''1''
                                                                                                                                ELSE ''1''
                                                                                                                END buildingcontents_stg,
                                                                                                                CASE
                                                                                                                                WHEN pct.typecode_stg IN (''ADB'',
                                                                                                                                                          ''AOD'',
                                                                                                                                                          ''CLP'',
                                                                                                                                                          ''COM'',
                                                                                                                                                          ''CUS'',
                                                                                                                                                          ''DOM'',
                                                                                                                                                          ''F'',
                                                                                                                                                          ''CLOTH'',
                                                                                                                                                          ''FRM'',
                                                                                                                                                          ''FST'',
                                                                                                                                                          ''GLA'',
                                                                                                                                                          ''HEA'',
                                                                                                                                                          ''L'',
                                                                                                                                                          ''LOG'',
                                                                                                                                                          ''LIG'',
                                                                                                                                                          ''NON'',
                                                                                                                                                          ''OTH'',
                                                                                                                                                          ''OTHER'',
                                                                                                                                                          ''PFR'',
                                                                                                                                                          ''STU'',
                                                                                                                                                          ''STW'',
                                                                                                                                                          ''TLU'',
                                                                                                                                                          ''UNK'',
                                                                                                                                                          ''WOO'',
                                                                                                                                                          ''WSC'') THEN ''1''
                                                                                                                                WHEN pct.typecode_stg IN (''BCB'',
                                                                                                                                                          ''BLB'',
                                                                                                                                                          ''BRC'',
                                                                                                                                                          ''BRF'',
                                                                                                                                                          ''BRS'',
                                                                                                                                                          ''BST'',
                                                                                                                                                          ''FRY'',
                                                                                                                                                          ''SRO'',
                                                                                                                                                          ''STV'',
                                                                                                                                                          ''TBM'',
                                                                                                                                                          ''WBR'',
                                                                                                                                                          ''WCB'',
                                                                                                                                                          ''WSN'') THEN ''2''
                                                                                                                                WHEN pct.typecode_stg IN (''BRK'',
                                                                                                                                                          ''CCM'',
                                                                                                                                                          ''CNB'',
                                                                                                                                                          ''CND'',
                                                                                                                                                          ''CRE'',
                                                                                                                                                          ''FLX'',
                                                                                                                                                          ''M'',
                                                                                                                                                          ''IRON'',
                                                                                                                                                          ''MAS'',
                                                                                                                                                          ''MTU'',
                                                                                                                                                          ''TUC'',
                                                                                                                                                          ''SFM'') THEN ''3''
                                                                                                                                WHEN pct.typecode_stg IN (''BLM'',
                                                                                                                                                          ''BLS'',
                                                                                                                                                          ''BRL'',
                                                                                                                                                          ''BRM'',
                                                                                                                                                          ''CCS'',
                                                                                                                                                          ''MET'',
                                                                                                                                                          ''PRM'',
                                                                                                                                                          ''S'',
                                                                                                                                                          ''STE'',
                                                                                                                                                          ''STS'') THEN ''4''
                                                                                                                                WHEN pct.typecode_stg IN (''ALF'',
                                                                                                                                                          ''ALS'',
                                                                                                                                                          ''ALV'',
                                                                                                                                                          ''FRS'',
                                                                                                                                                          ''WMT'',
                                                                                                                                                          ''WSL'') THEN ''5''
                                                                                                                                WHEN pct.typecode_stg IN (''MAN'') THEN ''6''
                                                                                                                                ELSE ''1''
                                                                                                                END construction_stg,
                                                                                                                CASE
                                                                                                                                WHEN dwellingprotectionclasscode_stg IS NULL
                                                                                                                                AND             jd.typecode_stg =''AL'' THEN ''05''
                                                                                                                                WHEN dwellingprotectionclasscode_stg IS NULL
                                                                                                                                AND             jd.typecode_stg =''GA'' THEN ''03''
                                                                                                                                WHEN dwellingprotectionclasscode_stg IS NULL
                                                                                                                                AND             jd.typecode_stg =''MS'' THEN ''10''
                                                                                                                                ELSE (substring(''00'',1,2-length(phh.dwellingprotectionclasscode_stg))
                                                                                                                                                                ||phh.dwellingprotectionclasscode_stg )
                                                                                                                END AS protectionclasscode_stg,
                                                                                                                CASE
                                                                                                                                WHEN jd.typecode_stg=''AL'' THEN (
                                                                                                                                                CASE
                                                                                                                                                                WHEN (
                                                                                                                                                                                                windhail_stg =''HODW_WindHail_Ded_HOE'')
                                                                                                                                                                AND             deductibleamountws_stg >0 THEN ''34''
                                                                                                                                                                WHEN (
                                                                                                                                                                                                hurricane_stg =''HODW_Hurricane_Ded_HOE''
                                                                                                                                                                                AND             terr.code_stg IN (''05'',
                                                                                                                                                                                                        ''06'',
                                                                                                                                                                                                        ''30'',
                                                                                                                                                                                                        ''31''))
                                                                                                                                                                AND             deductibleamountws_stg >0 THEN ''54''
                                                                                                                                                                WHEN (
                                                                                                                                                                                                hurricane_stg =''HODW_Hurricane_Ded_HOE''
                                                                                                                                                                                AND             terr.code_stg NOT IN (''05'',
                                                                                                                                                                                                        ''06'',
                                                                                                                                                                                                        ''30'',
                                                                                                                                                                                                        ''31''))
                                                                                                                                                                AND             deductibleamountws_stg >0 THEN ''34''
                                                                                                                                                                WHEN (
                                                                                                                                                                                                windstormhailexcl_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'')
                                                                                                                                                                AND             windstormhailexcl_amt_stg>0 THEN ''08''
                                                                                                                                                                ELSE ''04''
                                                                                                                                                END )
                                                                                                                                ELSE (
                                                                                                                                                CASE
                                                                                                                                                                WHEN (
                                                                                                                                                                                                windhail_stg =''HODW_WindHail_Ded_HOE'')
                                                                                                                                                                AND             deductibleamountws_stg >0 THEN ''04''
                                                                                                                                                                WHEN (
                                                                                                                                                                                                hurricane_stg =''HODW_Hurricane_Ded_HOE'' )
                                                                                                                                                                AND             deductibleamountws_stg >0 THEN ''04''
                                                                                                                                                                WHEN (
                                                                                                                                                                                                windstormhailexcl_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'')
                                                                                                                                                                AND             windstormhailexcl_amt_stg>0 THEN ''08''
                                                                                                                                                                ELSE ''02''
                                                                                                                                                END)
                                                                                                                END AS typeofdeductiblecode_stg,
                                                                                                                coalesce(lpad(cast(cast(
                                                                                                                CASE
                                                                                                                                WHEN ph.typecode_stg IN (''SF1'' ,
                                                                                                                                                         ''SF2'',
                                                                                                                                                         ''SF3'')
                                                                                                                                AND             dw_limit_stg>0 THEN dw_limit_stg
                                                                                                                                WHEN ph.typecode_stg IN (''SF1'' ,
                                                                                                                                                         ''SF2'',
                                                                                                                                                         ''SF3'')
                                                                                                                                AND             pp_limit_stg>0 THEN pp_limit_stg
                                                                                                                                ELSE st_limit_stg
                                                                                                                END AS INTEGER) AS VARCHAR(255)),5,''0''),''00000'') AS amountofinsurance_stg,
                                                                                                                coalesce(ltrim(rtrim(cast(
                                                                                                                CASE
                                                                                                                                WHEN (
                                                                                                                                                                pdh.yearbuilt_stg<=1959) THEN ''1959''
                                                                                                                                ELSE pdh.yearbuilt_stg
                                                                                                                END AS INTEGER))) ,''1959'')                                                                AS yearofmanufacture_stg,
                                                                                                                coalesce(perils_limit_ind_stg , ''0'')                                                         ded_ind_stg,
                                                                                                                coalesce(lpad(cast(cast(perils_limit_stg AS INTEGER) AS VARCHAR(255)),7, ''0''), ''0000000'')    ded_amount_stg,
                                                                                                                coalesce(
                                                                                                                CASE
                                                                                                                                WHEN jd.typecode_stg=''AL'' THEN deductiblews_stg
                                                                                                                                ELSE ''0''
                                                                                                                END,''0'') AS deductibleindicatorws_stg,
                                                                                                                coalesce(cast(cast(
                                                                                                                CASE
                                                                                                                                WHEN jd.typecode_stg=''AL'' THEN deductibleamountws_stg
                                                                                                                                ELSE ''0''
                                                                                                                END AS NUMBER) AS VARCHAR(255)),''0000000'')AS deductibleamountws_stg,
                                                                                                                pp.policynumber_stg,
                                                                                                                cast( pp.id_stg AS VARCHAR(20)) policyperiodid_stg,
                                                                                                                pj.jobnumber_stg                policyidentifier_stg
                                                                                                FROM            db_t_prod_stag.pc_policyperiod pp
                                                                                                join            db_t_prod_stag.pctl_jurisdiction jd
                                                                                                ON              pp.basestate_stg=jd.id_stg
                                                                                                join            db_t_prod_stag.pcx_dwelling_hoe pdh
                                                                                                ON              pdh.branchid_stg=pp.id_stg
                                                                                                AND             pdh.expirationdate_stg IS NULL
                                                                                                left join       db_t_prod_stag.pctl_dwellingoccupancytype_hoe occ_type
                                                                                                ON              pdh.occupancy_stg =occ_type.id_stg
                                                                                                left join       db_t_prod_stag.pctl_dwellingusage_hoe pcdh
                                                                                                ON              pcdh.id_stg =pdh.dwellingusage_stg
                                                                                                join
                                                                                                                (
                                                                                                                          SELECT    loc.branchid_stg                                                                                   id,
                                                                                                                                    max(cast(coalesce(old_code_stg, pht1.naiipcicode_alfa_stg, pht2.naiipcicode_alfa_stg) AS INTEGER)) code_stg ,
                                                                                                                                    max(coalesce(postalcodeinternal_stg, postalcode_stg))                                              postalcodeinternal_stg
                                                                                                                          FROM      (
                                                                                                                                              SELECT    e.branchid_stg,
                                                                                                                                                        policynumber_stg,
                                                                                                                                                        c.code_stg,
                                                                                                                                                        g.typecode_stg,
                                                                                                                                                        c.countycode_alfa_stg,
                                                                                                                                                        pc_policyline.hopolicytype_stg,
                                                                                                                                                        coalesce(postalcodeinternal_stg, postalcode_stg)postalcodeinternal_stg,
                                                                                                                                                        row_number() over( PARTITION BY e.branchid_stg,policynumber_stg, c.code_stg,g.typecode_stg, c.countycode_alfa_stg, pc_policyline.hopolicytype_stg ORDER BY
                                                                                                                                                        CASE
                                                                                                                                                                  WHEN (
                                                                                                                                                                                      c.policylocation_stg = b.id_stg ) THEN 1
                                                                                                                                                                  ELSE 2
                                                                                                                                                        END) rownum_stg,
                                                                                                                                                        cityinternal_stg,
                                                                                                                                                        countyinternal_stg,
                                                                                                                                                        county_stg,
                                                                                                                                                        CASE
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''BIRMINGHAM''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''JEFFERSON'' THEN ''32''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''HUNTSVILLE''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MADISON'' THEN ''35''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''MONTGOMERY''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MONTGOMERY'' THEN ''37''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''MOBILE''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MOBILE'' THEN ''30''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''AUTAUGA'',
                                                                                                                                                                                                        ''ELMORE'',
                                                                                                                                                                                                        ''MONTGOMERY'') THEN ''38''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''BALDWIN''
                                                                                                                                                                  AND       cast(c.code_stg AS INTEGER)=26 THEN ''41''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''BALDWIN''
                                                                                                                                                                  AND       cast(c.code_stg AS INTEGER)=28 THEN ''31''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BARBOUR'',
                                                                                                                                                                                                        ''BIBB'',
                                                                                                                                                                                                        ''BLOUNT'',
                                                                                                                                                                                                        ''BULLOCK'',
                                                                                                                                                                                                        ''BUTLER'',
                                                                                                                                                                                                        ''CHAMBERS'',
                                                                                                                                                                                                        ''CHEROKEE'',
                                                                                                                                                                                                        ''CHILTON'',
                                                                                                                                                                                                        ''CHOCTAW'',
                                                                                                                                                                                                        ''CLARKE'',
                                                                                                                                                                                                        ''CLAY'',
                                                                                                                                                                                                        ''CLEBURNE'',
                                                                                                                                                                                                        ''COFFEE'',
                                                                                                                                                                                                        ''CONECUH'',
                                                                                                                                                                                                        ''COOSA'',
                                                                                                                                                                                                        ''COVINGTON'',
                                                                                                                                                                                                        ''CRENSHAW'',
                                                                                                                                                                                                        ''CULLMAN'',
                                                                                                                                                                                                        ''DALE'',
                                                                                                                                                                                                        ''DALLAS'',
                                                                                                                                                                                                        ''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''ESCAMBIA'',
                                                                                                                                                                                                        ''FAYETTE'',
                                                                                                                                                                                                        ''FRANKLIN'',
                                                                                                                                                                                                        ''GENEVA'',
                                                                                                                                                                                                        ''GREENE'',
                                                                                                                                                                                                        ''HALE'',
                                                                                                                                                                                                        ''HENRY'',
                                                                                                                                                                                                        ''HOUSTON'',
                                                                                                                                                                                                        ''JACKSON'',
                                                                                                                                                                                                        ''LAMAR'',
                                                                                                                                                                                                        ''LAWRENCE'',
                                                                                                                                                                                                        ''LEE'',
                                                                                                                                                                                                        ''LOWNDES'',
                                                                                                                                                                                                        ''MACON'',
                                                                                                                                                                                                        ''MONROE'',
                                                                                                                                                                                                        ''MARENGO'',
                                                                                                                                                                                                        ''MARION'',
                                                                                                                                                                                                        ''MARSHALL'',
                                                                                                                                                                                                        ''PERRY'',
                                                                                                                                                                                                        ''PICKENS'',
                                                                                                                                                                                                        ''PIKE'',
                                                                                                                                                                                                        ''RANDOLPH'',
                                                                                                                                                                                                        ''RUSSELL'',
                                                                                                                                                                                                        ''SAINT CLAIR'',
                                                                                                                                                                                                        ''ST. CLAIR'',
                                                                                                                                                                                                        ''SUMTER'',
                                                                                                                                                                                                        ''TALLADEGA'',
                                                                                                                                                                                                        ''TALLAPOOSA'',
                                                                                                                                                                                                        ''WASHINGTON'',
                                                                                                                                                                                                        ''WILCOX'',
                                                                                                                                                                                                        ''WINSTON'') THEN ''41''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''CALHOUN'',
                                                                                                                                                                                                        ''ETOWAH'') THEN ''40''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''COLBERT'',
                                                                                                                                                                                                        ''LAUDERDALE'',
                                                                                                                                                                                                        ''LIMESTONE'',
                                                                                                                                                                                                        ''MADISON'',
                                                                                                                                                                                                        ''MORGAN'') THEN ''36''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''JEFFERSON'' THEN ''33''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MOBILE''
                                                                                                                                                                  AND       cast(c.code_stg AS INTEGER)=28 THEN ''31''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MOBILE''
                                                                                                                                                                  AND       cast(c.code_stg AS INTEGER)=11 THEN ''05''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''SHELBY'',
                                                                                                                                                                                                        ''WALKER'') THEN ''34''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''TUSCALOOSA'' THEN ''39''
                                                                                                                                                                  /*WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       (
                                                                                                                                                                                      substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-''))=''36511''
                                                                                                                                                                            OR        b.postalcodeinternal_stg=''36511'')
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''BON SECOUR'' THEN ''06''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       (
                                                                                                                                                                                      substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-''))=''36528''
                                                                                                                                                                            OR        b.postalcodeinternal_stg=''36528'')
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''DAUPHIN ISLAND'' THEN ''06''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       (
                                                                                                                                                                                      substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-'')) IN (''36542'',
                                                                                                                                                                                                        ''36547'')
                                                                                                                                                                            OR        b.postalcodeinternal_stg IN (''36542'',
                                                                                                                                                                                                        ''36547''))
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''GULF SHORES'' THEN ''06''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       (
                                                                                                                                                                                      substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-''))=''36561''
                                                                                                                                                                            OR        b.postalcodeinternal_stg=''36561'')
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''ORANGE BEACH'' THEN ''06''*/
                                                                                                                                                                 WHEN g.typecode_stg = ''AL''
                                                                                                                                                                 AND (
                                                                                                                                                                 IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                                                        SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                                                        b.postalcodeinternal_stg
                                                                                                                                                                 ) = ''36511''
                                                                                                                                                                 OR b.postalcodeinternal_stg = ''36511''
                                                                                                                                                                 )
                                                                                                                                                                 AND UPPER(cityinternal_stg) = ''BON SECOUR'' THEN ''06''

                                                                                                                                                                 WHEN g.typecode_stg = ''AL''
                                                                                                                                                                 AND (
                                                                                                                                                                 IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                                                        SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                                                        b.postalcodeinternal_stg
                                                                                                                                                                 ) = ''36528''
                                                                                                                                                                 OR b.postalcodeinternal_stg = ''36528''
                                                                                                                                                                 )
                                                                                                                                                                 AND UPPER(cityinternal_stg) = ''DAUPHIN ISLAND'' THEN ''06''

                                                                                                                                                                 WHEN g.typecode_stg = ''AL''
                                                                                                                                                                 AND (
                                                                                                                                                                 IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                                                        SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                                                        b.postalcodeinternal_stg
                                                                                                                                                                 ) IN (''36542'', ''36547'')
                                                                                                                                                                 OR b.postalcodeinternal_stg IN (''36542'', ''36547'')
                                                                                                                                                                 )
                                                                                                                                                                 AND UPPER(cityinternal_stg) = ''GULF SHORES'' THEN ''06''

                                                                                                                                                                 WHEN g.typecode_stg = ''AL''
                                                                                                                                                                 AND (
                                                                                                                                                                 IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                                                        SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                                                        b.postalcodeinternal_stg
                                                                                                                                                                 ) = ''36561''
                                                                                                                                                                 OR b.postalcodeinternal_stg = ''36561''
                                                                                                                                                                 )
                                                                                                                                                                 AND UPPER(cityinternal_stg) = ''ORANGE BEACH'' THEN ''06''
                                                                                                                                                                 
                                                                                                                                                                  WHEN g.typecode_stg=''MS''
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''JACKSON''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''HINDS'',
                                                                                                                                                                                                        ''RANKIN'') THEN ''30''
                                                                                                                                                                  WHEN g.typecode_stg=''MS''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''AMITE'',
                                                                                                                                                                                                        ''FORREST'',
                                                                                                                                                                                                        ''GREENE'',
                                                                                                                                                                                                        ''LAMAR'',
                                                                                                                                                                                                        ''MARION'',
                                                                                                                                                                                                        ''PERRY'',
                                                                                                                                                                                                        ''PIKE'',
                                                                                                                                                                                                        ''WALTHALL'',
                                                                                                                                                                                                        ''WILKINSON'') THEN ''03''
                                                                                                                                                                  WHEN g.typecode_stg=''MS''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''GEORGE'',
                                                                                                                                                                                                        ''PEARL RIVER'',
                                                                                                                                                                                                        ''STONE'') THEN ''05''
                                                                                                                                                                  WHEN g.typecode_stg=''MS''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''HANCOCK'',
                                                                                                                                                                                                        ''HARRISON'',
                                                                                                                                                                                                        ''JACKSON'') THEN ''06''
                                                                                                                                                                  WHEN g.typecode_stg=''MS''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''HINDS'',
                                                                                                                                                                                                        ''MADISON'',
                                                                                                                                                                                                        ''RANKIN'') THEN ''31''
                                                                                                                                                                  WHEN g.typecode_stg=''MS''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''ADAMS'',
                                                                                                                                                                                                        ''ALCORN'',
                                                                                                                                                                                                        ''ATTALA'',
                                                                                                                                                                                                        ''BENTON'',
                                                                                                                                                                                                        ''BOLIVAR'',
                                                                                                                                                                                                        ''CALHOUN'',
                                                                                                                                                                                                        ''CARROLL'',
                                                                                                                                                                                                        ''CHICKASAW'',
                                                                                                                                                                                                        ''CHOCTAW'',
                                                                                                                                                                                                        ''CLAIBORNE'',
                                                                                                                                                                                                        ''CLARKE'',
                                                                                                                                                                                                        ''CLAY'',
                                                                                                                                                                                                        ''COAHOMA'',
                                                                                                                                                                                                        ''COPIAH'',
                                                                                                                                                                                                        ''COVINGTON'',
                                                                                                                                                                                                        ''DESOTO'',
                                                                                                                                                                                                        ''FRANKLIN'',
                                                                                                                                                                                                        ''GRENADA'',
                                                                                                                                                                                                        ''HOLMES'',
                                                                                                                                                                                                        ''HUMPHREYS'',
                                                                                                                                                                                                        ''ISSAQUENA'',
                                                                                                                                                                                                        ''ITAWAMBA'',
                                                                                                                                                                                                        ''JASPER'',
                                                                                                                                                                                                        ''JEFFERSON'',
                                                                                                                                                                                                        ''JEFFERSON DAVIS'',
                                                                                                                                                                                                        ''JONES'',
                                                                                                                                                                                                        ''KEMPER'',
                                                                                                                                                                                                        ''LAFAYETTE'',
                                                                                                                                                                                                        ''LAUDERDALE'',
                                                                                                                                                                                                        ''LAWRENCE'',
                                                                                                                                                                                                        ''LEAKE'',
                                                                                                                                                                                                        ''LEE'',
                                                                                                                                                                                                        ''LEFLORE'',
                                                                                                                                                                                                        ''LINCOLN'',
                                                                                                                                                                                                        ''LOWNDES'',
                                                                                                                                                                                                        ''MARSHALL'',
                                                                                                                                                                                                        ''MONROE'',
                                                                                                                                                                                                        ''MONTGOMERY'',
                                                                                                                                                                                                        ''NESHOBA'',
                                                                                                                                                                                                        ''NEWTON'',
                                                                                                                                                                                                        ''NOXUBEE'',
                                                                                                                                                                                                        ''OKTIBBEHA'',
                                                                                                                                                                                                        ''PANOLA'',
                                                                                                                                                                                                        ''PONTOTOC'',
                                                                                                                                                                                                        ''PRENTISS'',
                                                                                                                                                                                                        ''QUITMAN'',
                                                                                                                                                                                                        ''SCOTT'',
                                                                                                                                                                                                        ''SHARKEY'',
                                                                                                                                                                                                        ''SIMPSON'',
                                                                                                                                                                                                        ''SMITH'',
                                                                                                                                                                                                        ''SUNFLOWER'',
                                                                                                                                                                                                        ''TALLAHATCHIE'',
                                                                                                                                                                                                        ''TATE'',
                                                                                                                                                                                                        ''TIPPAH'',
                                                                                                                                                                                                        ''TISHOMINGO'',
                                                                                                                                                                                                        ''TUNICA'',
                                                                                                                                                                                                        ''UNION'',
                                                                                                                                                                                                        ''WARREN'',
                                                                                                                                                                                                        ''WASHINGTON'',
                                                                                                                                                                                                        ''WAYNE'',
                                                                                                                                                                                                        ''WEBSTER'',
                                                                                                                                                                                                        ''WINSTON'',
                                                                                                                                                                                                        ''YALOBUSHA'',
                                                                                                                                                                                                        ''YAZOO'') THEN ''32''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''ATLANTA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''FULTON'') THEN ''32''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''MACON''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''BIBB'' THEN ''35''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(cityinternal_stg)= ''SAVANNAH''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''CHATHAM'' THEN ''30''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''FULTON'') THEN ''33''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BRYAN'',
                                                                                                                                                                                                        ''CAMDEN'',
                                                                                                                                                                                                        ''CHATHAM'',
                                                                                                                                                                                                        ''GLYNN'',
                                                                                                                                                                                                        ''LIBERTY'',
                                                                                                                                                                                                        ''MCINTOSH'') THEN ''31''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''FULTON'') THEN ''33''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''CLAYTON'',
                                                                                                                                                                                                        ''COBB'',
                                                                                                                                                                                                        ''GWINNETT'') THEN ''34''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''CATOOSA'',
                                                                                                                                                                                                        ''WALKER'',
                                                                                                                                                                                                        ''WHITFIELD'') THEN ''36''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) =''RICHMOND'' THEN ''37''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''CHATTAHOOCHEE'',
                                                                                                                                                                                                        ''MUSCOGEE'') THEN ''38''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BUTTS'',
                                                                                                                                                                                                        ''CHEROKEE'',
                                                                                                                                                                                                        ''DOUGLAS'',
                                                                                                                                                                                                        ''FAYETTE'',
                                                                                                                                                                                                        ''FORSYTH'',
                                                                                                                                                                                                        ''HENRY'',
                                                                                                                                                                                                        ''NEWTON'',
                                                                                                                                                                                                        ''PAULDING'',
                                                                                                                                                                                                        ''ROCKDALE'',
                                                                                                                                                                                                        ''WALTON'') THEN ''39''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BALDWIN'',
                                                                                                                                                                                                        ''BANKS'',
                                                                                                                                                                                                        ''BARROW'',
                                                                                                                                                                                                        ''BARTOW'',
                                                                                                                                                                                                        ''CARROLL'',
                                                                                                                                                                                                        ''CHATTOOGA'',
                                                                                                                                                                                                        ''CLARKE'',
                                                                                                                                                                                                        ''COLUMBIA'',
                                                                                                                                                                                                        ''COWETA'',
                                                                                                                                                                                                        ''DADE'',
                                                                                                                                                                                                        ''DAWSON'',
                                                                                                                                                                                                        ''ELBERT'',
                                                                                                                                                                                                        ''FANNIN'',
                                                                                                                                                                                                        ''FLOYD'',
                                                                                                                                                                                                        ''FRANKLIN'',
                                                                                                                                                                                                        ''GILMER'',
                                                                                                                                                                                                        ''GORDON'',
                                                                                                                                                                                                        ''GREENE'',
                                                                                                                                                                                                        ''HABERSHAM'',
                                                                                                                                                                                                        ''HALL'',
                                                                                                                                                                                                        ''HANCOCK'',
                                                                                                                                                                                                        ''HARALSON'',
                                                                                                                                                                                                        ''HART'',
                                                                                                                                                                                                        ''HEARD'',
                                                                                                                                                                                                        ''JACKSON'',
                                                                                                                                                                                                        ''JASPER'',
                                                                                                                                                                                                        ''JONES'',
                                                                                                                                                                                                        ''LAMAR'',
                                                                                                                                                                                                        ''LINCOLN'',
                                                                                                                                                                                                        ''LUMPKIN'',
                                                                                                                                                                                                        ''MADISON'',
                                                                                                                                                                                                        ''MCDUFFIE'',
                                                                                                                                                                                                        ''MERIWETHER'',
                                                                                                                                                                                                        ''MONROE'',
                                                                                                                                                                                                        ''MORGAN'',
                                                                                                                                                                                                        ''MURRAY'',
                                                                                                                                                                                                        ''OCONEE'',
                                                                                                                                                                                                        ''OGLETHORPE'',
                                                                                                                                                                                                        ''PICKENS'',
                                                                                                                                                                                                        ''PIKE'',
                                                                                                                                                                                                        ''POLK'',
                                                                                                                                                                                                        ''PUTNAM'',
                                                                                                                                                                                                        ''RABUN'',
                                                                                                                                                                                                        ''SPALDING'',
                                                                                                                                                                                                        ''STEPHENS'',
                                                                                                                                                                                                        ''TALIAFERRO'',
                                                                                                                                                                                                        ''TOWNS'',
                                                                                                                                                                                                        ''TROUP'',
                                                                                                                                                                                                        ''UNION'',
                                                                                                                                                                                                        ''WARREN'',
                                                                                                                                                                                                        ''WHITE'',
                                                                                                                                                                                                        ''WILKES'') THEN ''40''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BAKER'',
                                                                                                                                                                                                        ''BIBB'',
                                                                                                                                                                                                        ''BROOKS'',
                                                                                                                                                                                                        ''CALHOUN'',
                                                                                                                                                                                                        ''CLAY'',
                                                                                                                                                                                                        ''COLQUITT'',
                                                                                                                                                                                                        ''CRAWFORD'',
                                                                                                                                                                                                        ''CRISP'',
                                                                                                                                                                                                        ''DECATUR'',
                                                                                                                                                                                                        ''DOOLY'',
                                                                                                                                                                                                        ''DOUGHERTY'',
                                                                                                                                                                                                        ''EARLY'',
                                                                                                                                                                                                        ''GRADY'',
                                                                                                                                                                                                        ''HARRIS'',
                                                                                                                                                                                                        ''HOUSTON'',
                                                                                                                                                                                                        ''LEE'',
                                                                                                                                                                                                        ''MACON'',
                                                                                                                                                                                                        ''MARION'',
                                                                                                                                                                                                        ''MILLER'',
                                                                                                                                                                                                        ''MITCHELL'',
                                                                                                                                                                                                        ''PEACH'',
                                                                                                                                                                                                        ''QUITMAN'',
                                                                                                                                                                                                        ''RANDOLPH'',
                                                                                                                                                                                                        ''SCHLEY'',
                                                                                                                                                                                                        ''SEMINOLE'',
                                                                                                                                                                                                        ''STEWART'',
                                                                                                                                                                                                        ''SUMTER'',
                                                                                                                                                                                                        ''TALBOT'',
                                                                                                                                                                                                        ''TAYLOR'',
                                                                                                                                                                                                        ''TERRELL'',
                                                                                                                                                                                                        ''THOMAS'',
                                                                                                                                                                                                        ''TIFT'',
                                                                                                                                                                                                        ''TURNER'',
                                                                                                                                                                                                        ''UPSON'',
                                                                                                                                                                                                        ''WEBSTER'',
                                                                                                                                                                                                        ''WORTH'') THEN ''41''
                                                                                                                                                                  WHEN g.typecode_stg=''GA''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''APPLING'',
                                                                                                                                                                                                        ''ATKINSON'',
                                                                                                                                                                                                        ''BACON'',
                                                                                                                                                                                                        ''BEN HILL'',
                                                                                                                                                                                                        ''BERRIEN'',
                                                                                                                                                                                                        ''BLECKLEY'',
                                                                                                                                                                                                        ''BRANTLEY'',
                                                                                                                                                                                                        ''BULLOCH'',
                                                                                                                                                                                                        ''BURKE'',
                                                                                                                                                                                                        ''CANDLER'',
                                                                                                                                                                                                        ''CHARLTON'',
                                                                                                                                                                                                        ''CLINCH'',
                                                                                                                                                                                                        ''COFFEE'',
                                                                                                                                                                                                        ''COOK'',
                                                                                                                                                                                                        ''DODGE'',
                                                                                                                                                                                                        ''ECHOLS'',
                                                                                                                                                                                                        ''EFFINGHAM'',
                                                                                                                                                                                                        ''EMANUEL'',
                                                                                                                                                                                                        ''EVANS'',
                                                                                                                                                                                                        ''GLASCOCK'',
                                                                                                                                                                                                        ''IRWIN'',
                                                                                                                                                                                                        ''JEFF DAVIS'',
                                                                                                                                                                                                        ''JEFFERSON'',
                                                                                                                                                                                                        ''JENKINS'',
                                                                                                                                                                                                        ''JOHNSON'',
                                                                                                                                                                                                        ''LANIER'',
                                                                                                                                                                                                        ''LAURENS'',
                                                                                                                                                                                                        ''LONG'',
                                                                                                                                                                                                        ''LOWNDES'',
                                                                                                                                                                                                        ''MONTGOMERY'',
                                                                                                                                                                                                        ''PIERCE'',
                                                                                                                                                                                                        ''PULASKI'',
                                                                                                                                                                                                        ''SCREVEN'',
                                                                                                                                                                                                        ''TATTNALL'',
                                                                                                                                                                                                        ''TELFAIR'',
                                                                                                                                                                                                        ''TOOMBS'',
                                                                                                                                                                                                        ''TREUTLEN'',
                                                                                                                                                                                                        ''TWIGGS'',
                                                                                                                                                                                                        ''WARE'',
                                                                                                                                                                                                        ''WASHINGTON'',
                                                                                                                                                                                                        ''WAYNE'',
                                                                                                                                                                                                        ''WHEELER'',
                                                                                                                                                                                                        ''WILCOX'',
                                                                                                                                                                                                        ''WILKINSON'') THEN ''42''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''BALDWIN''
                                                                                                                                                                  AND       (
                                                                                                                                                                                      cast(c.code_stg AS INTEGER)=11
                                                                                                                                                                            OR        cast(c.code_stg AS INTEGER) IS NULL
                                                                                                                                                                            OR        cast(c.code_stg AS INTEGER) IN (1,2,3) ) THEN ''05''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(county_stg)=''BALDWIN''
                                                                                                                                                                  AND       (
                                                                                                                                                                                      cast(c.code_stg AS INTEGER)=11
                                                                                                                                                                            OR        cast(c.code_stg AS INTEGER) IS NULL
                                                                                                                                                                            OR        cast(c.code_stg AS INTEGER) IN (1,2,3) ) THEN ''05''
                                                                                                                                                                  WHEN g.typecode_stg=''AL''
                                                                                                                                                                  AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MOBILE''
                                                                                                                                                                  AND       (
                                                                                                                                                                                      cast(c.code_stg AS INTEGER)IN (2,1,26,3 )
                                                                                                                                                                            OR        cast(c.code_stg AS INTEGER)IS NULL) THEN ''41''
                                                                                                                                                        END AS old_code_stg
                                                                                                                                              FROM      db_t_prod_stag.pcx_holocation_hoe a
                                                                                                                                              join      db_t_prod_stag.pcx_dwelling_hoe e
                                                                                                                                              ON        e.holocation_stg=a.id_stg
                                                                                                                                              join      db_t_prod_stag.pc_policyperiod f
                                                                                                                                              ON        e.branchid_stg =f.id_stg
                                                                                                                                              left join db_t_prod_stag.pc_effectivedatedfields eff
                                                                                                                                              ON        eff.branchid_stg = f.id_stg
                                                                                                                                              AND       eff.expirationdate_stg IS NULL
                                                                                                                                              join      db_t_prod_stag.pc_policylocation b
                                                                                                                                              ON        b.id_stg = eff.primarylocation_stg
                                                                                                                                              AND       b.expirationdate_stg IS NULL
                                                                                                                                              join      db_t_prod_stag.pc_territorycode c
                                                                                                                                              ON        c.branchid_stg = f.id_stg
                                                                                                                                              join      db_t_prod_stag.pctl_territorycode d
                                                                                                                                              ON        c.subtype_stg=d.id_stg
                                                                                                                                              AND       d.typecode_stg = ''HOTerritoryCode_alfa''
                                                                                                                                              left join db_t_prod_stag.pc_contact pc
                                                                                                                                              ON        pc.id_stg =pnicontactdenorm_stg
                                                                                                                                              left join db_t_prod_stag.pc_address
                                                                                                                                              ON        pc.primaryaddressid_stg = pc_address.id_stg
                                                                                                                                              join      db_t_prod_stag.pc_policyline
                                                                                                                                              ON        f.id_stg = pc_policyline.branchid_stg
                                                                                                                                              AND       pc_policyline.expirationdate_stg IS NULL
                                                                                                                                              join      db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                              ON        pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                              AND       pctl_hopolicytype_hoe.typecode_stg IN (''SF1'',
                                                                                                                                                                                               ''SF2'',
                                                                                                                                                                                               ''SF3'')
                                                                                                                                              join      db_t_prod_stag.pctl_jurisdiction g
                                                                                                                                              ON        basestate_stg=g.id_stg
                                                                                                                                              AND       g.typecode_stg IN (''AL'',
                                                                                                                                                                           ''GA'',
                                                                                                                                                                           ''MS'')) loc
                                                                                                                          left join db_t_prod_stag.pcx_hodbterritory_alfa pht1
                                                                                                                          ON        pht1.code_stg =loc.code_stg
                                                                                                                          AND       cast(pht1.countycode_alfa_stg AS VARCHAR(50))=cast(loc.countycode_alfa_stg AS VARCHAR(50))
                                                                                                                          AND       substring(pht1.publicid_stg,7,2) =loc.typecode_stg
                                                                                                                          AND       pht1.hopolicytype_hoe_stg=loc.hopolicytype_stg
                                                                                                                          left join
                                                                                                                                    (
                                                                                                                                                    SELECT DISTINCT naiipcicode_alfa_stg,
                                                                                                                                                                    substring(publicid_stg,7,2) state_stg,
                                                                                                                                                                    code_stg                    territory_code_stg,
                                                                                                                                                                    hopolicytype_hoe_stg,
                                                                                                                                                                    rank() over( PARTITION BY naiipcicode_alfa_stg, substring(publicid_stg,7,2) , code_stg , hopolicytype_hoe_stg ORDER BY naiipcicode_alfa_stg,countycode_alfa_stg )"row"
                                                                                                                                                    FROM            db_t_prod_stag.pcx_hodbterritory_alfa
                                                                                                                                                                    /*where publicid like ''%ho%''*/
                                                                                                                                    )pht2
                                                                                                                          ON        pht2."row"=1
                                                                                                                          AND       pht2.territory_code_stg =loc.code_stg
                                                                                                                          AND       pht2.state_stg =loc.typecode_stg
                                                                                                                          AND       pht2.hopolicytype_hoe_stg=loc.hopolicytype_stg
                                                                                                                          left join
                                                                                                                                    (
                                                                                                                                                    SELECT DISTINCT naiipcicode_alfa_stg,
                                                                                                                                                                    substring(publicid_stg,7,2) state_stg,
                                                                                                                                                                    countycode_alfa_stg         countycode_alfa_stg,
                                                                                                                                                                    hopolicytype_hoe_stg,
                                                                                                                                                                    rank() over( PARTITION BY naiipcicode_alfa_stg, substring(publicid_stg,7,2) , countycode_alfa_stg , hopolicytype_hoe_stg ORDER BY naiipcicode_alfa_stg,code_stg )"row"
                                                                                                                                                    FROM            db_t_prod_stag.pcx_hodbterritory_alfa
                                                                                                                                                                    /*where publicid like ''%ho%''*/
                                                                                                                                    )pht3
                                                                                                                          ON        pht3."row"=1
                                                                                                                          AND       cast(pht3.countycode_alfa_stg AS VARCHAR(50))=cast(loc.countycode_alfa_stg AS VARCHAR(50))
                                                                                                                          AND       pht3.state_stg =loc.typecode_stg
                                                                                                                          AND       pht3.hopolicytype_hoe_stg=loc.hopolicytype_stg
                                                                                                                          WHERE     rownum_stg=1
                                                                                                                          GROUP BY  loc.branchid_stg) terr
                                                                                                ON              terr.id =pp.id_stg
                                                                                                join            db_t_prod_stag.pc_job pj
                                                                                                ON              pp.jobid_stg = pj.id_stg
                                                                                                join            db_t_prod_stag.pctl_job pcj
                                                                                                ON              pj.subtype_stg = pcj.id_stg
                                                                                                join            db_t_prod_stag.pcx_holocation_hoe phh
                                                                                                ON              pdh.holocation_stg= phh.id_stg
                                                                                                join            db_t_prod_stag.pctl_hopolicytype_hoe ph
                                                                                                ON              ph.id_stg=hopolicytype_stg
                                                                                                AND             ph.typecode_stg IN (''SF1'',
                                                                                                                                    ''SF2'',
                                                                                                                                    ''SF3'')
                                                                                                join
                                                                                                                (
                                                                                                                                SELECT DISTINCT branchid_stg,
                                                                                                                                                max(
                                                                                                                                                CASE
                                                                                                                                                                WHEN covterm.covtermpatternid_stg=''HODW_Dwelling_Limit_HOE'' THEN substring(1, (5-length( cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))))-1 + cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000, 0)AS INTEGER) AS VARCHAR(10))
                                                                                                                                                END )dw_limit_stg,
                                                                                                                                                max(
                                                                                                                                                CASE
                                                                                                                                                                WHEN covterm.covtermpatternid_stg=''HOSI_SpecificOtherStructureItemLimit_alfa'' THEN substring(1, (5-length( cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))))-1 + cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000, 0)AS INTEGER) AS VARCHAR(10))
                                                                                                                                                END )st_limit_stg,
                                                                                                                                                max (
                                                                                                                                                CASE
                                                                                                                                                                WHEN covterm.covtermpatternid_stg=''HODW_DwellingAdditionalLimit_alfa'' THEN cast(polcov.val_stg AS DECIMAL(18,4))
                                                                                                                                                END )lia_limit_stg,
                                                                                                                                                max (
                                                                                                                                                CASE
                                                                                                                                                                WHEN covterm.covtermpatternid_stg=''HODW_PersonalPropertyLimit_alfa'' THEN substring(1, (5-length( cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))))-1 +(cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))
                                                                                                                                                END )pp_limit_stg,
                                                                                                                                                max(
                                                                                                                                                CASE
                                                                                                                                                                WHEN covterm.covtermpatternid_stg=''HODW_OtherPerils_Ded_HOE'' THEN (
                                                                                                                                                                                CASE
                                                                                                                                                                                                WHEN substring(name1_stg ,length(name1_stg),1)=''%'' THEN ''F''
                                                                                                                                                                                                ELSE ''D''
                                                                                                                                                                                END)
                                                                                                                                                END)perils_limit_ind_stg,
                                                                                                                                                max(
                                                                                                                                                CASE
                                                                                                                                                                WHEN covterm.covtermpatternid_stg=''HODW_OtherPerils_Ded_HOE'' THEN (
                                                                                                                                                                                CASE
                                                                                                                                                                                                WHEN substring(name1_stg ,length(name1_stg),1)=''%'' THEN cast(cast(cast(cast(value1_stg AS DECIMAL(18,4)) *10000 AS DECIMAL(18,4)) AS bigint) AS VARCHAR(10))
                                                                                                                                                                                                ELSE cast(cast(cast(value1_stg AS DECIMAL(18,4)) AS INTEGER) AS VARCHAR(10))
                                                                                                                                                                                END)
                                                                                                                                                END)perils_limit_stg,
                                                                                                                                                max (
                                                                                                                                                CASE
                                                                                                                                                                WHEN patterncode_stg =''HODW_Earthquake_HOE'' THEN patterncode_stg
                                                                                                                                                END) earthquake,
                                                                                                                                                max (
                                                                                                                                                CASE
                                                                                                                                                                WHEN patterncode_stg =''HODW_PersonalPropertyReplacementCost_alfa'' THEN patterncode_stg
                                                                                                                                                END) replacement,
                                                                                                                                                max (
                                                                                                                                                CASE
                                                                                                                                                                WHEN (
                                                                                                                                                                                                covtermpatternid_stg =''HODW_WindHail_Ded_HOE'') THEN covtermpatternid_stg
                                                                                                                                                END )windhail_stg,
                                                                                                                                                max (
                                                                                                                                                CASE
                                                                                                                                                                WHEN (
                                                                                                                                                                                                covtermpatternid_stg =''HODW_Hurricane_Ded_HOE'' ) THEN covtermpatternid_stg
                                                                                                                                                END )hurricane_stg,
                                                                                                                                                max (
                                                                                                                                                CASE
                                                                                                                                                                WHEN (
                                                                                                                                                                                                covtermpatternid_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'') THEN covtermpatternid_stg
                                                                                                                                                END )windstormhailexcl_stg,
                                                                                                                                                max (
                                                                                                                                                CASE
                                                                                                                                                                WHEN (
                                                                                                                                                                                                covtermpatternid_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'') THEN coalesce( polcov.val_stg, value1_stg)
                                                                                                                                                END )windstormhailexcl_amt_stg,
                                                                                                                                                max(
                                                                                                                                                CASE
                                                                                                                                                                WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                                              ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                                              ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                                                AND             polcov.columnname_stg LIKE ''%direct%'' THEN polcov.val_stg
                                                                                                                                                                WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                                              ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                                              ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                                                AND             polcov.columnname_stg NOT LIKE ''%direct%'' THEN (
                                                                                                                                                                                CASE
                                                                                                                                                                                                WHEN (
                                                                                                                                                                                                        cast(value1_stg AS DECIMAL(18,4))<=1.0000 ) THEN cast(cast(cast(value1_stg AS DECIMAL(18,4))*10000 AS bigint) AS VARCHAR(10))
                                                                                                                                                                                                WHEN value1_stg IS NULL
                                                                                                                                                                                                OR              value1_stg =0 THEN 0
                                                                                                                                                                                                ELSE cast(cast(cast(value1_stg AS DECIMAL(18,4)) *10000 AS bigint) AS VARCHAR(10))
                                                                                                                                                                                END )
                                                                                                                                                END ) AS deductibleamountws_stg,
                                                                                                                                                max (
                                                                                                                                                CASE
                                                                                                                                                                WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                                              ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                                              ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                                                AND             polcov.columnname_stg LIKE ''%direct%'' THEN ''D''
                                                                                                                                                                WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                                              ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                                              ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                                                AND             polcov.columnname_stg NOT LIKE ''%direct%'' THEN (
                                                                                                                                                                                CASE
                                                                                                                                                                                                WHEN (
                                                                                                                                                                                                        cast(value1_stg AS DECIMAL(18,4))<=1.0000) THEN ''F''
                                                                                                                                                                                                WHEN value1_stg IS NULL
                                                                                                                                                                                                OR              value1_stg=0 THEN NULL
                                                                                                                                                                                                ELSE ''D''
                                                                                                                                                                                END )
                                                                                                                                                END ) AS deductiblews_stg
                                                                                                                                FROM            (
                                                                                                                                                           SELECT     cast(''DirectTerm1'' AS                       VARCHAR(100)) AS columnname_stg,
                                                                                                                                                                      cast(directterm1_stg AS                     VARCHAR(255)) AS val_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.          expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      directterm1avl_stg = 1
                                                                                                                                                           AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     ''Clause''                   AS columnname_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      pcx_dwellingcov_hoe.patterncode_stg= ''HODW_PersonalPropertyReplacementCost_alfa''
                                                                                                                                                           AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     ''DirectTerm2''                         AS columnname_stg,
                                                                                                                                                                      cast(directterm2_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      directterm2avl_stg = 1
                                                                                                                                                           AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     ''DirectTerm3''                         AS columnname_stg,
                                                                                                                                                                      cast(directterm3_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      directterm3avl_stg = 1
                                                                                                                                                           AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     ''DirectTerm4''                         AS columnname_stg,
                                                                                                                                                                      cast(directterm4_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.          expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      directterm4avl_stg = 1
                                                                                                                                                           AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     ''ChoiceTerm2''                         AS columnname_stg,
                                                                                                                                                                      cast(choiceterm2_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      choiceterm2avl_stg = 1
                                                                                                                                                           AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     ''ChoiceTerm3''                         AS columnname_stg,
                                                                                                                                                                      cast(choiceterm3_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe. effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      choiceterm3avl_stg = 1
                                                                                                                                                           AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     cast(''ChoiceTerm1'' AS                       VARCHAR(250)) AS columnname_stg,
                                                                                                                                                                      cast(choiceterm1_stg AS                     VARCHAR(255)) AS val_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe. effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      choiceterm1avl_stg = 1
                                                                                                                                                           AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     cast(''ChoiceTerm4'' AS                       VARCHAR(250)) AS columnname_stg,
                                                                                                                                                                      cast(choiceterm4_stg AS                     VARCHAR(255)) AS val_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      choiceterm4avl_stg= 1
                                                                                                                                                           AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     cast(''BooleanTerm1'' AS                      VARCHAR(250)) AS columnnname,
                                                                                                                                                                      cast(booleanterm1_stg AS                    VARCHAR(255)) AS val_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                                                      cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                      cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                      pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           WHERE      pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                           AND        pcx_dwellingcov_hoe.patterncode_stg =''HODW_SectionI_Ded_HOE''
                                                                                                                                                           UNION
                                                                                                                                                           SELECT     ''DirectTerm1''                         AS columnname_stg,
                                                                                                                                                                      cast(directterm1_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                      pha.patterncode_stg,
                                                                                                                                                                      cast(pha.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                      pha.createtime_stg,
                                                                                                                                                                      pha.effectivedate_stg,
                                                                                                                                                                      pha.expirationdate_stg,
                                                                                                                                                                      choiceterm1_stg,
                                                                                                                                                                      pe.patternid_stg AS patternid_stg,
                                                                                                                                                                      pha.updatetime_stg
                                                                                                                                                           FROM       db_t_prod_stag.pcx_holineschcovitemcov_alfa pha
                                                                                                                                                           inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                           ON         pp.id_stg = pha.branchid_stg
                                                                                                                                                                      /*and policynumber =''19000002261'' */
                                                                                                                                                           join       db_t_prod_stag.pc_policyline
                                                                                                                                                           ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                           join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                           ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                           AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                           left join  db_t_prod_stag.pc_etlclausepattern pe
                                                                                                                                                           ON         pe.patternid_stg = pha.patterncode_stg
                                                                                                                                                           WHERE      pe.patternid_stg IN (''HOSI_SpecificOtherStructureItem_alfa'',
                                                                                                                                                                                           ''HOSI_ScheduledPropertyItem_alfa'',
                                                                                                                                                                                           ''HOSI_SpecificOtherStructureExclItem_alfa'')
                                                                                                                                                           AND        directterm1avl_stg = 1
                                                                                                                                                           AND        pha.expirationdate_stg IS NULL ) polcov
                                                                                                                                left join
                                                                                                                                                (
                                                                                                                                                       SELECT pcl.patternid_stg     clausepatternid_stg,
                                                                                                                                                              pcv.patternid_stg     covtermpatternid_stg,
                                                                                                                                                              pcv.columnname_stg  AS columnname_stg,
                                                                                                                                                              pcv.covtermtype_stg AS covtermtype_stg,
                                                                                                                                                              pcl.name_stg           clausename_stg
                                                                                                                                                       FROM   db_t_prod_stag.pc_etlclausepattern pcl
                                                                                                                                                       join   db_t_prod_stag.pc_etlcovtermpattern pcv
                                                                                                                                                       ON     pcl.id_stg = pcv.clausepatternid_stg ) covterm
                                                                                                                                ON              covterm.clausepatternid_stg = polcov.patterncode_stg
                                                                                                                                AND             covterm.columnname_stg = polcov.columnname_stg
                                                                                                                                left outer join
                                                                                                                                                (
                                                                                                                                                           SELECT     pco.patternid_stg                        optionpatternid_stg,
                                                                                                                                                                      pco.optioncode_stg                       name1_stg,
                                                                                                                                                                      cast(pco.value_stg AS VARCHAR(255)) AS value1_stg,
                                                                                                                                                                      pcp.valuetype_stg                     AS valuetype_stg
                                                                                                                                                           FROM       db_t_prod_stag.pc_etlcovtermpattern pcp
                                                                                                                                                           inner join db_t_prod_stag.pc_etlcovtermoption pco
                                                                                                                                                           ON         pcp.id_stg = pco.coveragetermpatternid_stg ) optn
                                                                                                                                ON              optn.optionpatternid_stg = polcov.val_stg
                                                                                                                                GROUP BY        branchid_stg ) cov
                                                                                                ON              cast(cov.branchid_stg AS bigint)=pp.id_stg
                                                                                                left join       db_t_prod_stag.pctl_residencetype_hoe pr
                                                                                                ON              residencetype_stg= pr.id_stg
                                                                                                left join       db_t_prod_stag.pc_periodanswer ppa
                                                                                                ON              ppa.branchid_stg=pp.id_stg
                                                                                                AND             questioncode_stg=''HOStandardFirePolicySubtype_alfa''
                                                                                                left join       db_t_prod_stag.pctl_constructiontype_hoe pct
                                                                                                ON              pct.id_stg=constructiontype_stg )a
                                                                         WHERE  rnk_stg =1 ) sq_pc
                                                  ON              sq_clm.policyperiodid = cast(sq_pc.policyperiodid AS bigint)
                                                  left outer join
                                                                  (
                                                                         SELECT pc_policyperiod.territorycode_stg        AS territorycode,
                                                                                pc_policyperiod.zipcode_stg              AS zipcode,
                                                                                pc_policyperiod.itemcode_stg             AS itemcode,
                                                                                pc_policyperiod.sublinecode_stg          AS sublinecode,
                                                                                pc_policyperiod.occupancy_code_stg       AS occupancycode,
                                                                                pc_policyperiod.buildingcontents_stg     AS buildingcontents,
                                                                                pc_policyperiod.construction_stg         AS construction,
                                                                                pc_policyperiod.protectionclasscode_stg  AS protectionclass,
                                                                                pc_policyperiod.typeofdeductiblecode_stg AS typeofdeductible,
                                                                                pc_policyperiod.amountofinsurance_stg    AS amountofinsurance,
                                                                                pc_policyperiod.yearofmanufacture_stg    AS yearofmanufacutre,
                                                                                pc_policyperiod.ded_ind_stg              AS ded_ind,
                                                                                pc_policyperiod.ded_amount_stg           AS ded_amt,
                                                                                pc_policyperiod.deductibleindicatorws    AS ded_wind_ind,
                                                                                pc_policyperiod.deductibleamountws_stg   AS ded_wind_amt,
                                                                                pc_policyperiod.policyperiodid_stg       AS policyperiodid,
                                                                                pc_policyperiod.policynumber_stg         AS policynumber
                                                                         FROM   (
                                                                                       SELECT territorycode_stg,
                                                                                              zipcode_stg,
                                                                                              itemcode_stg,
                                                                                              sublinecode_stg,
                                                                                              occupancy_code_stg,
                                                                                              buildingcontents_stg,
                                                                                              construction_stg,
                                                                                              protectionclasscode_stg,
                                                                                              typeofdeductiblecode_stg,
                                                                                              amountofinsurance_stg,
                                                                                              yearofmanufacture_stg,
                                                                                              ded_ind_stg,
                                                                                              ded_amount_stg,
                                                                                              deductibleindicatorws,
                                                                                              deductibleamountws_stg,
                                                                                              policynumber_stg,
                                                                                              policyperiodid_stg
                                                                                       FROM   (
                                                                                                              SELECT DISTINCT row_number() over( PARTITION BY policynumber_stg ORDER BY pp.updatetime_stg DESC) rnk,
                                                                                                                              CASE
                                                                                                                                              WHEN occ_type.typecode_stg =''tenant'' THEN ''06''
                                                                                                                                              ELSE ''01''
                                                                                                                              END                                                            occupancy_code_stg ,
                                                                                                                              cast(cast(terr.code_stg AS NUMBER) AS VARCHAR(255))            AS territorycode_stg,
                                                                                                                              coalesce(substring( terr.postalcodeinternal_stg,1,5) , ''00000'')AS zipcode_stg,
                                                                                                                              ''03''                                                              itemcode_stg,
                                                                                                                              CASE
                                                                                                                                              WHEN ph.typecode_stg IN (''SF1'') THEN ''10''
                                                                                                                                              ELSE ''28''
                                                                                                                              END AS sublinecode_stg,
                                                                                                                              CASE
                                                                                                                                              WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireDwellingPolicySubtype_alfa''
                                                                                                                                              AND             pr.typecode_stg=''Fam1'' THEN ''1''
                                                                                                                                              WHEN pcdh.typecode_stg=''seas'' THEN ''1''
                                                                                                                                              WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireContentsPolicySubtype_alfa''
                                                                                                                                              AND             pr.typecode_stg=''Fam1'' THEN ''2''
                                                                                                                                              WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireDwellingPolicySubtype_alfa''
                                                                                                                                              AND             pr.typecode_stg=''Fam2'' THEN ''3''
                                                                                                                                              WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireContentsPolicySubtype_alfa''
                                                                                                                                              AND             pr.typecode_stg=''Fam2'' THEN ''4''
                                                                                                                                              WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireDwellingPolicySubtype_alfa''
                                                                                                                                              AND             pr.typecode_stg=''Fam3To4_alfa'' THEN ''7''
                                                                                                                                              WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireContentsPolicySubtype_alfa''
                                                                                                                                              AND             pr.typecode_stg=''Fam3To4_alfa'' THEN ''8''
                                                                                                                                              WHEN choiceanswerchoicecode_alfa_stg =''HOStandardFireOtherStructurePolicySubtype_alfa'' THEN ''1''
                                                                                                                                              ELSE ''1''
                                                                                                                              END buildingcontents_stg,
                                                                                                                              CASE
                                                                                                                                              WHEN pct.typecode_stg IN (''ADB'',
                                                                                                                                                                        ''AOD'',
                                                                                                                                                                        ''CLP'',
                                                                                                                                                                        ''COM'',
                                                                                                                                                                        ''CUS'',
                                                                                                                                                                        ''DOM'',
                                                                                                                                                                        ''F'',
                                                                                                                                                                        ''FRM'',
                                                                                                                                                                        ''FST'',
                                                                                                                                                                        ''GLA'',
                                                                                                                                                                        ''HEA'',
                                                                                                                                                                        ''L'',
                                                                                                                                                                        ''LOG'',
                                                                                                                                                                        ''LIG'',
                                                                                                                                                                        ''NON'',
                                                                                                                                                                        ''OTH'',
                                                                                                                                                                        ''OTHER'',
                                                                                                                                                                        ''PFR'',
                                                                                                                                                                        ''STU'',
                                                                                                                                                                        ''STW'',
                                                                                                                                                                        ''TLU'',
                                                                                                                                                                        ''UNK'',
                                                                                                                                                                        ''WOO'',
                                                                                                                                                                        ''WSC'',
                                                                                                                                                                        ''CLOTH'') THEN ''1''
                                                                                                                                              WHEN pct.typecode_stg IN (''BCB'',
                                                                                                                                                                        ''BLB'',
                                                                                                                                                                        ''BRC'',
                                                                                                                                                                        ''BRF'',
                                                                                                                                                                        ''BRS'',
                                                                                                                                                                        ''BST'',
                                                                                                                                                                        ''FRY'',
                                                                                                                                                                        ''SRO'',
                                                                                                                                                                        ''STV'',
                                                                                                                                                                        ''TBM'',
                                                                                                                                                                        ''WBR'',
                                                                                                                                                                        ''WCB'',
                                                                                                                                                                        ''WSN'') THEN ''2''
                                                                                                                                              WHEN pct.typecode_stg IN (''BRK'',
                                                                                                                                                                        ''CCM'',
                                                                                                                                                                        ''CNB'',
                                                                                                                                                                        ''CND'',
                                                                                                                                                                        ''CRE'',
                                                                                                                                                                        ''FLX'',
                                                                                                                                                                        ''M'',
                                                                                                                                                                        ''MAS'',
                                                                                                                                                                        ''MTU'',
                                                                                                                                                                        ''TUC'',
                                                                                                                                                                        ''SFM'',
                                                                                                                                                                        ''IRON'') THEN ''3''
                                                                                                                                              WHEN pct.typecode_stg IN (''BLM'',
                                                                                                                                                                        ''BLS'',
                                                                                                                                                                        ''BRL'',
                                                                                                                                                                        ''BRM'',
                                                                                                                                                                        ''CCS'',
                                                                                                                                                                        ''MET'',
                                                                                                                                                                        ''PRM'',
                                                                                                                                                                        ''S'',
                                                                                                                                                                        ''STE'',
                                                                                                                                                                        ''STS'') THEN ''4''
                                                                                                                                              WHEN pct.typecode_stg IN (''ALF'',
                                                                                                                                                                        ''ALS'',
                                                                                                                                                                        ''ALV'',
                                                                                                                                                                        ''FRS'',
                                                                                                                                                                        ''WMT'',
                                                                                                                                                                        ''WSL'') THEN ''5''
                                                                                                                                              WHEN pct.typecode_stg IN (''MAN'') THEN ''6''
                                                                                                                                              ELSE ''1''
                                                                                                                              END construction_stg,
                                                                                                                              CASE
                                                                                                                                              WHEN dwellingprotectionclasscode_stg IS NULL
                                                                                                                                              AND             jd.typecode_stg =''AL'' THEN ''05''
                                                                                                                                              WHEN dwellingprotectionclasscode_stg IS NULL
                                                                                                                                              AND             jd.typecode_stg =''GA'' THEN ''03''
                                                                                                                                              WHEN dwellingprotectionclasscode_stg IS NULL
                                                                                                                                              AND             jd.typecode_stg =''MS'' THEN ''10''
                                                                                                                                              ELSE (substring(''00'',1,2-length(phh.dwellingprotectionclasscode_stg))
                                                                                                                                                                              ||phh.dwellingprotectionclasscode_stg )
                                                                                                                              END AS protectionclasscode_stg,
                                                                                                                              CASE
                                                                                                                                              WHEN jd.typecode_stg=''AL'' THEN (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        windhail =''HODW_WindHail_Ded_HOE'')
                                                                                                                                                                              AND             deductibleamountws_stg >0 THEN ''34''
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        hurricane =''HODW_Hurricane_Ded_HOE''
                                                                                                                                                                                              AND             terr.code_stg IN (''05'',
                                                                                                                                                                                                        ''06'',
                                                                                                                                                                                                        ''30'',
                                                                                                                                                                                                        ''31''))
                                                                                                                                                                              AND             deductibleamountws_stg >0 THEN ''54''
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        hurricane =''HODW_Hurricane_Ded_HOE''
                                                                                                                                                                                              AND             terr.code_stg NOT IN (''05'',
                                                                                                                                                                                                        ''06'',
                                                                                                                                                                                                        ''30'',
                                                                                                                                                                                                        ''31''))
                                                                                                                                                                              AND             deductibleamountws_stg >0 THEN ''34''
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        windstormhailexcl =''HODW_SectionI_DedWindAndHailExcl_alfa'')
                                                                                                                                                                              AND             windstormhailexcl_amt>0 THEN ''08''
                                                                                                                                                                              ELSE ''04''
                                                                                                                                                              END )
                                                                                                                                              ELSE (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        windhail =''HODW_WindHail_Ded_HOE'')
                                                                                                                                                                              AND             deductibleamountws_stg >0 THEN ''04''
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        hurricane =''HODW_Hurricane_Ded_HOE'' )
                                                                                                                                                                              AND             deductibleamountws_stg >0 THEN ''04''
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        windstormhailexcl =''HODW_SectionI_DedWindAndHailExcl_alfa'')
                                                                                                                                                                              AND             windstormhailexcl_amt>0 THEN ''08''
                                                                                                                                                                              ELSE ''02''
                                                                                                                                                              END)
                                                                                                                              END AS typeofdeductiblecode_stg,
                                                                                                                              coalesce(lpad(cast(cast(
                                                                                                                              CASE
                                                                                                                                              WHEN ph.typecode_stg IN (''SF1'' ,
                                                                                                                                                                       ''SF2'',
                                                                                                                                                                       ''SF3'')
                                                                                                                                              AND             dw_limit>0 THEN dw_limit
                                                                                                                                              WHEN ph.typecode_stg IN (''SF1'' ,
                                                                                                                                                                       ''SF2'',
                                                                                                                                                                       ''SF3'')
                                                                                                                                              AND             pp_limit>0 THEN pp_limit
                                                                                                                                              ELSE st_limit
                                                                                                                              END AS INTEGER) AS VARCHAR(255)),5,''0''),''00000'') AS amountofinsurance_stg,
                                                                                                                              coalesce(ltrim(rtrim(cast(
                                                                                                                              CASE
                                                                                                                                              WHEN (
                                                                                                                                                                              pdh.yearbuilt_stg<=1959) THEN ''1959''
                                                                                                                                              ELSE pdh.yearbuilt_stg
                                                                                                                              END AS INTEGER))) ,''1959'')                                                            AS yearofmanufacture_stg,
                                                                                                                              coalesce(perils_limit_ind , ''0'')                                                         ded_ind_stg,
                                                                                                                              coalesce(lpad(cast(cast(perils_limit AS INTEGER) AS VARCHAR(255)),7, ''0''), ''0000000'')    ded_amount_stg,
                                                                                                                              coalesce(
                                                                                                                              CASE
                                                                                                                                              WHEN jd.typecode_stg=''AL'' THEN deductiblews
                                                                                                                                              ELSE ''0''
                                                                                                                              END,''0'') AS deductibleindicatorws,
                                                                                                                              coalesce(cast(cast(
                                                                                                                              CASE
                                                                                                                                              WHEN jd.typecode_stg=''AL'' THEN deductibleamountws_stg
                                                                                                                                              ELSE ''0''
                                                                                                                              END AS NUMBER) AS VARCHAR(255)),''0000000'')AS deductibleamountws_stg,
                                                                                                                              pp.policynumber_stg,
                                                                                                                              pp.id_stg        policyperiodid_stg,
                                                                                                                              pj.jobnumber_stg policyidentifier
                                                                                                              FROM            db_t_prod_stag.pc_policyperiod pp
                                                                                                              join            db_t_prod_stag.pctl_jurisdiction jd
                                                                                                              ON              pp.basestate_stg=jd.id_stg
                                                                                                              join            db_t_prod_stag.pcx_dwelling_hoe pdh
                                                                                                              ON              pdh.branchid_stg=pp.id_stg
                                                                                                              AND             pdh.expirationdate_stg IS NULL
                                                                                                              left join       db_t_prod_stag.pctl_dwellingoccupancytype_hoe occ_type
                                                                                                              ON              pdh.occupancy_stg =occ_type.id_stg
                                                                                                              left join       db_t_prod_stag.pctl_dwellingusage_hoe pcdh
                                                                                                              ON              pcdh.id_stg =pdh.dwellingusage_stg
                                                                                                              join
                                                                                                                              (
                                                                                                                                        SELECT    loc.branchid_stg                                                                                   id,
                                                                                                                                                  max(cast(coalesce(old_code_stg, pht1.naiipcicode_alfa_stg, pht2.naiipcicode_alfa_stg) AS INTEGER)) code_stg ,
                                                                                                                                                  max(coalesce(postalcodeinternal_stg, postalcode_stg))                                              postalcodeinternal_stg
                                                                                                                                        FROM      (
                                                                                                                                                            SELECT    e.branchid_stg,
                                                                                                                                                                      policynumber_stg,
                                                                                                                                                                      c.code_stg,
                                                                                                                                                                      g.typecode_stg,
                                                                                                                                                                      c.countycode_alfa_stg,
                                                                                                                                                                      pc_policyline.hopolicytype_stg,
                                                                                                                                                                      coalesce(postalcodeinternal_stg, postalcode_stg)postalcodeinternal_stg,
                                                                                                                                                                      row_number() over( PARTITION BY e.branchid_stg,policynumber_stg, c.code_stg,g.typecode_stg, c.countycode_alfa_stg, pc_policyline.hopolicytype_stg ORDER BY
                                                                                                                                                                      CASE
                                                                                                                                                                                WHEN (
                                                                                                                                                                                                    c.policylocation_stg = b.id_stg ) THEN 1
                                                                                                                                                                                ELSE 2
                                                                                                                                                                      END) ROWNUM,
                                                                                                                                                                      cityinternal_stg,
                                                                                                                                                                      countyinternal_stg,
                                                                                                                                                                      county_stg,
                                                                                                                                                                      CASE
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''BIRMINGHAM''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''JEFFERSON'' THEN ''32''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''HUNTSVILLE''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MADISON'' THEN ''35''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''MONTGOMERY''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MONTGOMERY'' THEN ''37''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''MOBILE''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MOBILE'' THEN ''30''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''AUTAUGA'',
                                                                                                                                                                                                        ''ELMORE'',
                                                                                                                                                                                                        ''MONTGOMERY'') THEN ''38''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''BALDWIN''
                                                                                                                                                                                AND       cast(c.code_stg AS INTEGER)=26 THEN ''41''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''BALDWIN''
                                                                                                                                                                                AND       cast(c.code_stg AS INTEGER)=28 THEN ''31''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BARBOUR'',
                                                                                                                                                                                                        ''BIBB'',
                                                                                                                                                                                                        ''BLOUNT'',
                                                                                                                                                                                                        ''BULLOCK'',
                                                                                                                                                                                                        ''BUTLER'',
                                                                                                                                                                                                        ''CHAMBERS'',
                                                                                                                                                                                                        ''CHEROKEE'',
                                                                                                                                                                                                        ''CHILTON'',
                                                                                                                                                                                                        ''CHOCTAW'',
                                                                                                                                                                                                        ''CLARKE'',
                                                                                                                                                                                                        ''CLAY'',
                                                                                                                                                                                                        ''CLEBURNE'',
                                                                                                                                                                                                        ''COFFEE'',
                                                                                                                                                                                                        ''CONECUH'',
                                                                                                                                                                                                        ''COOSA'',
                                                                                                                                                                                                        ''COVINGTON'',
                                                                                                                                                                                                        ''CRENSHAW'',
                                                                                                                                                                                                        ''CULLMAN'',
                                                                                                                                                                                                        ''DALE'',
                                                                                                                                                                                                        ''DALLAS'',
                                                                                                                                                                                                        ''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''ESCAMBIA'',
                                                                                                                                                                                                        ''FAYETTE'',
                                                                                                                                                                                                        ''FRANKLIN'',
                                                                                                                                                                                                        ''GENEVA'',
                                                                                                                                                                                                        ''GREENE'',
                                                                                                                                                                                                        ''HALE'',
                                                                                                                                                                                                        ''HENRY'',
                                                                                                                                                                                                        ''HOUSTON'',
                                                                                                                                                                                                        ''JACKSON'',
                                                                                                                                                                                                        ''LAMAR'',
                                                                                                                                                                                                        ''LAWRENCE'',
                                                                                                                                                                                                        ''LEE'',
                                                                                                                                                                                                        ''LOWNDES'',
                                                                                                                                                                                                        ''MACON'',
                                                                                                                                                                                                        ''MONROE'',
                                                                                                                                                                                                        ''MARENGO'',
                                                                                                                                                                                                        ''MARION'',
                                                                                                                                                                                                        ''MARSHALL'',
                                                                                                                                                                                                        ''PERRY'',
                                                                                                                                                                                                        ''PICKENS'',
                                                                                                                                                                                                        ''PIKE'',
                                                                                                                                                                                                        ''RANDOLPH'',
                                                                                                                                                                                                        ''RUSSELL'',
                                                                                                                                                                                                        ''SAINT CLAIR'',
                                                                                                                                                                                                        ''ST. CLAIR'',
                                                                                                                                                                                                        ''SUMTER'',
                                                                                                                                                                                                        ''TALLADEGA'',
                                                                                                                                                                                                        ''TALLAPOOSA'',
                                                                                                                                                                                                        ''WASHINGTON'',
                                                                                                                                                                                                        ''WILCOX'',
                                                                                                                                                                                                        ''WINSTON'') THEN ''41''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''CALHOUN'',
                                                                                                                                                                                                        ''ETOWAH'') THEN ''40''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''COLBERT'',
                                                                                                                                                                                                        ''LAUDERDALE'',
                                                                                                                                                                                                        ''LIMESTONE'',
                                                                                                                                                                                                        ''MADISON'',
                                                                                                                                                                                                        ''MORGAN'') THEN ''36''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''JEFFERSON'' THEN ''33''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MOBILE''
                                                                                                                                                                                AND       cast(c.code_stg AS INTEGER)=28 THEN ''31''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MOBILE''
                                                                                                                                                                                AND       cast(c.code_stg AS INTEGER)=11 THEN ''05''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''SHELBY'',
                                                                                                                                                                                                        ''WALKER'') THEN ''34''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''TUSCALOOSA'' THEN ''39''
                                                                                                                                                                                /*WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       (
                                                                                                                                                                                                    substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-''))=''36511''
                                                                                                                                                                                          OR        b.postalcodeinternal_stg=''36511'')
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''BON SECOUR'' THEN ''06''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       (
                                                                                                                                                                                                    substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-''))=''36528''
                                                                                                                                                                                          OR        b.postalcodeinternal_stg=''36528'')
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''DAUPHIN ISLAND'' THEN ''06''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       (
                                                                                                                                                                                                    substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-'')) IN (''36542'',
                                                                                                                                                                                                        ''36547'')
                                                                                                                                                                                          OR        b.postalcodeinternal_stg IN (''36542'',
                                                                                                                                                                                                        ''36547''))
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''GULF SHORES'' THEN ''06''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       (
                                                                                                                                                                                                    substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-''))=''36561''
                                                                                                                                                                                          OR        b.postalcodeinternal_stg=''36561'')
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''ORANGE BEACH'' THEN ''06''*/
                                                                                                                                                                               WHEN g.typecode_stg = ''AL''
                                                                                                                                                                               AND (
                                                                                                                                                                               IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                                                                      SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                                                                      b.postalcodeinternal_stg
                                                                                                                                                                               ) = ''36511''
                                                                                                                                                                               OR b.postalcodeinternal_stg = ''36511''
                                                                                                                                                                               )
                                                                                                                                                                               AND UPPER(cityinternal_stg) = ''BON SECOUR'' THEN ''06''

                                                                                                                                                                               WHEN g.typecode_stg = ''AL''
                                                                                                                                                                               AND (
                                                                                                                                                                               IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                                                                      SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                                                                      b.postalcodeinternal_stg
                                                                                                                                                                               ) = ''36528''
                                                                                                                                                                               OR b.postalcodeinternal_stg = ''36528''
                                                                                                                                                                               )
                                                                                                                                                                               AND UPPER(cityinternal_stg) = ''DAUPHIN ISLAND'' THEN ''06''

                                                                                                                                                                               WHEN g.typecode_stg = ''AL''
                                                                                                                                                                               AND (
                                                                                                                                                                               IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                                                                      SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                                                                      b.postalcodeinternal_stg
                                                                                                                                                                               ) IN (''36542'', ''36547'')
                                                                                                                                                                               OR b.postalcodeinternal_stg IN (''36542'', ''36547'')
                                                                                                                                                                               )
                                                                                                                                                                               AND UPPER(cityinternal_stg) = ''GULF SHORES'' THEN ''06''

                                                                                                                                                                               WHEN g.typecode_stg = ''AL''
                                                                                                                                                                               AND (
                                                                                                                                                                               IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                                                                      SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                                                                      b.postalcodeinternal_stg
                                                                                                                                                                               ) = ''36561''
                                                                                                                                                                               OR b.postalcodeinternal_stg = ''36561''
                                                                                                                                                                               )
                                                                                                                                                                               AND UPPER(cityinternal_stg) = ''ORANGE BEACH'' THEN ''06''
                                                                                                                                    
                                                                                                                                                                                WHEN g.typecode_stg=''MS''
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''JACKSON''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''HINDS'',
                                                                                                                                                                                                        ''RANKIN'') THEN ''30''
                                                                                                                                                                                WHEN g.typecode_stg=''MS''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''AMITE'',
                                                                                                                                                                                                        ''FORREST'',
                                                                                                                                                                                                        ''GREENE'',
                                                                                                                                                                                                        ''LAMAR'',
                                                                                                                                                                                                        ''MARION'',
                                                                                                                                                                                                        ''PERRY'',
                                                                                                                                                                                                        ''PIKE'',
                                                                                                                                                                                                        ''WALTHALL'',
                                                                                                                                                                                                        ''WILKINSON'') THEN ''03''
                                                                                                                                                                                WHEN g.typecode_stg=''MS''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''GEORGE'',
                                                                                                                                                                                                        ''PEARL RIVER'',
                                                                                                                                                                                                        ''STONE'') THEN ''05''
                                                                                                                                                                                WHEN g.typecode_stg=''MS''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''HANCOCK'',
                                                                                                                                                                                                        ''HARRISON'',
                                                                                                                                                                                                        ''JACKSON'') THEN ''06''
                                                                                                                                                                                WHEN g.typecode_stg=''MS''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''HINDS'',
                                                                                                                                                                                                        ''MADISON'',
                                                                                                                                                                                                        ''RANKIN'') THEN ''31''
                                                                                                                                                                                WHEN g.typecode_stg=''MS''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''ADAMS'',
                                                                                                                                                                                                        ''ALCORN'',
                                                                                                                                                                                                        ''ATTALA'',
                                                                                                                                                                                                        ''BENTON'',
                                                                                                                                                                                                        ''BOLIVAR'',
                                                                                                                                                                                                        ''CALHOUN'',
                                                                                                                                                                                                        ''CARROLL'',
                                                                                                                                                                                                        ''CHICKASAW'',
                                                                                                                                                                                                        ''CHOCTAW'',
                                                                                                                                                                                                        ''CLAIBORNE'',
                                                                                                                                                                                                        ''CLARKE'',
                                                                                                                                                                                                        ''CLAY'',
                                                                                                                                                                                                        ''COAHOMA'',
                                                                                                                                                                                                        ''COPIAH'',
                                                                                                                                                                                                        ''COVINGTON'',
                                                                                                                                                                                                        ''DESOTO'',
                                                                                                                                                                                                        ''FRANKLIN'',
                                                                                                                                                                                                        ''GRENADA'',
                                                                                                                                                                                                        ''HOLMES'',
                                                                                                                                                                                                        ''HUMPHREYS'',
                                                                                                                                                                                                        ''ISSAQUENA'',
                                                                                                                                                                                                        ''ITAWAMBA'',
                                                                                                                                                                                                        ''JASPER'',
                                                                                                                                                                                                        ''JEFFERSON'',
                                                                                                                                                                                                        ''JEFFERSON DAVIS'',
                                                                                                                                                                                                        ''JONES'',
                                                                                                                                                                                                        ''KEMPER'',
                                                                                                                                                                                                        ''LAFAYETTE'',
                                                                                                                                                                                                        ''LAUDERDALE'',
                                                                                                                                                                                                        ''LAWRENCE'',
                                                                                                                                                                                                        ''LEAKE'',
                                                                                                                                                                                                        ''LEE'',
                                                                                                                                                                                                        ''LEFLORE'',
                                                                                                                                                                                                        ''LINCOLN'',
                                                                                                                                                                                                        ''LOWNDES'',
                                                                                                                                                                                                        ''MARSHALL'',
                                                                                                                                                                                                        ''MONROE'',
                                                                                                                                                                                                        ''MONTGOMERY'',
                                                                                                                                                                                                        ''NESHOBA'',
                                                                                                                                                                                                        ''NEWTON'',
                                                                                                                                                                                                        ''NOXUBEE'',
                                                                                                                                                                                                        ''OKTIBBEHA'',
                                                                                                                                                                                                        ''PANOLA'',
                                                                                                                                                                                                        ''PONTOTOC'',
                                                                                                                                                                                                        ''PRENTISS'',
                                                                                                                                                                                                        ''QUITMAN'',
                                                                                                                                                                                                        ''SCOTT'',
                                                                                                                                                                                                        ''SHARKEY'',
                                                                                                                                                                                                        ''SIMPSON'',
                                                                                                                                                                                                        ''SMITH'',
                                                                                                                                                                                                        ''SUNFLOWER'',
                                                                                                                                                                                                        ''TALLAHATCHIE'',
                                                                                                                                                                                                        ''TATE'',
                                                                                                                                                                                                        ''TIPPAH'',
                                                                                                                                                                                                        ''TISHOMINGO'',
                                                                                                                                                                                                        ''TUNICA'',
                                                                                                                                                                                                        ''UNION'',
                                                                                                                                                                                                        ''WARREN'',
                                                                                                                                                                                                        ''WASHINGTON'',
                                                                                                                                                                                                        ''WAYNE'',
                                                                                                                                                                                                        ''WEBSTER'',
                                                                                                                                                                                                        ''WINSTON'',
                                                                                                                                                                                                        ''YALOBUSHA'',
                                                                                                                                                                                                        ''YAZOO'') THEN ''32''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''ATLANTA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''FULTON'') THEN ''32''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''MACON''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''BIBB'' THEN ''35''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(cityinternal_stg)= ''SAVANNAH''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''CHATHAM'' THEN ''30''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''FULTON'') THEN ''33''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BRYAN'',
                                                                                                                                                                                                        ''CAMDEN'',
                                                                                                                                                                                                        ''CHATHAM'',
                                                                                                                                                                                                        ''GLYNN'',
                                                                                                                                                                                                        ''LIBERTY'',
                                                                                                                                                                                                        ''MCINTOSH'') THEN ''31''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''DE KALB'',
                                                                                                                                                                                                        ''DEKALB'',
                                                                                                                                                                                                        ''FULTON'') THEN ''33''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''CLAYTON'',
                                                                                                                                                                                                        ''COBB'',
                                                                                                                                                                                                        ''GWINNETT'') THEN ''34''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''CATOOSA'',
                                                                                                                                                                                                        ''WALKER'',
                                                                                                                                                                                                        ''WHITFIELD'') THEN ''36''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) =''RICHMOND'' THEN ''37''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''CHATTAHOOCHEE'',
                                                                                                                                                                                                        ''MUSCOGEE'') THEN ''38''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BUTTS'',
                                                                                                                                                                                                        ''CHEROKEE'',
                                                                                                                                                                                                        ''DOUGLAS'',
                                                                                                                                                                                                        ''FAYETTE'',
                                                                                                                                                                                                        ''FORSYTH'',
                                                                                                                                                                                                        ''HENRY'',
                                                                                                                                                                                                        ''NEWTON'',
                                                                                                                                                                                                        ''PAULDING'',
                                                                                                                                                                                                        ''ROCKDALE'',
                                                                                                                                                                                                        ''WALTON'') THEN ''39''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BALDWIN'',
                                                                                                                                                                                                        ''BANKS'',
                                                                                                                                                                                                        ''BARROW'',
                                                                                                                                                                                                        ''BARTOW'',
                                                                                                                                                                                                        ''CARROLL'',
                                                                                                                                                                                                        ''CHATTOOGA'',
                                                                                                                                                                                                        ''CLARKE'',
                                                                                                                                                                                                        ''COLUMBIA'',
                                                                                                                                                                                                        ''COWETA'',
                                                                                                                                                                                                        ''DADE'',
                                                                                                                                                                                                        ''DAWSON'',
                                                                                                                                                                                                        ''ELBERT'',
                                                                                                                                                                                                        ''FANNIN'',
                                                                                                                                                                                                        ''FLOYD'',
                                                                                                                                                                                                        ''FRANKLIN'',
                                                                                                                                                                                                        ''GILMER'',
                                                                                                                                                                                                        ''GORDON'',
                                                                                                                                                                                                        ''GREENE'',
                                                                                                                                                                                                        ''HABERSHAM'',
                                                                                                                                                                                                        ''HALL'',
                                                                                                                                                                                                        ''HANCOCK'',
                                                                                                                                                                                                        ''HARALSON'',
                                                                                                                                                                                                        ''HART'',
                                                                                                                                                                                                        ''HEARD'',
                                                                                                                                                                                                        ''JACKSON'',
                                                                                                                                                                                                        ''JASPER'',
                                                                                                                                                                                                        ''JONES'',
                                                                                                                                                                                                        ''LAMAR'',
                                                                                                                                                                                                        ''LINCOLN'',
                                                                                                                                                                                                        ''LUMPKIN'',
                                                                                                                                                                                                        ''MADISON'',
                                                                                                                                                                                                        ''MCDUFFIE'',
                                                                                                                                                                                                        ''MERIWETHER'',
                                                                                                                                                                                                        ''MONROE'',
                                                                                                                                                                                                        ''MORGAN'',
                                                                                                                                                                                                        ''MURRAY'',
                                                                                                                                                                                                        ''OCONEE'',
                                                                                                                                                                                                        ''OGLETHORPE'',
                                                                                                                                                                                                        ''PICKENS'',
                                                                                                                                                                                                        ''PIKE'',
                                                                                                                                                                                                        ''POLK'',
                                                                                                                                                                                                        ''PUTNAM'',
                                                                                                                                                                                                        ''RABUN'',
                                                                                                                                                                                                        ''SPALDING'',
                                                                                                                                                                                                        ''STEPHENS'',
                                                                                                                                                                                                        ''TALIAFERRO'',
                                                                                                                                                                                                        ''TOWNS'',
                                                                                                                                                                                                        ''TROUP'',
                                                                                                                                                                                                        ''UNION'',
                                                                                                                                                                                                        ''WARREN'',
                                                                                                                                                                                                        ''WHITE'',
                                                                                                                                                                                                        ''WILKES'') THEN ''40''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''BAKER'',
                                                                                                                                                                                                        ''BIBB'',
                                                                                                                                                                                                        ''BROOKS'',
                                                                                                                                                                                                        ''CALHOUN'',
                                                                                                                                                                                                        ''CLAY'',
                                                                                                                                                                                                        ''COLQUITT'',
                                                                                                                                                                                                        ''CRAWFORD'',
                                                                                                                                                                                                        ''CRISP'',
                                                                                                                                                                                                        ''DECATUR'',
                                                                                                                                                                                                        ''DOOLY'',
                                                                                                                                                                                                        ''DOUGHERTY'',
                                                                                                                                                                                                        ''EARLY'',
                                                                                                                                                                                                        ''GRADY'',
                                                                                                                                                                                                        ''HARRIS'',
                                                                                                                                                                                                        ''HOUSTON'',
                                                                                                                                                                                                        ''LEE'',
                                                                                                                                                                                                        ''MACON'',
                                                                                                                                                                                                        ''MARION'',
                                                                                                                                                                                                        ''MILLER'',
                                                                                                                                                                                                        ''MITCHELL'',
                                                                                                                                                                                                        ''PEACH'',
                                                                                                                                                                                                        ''QUITMAN'',
                                                                                                                                                                                                        ''RANDOLPH'',
                                                                                                                                                                                                        ''SCHLEY'',
                                                                                                                                                                                                        ''SEMINOLE'',
                                                                                                                                                                                                        ''STEWART'',
                                                                                                                                                                                                        ''SUMTER'',
                                                                                                                                                                                                        ''TALBOT'',
                                                                                                                                                                                                        ''TAYLOR'',
                                                                                                                                                                                                        ''TERRELL'',
                                                                                                                                                                                                        ''THOMAS'',
                                                                                                                                                                                                        ''TIFT'',
                                                                                                                                                                                                        ''TURNER'',
                                                                                                                                                                                                        ''UPSON'',
                                                                                                                                                                                                        ''WEBSTER'',
                                                                                                                                                                                                        ''WORTH'') THEN ''41''
                                                                                                                                                                                WHEN g.typecode_stg=''GA''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg)) IN (''APPLING'',
                                                                                                                                                                                                        ''ATKINSON'',
                                                                                                                                                                                                        ''BACON'',
                                                                                                                                                                                                        ''BEN HILL'',
                                                                                                                                                                                                        ''BERRIEN'',
                                                                                                                                                                                                        ''BLECKLEY'',
                                                                                                                                                                                                        ''BRANTLEY'',
                                                                                                                                                                                                        ''BULLOCH'',
                                                                                                                                                                                                        ''BURKE'',
                                                                                                                                                                                                        ''CANDLER'',
                                                                                                                                                                                                        ''CHARLTON'',
                                                                                                                                                                                                        ''CLINCH'',
                                                                                                                                                                                                        ''COFFEE'',
                                                                                                                                                                                                        ''COOK'',
                                                                                                                                                                                                        ''DODGE'',
                                                                                                                                                                                                        ''ECHOLS'',
                                                                                                                                                                                                        ''EFFINGHAM'',
                                                                                                                                                                                                        ''EMANUEL'',
                                                                                                                                                                                                        ''EVANS'',
                                                                                                                                                                                                        ''GLASCOCK'',
                                                                                                                                                                                                        ''IRWIN'',
                                                                                                                                                                                                        ''JEFF DAVIS'',
                                                                                                                                                                                                        ''JEFFERSON'',
                                                                                                                                                                                                        ''JENKINS'',
                                                                                                                                                                                                        ''JOHNSON'',
                                                                                                                                                                                                        ''LANIER'',
                                                                                                                                                                                                        ''LAURENS'',
                                                                                                                                                                                                        ''LONG'',
                                                                                                                                                                                                        ''LOWNDES'',
                                                                                                                                                                                                        ''MONTGOMERY'',
                                                                                                                                                                                                        ''PIERCE'',
                                                                                                                                                                                                        ''PULASKI'',
                                                                                                                                                                                                        ''SCREVEN'',
                                                                                                                                                                                                        ''TATTNALL'',
                                                                                                                                                                                                        ''TELFAIR'',
                                                                                                                                                                                                        ''TOOMBS'',
                                                                                                                                                                                                        ''TREUTLEN'',
                                                                                                                                                                                                        ''TWIGGS'',
                                                                                                                                                                                                        ''WARE'',
                                                                                                                                                                                                        ''WASHINGTON'',
                                                                                                                                                                                                        ''WAYNE'',
                                                                                                                                                                                                        ''WHEELER'',
                                                                                                                                                                                                        ''WILCOX'',
                                                                                                                                                                                                        ''WILKINSON'') THEN ''42''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''BALDWIN''
                                                                                                                                                                                AND       (
                                                                                                                                                                                                    cast(c.code_stg AS INTEGER)=11
                                                                                                                                                                                          OR        cast(c.code_stg AS INTEGER) IS NULL
                                                                                                                                                                                          OR        cast(c.code_stg AS INTEGER) IN (1,2,3) ) THEN ''05''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(county_stg)=''BALDWIN''
                                                                                                                                                                                AND       (
                                                                                                                                                                                                    cast(c.code_stg AS INTEGER)=11
                                                                                                                                                                                          OR        cast(c.code_stg AS INTEGER) IS NULL
                                                                                                                                                                                          OR        cast(c.code_stg AS INTEGER) IN (1,2,3) ) THEN ''05''
                                                                                                                                                                                WHEN g.typecode_stg=''AL''
                                                                                                                                                                                AND       upper(coalesce(b.countyinternal_stg,county_stg))=''MOBILE''
                                                                                                                                                                                AND       (
                                                                                                                                                                                                    cast(c.code_stg AS INTEGER)IN (2,1,26,3 )
                                                                                                                                                                                          OR        cast(c.code_stg AS INTEGER)IS NULL) THEN ''41''
                                                                                                                                                                      END AS old_code_stg
                                                                                                                                                            FROM      db_t_prod_stag.pcx_holocation_hoe a
                                                                                                                                                            join      db_t_prod_stag.pcx_dwelling_hoe e
                                                                                                                                                            ON        e.holocation_stg=a.id_stg
                                                                                                                                                            join      db_t_prod_stag.pc_policyperiod f
                                                                                                                                                            ON        e.branchid_stg =f.id_stg
                                                                                                                                                            left join db_t_prod_stag.pc_effectivedatedfields eff
                                                                                                                                                            ON        eff.branchid_stg = f.id_stg
                                                                                                                                                            AND       eff.expirationdate_stg IS NULL
                                                                                                                                                            join      db_t_prod_stag.pc_policylocation b
                                                                                                                                                            ON        b.id_stg = eff.primarylocation_stg
                                                                                                                                                            AND       b.expirationdate_stg IS NULL
                                                                                                                                                            join      db_t_prod_stag.pc_territorycode c
                                                                                                                                                            ON        c.branchid_stg = f.id_stg
                                                                                                                                                            join      db_t_prod_stag.pctl_territorycode d
                                                                                                                                                            ON        c.subtype_stg=d.id_stg
                                                                                                                                                            AND       d.typecode_stg = ''HOTerritoryCode_alfa''
                                                                                                                                                            left join db_t_prod_stag.pc_contact pc
                                                                                                                                                            ON        pc.id_stg =pnicontactdenorm_stg
                                                                                                                                                            left join db_t_prod_stag.pc_address
                                                                                                                                                            ON        pc.primaryaddressid_stg = pc_address.id_stg
                                                                                                                                                            join      db_t_prod_stag.pc_policyline
                                                                                                                                                            ON        f.id_stg = pc_policyline.branchid_stg
                                                                                                                                                            AND       pc_policyline.expirationdate_stg IS NULL
                                                                                                                                                            join      db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                            ON        pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                            AND       pctl_hopolicytype_hoe.typecode_stg IN (''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                            join      db_t_prod_stag.pctl_jurisdiction g
                                                                                                                                                            ON        basestate_stg=g.id_stg
                                                                                                                                                            AND       g.typecode_stg IN (''AL'',
                                                                                                                                                                                         ''GA'',
                                                                                                                                                                                         ''MS'')) loc
                                                                                                                                        left join db_t_prod_stag.pcx_hodbterritory_alfa pht1
                                                                                                                                        ON        pht1.code_stg =loc.code_stg
                                                                                                                                        AND       cast(pht1.countycode_alfa_stg AS VARCHAR(50))=cast(loc.countycode_alfa_stg AS VARCHAR(50))
                                                                                                                                        AND       substring(pht1.publicid_stg,7,2) =loc.typecode_stg
                                                                                                                                        AND       pht1.hopolicytype_hoe_stg=loc.hopolicytype_stg
                                                                                                                                        left join
                                                                                                                                                  (
                                                                                                                                                                  SELECT DISTINCT naiipcicode_alfa_stg,
                                                                                                                                                                                  substring(publicid_stg,7,2) state_stg,
                                                                                                                                                                                  code_stg                    territory_code_stg,
                                                                                                                                                                                  hopolicytype_hoe_stg,
                                                                                                                                                                                  rank() over( PARTITION BY naiipcicode_alfa_stg, substring(publicid_stg,7,2) , code_stg , hopolicytype_hoe_stg ORDER BY naiipcicode_alfa_stg,countycode_alfa_stg )"row"
                                                                                                                                                                  FROM            db_t_prod_stag.pcx_hodbterritory_alfa
                                                                                                                                                                  WHERE           publicid_stg LIKE ''%SF%'')pht2
                                                                                                                                        ON        pht2."row"=1
                                                                                                                                        AND       pht2.territory_code_stg =loc.code_stg
                                                                                                                                        AND       pht2.state_stg =loc.typecode_stg
                                                                                                                                        AND       pht2.hopolicytype_hoe_stg=loc.hopolicytype_stg
                                                                                                                                        left join
                                                                                                                                                  (
                                                                                                                                                                  SELECT DISTINCT naiipcicode_alfa_stg,
                                                                                                                                                                                  substring(publicid_stg,7,2) state_stg,
                                                                                                                                                                                  countycode_alfa_stg         countycode_alfa_stg,
                                                                                                                                                                                  hopolicytype_hoe_stg,
                                                                                                                                                                                  rank() over( PARTITION BY naiipcicode_alfa_stg, substring(publicid_stg,7,2) , countycode_alfa_stg , hopolicytype_hoe_stg ORDER BY naiipcicode_alfa_stg,code_stg )"row"
                                                                                                                                                                  FROM            db_t_prod_stag.pcx_hodbterritory_alfa
                                                                                                                                                                  WHERE           publicid_stg LIKE ''%SF%'')pht3
                                                                                                                                        ON        pht3."row"=1
                                                                                                                                        AND       cast(pht3.countycode_alfa_stg AS VARCHAR(50))=cast(loc.countycode_alfa_stg AS VARCHAR(50))
                                                                                                                                        AND       pht3.state_stg =loc.typecode_stg
                                                                                                                                        AND       pht3.hopolicytype_hoe_stg=loc.hopolicytype_stg
                                                                                                                                        WHERE     ROWNUM=1
                                                                                                                                        GROUP BY  loc.branchid_stg) terr
                                                                                                              ON              terr.id=pp.id_stg
                                                                                                              join            db_t_prod_stag.pc_job pj
                                                                                                              ON              pp.jobid_stg = pj.id_stg
                                                                                                              join            db_t_prod_stag.pctl_job pcj
                                                                                                              ON              pj.subtype_stg = pcj.id_stg
                                                                                                              join            db_t_prod_stag.pcx_holocation_hoe phh
                                                                                                              ON              pdh.holocation_stg= phh.id_stg
                                                                                                              join            db_t_prod_stag.pctl_hopolicytype_hoe ph
                                                                                                              ON              ph.id_stg=hopolicytype_stg
                                                                                                              AND             ph.typecode_stg IN (''SF1'',
                                                                                                                                                  ''SF2'',
                                                                                                                                                  ''SF3'')
                                                                                                              join
                                                                                                                              (
                                                                                                                                              SELECT DISTINCT branchid_stg,
                                                                                                                                                              max(
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN covterm.covtermpatternid_stg=''HODW_Dwelling_Limit_HOE'' THEN substring(1, (5-length( cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))))-1 + cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000, 0)AS INTEGER) AS VARCHAR(10))
                                                                                                                                                              END )dw_limit,
                                                                                                                                                              max(
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN covterm.covtermpatternid_stg=''HOSI_SpecificOtherStructureItemLimit_alfa'' THEN substring(1, (5-length( cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))))-1 + cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000, 0)AS INTEGER) AS VARCHAR(10))
                                                                                                                                                              END )st_limit,
                                                                                                                                                              max (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN covterm.covtermpatternid_stg=''HODW_DwellingAdditionalLimit_alfa'' THEN cast(polcov.val_stg AS DECIMAL(18,4))
                                                                                                                                                              END )lia_limit,
                                                                                                                                                              max (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN covterm.covtermpatternid_stg=''HODW_PersonalPropertyLimit_alfa'' THEN substring(1, (5-length( cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))))-1 + (cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))
                                                                                                                                                              END )pp_limit,
                                                                                                                                                              max(
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN covterm.covtermpatternid_stg=''HODW_OtherPerils_Ded_HOE'' THEN (
                                                                                                                                                                                              CASE
                                                                                                                                                                                                        WHEN substring(name1_stg ,length(name1_stg),1)=''%'' THEN ''F''
                                                                                                                                                                                                        ELSE ''D''
                                                                                                                                                                                              END)
                                                                                                                                                              END)perils_limit_ind,
                                                                                                                                                              max(
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN covterm.covtermpatternid_stg=''HODW_OtherPerils_Ded_HOE'' THEN (
                                                                                                                                                                                              CASE
                                                                                                                                                                                                        WHEN substring(name1_stg ,length(name1_stg),1)=''%'' THEN cast(cast(cast(cast(value1_stg AS DECIMAL(18,4)) *10000 AS DECIMAL(18,4)) AS INTEGER) AS VARCHAR(10))
                                                                                                                                                                                                        ELSE cast(cast(cast(value1_stg AS DECIMAL(18,4)) AS INTEGER) AS VARCHAR(10))
                                                                                                                                                                                              END)
                                                                                                                                                              END)perils_limit,
                                                                                                                                                              max (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN patterncode_stg =''HODW_Earthquake_HOE'' THEN patterncode_stg
                                                                                                                                                              END) earthquake,
                                                                                                                                                              max (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN patterncode_stg =''HODW_PersonalPropertyReplacementCost_alfa'' THEN patterncode_stg
                                                                                                                                                              END) replacement,
                                                                                                                                                              max (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        covtermpatternid_stg =''HODW_WindHail_Ded_HOE'') THEN covtermpatternid_stg
                                                                                                                                                              END )windhail,
                                                                                                                                                              max (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        covtermpatternid_stg =''HODW_Hurricane_Ded_HOE'' ) THEN covtermpatternid_stg
                                                                                                                                                              END )hurricane,
                                                                                                                                                              max (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        covtermpatternid_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'') THEN covtermpatternid_stg
                                                                                                                                                              END )windstormhailexcl,
                                                                                                                                                              max (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN (
                                                                                                                                                                                                        covtermpatternid_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'') THEN coalesce( polcov.val_stg, value1_stg)
                                                                                                                                                              END )windstormhailexcl_amt,
                                                                                                                                                              max(
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                                                        ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                                                        ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                                                              AND             polcov.columnname_stg LIKE ''%direct%'' THEN polcov.val_stg
                                                                                                                                                                              WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                                                        ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                                                        ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                                                              AND             polcov.columnname_stg NOT LIKE ''%direct%'' THEN (
                                                                                                                                                                                              CASE
                                                                                                                                                                                                        WHEN (
                                                                                                                                                                                                        cast(value1_stg AS DECIMAL(18,4))<=1.0000 ) THEN cast(cast(cast(value1_stg AS DECIMAL(18,4))*10000 AS INTEGER) AS VARCHAR(10))
                                                                                                                                                                                                        WHEN value1_stg IS NULL
                                                                                                                                                                                                        OR              value1_stg =0 THEN 0
                                                                                                                                                                                                        ELSE cast(cast(cast(value1_stg AS DECIMAL(18,4)) *10000 AS INTEGER) AS VARCHAR(10))
                                                                                                                                                                                              END )
                                                                                                                                                              END ) AS deductibleamountws_stg,
                                                                                                                                                              max (
                                                                                                                                                              CASE
                                                                                                                                                                              WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                                                        ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                                                        ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                                                              AND             polcov.columnname_stg LIKE ''%direct%'' THEN ''D''
                                                                                                                                                                              WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                                                        ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                                                        ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                                                              AND             polcov.columnname_stg NOT LIKE ''%direct%'' THEN (
                                                                                                                                                                                              CASE
                                                                                                                                                                                                        WHEN (
                                                                                                                                                                                                        cast(value1_stg AS DECIMAL(18,4))<=1.0000) THEN ''F''
                                                                                                                                                                                                        WHEN value1_stg IS NULL
                                                                                                                                                                                                        OR              value1_stg=0 THEN NULL
                                                                                                                                                                                                        ELSE ''D''
                                                                                                                                                                                              END )
                                                                                                                                                              END ) AS deductiblews
                                                                                                                                              FROM            (
                                                                                                                                                                         SELECT     cast(''DirectTerm1'' AS                       VARCHAR(100)) AS columnname_stg,
                                                                                                                                                                                    cast(directterm1_stg AS                     VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.          expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      directterm1avl_stg = 1
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     ''Clause''                   AS columnname_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      pcx_dwellingcov_hoe.patterncode_stg= ''HODW_PersonalPropertyReplacementCost_alfa''
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     ''DirectTerm2''                         AS columnname_stg,
                                                                                                                                                                                    cast(directterm2_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      directterm2avl_stg = 1
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     ''DirectTerm3''                         AS columnname_stg,
                                                                                                                                                                                    cast(directterm3_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      directterm3avl_stg = 1
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     ''DirectTerm4''                         AS columnname_stg,
                                                                                                                                                                                    cast(directterm4_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.          expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      directterm4avl_stg = 1
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     ''ChoiceTerm2''                         AS columnname_stg,
                                                                                                                                                                                    cast(choiceterm2_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      choiceterm2avl_stg = 1
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     ''ChoiceTerm3''                         AS columnname_stg,
                                                                                                                                                                                    cast(choiceterm3_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe. effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      choiceterm3avl_stg = 1
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     cast(''ChoiceTerm1'' AS                       VARCHAR(250)) AS columnname_stg,
                                                                                                                                                                                    cast(choiceterm1_stg AS                     VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe. effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      choiceterm1avl_stg = 1
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     cast(''ChoiceTerm4'' AS                       VARCHAR(250)) AS columnname_stg,
                                                                                                                                                                                    cast(choiceterm4_stg AS                     VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      choiceterm4avl_stg = 1
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     cast(''BooleanTerm1'' AS                      VARCHAR(250)) AS columnname_stg,
                                                                                                                                                                                    cast(booleanterm1_stg AS                    VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                                                                    cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                                                                    cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                                                                    pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         WHERE      pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                                                                         AND        pcx_dwellingcov_hoe.patterncode_stg =''HODW_SectionI_Ded_HOE''
                                                                                                                                                                         UNION
                                                                                                                                                                         SELECT     ''DirectTerm1''                         AS columnname_stg,
                                                                                                                                                                                    cast(directterm1_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                                                                    pha.patterncode_stg,
                                                                                                                                                                                    cast(pha.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                                                                    pha.createtime_stg,
                                                                                                                                                                                    pha.effectivedate_stg,
                                                                                                                                                                                    pha.expirationdate_stg,
                                                                                                                                                                                    choiceterm1_stg,
                                                                                                                                                                                    pe.patternid_stg AS patternid_stg,
                                                                                                                                                                                    pha.updatetime_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pcx_holineschcovitemcov_alfa pha
                                                                                                                                                                         inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                                                                         ON         pp.id_stg = pha.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pc_policyline
                                                                                                                                                                         ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                                                                         join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                                                         ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                                                         AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                                        ''SF2'',
                                                                                                                                                                                                        ''SF3'')
                                                                                                                                                                         left join  db_t_prod_stag.pc_etlclausepattern pe
                                                                                                                                                                         ON         pe.patternid_stg = pha.patterncode_stg
                                                                                                                                                                         WHERE      pe.patternid_stg IN (''HOSI_SpecificOtherStructureItem_alfa'',
                                                                                                                                                                                                        ''HOSI_ScheduledPropertyItem_alfa'',
                                                                                                                                                                                                        ''HOSI_SpecificOtherStructureExclItem_alfa'')
                                                                                                                                                                         AND        directterm1avl_stg = 1
                                                                                                                                                                         AND        pha.expirationdate_stg IS NULL ) polcov
                                                                                                                                              left join
                                                                                                                                                              (
                                                                                                                                                                     SELECT pcl.patternid_stg     clausepatternid_stg,
                                                                                                                                                                            pcv.patternid_stg     covtermpatternid_stg,
                                                                                                                                                                            pcv.columnname_stg  AS columnname_stg,
                                                                                                                                                                            pcv.covtermtype_stg AS covtermtype_stg,
                                                                                                                                                                            pcl.name_stg           clausename_stg
                                                                                                                                                                     FROM   db_t_prod_stag.pc_etlclausepattern pcl
                                                                                                                                                                     join   db_t_prod_stag.pc_etlcovtermpattern pcv
                                                                                                                                                                     ON     pcl.id_stg = pcv.clausepatternid_stg ) covterm
                                                                                                                                              ON              covterm.clausepatternid_stg = polcov.patterncode_stg
                                                                                                                                              AND             covterm.columnname_stg = polcov.columnname_stg
                                                                                                                                              left outer join
                                                                                                                                                              (
                                                                                                                                                                         SELECT     pco.patternid_stg                      optionpatternid_stg,
                                                                                                                                                                                    pco.optioncode_stg                     name1_stg,
                                                                                                                                                                                    cast(pco.value_stg AS VARCHAR(255)) AS value1_stg,
                                                                                                                                                                                    pcp.valuetype_stg                   AS valuetype_stg
                                                                                                                                                                         FROM       db_t_prod_stag.pc_etlcovtermpattern pcp
                                                                                                                                                                         inner join db_t_prod_stag.pc_etlcovtermoption pco
                                                                                                                                                                         ON         pcp.id_stg = pco.coveragetermpatternid_stg ) optn
                                                                                                                                              ON              optn.optionpatternid_stg = polcov.val_stg
                                                                                                                                              GROUP BY        branchid_stg ) cov
                                                                                                              ON              cast(cov.branchid_stg AS bigint) =pp.id_stg
                                                                                                              left join       db_t_prod_stag.pctl_residencetype_hoe pr
                                                                                                              ON              residencetype_stg= pr.id_stg
                                                                                                              left join       db_t_prod_stag.pc_periodanswer ppa
                                                                                                              ON              ppa.branchid_stg=pp.id_stg
                                                                                                              AND             questioncode_stg=''HOStandardFirePolicySubtype_alfa''
                                                                                                              left join       db_t_prod_stag.pctl_constructiontype_hoe pct
                                                                                                              ON              pct.id_stg=constructiontype_stg )a
                                                                                       WHERE  rnk =1) pc_policyperiod ) lkp_pc
                                                  ON              lkp_pc.policynumber = sq_clm.policynumber
                                                                  /*  */
                                  ) src ) );
  -- Component exp_claims_pass_through, Type EXPRESSION
  CREATE
  OR
  replace TEMPORARY TABLE exp_claims_pass_through AS
  (
         SELECT sq_cc_claim.companynumber              AS companynumber,
                sq_cc_claim.lineofbusinesscode         AS lineofbusinesscode,
                sq_cc_claim.statecode                  AS statecode,
                sq_cc_claim.callyear                   AS callyear,
                sq_cc_claim.accountingyear             AS accountingyear,
                sq_cc_claim.expperiodyear              AS expperiodyear,
                sq_cc_claim.expperiodmonth             AS expperiodmonth,
                sq_cc_claim.expeperiodday              AS expeperiodday,
                sq_cc_claim.occupancycode              AS occupancycode,
                sq_cc_claim.classificationcode         AS classificationcode,
                sq_cc_claim.territorycode              AS territorycode,
                sq_cc_claim.stateexceptionind          AS stateexceptionind,
                sq_cc_claim.zipcode                    AS zipcode,
                sq_cc_claim.policyeffectiveyear        AS policyeffectiveyear,
                sq_cc_claim.newrecordformat            AS newrecordformat,
                sq_cc_claim.aslob                      AS aslob,
                sq_cc_claim.itemcode                   AS itemcode,
                sq_cc_claim.sublinecode                AS sublinecode,
                sq_cc_claim.policyprogramcode          AS policyprogramcode,
                sq_cc_claim.policyformcode             AS policyformcode,
                sq_cc_claim.no_of_family_codes         AS no_of_family_codes,
                sq_cc_claim.construction               AS construction,
                sq_cc_claim.protectioncode             AS protectioncode,
                sq_cc_claim.exceptioncode              AS exceptioncode,
                sq_cc_claim.typeofdeductiblecode       AS typeofdeductiblecode,
                sq_cc_claim.policytermcode             AS policytermcode,
                sq_cc_claim.typeoflosscode             AS typeoflosscode,
                sq_cc_claim.stateexceptionb            AS stateexceptionb,
                sq_cc_claim.amountofinsurance          AS amountofinsurance,
                sq_cc_claim.yeaofmanufacture           AS yeaofmanufacture,
                sq_cc_claim.coveragecodeb              AS coveragecodeb,
                sq_cc_claim.exposurecodes              AS exposurecodes,
                sq_cc_claim.leadpoisioning             AS leadpoisioning,
                sq_cc_claim.dedindicator               AS dedindicator,
                sq_cc_claim.dedamount                  AS dedamount,
                sq_cc_claim.deductibleindicatorws      AS deductibleindicatorws,
                sq_cc_claim.deductibleamountws         AS deductibleamountws,
                sq_cc_claim.claimidentifier            AS claimidentifier,
                sq_cc_claim.claimantidentifier         AS claimantidentifier,
                sq_cc_claim.writtenexposure            AS writtenexposure,
                sq_cc_claim.writtenpremium             AS writtenpremium,
                sq_cc_claim.paidlosses                 AS paidlosses,
                sq_cc_claim.paidnumberofclaims         AS paidnumberofclaims,
                sq_cc_claim.outstandinglosses          AS outstandinglosses,
                sq_cc_claim.outstandingnoofclaims      AS outstandingnoofclaims,
                sq_cc_claim.policynumber               AS policynumber,
                sq_cc_claim.policyperiodid             AS policyperiodid,
                sq_cc_claim.policysystemperiodid       AS policysystemperiodid,
                sq_cc_claim.effectivedate              AS effectivedate,
                sq_cc_claim.territorycode_pc           AS territorycode_pc,
                sq_cc_claim.zipcode_pc                 AS zipcode_pc,
                sq_cc_claim.itemcode_pc                AS itemcode_pc,
                sq_cc_claim.sublinecode_pc             AS sublinecode_pc,
                sq_cc_claim.occupancy_code_pc          AS occupancy_code_pc,
                sq_cc_claim.buildingcontents_pc        AS buildingcontents_pc,
                sq_cc_claim.constructioncode_pc        AS constructioncode_pc,
                sq_cc_claim.protectionclasscode_pc     AS protectionclasscode_pc,
                sq_cc_claim.typeofdeductiblecode_pc    AS typeofdeductiblecode_pc,
                sq_cc_claim.amountofinsurance_pc       AS amountofinsurance_pc,
                sq_cc_claim.yeaofconstructionliablt_pc AS yeaofconstructionliablt_pc,
                sq_cc_claim.deductibleindicator_pc     AS deductibleindicator_pc,
                sq_cc_claim.deductibleamount_pc        AS deductibleamount_pc,
                sq_cc_claim.deductibleindicatorws_pc   AS deductibleindicatorws_pc,
                sq_cc_claim.deductibleamountws_pc      AS deductibleamountws_pc,
                sq_cc_claim.policynumber_pc            AS policynumber_pc,
                sq_cc_claim.policyidentifier_pc        AS policyidentifier_pc,
                sq_cc_claim.territorycode_lkppc        AS territorycode_lkppc,
                sq_cc_claim.zipcode_lkppc              AS zipcode_lkppc,
                sq_cc_claim.itemcode_lkppc             AS itemcode_lkppc,
                sq_cc_claim.sublinecode_lkppc          AS sublinecode_lkppc,
                sq_cc_claim.occupancycode_lkppc        AS occupancycode_lkppc,
                sq_cc_claim.buildingcontents_lkppc     AS buildingcontents_lkppc,
                sq_cc_claim.construction_lkppc         AS construction_lkppc,
                sq_cc_claim.protectionclass_lkppc      AS protectionclass_lkppc,
                sq_cc_claim.typeofdeductible_lkppc     AS typeofdeductible_lkppc,
                sq_cc_claim.amountofinsurance_lkppc    AS amountofinsurance_lkppc,
                sq_cc_claim.yearofmanufacutre_lkppc    AS yearofmanufacutre_lkppc,
                sq_cc_claim.ded_ind_lkppc              AS ded_ind_lkppc,
                sq_cc_claim.ded_amt_lkppc              AS ded_amt_lkppc,
                sq_cc_claim.ded_wind_ind_lkppc         AS ded_wind_ind_lkppc,
                sq_cc_claim.ded_wind_amt_lkppc         AS ded_wind_amt_lkppc,
                sq_cc_claim.policyperiodid_lkppc       AS policyperiodid_lkppc,
                sq_cc_claim.policynumber_lkppc         AS policynumber_lkppc,
                sq_cc_claim.source_record_id
         FROM   sq_cc_claim );
  -- Component expr_logic_formatting, Type EXPRESSION
  CREATE
  OR
  replace TEMPORARY TABLE expr_logic_formatting AS
  (
         SELECT exp_claims_pass_through.companynumber       AS companynumber,
                exp_claims_pass_through.lineofbusinesscode  AS lineofbusinesscode,
                exp_claims_pass_through.statecode           AS statecode,
                exp_claims_pass_through.callyear            AS callyear,
                exp_claims_pass_through.accountingyear      AS accountingyear,
                exp_claims_pass_through.expperiodyear       AS expperiodyear,
                exp_claims_pass_through.expperiodmonth      AS expperiodmonth,
                exp_claims_pass_through.expeperiodday       AS expeperiodday,
                exp_claims_pass_through.stateexceptionind   AS stateexceptionind,
                exp_claims_pass_through.policyeffectiveyear AS policyeffectiveyear,
                exp_claims_pass_through.newrecordformat     AS newrecordformat,
                exp_claims_pass_through.aslob               AS aslob,
                exp_claims_pass_through.policyformcode      AS policyformcode,
                exp_claims_pass_through.exceptioncode       AS exceptioncode,
                exp_claims_pass_through.policytermcode      AS policytermcode,
                exp_claims_pass_through.typeoflosscode      AS typeoflosscode,
                exp_claims_pass_through.stateexceptionb     AS stateexceptionb,
                exp_claims_pass_through.coveragecodeb       AS coveragecodeb,
                exp_claims_pass_through.claimantidentifier  AS claimantidentifier,
                exp_claims_pass_through.writtenexposure     AS writtenexposure,
                exp_claims_pass_through.writtenpremium      AS writtenpremium,
                CASE
                       WHEN ltrim ( rtrim ( exp_claims_pass_through.paidlosses ) ) = ''.00'' THEN ''0.00''
                       ELSE exp_claims_pass_through.paidlosses
                END                                        AS o_paidlosses,
                exp_claims_pass_through.paidnumberofclaims AS paidnumberofclaims,
                CASE
                       WHEN ltrim ( rtrim ( exp_claims_pass_through.outstandinglosses ) ) = ''.00'' THEN ''0.00''
                       ELSE exp_claims_pass_through.outstandinglosses
                END                                           AS o_outstandinglosses,
                exp_claims_pass_through.outstandingnoofclaims AS outstandingnoofclaims,
                exp_claims_pass_through.policynumber          AS policynumber,
                exp_claims_pass_through.policyidentifier_pc   AS policyidentifier_pc,
                substr ( ''000000000000000'' , 1 , 15 - length ( exp_claims_pass_through.claimidentifier ) )
                       || exp_claims_pass_through.claimidentifier AS claimidentifier1,
                substr ( ''00'' , 1 , 2 - length (
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.territorycode_pc IS NULL THEN exp_claims_pass_through.territorycode_lkppc
                                     ELSE exp_claims_pass_through.territorycode_pc
                              END IS NULL THEN ''00''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.territorycode_pc IS NULL THEN exp_claims_pass_through.territorycode_lkppc
                                     ELSE exp_claims_pass_through.territorycode_pc
                              END
                END ) )
                       ||
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.territorycode_pc IS NULL THEN exp_claims_pass_through.territorycode_lkppc
                                     ELSE exp_claims_pass_through.territorycode_pc
                              END IS NULL THEN ''00''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.territorycode_pc IS NULL THEN exp_claims_pass_through.territorycode_lkppc
                                     ELSE exp_claims_pass_through.territorycode_pc
                              END
                END AS out_territorycode,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.zipcode_pc IS NULL THEN exp_claims_pass_through.zipcode_lkppc
                                     ELSE exp_claims_pass_through.zipcode_pc
                              END IS NULL THEN ''00000''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.zipcode_pc IS NULL THEN exp_claims_pass_through.zipcode_lkppc
                                     ELSE exp_claims_pass_through.zipcode_pc
                              END
                END AS out_zipcode,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.itemcode_pc IS NULL THEN exp_claims_pass_through.itemcode_lkppc
                                     ELSE exp_claims_pass_through.itemcode_pc
                              END IS NULL THEN ''00''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.itemcode_pc IS NULL THEN exp_claims_pass_through.itemcode_lkppc
                                     ELSE exp_claims_pass_through.itemcode_pc
                              END
                END AS out_itemcode,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.sublinecode_pc IS NULL THEN exp_claims_pass_through.sublinecode_lkppc
                                     ELSE exp_claims_pass_through.sublinecode_pc
                              END IS NULL THEN ''00''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.sublinecode_pc IS NULL THEN exp_claims_pass_through.sublinecode_lkppc
                                     ELSE exp_claims_pass_through.sublinecode_pc
                              END
                END AS out_sublinecode,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.occupancy_code_pc IS NULL THEN exp_claims_pass_through.occupancycode_lkppc
                                     ELSE exp_claims_pass_through.occupancycode
                              END IS NULL THEN ''0''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.occupancy_code_pc IS NULL THEN exp_claims_pass_through.occupancycode_lkppc
                                     ELSE exp_claims_pass_through.occupancy_code_pc
                              END
                END AS out_occupencycode,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.buildingcontents_pc IS NULL THEN exp_claims_pass_through.buildingcontents_lkppc
                                     ELSE exp_claims_pass_through.buildingcontents_pc
                              END IS NULL THEN ''0''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.buildingcontents_pc IS NULL THEN exp_claims_pass_through.buildingcontents_lkppc
                                     ELSE exp_claims_pass_through.buildingcontents_pc
                              END
                END AS out_buildingcontents,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.constructioncode_pc IS NULL THEN exp_claims_pass_through.construction_lkppc
                                     ELSE exp_claims_pass_through.constructioncode_pc
                              END IS NULL THEN ''0''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.constructioncode_pc IS NULL THEN exp_claims_pass_through.construction_lkppc
                                     ELSE exp_claims_pass_through.constructioncode_pc
                              END
                END AS out_constructioncode,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.protectionclasscode_pc IS NULL THEN exp_claims_pass_through.protectionclass_lkppc
                                     ELSE exp_claims_pass_through.protectionclasscode_pc
                              END IS NULL THEN ''00''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.protectionclasscode_pc IS NULL THEN exp_claims_pass_through.protectionclass_lkppc
                                     ELSE exp_claims_pass_through.protectionclasscode_pc
                              END
                END AS out_protectioncasscode,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.typeofdeductiblecode_pc IS NULL THEN exp_claims_pass_through.typeofdeductible_lkppc
                                     ELSE exp_claims_pass_through.typeofdeductiblecode_pc
                              END IS NULL THEN ''00''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.typeofdeductiblecode_pc IS NULL THEN exp_claims_pass_through.typeofdeductible_lkppc
                                     ELSE exp_claims_pass_through.typeofdeductiblecode_pc
                              END
                END AS out_typeofdeductiblecode,
                substr ( ''00000'' , 1 , 5 - length (
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.amountofinsurance_pc IS NULL THEN exp_claims_pass_through.amountofinsurance_lkppc
                                     ELSE exp_claims_pass_through.amountofinsurance_pc
                              END IS NULL THEN ''00000''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.amountofinsurance_pc IS NULL THEN exp_claims_pass_through.amountofinsurance_lkppc
                                     ELSE exp_claims_pass_through.amountofinsurance_pc
                              END
                END ) )
                       ||
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.amountofinsurance_pc IS NULL THEN exp_claims_pass_through.amountofinsurance_lkppc
                                     ELSE exp_claims_pass_through.amountofinsurance_pc
                              END IS NULL THEN ''00000''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.amountofinsurance_pc IS NULL THEN exp_claims_pass_through.amountofinsurance_lkppc
                                     ELSE exp_claims_pass_through.amountofinsurance_pc
                              END
                END AS out_amountofinsurance,
                substr ( ''0000'' , 1 , 4 - length (
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.yeaofconstructionliablt_pc IS NULL THEN exp_claims_pass_through.yearofmanufacutre_lkppc
                                     ELSE exp_claims_pass_through.yeaofconstructionliablt_pc
                              END IS NULL THEN ''0000''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.yeaofconstructionliablt_pc IS NULL THEN exp_claims_pass_through.yearofmanufacutre_lkppc
                                     ELSE exp_claims_pass_through.yeaofconstructionliablt_pc
                              END
                END ) )
                       ||
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.yeaofconstructionliablt_pc IS NULL THEN exp_claims_pass_through.yearofmanufacutre_lkppc
                                     ELSE exp_claims_pass_through.yeaofconstructionliablt_pc
                              END IS NULL THEN ''0000''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.yeaofconstructionliablt_pc IS NULL THEN exp_claims_pass_through.yearofmanufacutre_lkppc
                                     ELSE exp_claims_pass_through.yeaofconstructionliablt_pc
                              END
                END AS out_yeaofconstructionliablt,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.deductibleindicator_pc IS NULL THEN exp_claims_pass_through.ded_ind_lkppc
                                     ELSE exp_claims_pass_through.deductibleindicator_pc
                              END IS NULL THEN ''0''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.deductibleindicator_pc IS NULL THEN exp_claims_pass_through.ded_ind_lkppc
                                     ELSE exp_claims_pass_through.deductibleindicator_pc
                              END
                END AS out_deductibleindicator,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.deductibleamount_pc IS NULL THEN exp_claims_pass_through.ded_amt_lkppc
                                     ELSE exp_claims_pass_through.deductibleamount_pc
                              END IS NULL THEN ''0000000''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.deductibleamount_pc IS NULL THEN exp_claims_pass_through.ded_amt_lkppc
                                     ELSE exp_claims_pass_through.deductibleamount_pc
                              END
                END AS out_deductibleamount,
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.deductibleindicatorws_pc IS NULL THEN exp_claims_pass_through.ded_wind_ind_lkppc
                                     ELSE exp_claims_pass_through.deductibleindicatorws_pc
                              END IS NULL THEN ''0''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.deductibleindicatorws_pc IS NULL THEN exp_claims_pass_through.ded_wind_ind_lkppc
                                     ELSE exp_claims_pass_through.deductibleindicatorws_pc
                              END
                END AS out_deductibleindicatorws,
                substr ( ''0000000'' , 1 , 7 - length (
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.deductibleamountws_pc IS NULL THEN exp_claims_pass_through.ded_wind_amt_lkppc
                                     ELSE exp_claims_pass_through.deductibleamountws_pc
                              END IS NULL THEN ''0000000''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.deductibleamountws_pc IS NULL THEN exp_claims_pass_through.ded_wind_amt_lkppc
                                     ELSE exp_claims_pass_through.deductibleamountws_pc
                              END
                END ) )
                       ||
                CASE
                       WHEN
                              CASE
                                     WHEN exp_claims_pass_through.deductibleamountws_pc IS NULL THEN exp_claims_pass_through.ded_wind_amt_lkppc
                                     ELSE exp_claims_pass_through.deductibleamountws_pc
                              END IS NULL THEN ''0000000''
                       ELSE
                              CASE
                                     WHEN exp_claims_pass_through.deductibleamountws_pc IS NULL THEN exp_claims_pass_through.ded_wind_amt_lkppc
                                     ELSE exp_claims_pass_through.deductibleamountws_pc
                              END
                END               AS out_deductibleamountws,
                current_timestamp AS creationts,
                ''0''               AS createdby,
                exp_claims_pass_through.source_record_id
         FROM   exp_claims_pass_through );
  -- Component OUT_NAIIPCI_SF, Type TARGET
  INSERT INTO db_t_prod_comn.out_naiipci_sf
              (
                          companynumber,
                          lineofbusinesscode,
                          statecode,
                          callyear,
                          accountingyear,
                          expperiodyear,
                          expperiodmonth,
                          expperiodday,
                          occupancycode,
                          territorycode,
                          stateexceptionindicator,
                          zipcode,
                          policyeffectiveyear,
                          newrecordformat,
                          aslob,
                          itemcode,
                          sublinecode,
                          policyformcode,
                          buildingcontentscode,
                          constructioncode,
                          protectionclasscode,
                          exceptioncode,
                          typeofdeductiblecode,
                          policytermcode,
                          typeoflosscode,
                          stateexceptionb,
                          amountofinsurance,
                          yearofconstruction,
                          coveragecodeordlaw,
                          deductibleindicator,
                          deductibleamount,
                          deductibleindicatorws,
                          deductibleamountws,
                          claimidentifier,
                          claimantidentifier,
                          writtenexposure,
                          writtenpremium,
                          paidlosses,
                          paidnumberofclaims,
                          outstandinglosses,
                          outstandingnoofclaims,
                          policynumber,
                          policyperiodid,
                          creationts,
                          creationuid,
                          updatets,
                          updateuid,
                          policyidentifier
              )
  SELECT expr_logic_formatting.companynumber               AS companynumber,
         expr_logic_formatting.lineofbusinesscode          AS lineofbusinesscode,
         expr_logic_formatting.statecode                   AS statecode,
         expr_logic_formatting.callyear                    AS callyear,
         expr_logic_formatting.accountingyear              AS accountingyear,
         expr_logic_formatting.expperiodyear               AS expperiodyear,
         expr_logic_formatting.expperiodmonth              AS expperiodmonth,
         expr_logic_formatting.expeperiodday               AS expperiodday,
         expr_logic_formatting.out_occupencycode           AS occupancycode,
         expr_logic_formatting.out_territorycode           AS territorycode,
         expr_logic_formatting.stateexceptionind           AS stateexceptionindicator,
         expr_logic_formatting.out_zipcode                 AS zipcode,
         expr_logic_formatting.policyeffectiveyear         AS policyeffectiveyear,
         expr_logic_formatting.newrecordformat             AS newrecordformat,
         expr_logic_formatting.aslob                       AS aslob,
         expr_logic_formatting.out_itemcode                AS itemcode,
         expr_logic_formatting.out_sublinecode             AS sublinecode,
         expr_logic_formatting.policyformcode              AS policyformcode,
         expr_logic_formatting.out_buildingcontents        AS buildingcontentscode,
         expr_logic_formatting.out_constructioncode        AS constructioncode,
         expr_logic_formatting.out_protectioncasscode      AS protectionclasscode,
         expr_logic_formatting.exceptioncode               AS exceptioncode,
         expr_logic_formatting.out_typeofdeductiblecode    AS typeofdeductiblecode,
         expr_logic_formatting.policytermcode              AS policytermcode,
         expr_logic_formatting.typeoflosscode              AS typeoflosscode,
         expr_logic_formatting.stateexceptionb             AS stateexceptionb,
         expr_logic_formatting.out_amountofinsurance       AS amountofinsurance,
         expr_logic_formatting.out_yeaofconstructionliablt AS yearofconstruction,
         expr_logic_formatting.coveragecodeb               AS coveragecodeordlaw,
         expr_logic_formatting.out_deductibleindicator     AS deductibleindicator,
         expr_logic_formatting.out_deductibleamount        AS deductibleamount,
         expr_logic_formatting.out_deductibleindicatorws   AS deductibleindicatorws,
         expr_logic_formatting.out_deductibleamountws      AS deductibleamountws,
         expr_logic_formatting.claimidentifier1            AS claimidentifier,
         expr_logic_formatting.claimantidentifier          AS claimantidentifier,
         expr_logic_formatting.writtenexposure             AS writtenexposure,
         expr_logic_formatting.writtenpremium              AS writtenpremium,
         expr_logic_formatting.o_paidlosses                AS paidlosses,
         expr_logic_formatting.paidnumberofclaims          AS paidnumberofclaims,
         expr_logic_formatting.o_outstandinglosses         AS outstandinglosses,
         expr_logic_formatting.outstandingnoofclaims       AS outstandingnoofclaims,
         expr_logic_formatting.policynumber                AS policynumber,
         expr_logic_formatting.policyidentifier_pc         AS policyperiodid,
         expr_logic_formatting.creationts                  AS creationts,
         expr_logic_formatting.createdby                   AS creationuid,
         expr_logic_formatting.creationts                  AS updatets,
         expr_logic_formatting.createdby                   AS updateuid,
         expr_logic_formatting.policyidentifier_pc         AS policyidentifier
  FROM   expr_logic_formatting;
  
  -- PIPELINE END FOR 1
  -- PIPELINE START FOR 2
  -- Component SQ_pc_policyperiod, Type SOURCE
  CREATE
  OR
  replace TEMPORARY TABLE sq_pc_policyperiod AS
  (
         SELECT
                /* adding column aliases to ensure proper downstream column references */
                $1  AS companynumber,
                $2  AS lineofbusinesscode,
                $3  AS statecode,
                $4  AS callyear,
                $5  AS accountingyear,
                $6  AS expperiodyear,
                $7  AS expperiodmonth,
                $8  AS expeperiodday,
                $9  AS occupanycode,
                $10 AS buildingcontents,
                $11 AS territorycode,
                $12 AS stateexceptionind,
                $13 AS zipcode,
                $14 AS policyeffectiveyear,
                $15 AS newrecordformat,
                $16 AS aslob,
                $17 AS itemcode,
                $18 AS sublinecode,
                $19 AS policyprogramcode,
                $20 AS policyformcode,
                $21 AS numberoffamilycodes,
                $22 AS constructioncode,
                $23 AS protectionclasscode,
                $24 AS exceptioncode,
                $25 AS typeofdeductiblecode,
                $26 AS policytermcode,
                $27 AS typeoflosscode,
                $28 AS stateofexceptionb,
                $29 AS amountofinsurance,
                $30 AS yeaofconstructionliablt,
                $31 AS coveragecodeordlaw,
                $32 AS exposurecode,
                $33 AS leadpoisoningliability,
                $34 AS deductibleindicator,
                $35 AS deductibleamount,
                $36 AS deductibleindicatorws,
                $37 AS deductibleamountws,
                $38 AS claimidentifier,
                $39 AS claimantidentifier,
                $40 AS writtenexposure,
                $41 AS writtenpremium,
                $42 AS paidlosses,
                $43 AS paidnumberofclaims,
                $44 AS outstandinglosses,
                $45 AS outstandingnoofclaims,
                $46 AS policynumber,
                $47 AS policyperiodid,
                $48 AS policyidentifier,
                $49 AS source_record_id
         FROM   (
                         SELECT   src.*,
                                  row_number() over (ORDER BY 1) AS source_record_id
                         FROM     (
                                           SELECT   companynumber,
                                                    lob AS lineofbusinesscode,
                                                    statecode,
                                                    callyear,
                                                    accountingyear,
                                                    expperiodyear,
                                                    expperiodmonth,
                                                    expperiodday,
                                                    occupancy_code,
                                                    buildingcontents,
                                                    territorycode,
                                                    ''0''stateexceptionind,
                                                    zipcode,
                                                    policy_eff_yr AS policyeffectiveyear,
                                                    newrecordformat,
                                                    aslob,
                                                    itemcode,
                                                    sublinecode,
                                                    ''0''                 policyprogramcode,
                                                    policy_form_code AS policyformcode,
                                                    0                   numberoffamilycodes,
                                                    construction     AS constructioncode,
                                                    protectionclasscode,
                                                    ''00''exceptioncode,
                                                    typeofdeductiblecode,
                                                    abs(writtenexposure) policytermcode,
                                                    ''0''                  typeoflosscode,
                                                    ''00''                 stateexceptionb,
                                                    amountofinsurance,
                                                    yearofmanufacture AS yeaofconstructionliablt,
                                                    ''0''                  coveragecodeordlaw,
                                                    ''0''                  exposurecodes,
                                                    ''0''                  leadpoisoningliability,
                                                    ded_ind           AS deductibleindicator,
                                                    ded_amount        AS deductibleamount,
                                                    deductibleindicatorws,
                                                    deductibleamountws,
                                                    claimidentifier,
                                                    claimantidentifier,
                                                    writtenexposure,
                                                    cast( SUM(cast(writtenpremium AS DECIMAL(18,7))) AS VARCHAR(40))writtenpremium,
                                                    paidlosses,
                                                    paidnumberofclaims,
                                                    outstandinglosses,
                                                    outstandingnumberofclaims,
                                                    policynumber_stg   AS policynumber,
                                                    policyperiodid_stg AS policyperiodid,
                                                    policyidentifier
                                           FROM    (
                                                                    SELECT DISTINCT
                                                                                    CASE
                                                                                                    WHEN uwc.publicid_stg=''AMI'' THEN ''0005''
                                                                                                    WHEN uwc.publicid_stg=''AMG'' THEN ''0196''
                                                                                                    WHEN uwc.publicid_stg=''AMF'' THEN ''0006''
                                                                                                    WHEN uwc.publicid_stg=''AIC'' THEN ''0050''
                                                                                                    WHEN uwc.publicid_stg=''AGI'' THEN ''0318''
                                                                                                    ELSE ''''
                                                                                    END  AS companynumber,
                                                                                    ''18'' AS lob,
                                                                                    CASE
                                                                                                    WHEN jd.typecode_stg=''AL'' THEN ''01''
                                                                                                    WHEN jd.typecode_stg=''GA'' THEN ''10''
                                                                                                    WHEN jd.typecode_stg=''MS'' THEN ''23''
                                                                                    END                                                                  statecode,
                                                                                    extract(year FROM cast(:pc_eoy AS timestamp(6)) + interval ''1 year'') callyear,
                                                                                    extract(year FROM cast(:pc_eoy AS timestamp(6)))                     accountingyear,
                                                                                    ''0000''                                                               expperiodyear,
                                                                                    ''00''                                                                 expperiodmonth,
                                                                                    ''00''                                                                 expperiodday,
                                                                                    CASE
                                                                                                    WHEN occ_type.typecode_stg =''tenant'' THEN ''06''
                                                                                                    ELSE ''01''
                                                                                    END                                                           occupancy_code,
                                                                                    terr.code                                                     AS territorycode,
                                                                                    coalesce(substring(terr.postalcodeinternal_stg,1,5) , ''00000'')AS zipcode,
                                                                                    CASE
                                                                                                    WHEN pcj.typecode_stg=''Cancellation'' THEN year(pp.cancellationdate_stg)
                                                                                                    ELSE year(pp.periodstart_stg)
                                                                                    END AS policy_eff_yr,
                                                                                    ''D'' AS newrecordformat,
                                                                                    CASE
                                                                                                    WHEN peril.name_stg =''Fire'' THEN ''010''
                                                                                                    ELSE ''021''
                                                                                    END  aslob,
                                                                                    ''03'' itemcode,
                                                                                    CASE
                                                                                                    WHEN ph.typecode_stg IN (''SF1'') THEN ''10''
                                                                                                    ELSE ''28''
                                                                                    END AS sublinecode,
                                                                                    CASE
                                                                                                    WHEN ph.typecode_stg=''SF2'' THEN ''02''
                                                                                                    WHEN ph.typecode_stg =''SF3'' THEN ''03''
                                                                                                    ELSE ''01''
                                                                                    END policy_form_code,
                                                                                    CASE
                                                                                                    WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireDwellingPolicySubtype_alfa''
                                                                                                    AND             pr.typecode_stg=''Fam1'' THEN ''1''
                                                                                                    WHEN pcdh.typecode_stg=''seas'' THEN ''1''
                                                                                                    WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireContentsPolicySubtype_alfa''
                                                                                                    AND             pr.typecode_stg=''Fam1'' THEN ''2''
                                                                                                    WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireDwellingPolicySubtype_alfa''
                                                                                                    AND             pr.typecode_stg=''Fam2'' THEN ''3''
                                                                                                    WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireContentsPolicySubtype_alfa''
                                                                                                    AND             pr.typecode_stg=''Fam2'' THEN ''4''
                                                                                                    WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireDwellingPolicySubtype_alfa''
                                                                                                    AND             pr.typecode_stg=''Fam3To4_alfa'' THEN ''7''
                                                                                                    WHEN choiceanswerchoicecode_alfa_stg = ''HOStandardFireContentsPolicySubtype_alfa''
                                                                                                    AND             pr.typecode_stg=''Fam3To4_alfa'' THEN ''8''
                                                                                                    WHEN choiceanswerchoicecode_alfa_stg =''HOStandardFireOtherStructurePolicySubtype_alfa'' THEN ''1''
                                                                                                    ELSE ''1''
                                                                                    END buildingcontents,
                                                                                    CASE
                                                                                                    WHEN pct.typecode_stg IN (''ADB'',
                                                                                                                              ''AOD'',
                                                                                                                              ''CLP'',
                                                                                                                              ''COM'',
                                                                                                                              ''CUS'',
                                                                                                                              ''DOM'',
                                                                                                                              ''F'',
                                                                                                                              ''FRM'',
                                                                                                                              ''FST'',
                                                                                                                              ''GLA'',
                                                                                                                              ''HEA'',
                                                                                                                              ''L'',
                                                                                                                              ''LOG'',
                                                                                                                              ''LIG'',
                                                                                                                              ''NON'',
                                                                                                                              ''OTH'',
                                                                                                                              ''OTHER'',
                                                                                                                              ''PFR'',
                                                                                                                              ''STU'',
                                                                                                                              ''STW'',
                                                                                                                              ''TLU'',
                                                                                                                              ''UNK'',
                                                                                                                              ''WOO'',
                                                                                                                              ''WSC'',
                                                                                                                              ''CLOTH'') THEN ''1''
                                                                                                    WHEN pct.typecode_stg IN (''BCB'',
                                                                                                                              ''BLB'',
                                                                                                                              ''BRC'',
                                                                                                                              ''BRF'',
                                                                                                                              ''BRS'',
                                                                                                                              ''BST'',
                                                                                                                              ''FRY'',
                                                                                                                              ''SRO'',
                                                                                                                              ''STV'',
                                                                                                                              ''TBM'',
                                                                                                                              ''WBR'',
                                                                                                                              ''WCB'',
                                                                                                                              ''WSN'') THEN ''2''
                                                                                                    WHEN pct.typecode_stg IN (''BRK'',
                                                                                                                              ''CCM'',
                                                                                                                              ''CNB'',
                                                                                                                              ''CND'',
                                                                                                                              ''CRE'',
                                                                                                                              ''FLX'',
                                                                                                                              ''M'',
                                                                                                                              ''MAS'',
                                                                                                                              ''MTU'',
                                                                                                                              ''TUC'',
                                                                                                                              ''SFM'',
                                                                                                                              ''IRON'') THEN ''3''
                                                                                                    WHEN pct.typecode_stg IN (''BLM'',
                                                                                                                              ''BLS'',
                                                                                                                              ''BRL'',
                                                                                                                              ''BRM'',
                                                                                                                              ''CCS'',
                                                                                                                              ''MET'',
                                                                                                                              ''PRM'',
                                                                                                                              ''S'',
                                                                                                                              ''STE'',
                                                                                                                              ''STS'') THEN ''4''
                                                                                                    WHEN pct.typecode_stg IN (''ALF'',
                                                                                                                              ''ALS'',
                                                                                                                              ''ALV'',
                                                                                                                              ''FRS'',
                                                                                                                              ''WMT'',
                                                                                                                              ''WSL'') THEN ''5''
                                                                                                    WHEN pct.typecode_stg IN (''MAN'') THEN ''6''
                                                                                                    ELSE ''1''
                                                                                    END construction,
                                                                                    CASE
                                                                                                    WHEN dwellingprotectionclasscode_stg IS NULL
                                                                                                    AND             jd.typecode_stg =''AL'' THEN ''05''
                                                                                                    WHEN dwellingprotectionclasscode_stg IS NULL
                                                                                                    AND             jd.typecode_stg =''GA'' THEN ''03''
                                                                                                    WHEN dwellingprotectionclasscode_stg IS NULL
                                                                                                    AND             jd.typecode_stg =''MS'' THEN ''10''
                                                                                                    ELSE (substring(''00'',1,2-length(phh.dwellingprotectionclasscode_stg))
                                                                                                                                    ||phh.dwellingprotectionclasscode_stg )
                                                                                    END AS protectionclasscode,
                                                                                    CASE
                                                                                                    WHEN jd.typecode_stg=''AL'' THEN (
                                                                                                                    CASE
                                                                                                                                    WHEN (
                                                                                                                                                                    windhail =''HODW_WindHail_Ded_HOE'')
                                                                                                                                    AND             deductibleamountws >0 THEN ''34''
                                                                                                                                    WHEN (
                                                                                                                                                                    hurricane =''HODW_Hurricane_Ded_HOE''
                                                                                                                                                    AND             terr.code IN (''05'',
                                                                                                                                                                                  ''06'',
                                                                                                                                                                                  ''30'',
                                                                                                                                                                                  ''31''))
                                                                                                                                    AND             deductibleamountws >0 THEN ''54''
                                                                                                                                    WHEN (
                                                                                                                                                                    hurricane =''HODW_Hurricane_Ded_HOE''
                                                                                                                                                    AND             terr.code NOT IN (''05'',
                                                                                                                                                                                      ''06'',
                                                                                                                                                                                      ''30'',
                                                                                                                                                                                      ''31''))
                                                                                                                                    AND             deductibleamountws >0 THEN ''34''
                                                                                                                                    WHEN (
                                                                                                                                                                    windstormhailexcl =''HODW_SectionI_DedWindAndHailExcl_alfa'')
                                                                                                                                    AND             windstormhailexcl_amt>0 THEN ''08''
                                                                                                                                    ELSE ''04''
                                                                                                                    END )
                                                                                                    ELSE (
                                                                                                                    CASE
                                                                                                                                    WHEN (
                                                                                                                                                                    windhail =''HODW_WindHail_Ded_HOE'')
                                                                                                                                    AND             deductibleamountws >0 THEN ''04''
                                                                                                                                    WHEN (
                                                                                                                                                                    hurricane =''HODW_Hurricane_Ded_HOE'' )
                                                                                                                                    AND             deductibleamountws >0 THEN ''04''
                                                                                                                                    WHEN (
                                                                                                                                                                    windstormhailexcl =''HODW_SectionI_DedWindAndHailExcl_alfa'')
                                                                                                                                    AND             windstormhailexcl_amt>0 THEN ''08''
                                                                                                                                    ELSE ''02''
                                                                                                                    END)
                                                                                    END AS typeofdeductiblecode,
                                                                                    /*CASE
                                                                                                    WHEN pp.cancellationdate_stg IS NOT NULL THEN cast(((cast(pp.cancellationdate_stg AS DATE)-cast(pp.periodstart_stg AS DATE)) month) AS INTEGER)
                                                                                                    WHEN pp.cancellationdate_stg IS NULL THEN cast(((cast(pp.periodend_stg AS            DATE)-cast(pp.periodstart_stg AS DATE)) month) AS INTEGER)
                                                                                    END                          AS policytermcode,
                                                                                    pdh.manhomeparkcode_alfa_stg AS locationcode,*/
                                                                                    CASE
                                                                                    WHEN pp.cancellationdate_stg IS NOT NULL THEN 
                                                                                           MONTHS_BETWEEN(CAST(pp.cancellationdate_stg AS DATE), CAST(pp.periodstart_stg AS DATE))
                                                                                    ELSE 
                                                                                           MONTHS_BETWEEN(CAST(pp.periodend_stg AS DATE), CAST(pp.periodstart_stg AS DATE))
                                                                                    END AS policytermcode,
                                                                                    coalesce(lpad(cast(cast(
                                                                                    CASE
                                                                                                    WHEN ph.typecode_stg IN (''SF1'' ,
                                                                                                                             ''SF2'',
                                                                                                                             ''SF3'')
                                                                                                    AND             dw_limit>0 THEN dw_limit
                                                                                                    WHEN ph.typecode_stg IN (''SF1'' ,
                                                                                                                             ''SF2'',
                                                                                                                             ''SF3'')
                                                                                                    AND             pp_limit>0 THEN pp_limit
                                                                                                    ELSE st_limit
                                                                                    END AS NUMBER)AS VARCHAR(255)),5,''00000''),''00000'') AS amountofinsurance,
                                                                                    coalesce(ltrim(rtrim(cast(
                                                                                    CASE
                                                                                                    WHEN (
                                                                                                                                    pdh.yearbuilt_stg<=1959) THEN ''1959''
                                                                                                    ELSE pdh.yearbuilt_stg
                                                                                    END AS INTEGER))) ,''1959'')                                                            AS yearofmanufacture,
                                                                                    coalesce(perils_limit_ind , ''0'')                                                         ded_ind,
                                                                                    coalesce(lpad(cast(cast(perils_limit AS INTEGER) AS VARCHAR(255)),7, ''0''), ''0000000'')    ded_amount,
                                                                                    ''3''                                                                                   AS tiedowncode,
                                                                                    coalesce(
                                                                                    CASE
                                                                                                    WHEN jd.typecode_stg=''AL'' THEN deductiblews
                                                                                                    ELSE ''0''
                                                                                    END,''0'') AS deductibleindicatorws,
                                                                                    coalesce(cast(cast(
                                                                                    CASE
                                                                                                    WHEN jd.typecode_stg=''AL'' THEN deductibleamountws
                                                                                                    ELSE ''0''
                                                                                    END AS NUMBER) AS VARCHAR(255)),''0000000'')AS deductibleamountws,
                                                                                    ''0''                                       AS claimidentifier,
                                                                                    ''0''                                       AS claimantidentifier, 
                                                                                    /*(
                                                                                    CASE
                                                                                                    WHEN phth.amount_stg <=0 THEN
                                                                                                                    CASE
                                                                                                                                    WHEN (
                                                                                                                                                                    month(editeffectivedate_stg) IN (1,2,3)
                                                                                                                                                    AND             month(periodend_stg)         IN (1,2,3)
                                                                                                                                                    AND             abs(cast(pp.editeffectivedate_stg AS DATE) - cast(pp.periodend_stg AS DATE)) BETWEEN 0 AND             29) THEN -1
                                                                                                                                    WHEN (
                                                                                                                                                                    month(editeffectivedate_stg) NOT IN (1,2,3)
                                                                                                                                                    AND             month(periodend_stg) NOT         IN (1,2,3)
                                                                                                                                                    AND             abs(cast(pp.editeffectivedate_stg AS DATE) - cast(pp.periodend_stg AS DATE)) BETWEEN 0 AND             30) THEN -1
                                                                                                                                    ELSE abs(cast((cast(pp.editeffectivedate_stg AS DATE)-cast(pp.periodend_stg AS DATE) month(4)) AS INTEGER) )*-1
                                                                                                                    END
                                                                                                    WHEN phth.amount_stg > 0 THEN
                                                                                                                    CASE
                                                                                                                                    WHEN (
                                                                                                                                                                    month(editeffectivedate_stg) IN (1,2,3)
                                                                                                                                                    AND             month(periodend_stg)         IN (1,2,3)
                                                                                                                                                    AND             abs(cast(pp.editeffectivedate_stg AS DATE) - cast(pp.periodend_stg AS DATE)) BETWEEN 0 AND             29) THEN 1
                                                                                                                                    WHEN (
                                                                                                                                                                    month(editeffectivedate_stg) NOT IN (1,2,3)
                                                                                                                                                    AND             month(periodend_stg) NOT         IN (1,2,3)
                                                                                                                                                    AND             abs(cast(pp.editeffectivedate_stg AS DATE) - cast(pp.periodend_stg AS DATE)) BETWEEN 0 AND             30) THEN 1
                                                                                                                                    ELSE abs(cast((cast(pp.editeffectivedate_stg AS DATE)-cast(pp.periodend_stg AS DATE) month(4)) AS INTEGER) )
                                                                                                                    END
                                                                                                    ELSE 0
                                                                                    END ) AS writtenexposure, */
                                                                                    (
                                                                                    CASE
                                                                                           WHEN phth.amount_stg <= 0 THEN
                                                                                                  CASE
                                                                                                         WHEN MONTH(editeffectivedate_stg) IN (1, 2, 3)
                                                                                                         AND MONTH(periodend_stg) IN (1, 2, 3)
                                                                                                         AND ABS(DATEDIFF(DAY, CAST(pp.editeffectivedate_stg AS DATE), CAST(pp.periodend_stg AS DATE))) BETWEEN 0 AND 29
                                                                                                         THEN -1
                                                                                                         WHEN MONTH(editeffectivedate_stg) NOT IN (1, 2, 3)
                                                                                                         AND MONTH(periodend_stg) NOT IN (1, 2, 3)
                                                                                                         AND ABS(DATEDIFF(DAY, CAST(pp.editeffectivedate_stg AS DATE), CAST(pp.periodend_stg AS DATE))) BETWEEN 0 AND 30
                                                                                                         THEN -1
                                                                                                         ELSE -1 * FLOOR(MONTHS_BETWEEN(CAST(pp.periodend_stg AS DATE), CAST(pp.editeffectivedate_stg AS DATE)))
                                                                                                  END

                                                                                           WHEN phth.amount_stg > 0 THEN
                                                                                                  CASE
                                                                                                         WHEN MONTH(editeffectivedate_stg) IN (1, 2, 3)
                                                                                                         AND MONTH(periodend_stg) IN (1, 2, 3)
                                                                                                         AND ABS(DATEDIFF(DAY, CAST(pp.editeffectivedate_stg AS DATE), CAST(pp.periodend_stg AS DATE))) BETWEEN 0 AND 29
                                                                                                         THEN 1
                                                                                                         WHEN MONTH(editeffectivedate_stg) NOT IN (1, 2, 3)
                                                                                                         AND MONTH(periodend_stg) NOT IN (1, 2, 3)
                                                                                                         AND ABS(DATEDIFF(DAY, CAST(pp.editeffectivedate_stg AS DATE), CAST(pp.periodend_stg AS DATE))) BETWEEN 0 AND 30
                                                                                                         THEN 1
                                                                                                         ELSE FLOOR(MONTHS_BETWEEN(CAST(pp.periodend_stg AS DATE), CAST(pp.editeffectivedate_stg AS DATE)))
                                                                                                  END

                                                                                    ELSE 0
                                                                                    END
                                                                                    ) AS writtenexposure,

                                                                                    (
                                                                                    CASE
                                                                                                    WHEN 1 =
                                                                                                                    (
                                                                                                                           SELECT 1
                                                                                                                           WHERE  EXISTS
                                                                                                                                  (
                                                                                                                                         SELECT pc_policyperiod2.policynumber_stg
                                                                                                                                         FROM   db_t_prod_stag.pc_policyperiod pc_policyperiod2
                                                                                                                                         join   db_t_prod_stag.pc_policyterm pt2
                                                                                                                                         ON     pt2.id_stg = pc_policyperiod2.policytermid_stg
                                                                                                                                         join   db_t_prod_stag.pc_policyline
                                                                                                                                         ON     pc_policyperiod2.id_stg = pc_policyline.branchid_stg
                                                                                                                                         join   db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                                         ON     pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                                         AND    pctl_hopolicytype_hoe.typecode_stg IN (''SF1'',
                                                                                                                                                                                       ''SF2'',
                                                                                                                                                                                       ''SF3'')
                                                                                                                                         join   db_t_prod_stag.pc_job job2
                                                                                                                                         ON     job2.id_stg = pc_policyperiod2.jobid_stg
                                                                                                                                         join   db_t_prod_stag.pctl_job pctl_job2
                                                                                                                                         ON     pctl_job2.id_stg = job2.subtype_stg
                                                                                                                                         WHERE  pctl_job2.name_stg = ''Renewal''
                                                                                                                                         AND    (
                                                                                                                                                       pt.confirmationdate_alfa_stg > :pc_eoy
                                                                                                                                                OR     pt.confirmationdate_alfa_stg IS NULL)
                                                                                                                                         AND    pc_policyperiod2.policynumber_stg = pp.policynumber_stg
                                                                                                                                         AND    pc_policyperiod2.termnumber_stg = pp.termnumber_stg )) THEN 0
                                                                                                    ELSE phth.amount_stg
                                                                                    END) AS writtenpremium,
                                                                                    ''0''  AS paidlosses,
                                                                                    ''0''  AS paidnumberofclaims,
                                                                                    ''0''  AS outstandinglosses,
                                                                                    ''0''  AS outstandingnumberofclaims,
                                                                                    pp.policynumber_stg,
                                                                                    pp.id_stg        policyperiodid_stg,
                                                                                    pj.jobnumber_stg policyidentifier ,
                                                                                    phth.id_stg
                                                                    FROM            db_t_prod_stag.pcx_hotransaction_hoe phth
                                                                    join            db_t_prod_stag.pcx_homeownerscost_hoe phch
                                                                    ON              phth.homeownerscost_stg = phch.id_stg
                                                                    join            db_t_prod_stag.pc_policyperiod pp
                                                                    ON              phth.branchid_stg =pp.id_stg
                                                                    join            db_t_prod_stag.pc_uwcompany uwc
                                                                    ON              pp.uwcompany_stg=uwc.id_stg
                                                                    join            db_t_prod_stag.pctl_jurisdiction jd
                                                                    ON              pp.basestate_stg=jd.id_stg
                                                                    join            db_t_prod_stag.pcx_dwelling_hoe pdh
                                                                    ON              pdh.branchid_stg=pp.id_stg
                                                                    AND             pdh.expirationdate_stg IS NULL
                                                                    left join       db_t_prod_stag.pctl_periltype_alfa peril
                                                                    ON              periltype_alfa_stg=peril.id_stg
                                                                    left join       db_t_prod_stag.pctl_dwellingoccupancytype_hoe occ_type
                                                                    ON              pdh.occupancy_stg =occ_type.id_stg
                                                                    left join       db_t_prod_stag.pctl_dwellingusage_hoe pcdh
                                                                    ON              pcdh.id_stg =pdh.dwellingusage_stg
                                                                    left join
                                                                                    (
                                                                                              SELECT    loc.branchid_stg                                                                               id,
                                                                                                        max(cast(coalesce(old_code, pht1.naiipcicode_alfa_stg, pht2.naiipcicode_alfa_stg) AS INTEGER)) code ,
                                                                                                        max(coalesce(postalcodeinternal_stg, postalcode_stg))                                          postalcodeinternal_stg
                                                                                              FROM      (
                                                                                                                  SELECT    e.branchid_stg,
                                                                                                                            policynumber_stg,
                                                                                                                            c.code_stg,
                                                                                                                            g.typecode_stg,
                                                                                                                            c.countycode_alfa_stg,
                                                                                                                            pc_policyline.hopolicytype_stg,
                                                                                                                            coalesce(postalcodeinternal_stg, postalcode_stg)postalcodeinternal_stg,
                                                                                                                            row_number() over( PARTITION BY e.branchid_stg,policynumber_stg, c.code_stg,g.typecode_stg, c.countycode_alfa_stg, pc_policyline.hopolicytype_stg ORDER BY
                                                                                                                            CASE
                                                                                                                                      WHEN (
                                                                                                                                                          c.policylocation_stg = b.id_stg
                                                                                                                                                AND       pc_policyline.expirationdate_stg IS NULL ) THEN 1
                                                                                                                                      ELSE 2
                                                                                                                            END) rownum_stg,
                                                                                                                            cityinternal_stg,
                                                                                                                            countyinternal_stg,
                                                                                                                            county_stg,
                                                                                                                            CASE
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(cityinternal_stg)= ''BIRMINGHAM''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''JEFFERSON'' THEN ''32''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(cityinternal_stg)= ''HUNTSVILLE''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''MADISON'' THEN ''35''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(cityinternal_stg)= ''MONTGOMERY''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''MONTGOMERY'' THEN ''37''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(cityinternal_stg)= ''MOBILE''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''MOBILE'' THEN ''30''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''AUTAUGA'',
                                                                                                                                                                                ''ELMORE'',
                                                                                                                                                                                ''MONTGOMERY'') THEN ''38''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''BALDWIN''
                                                                                                                                      AND       cast(c.code_stg AS INTEGER)=26 THEN ''41''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''BALDWIN''
                                                                                                                                      AND       cast(c.code_stg AS INTEGER)=28 THEN ''31''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''BARBOUR'',
                                                                                                                                                                                ''BIBB'',
                                                                                                                                                                                ''BLOUNT'',
                                                                                                                                                                                ''BULLOCK'',
                                                                                                                                                                                ''BUTLER'',
                                                                                                                                                                                ''CHAMBERS'',
                                                                                                                                                                                ''CHEROKEE'',
                                                                                                                                                                                ''CHILTON'',
                                                                                                                                                                                ''CHOCTAW'',
                                                                                                                                                                                ''CLARKE'',
                                                                                                                                                                                ''CLAY'',
                                                                                                                                                                                ''CLEBURNE'',
                                                                                                                                                                                ''COFFEE'',
                                                                                                                                                                                ''CONECUH'',
                                                                                                                                                                                ''COOSA'',
                                                                                                                                                                                ''COVINGTON'',
                                                                                                                                                                                ''CRENSHAW'',
                                                                                                                                                                                ''CULLMAN'',
                                                                                                                                                                                ''DALE'',
                                                                                                                                                                                ''DALLAS'',
                                                                                                                                                                                ''DE KALB'',
                                                                                                                                                                                ''DEKALB'',
                                                                                                                                                                                ''ESCAMBIA'',
                                                                                                                                                                                ''FAYETTE'',
                                                                                                                                                                                ''FRANKLIN'',
                                                                                                                                                                                ''GENEVA'',
                                                                                                                                                                                ''GREENE'',
                                                                                                                                                                                ''HALE'',
                                                                                                                                                                                ''HENRY'',
                                                                                                                                                                                ''HOUSTON'',
                                                                                                                                                                                ''JACKSON'',
                                                                                                                                                                                ''LAMAR'',
                                                                                                                                                                                ''LAWRENCE'',
                                                                                                                                                                                ''LEE'',
                                                                                                                                                                                ''LOWNDES'',
                                                                                                                                                                                ''MACON'',
                                                                                                                                                                                ''MONROE'',
                                                                                                                                                                                ''MARENGO'',
                                                                                                                                                                                ''MARION'',
                                                                                                                                                                                ''MARSHALL'',
                                                                                                                                                                                ''PERRY'',
                                                                                                                                                                                ''PICKENS'',
                                                                                                                                                                                ''PIKE'',
                                                                                                                                                                                ''RANDOLPH'',
                                                                                                                                                                                ''RUSSELL'',
                                                                                                                                                                                ''SAINT CLAIR'',
                                                                                                                                                                                ''ST. CLAIR'',
                                                                                                                                                                                ''SUMTER'',
                                                                                                                                                                                ''TALLADEGA'',
                                                                                                                                                                                ''TALLAPOOSA'',
                                                                                                                                                                                ''WASHINGTON'',
                                                                                                                                                                                ''WILCOX'',
                                                                                                                                                                                ''WINSTON'') THEN ''41''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''CALHOUN'',
                                                                                                                                                                                ''ETOWAH'') THEN ''40''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''COLBERT'',
                                                                                                                                                                                ''LAUDERDALE'',
                                                                                                                                                                                ''LIMESTONE'',
                                                                                                                                                                                ''MADISON'',
                                                                                                                                                                                ''MORGAN'') THEN ''36''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''JEFFERSON'' THEN ''33''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''MOBILE''
                                                                                                                                      AND       cast(c.code_stg AS INTEGER)=28 THEN ''31''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''MOBILE''
                                                                                                                                      AND       cast(c.code_stg AS INTEGER)=11 THEN ''05''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''SHELBY'',
                                                                                                                                                                                ''WALKER'') THEN ''34''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''TUSCALOOSA'' THEN ''39''
                                                                                                                                      /*WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       (
                                                                                                                                                          substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-''))=''36511''
                                                                                                                                                OR        b.postalcodeinternal_stg=''36511'')
                                                                                                                                      AND       upper(cityinternal_stg)= ''BON SECOUR'' THEN ''06''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       (
                                                                                                                                                          substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-''))=''36528''
                                                                                                                                                OR        b.postalcodeinternal_stg=''36528'')
                                                                                                                                      AND       upper(cityinternal_stg)= ''DAUPHIN ISLAND'' THEN ''06''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       (
                                                                                                                                                          substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-'')) IN (''36542'',
                                                                                                                                                                                                        ''36547'')
                                                                                                                                                OR        b.postalcodeinternal_stg IN (''36542'',
                                                                                                                                                                                       ''36547''))
                                                                                                                                      AND       upper(cityinternal_stg)= ''GULF SHORES'' THEN ''06''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       (
                                                                                                                                                          substring (b.postalcodeinternal_stg,0,INDEX(b.postalcodeinternal_stg, ''-''))=''36561''
                                                                                                                                                OR        b.postalcodeinternal_stg=''36561'')
                                                                                                                                      AND       upper(cityinternal_stg)= ''ORANGE BEACH'' THEN ''06''*/
                                                                                                                                      WHEN g.typecode_stg = ''AL''
                                                                                                                                     AND (
                                                                                                                                     IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                            SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                            b.postalcodeinternal_stg
                                                                                                                                     ) = ''36511''
                                                                                                                                     OR b.postalcodeinternal_stg = ''36511''
                                                                                                                                     )
                                                                                                                                     AND UPPER(cityinternal_stg) = ''BON SECOUR'' THEN ''06''

                                                                                                                                     WHEN g.typecode_stg = ''AL''
                                                                                                                                     AND (
                                                                                                                                     IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                            SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                            b.postalcodeinternal_stg
                                                                                                                                     ) = ''36528''
                                                                                                                                     OR b.postalcodeinternal_stg = ''36528''
                                                                                                                                     )
                                                                                                                                     AND UPPER(cityinternal_stg) = ''DAUPHIN ISLAND'' THEN ''06''

                                                                                                                                     WHEN g.typecode_stg = ''AL''
                                                                                                                                     AND (
                                                                                                                                     IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                            SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                            b.postalcodeinternal_stg
                                                                                                                                     ) IN (''36542'', ''36547'')
                                                                                                                                     OR b.postalcodeinternal_stg IN (''36542'', ''36547'')
                                                                                                                                     )
                                                                                                                                     AND UPPER(cityinternal_stg) = ''GULF SHORES'' THEN ''06''

                                                                                                                                     WHEN g.typecode_stg = ''AL''
                                                                                                                                     AND (
                                                                                                                                     IFF(POSITION(''-'' IN b.postalcodeinternal_stg) > 0,
                                                                                                                                            SUBSTRING(b.postalcodeinternal_stg, 1, POSITION(''-'' IN b.postalcodeinternal_stg) - 1),
                                                                                                                                            b.postalcodeinternal_stg
                                                                                                                                     ) = ''36561''
                                                                                                                                     OR b.postalcodeinternal_stg = ''36561''
                                                                                                                                     )
                                                                                                                                     AND UPPER(cityinternal_stg) = ''ORANGE BEACH'' THEN ''06''

                                                                                                                                      WHEN g.typecode_stg=''MS''
                                                                                                                                      AND       upper(cityinternal_stg)= ''JACKSON''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''HINDS'',
                                                                                                                                                                                ''RANKIN'') THEN ''30''
                                                                                                                                      WHEN g.typecode_stg=''MS''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''AMITE'',
                                                                                                                                                                                ''FORREST'',
                                                                                                                                                                                ''GREENE'',
                                                                                                                                                                                ''LAMAR'',
                                                                                                                                                                                ''MARION'',
                                                                                                                                                                                ''PERRY'',
                                                                                                                                                                                ''PIKE'',
                                                                                                                                                                                ''WALTHALL'',
                                                                                                                                                                                ''WILKINSON'') THEN ''03''
                                                                                                                                      WHEN g.typecode_stg=''MS''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''GEORGE'',
                                                                                                                                                                                ''PEARL RIVER'',
                                                                                                                                                                                ''STONE'') THEN ''05''
                                                                                                                                      WHEN g.typecode_stg=''MS''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''HANCOCK'',
                                                                                                                                                                                ''HARRISON'',
                                                                                                                                                                                ''JACKSON'') THEN ''06''
                                                                                                                                      WHEN g.typecode_stg=''MS''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''HINDS'',
                                                                                                                                                                                ''MADISON'',
                                                                                                                                                                                ''RANKIN'') THEN ''31''
                                                                                                                                      WHEN g.typecode_stg=''MS''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''ADAMS'',
                                                                                                                                                                                ''ALCORN'',
                                                                                                                                                                                ''ATTALA'',
                                                                                                                                                                                ''BENTON'',
                                                                                                                                                                                ''BOLIVAR'',
                                                                                                                                                                                ''CALHOUN'',
                                                                                                                                                                                ''CARROLL'',
                                                                                                                                                                                ''CHICKASAW'',
                                                                                                                                                                                ''CHOCTAW'',
                                                                                                                                                                                ''CLAIBORNE'',
                                                                                                                                                                                ''CLARKE'',
                                                                                                                                                                                ''CLAY'',
                                                                                                                                                                                ''COAHOMA'',
                                                                                                                                                                                ''COPIAH'',
                                                                                                                                                                                ''COVINGTON'',
                                                                                                                                                                                ''DESOTO'',
                                                                                                                                                                                ''FRANKLIN'',
                                                                                                                                                                                ''GRENADA'',
                                                                                                                                                                                ''HOLMES'',
                                                                                                                                                                                ''HUMPHREYS'',
                                                                                                                                                                                ''ISSAQUENA'',
                                                                                                                                                                                ''ITAWAMBA'',
                                                                                                                                                                                ''JASPER'',
                                                                                                                                                                                ''JEFFERSON'',
                                                                                                                                                                                ''JEFFERSON DAVIS'',
                                                                                                                                                                                ''JONES'',
                                                                                                                                                                                ''KEMPER'',
                                                                                                                                                                                ''LAFAYETTE'',
                                                                                                                                                                                ''LAUDERDALE'',
                                                                                                                                                                                ''LAWRENCE'',
                                                                                                                                                                                ''LEAKE'',
                                                                                                                                                                                ''LEE'',
                                                                                                                                                                                ''LEFLORE'',
                                                                                                                                                                                ''LINCOLN'',
                                                                                                                                                                                ''LOWNDES'',
                                                                                                                                                                                ''MARSHALL'',
                                                                                                                                                                                ''MONROE'',
                                                                                                                                                                                ''MONTGOMERY'',
                                                                                                                                                                                ''NESHOBA'',
                                                                                                                                                                                ''NEWTON'',
                                                                                                                                                                                ''NOXUBEE'',
                                                                                                                                                                                ''OKTIBBEHA'',
                                                                                                                                                                                ''PANOLA'',
                                                                                                                                                                                ''PONTOTOC'',
                                                                                                                                                                                ''PRENTISS'',
                                                                                                                                                                                ''QUITMAN'',
                                                                                                                                                                                ''SCOTT'',
                                                                                                                                                                                ''SHARKEY'',
                                                                                                                                                                                ''SIMPSON'',
                                                                                                                                                                                ''SMITH'',
                                                                                                                                                                                ''SUNFLOWER'',
                                                                                                                                                                                ''TALLAHATCHIE'',
                                                                                                                                                                                ''TATE'',
                                                                                                                                                                                ''TIPPAH'',
                                                                                                                                                                                ''TISHOMINGO'',
                                                                                                                                                                                ''TUNICA'',
                                                                                                                                                                                ''UNION'',
                                                                                                                                                                                ''WARREN'',
                                                                                                                                                                                ''WASHINGTON'',
                                                                                                                                                                                ''WAYNE'',
                                                                                                                                                                                ''WEBSTER'',
                                                                                                                                                                                ''WINSTON'',
                                                                                                                                                                                ''YALOBUSHA'',
                                                                                                                                                                                ''YAZOO'') THEN ''32''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(cityinternal_stg)= ''ATLANTA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''DE KALB'',
                                                                                                                                                                                ''DEKALB'',
                                                                                                                                                                                ''FULTON'') THEN ''32''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(cityinternal_stg)= ''MACON''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''BIBB'' THEN ''35''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(cityinternal_stg)= ''SAVANNAH''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''CHATHAM'' THEN ''30''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''DE KALB'',
                                                                                                                                                                                ''DEKALB'',
                                                                                                                                                                                ''DE KALB'',
                                                                                                                                                                                ''DEKALB'',
                                                                                                                                                                                ''FULTON'') THEN ''33''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''BRYAN'',
                                                                                                                                                                                ''CAMDEN'',
                                                                                                                                                                                ''CHATHAM'',
                                                                                                                                                                                ''GLYNN'',
                                                                                                                                                                                ''LIBERTY'',
                                                                                                                                                                                ''MCINTOSH'') THEN ''31''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''DE KALB'',
                                                                                                                                                                                ''DEKALB'',
                                                                                                                                                                                ''DE KALB'',
                                                                                                                                                                                ''DEKALB'',
                                                                                                                                                                                ''FULTON'') THEN ''33''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''CLAYTON'',
                                                                                                                                                                                ''COBB'',
                                                                                                                                                                                ''GWINNETT'') THEN ''34''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''CATOOSA'',
                                                                                                                                                                                ''WALKER'',
                                                                                                                                                                                ''WHITFIELD'') THEN ''36''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) =''RICHMOND'' THEN ''37''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''CHATTAHOOCHEE'',
                                                                                                                                                                                ''MUSCOGEE'') THEN ''38''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''BUTTS'',
                                                                                                                                                                                ''CHEROKEE'',
                                                                                                                                                                                ''DOUGLAS'',
                                                                                                                                                                                ''FAYETTE'',
                                                                                                                                                                                ''FORSYTH'',
                                                                                                                                                                                ''HENRY'',
                                                                                                                                                                                ''NEWTON'',
                                                                                                                                                                                ''PAULDING'',
                                                                                                                                                                                ''ROCKDALE'',
                                                                                                                                                                                ''WALTON'') THEN ''39''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''BALDWIN'',
                                                                                                                                                                                ''BANKS'',
                                                                                                                                                                                ''BARROW'',
                                                                                                                                                                                ''BARTOW'',
                                                                                                                                                                                ''CARROLL'',
                                                                                                                                                                                ''CHATTOOGA'',
                                                                                                                                                                                ''CLARKE'',
                                                                                                                                                                                ''COLUMBIA'',
                                                                                                                                                                                ''COWETA'',
                                                                                                                                                                                ''DADE'',
                                                                                                                                                                                ''DAWSON'',
                                                                                                                                                                                ''ELBERT'',
                                                                                                                                                                                ''FANNIN'',
                                                                                                                                                                                ''FLOYD'',
                                                                                                                                                                                ''FRANKLIN'',
                                                                                                                                                                                ''GILMER'',
                                                                                                                                                                                ''GORDON'',
                                                                                                                                                                                ''GREENE'',
                                                                                                                                                                                ''HABERSHAM'',
                                                                                                                                                                                ''HALL'',
                                                                                                                                                                                ''HANCOCK'',
                                                                                                                                                                                ''HARALSON'',
                                                                                                                                                                                ''HART'',
                                                                                                                                                                                ''HEARD'',
                                                                                                                                                                                ''JACKSON'',
                                                                                                                                                                                ''JASPER'',
                                                                                                                                                                                ''JONES'',
                                                                                                                                                                                ''LAMAR'',
                                                                                                                                                                                ''LINCOLN'',
                                                                                                                                                                                ''LUMPKIN'',
                                                                                                                                                                                ''MADISON'',
                                                                                                                                                                                ''MCDUFFIE'',
                                                                                                                                                                                ''MERIWETHER'',
                                                                                                                                                                                ''MONROE'',
                                                                                                                                                                                ''MORGAN'',
                                                                                                                                                                                ''MURRAY'',
                                                                                                                                                                                ''OCONEE'',
                                                                                                                                                                                ''OGLETHORPE'',
                                                                                                                                                                                ''PICKENS'',
                                                                                                                                                                                ''PIKE'',
                                                                                                                                                                                ''POLK'',
                                                                                                                                                                                ''PUTNAM'',
                                                                                                                                                                                ''RABUN'',
                                                                                                                                                                                ''SPALDING'',
                                                                                                                                                                                ''STEPHENS'',
                                                                                                                                                                                ''TALIAFERRO'',
                                                                                                                                                                                ''TOWNS'',
                                                                                                                                                                                ''TROUP'',
                                                                                                                                                                                ''UNION'',
                                                                                                                                                                                ''WARREN'',
                                                                                                                                                                                ''WHITE'',
                                                                                                                                                                                ''WILKES'') THEN ''40''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''BAKER'',
                                                                                                                                                                                ''BIBB'',
                                                                                                                                                                                ''BROOKS'',
                                                                                                                                                                                ''CALHOUN'',
                                                                                                                                                                                ''CLAY'',
                                                                                                                                                                                ''COLQUITT'',
                                                                                                                                                                                ''CRAWFORD'',
                                                                                                                                                                                ''CRISP'',
                                                                                                                                                                                ''DECATUR'',
                                                                                                                                                                                ''DOOLY'',
                                                                                                                                                                                ''DOUGHERTY'',
                                                                                                                                                                                ''EARLY'',
                                                                                                                                                                                ''GRADY'',
                                                                                                                                                                                ''HARRIS'',
                                                                                                                                                                                ''HOUSTON'',
                                                                                                                                                                                ''LEE'',
                                                                                                                                                                                ''MACON'',
                                                                                                                                                                                ''MARION'',
                                                                                                                                                                                ''MILLER'',
                                                                                                                                                                                ''MITCHELL'',
                                                                                                                                                                                ''PEACH'',
                                                                                                                                                                                ''QUITMAN'',
                                                                                                                                                                                ''RANDOLPH'',
                                                                                                                                                                                ''SCHLEY'',
                                                                                                                                                                                ''SEMINOLE'',
                                                                                                                                                                                ''STEWART'',
                                                                                                                                                                                ''SUMTER'',
                                                                                                                                                                                ''TALBOT'',
                                                                                                                                                                                ''TAYLOR'',
                                                                                                                                                                                ''TERRELL'',
                                                                                                                                                                                ''THOMAS'',
                                                                                                                                                                                ''TIFT'',
                                                                                                                                                                                ''TURNER'',
                                                                                                                                                                                ''UPSON'',
                                                                                                                                                                                ''WEBSTER'',
                                                                                                                                                                                ''WORTH'') THEN ''41''
                                                                                                                                      WHEN g.typecode_stg=''GA''
                                                                                                                                      AND       upper(b.countyinternal_stg) IN (''APPLING'',
                                                                                                                                                                                ''ATKINSON'',
                                                                                                                                                                                ''BACON'',
                                                                                                                                                                                ''BEN HILL'',
                                                                                                                                                                                ''BERRIEN'',
                                                                                                                                                                                ''BLECKLEY'',
                                                                                                                                                                                ''BRANTLEY'',
                                                                                                                                                                                ''BULLOCH'',
                                                                                                                                                                                ''BURKE'',
                                                                                                                                                                                ''CANDLER'',
                                                                                                                                                                                ''CHARLTON'',
                                                                                                                                                                                ''CLINCH'',
                                                                                                                                                                                ''COFFEE'',
                                                                                                                                                                                ''COOK'',
                                                                                                                                                                                ''DODGE'',
                                                                                                                                                                                ''ECHOLS'',
                                                                                                                                                                                ''EFFINGHAM'',
                                                                                                                                                                                ''EMANUEL'',
                                                                                                                                                                                ''EVANS'',
                                                                                                                                                                                ''GLASCOCK'',
                                                                                                                                                                                ''IRWIN'',
                                                                                                                                                                                ''JEFF DAVIS'',
                                                                                                                                                                                ''JEFFERSON'',
                                                                                                                                                                                ''JENKINS'',
                                                                                                                                                                                ''JOHNSON'',
                                                                                                                                                                                ''LANIER'',
                                                                                                                                                                                ''LAURENS'',
                                                                                                                                                                                ''LONG'',
                                                                                                                                                                                ''LOWNDES'',
                                                                                                                                                                                ''MONTGOMERY'',
                                                                                                                                                                                ''PIERCE'',
                                                                                                                                                                                ''PULASKI'',
                                                                                                                                                                                ''SCREVEN'',
                                                                                                                                                                                ''TATTNALL'',
                                                                                                                                                                                ''TELFAIR'',
                                                                                                                                                                                ''TOOMBS'',
                                                                                                                                                                                ''TREUTLEN'',
                                                                                                                                                                                ''TWIGGS'',
                                                                                                                                                                                ''WARE'',
                                                                                                                                                                                ''WASHINGTON'',
                                                                                                                                                                                ''WAYNE'',
                                                                                                                                                                                ''WHEELER'',
                                                                                                                                                                                ''WILCOX'',
                                                                                                                                                                                ''WILKINSON'') THEN ''42''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''BALDWIN''
                                                                                                                                      AND       (
                                                                                                                                                          cast(c.code_stg AS INTEGER)=11
                                                                                                                                                OR        cast(c.code_stg AS INTEGER) IS NULL
                                                                                                                                                OR        cast(c.code_stg AS INTEGER) IN (1,2,3) ) THEN ''05''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(county_stg)=''BALDWIN''
                                                                                                                                      AND       (
                                                                                                                                                          cast(c.code_stg AS INTEGER)=11
                                                                                                                                                OR        cast(c.code_stg AS INTEGER) IS NULL
                                                                                                                                                OR        cast(c.code_stg AS INTEGER) IN (1,2,3) ) THEN ''05''
                                                                                                                                      WHEN g.typecode_stg=''AL''
                                                                                                                                      AND       upper(b.countyinternal_stg)=''MOBILE''
                                                                                                                                      AND       (
                                                                                                                                                          cast(c.code_stg AS INTEGER)IN (2,1,26,3 )
                                                                                                                                                OR        cast(c.code_stg AS INTEGER)IS NULL) THEN ''41''
                                                                                                                            END AS old_code
                                                                                                                  FROM      db_t_prod_stag.pcx_holocation_hoe a
                                                                                                                  join      db_t_prod_stag.pcx_dwelling_hoe e
                                                                                                                  ON        e.holocation_stg=a.id_stg
                                                                                                                  join      db_t_prod_stag.pc_policyperiod f
                                                                                                                  ON        e.branchid_stg =f.id_stg
                                                                                                                  left join db_t_prod_stag.pc_effectivedatedfields eff
                                                                                                                  ON        eff.branchid_stg = f.id_stg
                                                                                                                  AND       eff.expirationdate_stg IS NULL
                                                                                                                  join      db_t_prod_stag.pc_policylocation b
                                                                                                                  ON        b.id_stg = eff.primarylocation_stg
                                                                                                                  AND       b.expirationdate_stg IS NULL
                                                                                                                  join      db_t_prod_stag.pc_territorycode c
                                                                                                                  ON        c.branchid_stg = f.id_stg
                                                                                                                  join      db_t_prod_stag.pctl_territorycode d
                                                                                                                  ON        c.subtype_stg=d.id_stg
                                                                                                                  AND       d.typecode_stg = ''HOTerritoryCode_alfa''
                                                                                                                  left join db_t_prod_stag.pc_contact pc
                                                                                                                  ON        pc.id_stg =pnicontactdenorm_stg
                                                                                                                  left join db_t_prod_stag.pc_address
                                                                                                                  ON        pc.primaryaddressid_stg = pc_address.id_stg
                                                                                                                  join      db_t_prod_stag.pc_policyline
                                                                                                                  ON        f.id_stg = pc_policyline.branchid_stg
                                                                                                                  AND       pc_policyline.expirationdate_stg IS NULL
                                                                                                                  join      db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                  ON        pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                  AND       pctl_hopolicytype_hoe.typecode_stg IN (''SF1'',
                                                                                                                                                                   ''SF2'',
                                                                                                                                                                   ''SF3'')
                                                                                                                  join      db_t_prod_stag.pctl_jurisdiction g
                                                                                                                  ON        basestate_stg=g.id_stg
                                                                                                                  AND       g.typecode_stg IN (''AL'',
                                                                                                                                               ''GA'',
                                                                                                                                               ''MS'')) loc
                                                                                              left join db_t_prod_stag.pcx_hodbterritory_alfa pht1
                                                                                              ON        pht1.code_stg =loc.code_stg
                                                                                              AND       cast(pht1.countycode_alfa_stg AS VARCHAR(50))=cast(loc.countycode_alfa_stg AS VARCHAR(50))
                                                                                              AND       substring(pht1.publicid_stg,7,2) =loc.typecode_stg
                                                                                              AND       pht1.hopolicytype_hoe_stg=loc.hopolicytype_stg
                                                                                              left join
                                                                                                        (
                                                                                                                        SELECT DISTINCT naiipcicode_alfa_stg,
                                                                                                                                        substring(publicid_stg,7,2) state_stg,
                                                                                                                                        code_stg                    territory_code_stg,
                                                                                                                                        hopolicytype_hoe_stg,
                                                                                                                                        rank() over( PARTITION BY naiipcicode_alfa_stg, substring(publicid_stg,7,2) , code_stg , hopolicytype_hoe_stg ORDER BY naiipcicode_alfa_stg,countycode_alfa_stg )"row"
                                                                                                                        FROM            db_t_prod_stag.pcx_hodbterritory_alfa )pht2
                                                                                              ON        pht2."row"=1
                                                                                              AND       pht2.territory_code_stg =loc.code_stg
                                                                                              AND       pht2.state_stg =loc.typecode_stg
                                                                                              AND       pht2.hopolicytype_hoe_stg=loc.hopolicytype_stg
                                                                                              left join
                                                                                                        (
                                                                                                                        SELECT DISTINCT naiipcicode_alfa_stg,
                                                                                                                                        substring(publicid_stg,7,2) state_stg,
                                                                                                                                        countycode_alfa_stg         countycode_alfa_stg,
                                                                                                                                        hopolicytype_hoe_stg,
                                                                                                                                        rank() over( PARTITION BY naiipcicode_alfa_stg, substring(publicid_stg,7,2) , countycode_alfa_stg , hopolicytype_hoe_stg ORDER BY naiipcicode_alfa_stg,code_stg )"row"
                                                                                                                        FROM            db_t_prod_stag.pcx_hodbterritory_alfa )pht3
                                                                                              ON        pht3."row"=1
                                                                                              AND       cast(pht3.countycode_alfa_stg AS VARCHAR(50))=cast(loc.countycode_alfa_stg AS VARCHAR(50))
                                                                                              AND       pht3.state_stg =loc.typecode_stg
                                                                                              AND       pht3.hopolicytype_hoe_stg=loc.hopolicytype_stg
                                                                                              WHERE     rownum_stg=1
                                                                                              GROUP BY  loc.branchid_stg) terr
                                                                    ON              terr.id=pp.id_stg
                                                                    join            db_t_prod_stag.pc_job pj
                                                                    ON              pp.jobid_stg = pj.id_stg
                                                                    join            db_t_prod_stag.pctl_job pcj
                                                                    ON              pj.subtype_stg = pcj.id_stg
                                                                    join            db_t_prod_stag.pcx_holocation_hoe phh
                                                                    ON              pdh.holocation_stg= phh.id_stg
                                                                    join            db_t_prod_stag.pctl_hopolicytype_hoe ph
                                                                    ON              ph.id_stg=hopolicytype_stg
                                                                    AND             ph.typecode_stg IN (''SF1'',
                                                                                                        ''SF2'',
                                                                                                        ''SF3'')
                                                                    join
                                                                                    (
                                                                                                    SELECT DISTINCT branchid_stg,
                                                                                                                    max(
                                                                                                                    CASE
                                                                                                                                    WHEN covterm.covtermpatternid_stg=''HODW_Dwelling_Limit_HOE'' THEN substring(1, (5-length( cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))))-1 +cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000, 0)AS INTEGER) AS VARCHAR(10))
                                                                                                                    END )dw_limit,
                                                                                                                    max(
                                                                                                                    CASE
                                                                                                                                    WHEN covterm.covtermpatternid_stg=''HOSI_SpecificOtherStructureItemLimit_alfa'' THEN substring(1, (5-length( cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))))-1 + cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000, 0)AS INTEGER) AS VARCHAR(10))
                                                                                                                    END )st_limit,
                                                                                                                    max (
                                                                                                                    CASE
                                                                                                                                    WHEN covterm.covtermpatternid_stg=''HODW_DwellingAdditionalLimit_alfa'' THEN cast(polcov.val_stg AS DECIMAL(18,4))
                                                                                                                    END )lia_limit,
                                                                                                                    max (
                                                                                                                    CASE
                                                                                                                                    WHEN covterm.covtermpatternid_stg=''HODW_PersonalPropertyLimit_alfa'' THEN substring(1, (5-length( cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))))-1 +(cast(cast(round(cast(polcov.val_stg AS DECIMAL(18,4))/1000,0)AS INTEGER) AS VARCHAR(10)))
                                                                                                                    END )pp_limit,
                                                                                                                    max(
                                                                                                                    CASE
                                                                                                                                    WHEN covterm.covtermpatternid_stg=''HODW_OtherPerils_Ded_HOE'' THEN (
                                                                                                                                                    CASE
                                                                                                                                                                    WHEN substring(name1_stg ,length(name1_stg),1)=''%'' THEN ''F''
                                                                                                                                                                    ELSE ''D''
                                                                                                                                                    END)
                                                                                                                    END)perils_limit_ind,
                                                                                                                    max(
                                                                                                                    CASE
                                                                                                                                    WHEN covterm.covtermpatternid_stg=''HODW_OtherPerils_Ded_HOE'' THEN (
                                                                                                                                                    CASE
                                                                                                                                                                    WHEN substring(name1_stg ,length(name1_stg),1)=''%'' THEN cast(cast(cast(cast(value1_stg AS DECIMAL(18,4)) *10000 AS DECIMAL(18,4)) AS INTEGER) AS VARCHAR(10))
                                                                                                                                                                    ELSE cast(cast(cast(value1_stg AS DECIMAL(18,4)) AS INTEGER) AS VARCHAR(10))
                                                                                                                                                    END)
                                                                                                                    END)perils_limit,
                                                                                                                    max (
                                                                                                                    CASE
                                                                                                                                    WHEN patterncode_stg =''HODW_Earthquake_HOE'' THEN patterncode_stg
                                                                                                                    END) earthquake,
                                                                                                                    max (
                                                                                                                    CASE
                                                                                                                                    WHEN patterncode_stg =''HODW_PersonalPropertyReplacementCost_alfa'' THEN patterncode_stg
                                                                                                                    END) replacement,
                                                                                                                    max (
                                                                                                                    CASE
                                                                                                                                    WHEN (
                                                                                                                                                                    covtermpatternid_stg =''HODW_WindHail_Ded_HOE'') THEN covtermpatternid_stg
                                                                                                                    END )windhail,
                                                                                                                    max (
                                                                                                                    CASE
                                                                                                                                    WHEN (
                                                                                                                                                                    covtermpatternid_stg =''HODW_Hurricane_Ded_HOE'' ) THEN covtermpatternid_stg
                                                                                                                    END )hurricane,
                                                                                                                    max (
                                                                                                                    CASE
                                                                                                                                    WHEN (
                                                                                                                                                                    covtermpatternid_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'') THEN covtermpatternid_stg
                                                                                                                    END )windstormhailexcl,
                                                                                                                    max (
                                                                                                                    CASE
                                                                                                                                    WHEN (
                                                                                                                                                                    covtermpatternid_stg =''HODW_SectionI_DedWindAndHailExcl_alfa'') THEN coalesce( polcov.val_stg, value1_stg)
                                                                                                                    END )windstormhailexcl_amt,
                                                                                                                    max(
                                                                                                                    CASE
                                                                                                                                    WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                  ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                  ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                    AND             polcov.columnname_stg LIKE ''%direct%'' THEN polcov.val_stg
                                                                                                                                    WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                  ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                  ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                    AND             polcov.columnname_stg NOT LIKE ''%direct%'' THEN (
                                                                                                                                                    CASE
                                                                                                                                                                    WHEN (
                                                                                                                                                                                                    cast(value1_stg AS DECIMAL(18,4))<=1.0000 ) THEN cast(cast(cast(value1_stg AS DECIMAL(18,4))*10000 AS INTEGER) AS VARCHAR(10))
                                                                                                                                                                    WHEN value1_stg IS NULL
                                                                                                                                                                    OR              value1_stg =0 THEN 0
                                                                                                                                                                    ELSE cast(cast(cast(value1_stg AS DECIMAL(18,4)) *10000 AS INTEGER) AS VARCHAR(10))
                                                                                                                                                    END )
                                                                                                                    END ) AS deductibleamountws,
                                                                                                                    max (
                                                                                                                    CASE
                                                                                                                                    WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                  ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                  ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                    AND             polcov.columnname_stg LIKE ''%direct%'' THEN ''D''
                                                                                                                                    WHEN covtermpatternid_stg IN (''HODW_WindHail_Ded_HOE'',
                                                                                                                                                                  ''HODW_Hurricane_Ded_HOE'',
                                                                                                                                                                  ''HODW_SectionI_DedWindstorm_alfa'')
                                                                                                                                    AND             polcov.columnname_stg NOT LIKE ''%direct%'' THEN (
                                                                                                                                                    CASE
                                                                                                                                                                    WHEN (
                                                                                                                                                                                                    cast(value1_stg AS DECIMAL(18,4))<=1.0000) THEN ''F''
                                                                                                                                                                    WHEN value1_stg IS NULL
                                                                                                                                                                    OR              value1_stg=0 THEN NULL
                                                                                                                                                                    ELSE ''D''
                                                                                                                                                    END )
                                                                                                                    END ) AS deductiblews
                                                                                                    FROM            (
                                                                                                                               SELECT     cast(''DirectTerm1'' AS                       VARCHAR(100)) AS columnname_stg,
                                                                                                                                          cast(directterm1_stg AS                     VARCHAR(255)) AS val_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.          expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      directterm1avl_stg = 1
                                                                                                                               AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               UNION
                                                                                                                               SELECT     ''Clause''                   AS columnname_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS val_stg,
                                                                                                                                          pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      pcx_dwellingcov_hoe.patterncode_stg= ''HODW_PersonalPropertyReplacementCost_alfa''
                                                                                                                               AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               UNION
                                                                                                                               SELECT     ''DirectTerm2''                         AS columnname_stg,
                                                                                                                                          cast(directterm2_stg AS VARCHAR(255)) AS val,
                                                                                                                                          pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      directterm2avl_stg = 1
                                                                                                                               AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               UNION
                                                                                                                               SELECT     ''DirectTerm3''                         AS columnname_stg,
                                                                                                                                          cast(directterm3_stg AS VARCHAR(255)) AS val,
                                                                                                                                          pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      directterm3avl_stg = 1
                                                                                                                               AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               UNION
                                                                                                                               SELECT     ''DirectTerm4''                         AS columnname_stg,
                                                                                                                                          cast(directterm4_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                          pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.          expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      directterm4avl_stg = 1
                                                                                                                               AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               UNION
                                                                                                                               SELECT     ''ChoiceTerm2''                         AS columnname_stg,
                                                                                                                                          cast(choiceterm2_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                          pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      choiceterm2avl_stg = 1
                                                                                                                               AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               UNION
                                                                                                                               SELECT     ''ChoiceTerm3''                         AS columnname_stg,
                                                                                                                                          cast(choiceterm3_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                          pcx_dwellingcov_hoe.patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe. effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      choiceterm3avl_stg = 1
                                                                                                                               AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               UNION
                                                                                                                               SELECT     cast(''ChoiceTerm1'' AS                       VARCHAR(250)) AS columnname_stg,
                                                                                                                                          cast(choiceterm1_stg AS                     VARCHAR(255)) AS val_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe. effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      choiceterm1avl_stg = 1
                                                                                                                               AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               UNION
                                                                                                                               SELECT     cast(''ChoiceTerm4'' AS                       VARCHAR(250)) AS columnname_stg,
                                                                                                                                          cast(choiceterm4_stg AS                     VARCHAR(255)) AS val_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      choiceterm4avl_stg = 1
                                                                                                                               AND        pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               UNION
                                                                                                                               SELECT     cast(''BooleanTerm1'' AS                      VARCHAR(250)) AS columnname_stg,
                                                                                                                                          cast(booleanterm1_stg AS                    VARCHAR(255)) AS val_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.patterncode_stg AS VARCHAR(250))    patterncode_stg,
                                                                                                                                          cast(pcx_dwellingcov_hoe.branchid_stg AS    VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.createtime_stg,
                                                                                                                                          pcx_dwellingcov_hoe.effectivedate_stg,
                                                                                                                                          pcx_dwellingcov_hoe.expirationdate_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS choiceterm1_stg,
                                                                                                                                          cast(NULL AS VARCHAR(255)) AS patternid_stg,
                                                                                                                                          pcx_dwellingcov_hoe.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_dwellingcov_hoe
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pcx_dwellingcov_hoe.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               WHERE      pcx_dwellingcov_hoe.expirationdate_stg IS NULL
                                                                                                                               AND        pcx_dwellingcov_hoe.patterncode_stg =''HODW_SectionI_Ded_HOE''
                                                                                                                               UNION
                                                                                                                               SELECT     ''DirectTerm1''                         AS columnname_stg,
                                                                                                                                          cast(directterm1_stg AS VARCHAR(255)) AS val_stg,
                                                                                                                                          pha.patterncode_stg,
                                                                                                                                          cast(pha.branchid_stg AS VARCHAR(255)) AS branchid_stg,
                                                                                                                                          pha.createtime_stg,
                                                                                                                                          pha.effectivedate_stg,
                                                                                                                                          pha.expirationdate_stg,
                                                                                                                                          choiceterm1_stg,
                                                                                                                                          pe.patternid_stg AS patternid_stg,
                                                                                                                                          pha.updatetime_stg
                                                                                                                               FROM       db_t_prod_stag.pcx_holineschcovitemcov_alfa pha
                                                                                                                               inner join db_t_prod_stag.pc_policyperiod pp
                                                                                                                               ON         pp.id_stg = pha.branchid_stg
                                                                                                                               join       db_t_prod_stag.pc_policyline
                                                                                                                               ON         pp.id_stg = pc_policyline.branchid_stg
                                                                                                                               join       db_t_prod_stag.pctl_hopolicytype_hoe
                                                                                                                               ON         pc_policyline.hopolicytype_stg = pctl_hopolicytype_hoe.id_stg
                                                                                                                               AND        pctl_hopolicytype_hoe.typecode_stg IN ( ''SF1'',
                                                                                                                                                                                 ''SF2'',
                                                                                                                                                                                 ''SF3'')
                                                                                                                               left join  db_t_prod_stag.pc_etlclausepattern pe
                                                                                                                               ON         pe.patternid_stg = pha.patterncode_stg
                                                                                                                               WHERE      pe.patternid_stg IN (''HOSI_SpecificOtherStructureItem_alfa'',
                                                                                                                                                               ''HOSI_ScheduledPropertyItem_alfa'',
                                                                                                                                                               ''HOSI_SpecificOtherStructureExclItem_alfa'')
                                                                                                                               AND        directterm1avl_stg = 1
                                                                                                                               AND        pha.expirationdate_stg IS NULL ) polcov
                                                                                                    left join
                                                                                                                    (
                                                                                                                           SELECT pcl.patternid_stg     clausepatternid_stg,
                                                                                                                                  pcv.patternid_stg     covtermpatternid_stg,
                                                                                                                                  pcv.columnname_stg  AS columnname_stg,
                                                                                                                                  pcv.covtermtype_stg AS covtermtype_stg,
                                                                                                                                  pcl.name_stg           clausename_stg
                                                                                                                           FROM   db_t_prod_stag.pc_etlclausepattern pcl
                                                                                                                           join   db_t_prod_stag.pc_etlcovtermpattern pcv
                                                                                                                           ON     pcl.id_stg = pcv.clausepatternid_stg ) covterm
                                                                                                    ON              covterm.clausepatternid_stg = polcov.patterncode_stg
                                                                                                    AND             covterm.columnname_stg = polcov.columnname_stg
                                                                                                    left outer join
                                                                                                                    (
                                                                                                                               SELECT     pco.patternid_stg                      optionpatternid_stg,
                                                                                                                                          pco.optioncode_stg                     name1_stg,
                                                                                                                                          cast(pco.value_stg AS VARCHAR(255)) AS value1_stg,
                                                                                                                                          pcp.valuetype_stg                   AS valuetype_stg
                                                                                                                               FROM       db_t_prod_stag.pc_etlcovtermpattern pcp
                                                                                                                               inner join db_t_prod_stag.pc_etlcovtermoption pco
                                                                                                                               ON         pcp.id_stg = pco.coveragetermpatternid_stg ) optn
                                                                                                    ON              optn.optionpatternid_stg = polcov.val_stg
                                                                                                    GROUP BY        branchid_stg ) cov
                                                                    ON              cast(cov.branchid_stg AS bigint) =pp.id_stg
                                                                    left join       db_t_prod_stag.pctl_residencetype_hoe pr
                                                                    ON              residencetype_stg= pr.id_stg
                                                                    left join       db_t_prod_stag.pc_periodanswer ppa
                                                                    ON              ppa.branchid_stg=pp.id_stg
                                                                    AND             questioncode_stg=''HOStandardFirePolicySubtype_alfa''
                                                                    left join       db_t_prod_stag.pctl_constructiontype_hoe pct
                                                                    ON              pct.id_stg=constructiontype_stg
                                                                    join            db_t_prod_stag.pctl_policyperiodstatus
                                                                    ON              pp.status_stg=pctl_policyperiodstatus.id_stg
                                                                    AND             pctl_policyperiodstatus.typecode_stg=''Bound''
                                                                    join            db_t_prod_stag.pc_policyterm pt
                                                                    ON              pt.id_stg = pp.policytermid_stg
                                                                    AND
                                                                                    CASE
                                                                                                    WHEN pp.editeffectivedate_stg >= pp.modeldate_stg
                                                                                                    AND             pp.editeffectivedate_stg>= coalesce(cast(pt.confirmationdate_alfa_stg AS timestamp), cast(''1900-01-01 00:00:00.000000''AS timestamp)) THEN pp.editeffectivedate_stg
                                                                                                    WHEN coalesce(cast(pt.confirmationdate_alfa_stg AS timestamp), cast(''1900-01-01 00:00:00.000000'' AS timestamp)) >= pp.modeldate_stg THEN coalesce(cast(pt.confirmationdate_alfa_stg AS timestamp), cast(''1900-01-01 00:00:00.000000'' AS timestamp))
                                                                                                    ELSE pp.modeldate_stg
                                                                                    END BETWEEN :pc_boy AND             :pc_eoy)a
                                           GROUP BY companynumber,
                                                    lob,
                                                    statecode,
                                                    callyear,
                                                    accountingyear,
                                                    expperiodyear,
                                                    expperiodmonth,
                                                    expperiodday,
                                                    territorycode,
                                                    occupancy_code,
                                                    zipcode,
                                                    policy_eff_yr,
                                                    newrecordformat,
                                                    aslob,
                                                    itemcode,
                                                    sublinecode,
                                                    buildingcontents,
                                                    policy_form_code,
                                                    construction,
                                                    protectionclasscode,
                                                    typeofdeductiblecode,
                                                    policytermcode,
                                                    locationcode,
                                                    amountofinsurance,
                                                    yearofmanufacture,
                                                    ded_ind,
                                                    ded_amount,
                                                    tiedowncode,
                                                    deductibleindicatorws,
                                                    deductibleamountws,
                                                    claimidentifier,
                                                    claimantidentifier,
                                                    writtenexposure,
                                                    paidlosses,
                                                    paidnumberofclaims,
                                                    outstandinglosses,
                                                    outstandingnumberofclaims,
                                                    policynumber_stg,
                                                    policyperiodid_stg,
                                                    policyidentifier
                                           HAVING   SUM(cast(writtenpremium AS DECIMAL(18,4)))<>0.00
                                                    /*  */
                                  ) src ) );
  -- Component exp_policy_pass_through, Type EXPRESSION
  CREATE
  OR
  replace TEMPORARY TABLE exp_policy_pass_through AS
  (
         SELECT sq_pc_policyperiod.companynumber           AS companynumber,
                sq_pc_policyperiod.lineofbusinesscode      AS lineofbusinesscode,
                sq_pc_policyperiod.statecode               AS statecode,
                sq_pc_policyperiod.callyear                AS callyear,
                sq_pc_policyperiod.accountingyear          AS accountingyear,
                sq_pc_policyperiod.expperiodyear           AS expperiodyear,
                sq_pc_policyperiod.expperiodmonth          AS expperiodmonth,
                sq_pc_policyperiod.expeperiodday           AS expeperiodday,
                sq_pc_policyperiod.occupanycode            AS occupancycode,
                sq_pc_policyperiod.buildingcontents        AS buildingcontents,
                sq_pc_policyperiod.territorycode           AS territorycode,
                sq_pc_policyperiod.stateexceptionind       AS stateexceptionind,
                sq_pc_policyperiod.zipcode                 AS zipcode,
                sq_pc_policyperiod.policyeffectiveyear     AS policyeffectiveyear,
                sq_pc_policyperiod.newrecordformat         AS newrecordformat,
                sq_pc_policyperiod.aslob                   AS aslob,
                sq_pc_policyperiod.itemcode                AS itemcode,
                sq_pc_policyperiod.sublinecode             AS sublinecode,
                sq_pc_policyperiod.policyprogramcode       AS policyprogramcode,
                sq_pc_policyperiod.policyformcode          AS policyformcode,
                sq_pc_policyperiod.numberoffamilycodes     AS numberoffamilycodes,
                sq_pc_policyperiod.constructioncode        AS constructioncode,
                sq_pc_policyperiod.protectionclasscode     AS protectioncasscode,
                sq_pc_policyperiod.exceptioncode           AS exceptioncode,
                sq_pc_policyperiod.typeofdeductiblecode    AS typeofdeductiblecode,
                sq_pc_policyperiod.policytermcode          AS policytermcode,
                sq_pc_policyperiod.typeoflosscode          AS typeoflosscode,
                sq_pc_policyperiod.stateofexceptionb       AS stateofexceptionb,
                sq_pc_policyperiod.amountofinsurance       AS amountofinsurance,
                sq_pc_policyperiod.yeaofconstructionliablt AS yeaofconstructionliablt,
                sq_pc_policyperiod.coveragecodeordlaw      AS coveragecodeordlaw,
                sq_pc_policyperiod.exposurecode            AS exposurecode,
                sq_pc_policyperiod.leadpoisoningliability  AS leadpoisoningliability,
                sq_pc_policyperiod.deductibleindicator     AS deductibleindicator,
                sq_pc_policyperiod.deductibleamount        AS deductibleamount,
                sq_pc_policyperiod.deductibleindicatorws   AS deductibleindicatorws,
                sq_pc_policyperiod.deductibleamountws      AS deductibleamountws,
                sq_pc_policyperiod.writtenexposure         AS writtenexposure,
                sq_pc_policyperiod.writtenpremium          AS writtenpremium,
                sq_pc_policyperiod.paidlosses              AS paidlosses,
                sq_pc_policyperiod.paidnumberofclaims      AS paidnumberofclaims,
                sq_pc_policyperiod.outstandinglosses       AS outstandinglosses,
                sq_pc_policyperiod.outstandingnoofclaims   AS outstandingnoofclaims,
                sq_pc_policyperiod.policynumber            AS policynumber,
                sq_pc_policyperiod.policyperiodid          AS policyperiodid,
                sq_pc_policyperiod.policyidentifier        AS policyidentifier,
                sq_pc_policyperiod.source_record_id
         FROM   sq_pc_policyperiod );
  -- Component exp_default, Type EXPRESSION
  CREATE
  OR
  replace TEMPORARY TABLE exp_default AS
  (
         SELECT exp_policy_pass_through.companynumber      AS companynumber,
                exp_policy_pass_through.lineofbusinesscode AS lineofbusinesscode,
                exp_policy_pass_through.statecode          AS statecode,
                exp_policy_pass_through.callyear           AS callyear,
                exp_policy_pass_through.accountingyear     AS accountingyear,
                exp_policy_pass_through.expperiodyear      AS expperiodyear,
                exp_policy_pass_through.expperiodmonth     AS expperiodmonth,
                exp_policy_pass_through.expeperiodday      AS expeperiodday,
                exp_policy_pass_through.occupancycode      AS occupancycode,
                exp_policy_pass_through.buildingcontents   AS buildingcontents,
                CASE
                       WHEN exp_policy_pass_through.territorycode IS NULL THEN ''00''
                       ELSE substr ( ''00'' , 1 , 2 - length ( exp_policy_pass_through.territorycode ) )
                                     || exp_policy_pass_through.territorycode
                END                                          AS territorycode1,
                exp_policy_pass_through.stateexceptionind    AS stateexceptioncodeb,
                exp_policy_pass_through.zipcode              AS zipcode,
                exp_policy_pass_through.policyeffectiveyear  AS policyeffectiveyear,
                exp_policy_pass_through.newrecordformat      AS newrecordformat,
                exp_policy_pass_through.aslob                AS aslob,
                exp_policy_pass_through.itemcode             AS itemcode,
                exp_policy_pass_through.sublinecode          AS sublinecode,
                exp_policy_pass_through.policyformcode       AS policyformcode,
                exp_policy_pass_through.constructioncode     AS constructioncode,
                exp_policy_pass_through.protectioncasscode   AS protectionclasscosse,
                exp_policy_pass_through.exceptioncode        AS exceptioncode,
                exp_policy_pass_through.typeofdeductiblecode AS typeofdeductible,
                CASE
                       WHEN exp_policy_pass_through.policytermcode IS NULL THEN ''00''
                       ELSE substr ( ''00'' , 1 , 2 - length ( exp_policy_pass_through.policytermcode ) )
                                     || exp_policy_pass_through.policytermcode
                END                                       AS policytermcode1,
                exp_policy_pass_through.typeoflosscode    AS typeoflosscode,
                exp_policy_pass_through.stateofexceptionb AS stateofexceptioncode,
                CASE
                       WHEN exp_policy_pass_through.amountofinsurance IS NULL THEN ''00000''
                       ELSE substr ( ''00000'' , 1 , 5 - length ( exp_policy_pass_through.amountofinsurance ) )
                                     || exp_policy_pass_through.amountofinsurance
                END AS amountofinsurance1,
                CASE
                       WHEN exp_policy_pass_through.yeaofconstructionliablt IS NULL THEN ''0000''
                       ELSE substr ( ''0000'' , 1 , 4 - length ( exp_policy_pass_through.yeaofconstructionliablt ) )
                                     || exp_policy_pass_through.yeaofconstructionliablt
                END                                           AS yearofconstru,
                exp_policy_pass_through.coveragecodeordlaw    AS coveragecodeb,
                exp_policy_pass_through.deductibleindicator   AS deductibleindicator,
                exp_policy_pass_through.deductibleamount      AS deductibleamount,
                exp_policy_pass_through.deductibleindicatorws AS deductiblewindindicator,
                CASE
                       WHEN exp_policy_pass_through.deductibleamountws IS NULL THEN ''0000000''
                       ELSE substr ( ''0000000'' , 1 , 7 - length ( exp_policy_pass_through.deductibleamountws ) )
                                     || exp_policy_pass_through.deductibleamountws
                END                                           AS deductiblewindamount1,
                ''000000000000000''                             AS claimidentifer,
                ''000''                                         AS claimantidentifier,
                exp_policy_pass_through.writtenexposure       AS writtenexposure,
                exp_policy_pass_through.writtenpremium        AS writtenpremium,
                exp_policy_pass_through.paidlosses            AS paidlosses,
                exp_policy_pass_through.paidnumberofclaims    AS paidnumberofclaims,
                exp_policy_pass_through.outstandinglosses     AS outstandingloesses,
                exp_policy_pass_through.outstandingnoofclaims AS outstandingnoofclaims,
                exp_policy_pass_through.policynumber          AS policynumber,
                exp_policy_pass_through.policyperiodid        AS policyperiodid,
                exp_policy_pass_through.policyidentifier      AS policyidentifier1,
                current_timestamp                             AS creationts,
                ''0''                                           AS creationid,
                current_timestamp                             AS updatets,
                ''0''                                           AS updateid,
                exp_policy_pass_through.source_record_id
         FROM   exp_policy_pass_through );
  -- Component OUT_NAIIPCI_SF1, Type TARGET
  INSERT INTO db_t_prod_comn.out_naiipci_sf
              (
                          companynumber,
                          lineofbusinesscode,
                          statecode,
                          callyear,
                          accountingyear,
                          expperiodyear,
                          expperiodmonth,
                          expperiodday,
                          occupancycode,
                          territorycode,
                          stateexceptionindicator,
                          zipcode,
                          policyeffectiveyear,
                          newrecordformat,
                          aslob,
                          itemcode,
                          sublinecode,
                          policyformcode,
                          buildingcontentscode,
                          constructioncode,
                          protectionclasscode,
                          exceptioncode,
                          typeofdeductiblecode,
                          policytermcode,
                          typeoflosscode,
                          stateexceptionb,
                          amountofinsurance,
                          yearofconstruction,
                          coveragecodeordlaw,
                          deductibleindicator,
                          deductibleamount,
                          deductibleindicatorws,
                          deductibleamountws,
                          claimidentifier,
                          claimantidentifier,
                          writtenexposure,
                          writtenpremium,
                          paidlosses,
                          paidnumberofclaims,
                          outstandinglosses,
                          outstandingnoofclaims,
                          policynumber,
                          policyperiodid,
                          creationts,
                          creationuid,
                          updatets,
                          updateuid,
                          policyidentifier
              )
  SELECT exp_default.companynumber           AS companynumber,
         exp_default.lineofbusinesscode      AS lineofbusinesscode,
         exp_default.statecode               AS statecode,
         exp_default.callyear                AS callyear,
         exp_default.accountingyear          AS accountingyear,
         exp_default.expperiodyear           AS expperiodyear,
         exp_default.expperiodmonth          AS expperiodmonth,
         exp_default.expeperiodday           AS expperiodday,
         exp_default.occupancycode           AS occupancycode,
         exp_default.territorycode1          AS territorycode,
         exp_default.stateexceptioncodeb     AS stateexceptionindicator,
         exp_default.zipcode                 AS zipcode,
         exp_default.policyeffectiveyear     AS policyeffectiveyear,
         exp_default.newrecordformat         AS newrecordformat,
         exp_default.aslob                   AS aslob,
         exp_default.itemcode                AS itemcode,
         exp_default.sublinecode             AS sublinecode,
         exp_default.policyformcode          AS policyformcode,
         exp_default.buildingcontents        AS buildingcontentscode,
         exp_default.constructioncode        AS constructioncode,
         exp_default.protectionclasscosse    AS protectionclasscode,
         exp_default.exceptioncode           AS exceptioncode,
         exp_default.typeofdeductible        AS typeofdeductiblecode,
         exp_default.policytermcode1         AS policytermcode,
         exp_default.typeoflosscode          AS typeoflosscode,
         exp_default.stateofexceptioncode    AS stateexceptionb,
         exp_default.amountofinsurance1      AS amountofinsurance,
         exp_default.yearofconstru           AS yearofconstruction,
         exp_default.coveragecodeb           AS coveragecodeordlaw,
         exp_default.deductibleindicator     AS deductibleindicator,
         exp_default.deductibleamount        AS deductibleamount,
         exp_default.deductiblewindindicator AS deductibleindicatorws,
         exp_default.deductiblewindamount1   AS deductibleamountws,
         exp_default.claimidentifer          AS claimidentifier,
         exp_default.claimantidentifier      AS claimantidentifier,
         exp_default.writtenexposure         AS writtenexposure,
         exp_default.writtenpremium          AS writtenpremium,
         exp_default.paidlosses              AS paidlosses,
         exp_default.paidnumberofclaims      AS paidnumberofclaims,
         exp_default.outstandingloesses      AS outstandinglosses,
         exp_default.outstandingnoofclaims   AS outstandingnoofclaims,
         exp_default.policynumber            AS policynumber,
         exp_default.policyperiodid          AS policyperiodid,
         exp_default.creationts              AS creationts,
         exp_default.creationid              AS creationuid,
         exp_default.updatets                AS updatets,
         exp_default.updateid                AS updateuid,
         exp_default.policyidentifier1       AS policyidentifier
  FROM   exp_default;
  
  -- PIPELINE END FOR 2
END;
';