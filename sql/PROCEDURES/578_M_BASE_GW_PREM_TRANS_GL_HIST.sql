-- Object Type: PROCEDURES
CREATE OR REPLACE PROCEDURE ALFA_EDW_DEV.PUBLIC.M_BASE_GW_PREM_TRANS_GL_HIST("WORKLET_NAME" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS ' DECLARE
  GL_END_MTH_ID STRING;
  GL_START_MTH_ID STRING;
  PRCS_ID STRING;
  P_LOAD_USER STRING;
  run_id STRING;
  workflow_name STRING;
  session_name STRING;
BEGIN
  run_id := public.func_get_scoped_param(:run_id, ''run_id'', :workflow_name, :worklet_name, :session_name);
  workflow_name := public.func_get_scoped_param(:run_id, ''workflow_name'', :workflow_name, :worklet_name, :session_name);
  session_name := public.func_get_scoped_param(:run_id, ''session_name'', :workflow_name, :worklet_name, :session_name);

  GL_END_MTH_ID := public.func_get_scoped_param(:run_id, ''gl_end_mth_id'', :workflow_name, :worklet_name, :session_name);
  GL_START_MTH_ID := public.func_get_scoped_param(:run_id, ''gl_start_mth_id'', :workflow_name, :worklet_name, :session_name);
  PRCS_ID := public.func_get_scoped_param(:run_id, ''prcs_id'', :workflow_name, :worklet_name, :session_name);
  P_LOAD_USER := public.func_get_scoped_param(:run_id, ''p_load_user'', :workflow_name, :worklet_name, :session_name);
 

-- Component SQ_GW_PREMIUM_TRANS1, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_GW_PREMIUM_TRANS1 AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as BATCH_TYPE,
$2 as BATCH_DATE,
$3 as BATCH_SEQ_NBR,
$4 as TRANS_SEQ_NBR,
$5 as SOURCE_CD,
$6 as ACCOUNTING_MO,
$7 as ACCOUNTING_YR,
$8 as ACCOUNTING_DT,
$9 as POLICY_NBR,
$10 as AGENT_NBR,
$11 as SERVICE_CENTER,
$12 as UNDERWRITING_CMPY_CD,
$13 as UNDERWRITING_CMPY_DESC,
$14 as RISK_STATE_CD,
$15 as ASSIGNED_RISK_IND,
$16 as POLICY_TYPE,
$17 as POLICY_TYPE_DESC,
$18 as LINE_OF_BUS_CD,
$19 as POLICY_CENTER_ACCT,
$20 as POLICY_EFF_DT,
$21 as POLICY_EXP_DT,
$22 as POLICY_TERM,
$23 as POLICY_TERM_NBR,
$24 as POLICY_MODEL_NBR,
$25 as POLICY_HLDR_LST_NM,
$26 as POLICY_HLDR_FST_NM,
$27 as TRANS_TYPE_CD,
$28 as TRANS_PUBLIC_ID,
$29 as PROP_PROTECT_CLASS,
$30 as PROP_CONSTR_TYPE,
$31 as PROP_CONSTR_NM,
$32 as PROP_OCCUPANCY,
$33 as COV_TYPE_CD,
$34 as COV_TYPE_DESC,
$35 as TRANS_EFF_DT,
$36 as TRANS_EXP_DT,
$37 as COMM_TRANS_CD,
$38 as COMM_IND,
$39 as COMM_MO,
$40 as COMM_YR,
$41 as COMM_RATE_OVERRIDE,
$42 as EFF_TYPE_CD,
$43 as EFF_TYPE_CD_DESC,
$44 as AGT_PROD_OVERRIDE,
$45 as SECTION_TYPE,
$46 as PERIL_TYPE,
$47 as PREMIUM_TRANS_AMT,
$48 as BUS_ACT_TRNS_OBJ,
$49 as BUS_ACT_TRNS_ACT,
$50 as PRIOR_TRM_CANCEL_DT,
$51 as PRIOR_TRM_CANCEL_RSN,
$52 as RNT_DAYS_ELAPSED,
$53 as COV_EFF_DT,
$54 as COV_EXP_DT,
$55 as BUSINESS_TYPE_CD,
$56 as TRANSACTION_CAT,
$57 as ISSUE_DT,
$58 as ISSUE_TM,
$59 as CANC_RSN_CD,
$60 as GW_CANC_RSN,
$61 as UNIT_REFERENCE_NBR,
$62 as MUNI_TAX_UNIT_ORIG_DT,
$63 as VEH_ORIG_EFF_DT,
$64 as VEH_REPLACEMENT_IND,
$65 as VEH_ADD_REMOVAL_CD,
$66 as NEW_BUSINESS_TERM,
$67 as INCEPTION_DT,
$68 as UNIT_TYPE_CD,
$69 as UNIT_TYPE_NM,
$70 as TAX_CD,
$71 as TAX_YR,
$72 as TAX_PREM_TYPE,
$73 as REWRITE_CD,
$74 as COMPANY_CHG_IND,
$75 as TIER_RATING_CD,
$76 as TRNS_EARN_PREM_AMT,
$77 as TRNS_UNEARN_PREM_AMT,
$78 as FULLY_EARNED_COV_IND,
$79 as FULLY_EARNED_IND,
$80 as EARNINGS_AS_OF_DT,
$81 as DAYS_IN_TERM,
$82 as PREM_PER_DAY,
$83 as DAYS_EARNED,
$84 as DAYS_UNEARNED,
$85 as CREATE_TS,
$86 as TERRITORY_CD,
$87 as DRIVER_CLASS_CD,
$88 as GL_EXTR_MO,
$89 as GL_EXTR_YR,
$90 as GL_PREM_TYPE,
$91 as PS_ACCOUNTING_MO,
$92 as PS_ACCOUNTING_YR,
$93 as BUSINESS_UNIT,
$94 as TRANSACTION_ID,
$95 as BILLING_REF_NBR,
$96 as PS_DTTM_STAMP,
$97 as LEDGER,
$98 as JOURNAL_ID,
$99 as JOURNAL_LINE,
$100 as JOURNAL_DATE,
$101 as GL_ACCOUNT_NBR,
$102 as DEPTID,
$103 as PRODUCT,
$104 as INVOICE_NBR,
$105 as PS_COMPANY_CD,
$106 as PS_STATE,
$107 as PS_POOL_CD,
$108 as GL_RECORD_TAG,
$109 as MASTER_CMPY_NBR,
$110 as BRANCH_NBR,
$111 as STATE_CD,
$112 as COV_CD,
$113 as INSURANCE_LINE_CD,
$114 as TRANS_SOURCE_CD,
$115 as REINSURANCE_CD,
$116 as GL_DISTRIB_STATUS,
$117 as PROCESS_INSTANCE,
$118 as ROW_PROC_IND,
$119 as ROW_PROC_TS,
$120 as ROW_PRC_IND_ERR,
$121 as LAST_UPDATE_PROG,
$122 as INTG_EVNT_STG_ID,
$123 as COMM_PROC_IND,
$124 as COMM_PROC_TS,
$125 as VEHREPL_PROC_CD,
$126 as VEHREPL_UNIT_REF_NBR,
$127 as CAN_NONPMT_60DAYS_IND,
$128 as FLAT_CAN_IND,
$129 as PRIOR_TRMCANNONPMT60DAY_IND,
$130 as PRIOR_TRM_FLAT_CAN_IND,
$131 as COMM_NB_IND,
$132 as COMM_RN_IND,
$133 as BUSINESS_TYPE,
$134 as BOPCHU_POLCHG_PREM_INCR_CD,
$135 as PROP_ONLY_IND,
$136 as LIAB_ONLY_IND,
$137 as AGTRECD_PROC_CD,
$138 as USER_ID,
$139 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT GW_PREMIUM_TRANS.BATCH_TYPE, GW_PREMIUM_TRANS.BATCH_DATE, GW_PREMIUM_TRANS.BATCH_SEQ_NBR, GW_PREMIUM_TRANS.TRANS_SEQ_NBR, GW_PREMIUM_TRANS.SOURCE_CD, GW_PREMIUM_TRANS.ACCOUNTING_MO, GW_PREMIUM_TRANS.ACCOUNTING_YR, GW_PREMIUM_TRANS.ACCOUNTING_DT, GW_PREMIUM_TRANS.POLICY_NBR, GW_PREMIUM_TRANS.AGENT_NBR, GW_PREMIUM_TRANS.SERVICE_CENTER, GW_PREMIUM_TRANS.UNDERWRITING_CMPY_CD, GW_PREMIUM_TRANS.UNDERWRITING_CMPY_DESC, GW_PREMIUM_TRANS.RISK_STATE_CD, GW_PREMIUM_TRANS.ASSIGNED_RISK_IND, GW_PREMIUM_TRANS.POLICY_TYPE, GW_PREMIUM_TRANS.POLICY_TYPE_DESC, GW_PREMIUM_TRANS.LINE_OF_BUS_CD, GW_PREMIUM_TRANS.POLICY_CENTER_ACCT, GW_PREMIUM_TRANS.POLICY_EFF_DT, GW_PREMIUM_TRANS.POLICY_EXP_DT, GW_PREMIUM_TRANS.POLICY_TERM, GW_PREMIUM_TRANS.POLICY_TERM_NBR, GW_PREMIUM_TRANS.POLICY_MODEL_NBR, GW_PREMIUM_TRANS.POLICY_HLDR_LST_NM, GW_PREMIUM_TRANS.POLICY_HLDR_FST_NM, GW_PREMIUM_TRANS.TRANS_TYPE_CD, GW_PREMIUM_TRANS.TRANS_PUBLIC_ID, GW_PREMIUM_TRANS.PROP_PROTECT_CLASS, GW_PREMIUM_TRANS.PROP_CONSTR_TYPE, GW_PREMIUM_TRANS.PROP_CONSTR_NM, GW_PREMIUM_TRANS.PROP_OCCUPANCY, GW_PREMIUM_TRANS.COV_TYPE_CD, GW_PREMIUM_TRANS.COV_TYPE_DESC, GW_PREMIUM_TRANS.TRANS_EFF_DT, GW_PREMIUM_TRANS.TRANS_EXP_DT, GW_PREMIUM_TRANS.COMM_TRANS_CD, GW_PREMIUM_TRANS.COMM_IND, GW_PREMIUM_TRANS.COMM_MO, GW_PREMIUM_TRANS.COMM_YR, GW_PREMIUM_TRANS.COMM_RATE_OVERRIDE, GW_PREMIUM_TRANS.EFF_TYPE_CD, GW_PREMIUM_TRANS.EFF_TYPE_CD_DESC, GW_PREMIUM_TRANS.AGT_PROD_OVERRIDE, GW_PREMIUM_TRANS.SECTION_TYPE, GW_PREMIUM_TRANS.PERIL_TYPE, GW_PREMIUM_TRANS.PREMIUM_TRANS_AMT, GW_PREMIUM_TRANS.BUS_ACT_TRNS_OBJ, GW_PREMIUM_TRANS.BUS_ACT_TRNS_ACT, GW_PREMIUM_TRANS.PRIOR_TRM_CANCEL_DT, GW_PREMIUM_TRANS.PRIOR_TRM_CANCEL_RSN, GW_PREMIUM_TRANS.RNT_DAYS_ELAPSED, GW_PREMIUM_TRANS.COV_EFF_DT, GW_PREMIUM_TRANS.COV_EXP_DT, GW_PREMIUM_TRANS.BUSINESS_TYPE_CD, GW_PREMIUM_TRANS.TRANSACTION_CAT, GW_PREMIUM_TRANS.ISSUE_DT, GW_PREMIUM_TRANS.ISSUE_TM, GW_PREMIUM_TRANS.CANC_RSN_CD, GW_PREMIUM_TRANS.GW_CANC_RSN, GW_PREMIUM_TRANS.UNIT_REFERENCE_NBR, GW_PREMIUM_TRANS.MUNI_TAX_UNIT_ORIG_DT, GW_PREMIUM_TRANS.VEH_ORIG_EFF_DT, GW_PREMIUM_TRANS.VEH_REPLACEMENT_IND, GW_PREMIUM_TRANS.VEH_ADD_REMOVAL_CD, GW_PREMIUM_TRANS.NEW_BUSINESS_TERM, GW_PREMIUM_TRANS.INCEPTION_DT, GW_PREMIUM_TRANS.UNIT_TYPE_CD, GW_PREMIUM_TRANS.UNIT_TYPE_NM, GW_PREMIUM_TRANS.TAX_CD, GW_PREMIUM_TRANS.TAX_YR, GW_PREMIUM_TRANS.TAX_PREM_TYPE, GW_PREMIUM_TRANS.REWRITE_CD, GW_PREMIUM_TRANS.COMPANY_CHG_IND, GW_PREMIUM_TRANS.TIER_RATING_CD, GW_PREMIUM_TRANS.TRNS_EARN_PREM_AMT, GW_PREMIUM_TRANS.TRNS_UNEARN_PREM_AMT, GW_PREMIUM_TRANS.FULLY_EARNED_COV_IND, GW_PREMIUM_TRANS.FULLY_EARNED_IND, GW_PREMIUM_TRANS.EARNINGS_AS_OF_DT, GW_PREMIUM_TRANS.DAYS_IN_TERM, GW_PREMIUM_TRANS.PREM_PER_DAY, GW_PREMIUM_TRANS.DAYS_EARNED, GW_PREMIUM_TRANS.DAYS_UNEARNED, GW_PREMIUM_TRANS.CREATE_TS, GW_PREMIUM_TRANS.TERRITORY_CD, GW_PREMIUM_TRANS.DRIVER_CLASS_CD, GW_PREMIUM_TRANS.GL_EXTR_MO, GW_PREMIUM_TRANS.GL_EXTR_YR, GW_PREMIUM_TRANS.GL_PREM_TYPE, GW_PREMIUM_TRANS.PS_ACCOUNTING_MO, GW_PREMIUM_TRANS.PS_ACCOUNTING_YR, GW_PREMIUM_TRANS.BUSINESS_UNIT, GW_PREMIUM_TRANS.TRANSACTION_ID, GW_PREMIUM_TRANS.BILLING_REF_NBR, GW_PREMIUM_TRANS.PS_DTTM_STAMP, GW_PREMIUM_TRANS.LEDGER, GW_PREMIUM_TRANS.JOURNAL_ID, GW_PREMIUM_TRANS.JOURNAL_LINE, GW_PREMIUM_TRANS.JOURNAL_DATE, GW_PREMIUM_TRANS.GL_ACCOUNT_NBR, GW_PREMIUM_TRANS.DEPTID, GW_PREMIUM_TRANS.PRODUCT, GW_PREMIUM_TRANS.INVOICE_NBR, GW_PREMIUM_TRANS.PS_COMPANY_CD, GW_PREMIUM_TRANS.PS_STATE, GW_PREMIUM_TRANS.PS_POOL_CD, GW_PREMIUM_TRANS.GL_RECORD_TAG, GW_PREMIUM_TRANS.MASTER_CMPY_NBR, GW_PREMIUM_TRANS.BRANCH_NBR, GW_PREMIUM_TRANS.STATE_CD, GW_PREMIUM_TRANS.COV_CD, GW_PREMIUM_TRANS.INSURANCE_LINE_CD, GW_PREMIUM_TRANS.TRANS_SOURCE_CD, GW_PREMIUM_TRANS.REINSURANCE_CD, GW_PREMIUM_TRANS.GL_DISTRIB_STATUS, GW_PREMIUM_TRANS.PROCESS_INSTANCE, GW_PREMIUM_TRANS.ROW_PROC_IND, GW_PREMIUM_TRANS.ROW_PROC_TS, GW_PREMIUM_TRANS.ROW_PRC_IND_ERR, GW_PREMIUM_TRANS.LAST_UPDATE_PROG, GW_PREMIUM_TRANS.INTG_EVNT_STG_ID, GW_PREMIUM_TRANS.COMM_PROC_IND, GW_PREMIUM_TRANS.COMM_PROC_TS, GW_PREMIUM_TRANS.VEHREPL_PROC_CD, GW_PREMIUM_TRANS.VEHREPL_UNIT_REF_NBR, GW_PREMIUM_TRANS.CAN_NONPMT_60DAYS_IND, GW_PREMIUM_TRANS.FLAT_CAN_IND, GW_PREMIUM_TRANS.PRIOR_TRMCANNONPMT60DAY_IND, GW_PREMIUM_TRANS.PRIOR_TRM_FLAT_CAN_IND, GW_PREMIUM_TRANS.COMM_NB_IND, GW_PREMIUM_TRANS.COMM_RN_IND, GW_PREMIUM_TRANS.BUSINESS_TYPE, GW_PREMIUM_TRANS.BOPCHU_POLCHG_PREM_INCR_CD, GW_PREMIUM_TRANS.PROP_ONLY_IND, GW_PREMIUM_TRANS.LIAB_ONLY_IND, GW_PREMIUM_TRANS.AGTRECD_PROC_CD, GW_PREMIUM_TRANS.USER_ID 

FROM

 --POLDATA.GW_PREMIUM_TRANS GW_PREMIUM_TRANS
 db_t_prod_stag.GW_PREMIUM_TRANS GW_PREMIUM_TRANS


where BATCH_TYPE=''GL ROW'' 

and  GL_EXTR_YR*100+GL_EXTR_MO >= :GL_START_MTH_ID 

and  GL_EXTR_YR*100+GL_EXTR_MO <= :GL_END_MTH_ID 

and row_proc_ind = ''PROCESS''
) SRC
)
);


-- Component EXPTRANS, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE EXPTRANS AS
(
SELECT
SQ_GW_PREMIUM_TRANS1.BATCH_TYPE as BATCH_TYPE,
SQ_GW_PREMIUM_TRANS1.BATCH_DATE as BATCH_DATE,
SQ_GW_PREMIUM_TRANS1.BATCH_SEQ_NBR as BATCH_SEQ_NBR,
SQ_GW_PREMIUM_TRANS1.TRANS_SEQ_NBR as TRANS_SEQ_NBR,
SQ_GW_PREMIUM_TRANS1.SOURCE_CD as SOURCE_CD,
SQ_GW_PREMIUM_TRANS1.ACCOUNTING_MO as ACCOUNTING_MO,
SQ_GW_PREMIUM_TRANS1.ACCOUNTING_YR as ACCOUNTING_YR,
SQ_GW_PREMIUM_TRANS1.ACCOUNTING_DT as ACCOUNTING_DT,
SQ_GW_PREMIUM_TRANS1.POLICY_NBR as POLICY_NBR,
SQ_GW_PREMIUM_TRANS1.AGENT_NBR as AGENT_NBR,
SQ_GW_PREMIUM_TRANS1.SERVICE_CENTER as SERVICE_CENTER,
SQ_GW_PREMIUM_TRANS1.UNDERWRITING_CMPY_CD as UNDERWRITING_CMPY_CD,
SQ_GW_PREMIUM_TRANS1.UNDERWRITING_CMPY_DESC as UNDERWRITING_CMPY_DESC,
SQ_GW_PREMIUM_TRANS1.RISK_STATE_CD as RISK_STATE_CD,
SQ_GW_PREMIUM_TRANS1.ASSIGNED_RISK_IND as ASSIGNED_RISK_IND,
SQ_GW_PREMIUM_TRANS1.POLICY_TYPE as POLICY_TYPE,
SQ_GW_PREMIUM_TRANS1.POLICY_TYPE_DESC as POLICY_TYPE_DESC,
SQ_GW_PREMIUM_TRANS1.LINE_OF_BUS_CD as LINE_OF_BUS_CD,
SQ_GW_PREMIUM_TRANS1.POLICY_CENTER_ACCT as POLICY_CENTER_ACCT,
SQ_GW_PREMIUM_TRANS1.POLICY_EFF_DT as POLICY_EFF_DT,
SQ_GW_PREMIUM_TRANS1.POLICY_EXP_DT as POLICY_EXP_DT,
SQ_GW_PREMIUM_TRANS1.POLICY_TERM as POLICY_TERM,
SQ_GW_PREMIUM_TRANS1.POLICY_TERM_NBR as POLICY_TERM_NBR,
SQ_GW_PREMIUM_TRANS1.POLICY_MODEL_NBR as POLICY_MODEL_NBR,
SQ_GW_PREMIUM_TRANS1.POLICY_HLDR_LST_NM as POLICY_HLDR_LST_NM,
SQ_GW_PREMIUM_TRANS1.POLICY_HLDR_FST_NM as POLICY_HLDR_FST_NM,
SQ_GW_PREMIUM_TRANS1.TRANS_TYPE_CD as TRANS_TYPE_CD,
SQ_GW_PREMIUM_TRANS1.TRANS_PUBLIC_ID as TRANS_PUBLIC_ID,
SQ_GW_PREMIUM_TRANS1.PROP_PROTECT_CLASS as PROP_PROTECT_CLASS,
SQ_GW_PREMIUM_TRANS1.PROP_CONSTR_TYPE as PROP_CONSTR_TYPE,
SQ_GW_PREMIUM_TRANS1.PROP_CONSTR_NM as PROP_CONSTR_NM,
SQ_GW_PREMIUM_TRANS1.PROP_OCCUPANCY as PROP_OCCUPANCY,
SQ_GW_PREMIUM_TRANS1.COV_TYPE_CD as COV_TYPE_CD,
SQ_GW_PREMIUM_TRANS1.COV_TYPE_DESC as COV_TYPE_DESC,
SQ_GW_PREMIUM_TRANS1.TRANS_EFF_DT as TRANS_EFF_DT,
SQ_GW_PREMIUM_TRANS1.TRANS_EXP_DT as TRANS_EXP_DT,
SQ_GW_PREMIUM_TRANS1.COMM_TRANS_CD as COMM_TRANS_CD,
SQ_GW_PREMIUM_TRANS1.COMM_IND as COMM_IND,
SQ_GW_PREMIUM_TRANS1.COMM_MO as COMM_MO,
SQ_GW_PREMIUM_TRANS1.COMM_YR as COMM_YR,
SQ_GW_PREMIUM_TRANS1.COMM_RATE_OVERRIDE as COMM_RATE_OVERRIDE,
SQ_GW_PREMIUM_TRANS1.EFF_TYPE_CD as EFF_TYPE_CD,
SQ_GW_PREMIUM_TRANS1.EFF_TYPE_CD_DESC as EFF_TYPE_CD_DESC,
SQ_GW_PREMIUM_TRANS1.AGT_PROD_OVERRIDE as AGT_PROD_OVERRIDE,
SQ_GW_PREMIUM_TRANS1.SECTION_TYPE as SECTION_TYPE,
SQ_GW_PREMIUM_TRANS1.PERIL_TYPE as PERIL_TYPE,
SQ_GW_PREMIUM_TRANS1.PREMIUM_TRANS_AMT as PREMIUM_TRANS_AMT,
SQ_GW_PREMIUM_TRANS1.BUS_ACT_TRNS_OBJ as BUS_ACT_TRNS_OBJ,
SQ_GW_PREMIUM_TRANS1.BUS_ACT_TRNS_ACT as BUS_ACT_TRNS_ACT,
SQ_GW_PREMIUM_TRANS1.PRIOR_TRM_CANCEL_DT as PRIOR_TRM_CANCEL_DT,
SQ_GW_PREMIUM_TRANS1.PRIOR_TRM_CANCEL_RSN as PRIOR_TRM_CANCEL_RSN,
SQ_GW_PREMIUM_TRANS1.RNT_DAYS_ELAPSED as RNT_DAYS_ELAPSED,
SQ_GW_PREMIUM_TRANS1.COV_EFF_DT as COV_EFF_DT,
SQ_GW_PREMIUM_TRANS1.COV_EXP_DT as COV_EXP_DT,
SQ_GW_PREMIUM_TRANS1.BUSINESS_TYPE_CD as BUSINESS_TYPE_CD,
SQ_GW_PREMIUM_TRANS1.TRANSACTION_CAT as TRANSACTION_CAT,
SQ_GW_PREMIUM_TRANS1.ISSUE_DT as ISSUE_DT,
SQ_GW_PREMIUM_TRANS1.ISSUE_TM as ISSUE_TM,
SQ_GW_PREMIUM_TRANS1.CANC_RSN_CD as CANC_RSN_CD,
SQ_GW_PREMIUM_TRANS1.GW_CANC_RSN as GW_CANC_RSN,
SQ_GW_PREMIUM_TRANS1.UNIT_REFERENCE_NBR as UNIT_REFERENCE_NBR,
SQ_GW_PREMIUM_TRANS1.MUNI_TAX_UNIT_ORIG_DT as MUNI_TAX_UNIT_ORIG_DT,
SQ_GW_PREMIUM_TRANS1.VEH_ORIG_EFF_DT as VEH_ORIG_EFF_DT,
SQ_GW_PREMIUM_TRANS1.VEH_REPLACEMENT_IND as VEH_REPLACEMENT_IND,
SQ_GW_PREMIUM_TRANS1.VEH_ADD_REMOVAL_CD as VEH_ADD_REMOVAL_CD,
SQ_GW_PREMIUM_TRANS1.NEW_BUSINESS_TERM as NEW_BUSINESS_TERM,
SQ_GW_PREMIUM_TRANS1.INCEPTION_DT as INCEPTION_DT,
SQ_GW_PREMIUM_TRANS1.UNIT_TYPE_CD as UNIT_TYPE_CD,
SQ_GW_PREMIUM_TRANS1.UNIT_TYPE_NM as UNIT_TYPE_NM,
SQ_GW_PREMIUM_TRANS1.TAX_CD as TAX_CD,
SQ_GW_PREMIUM_TRANS1.TAX_YR as TAX_YR,
SQ_GW_PREMIUM_TRANS1.TAX_PREM_TYPE as TAX_PREM_TYPE,
SQ_GW_PREMIUM_TRANS1.REWRITE_CD as REWRITE_CD,
SQ_GW_PREMIUM_TRANS1.COMPANY_CHG_IND as COMPANY_CHG_IND,
SQ_GW_PREMIUM_TRANS1.TIER_RATING_CD as TIER_RATING_CD,
SQ_GW_PREMIUM_TRANS1.TRNS_EARN_PREM_AMT as TRNS_EARN_PREM_AMT,
SQ_GW_PREMIUM_TRANS1.TRNS_UNEARN_PREM_AMT as TRNS_UNEARN_PREM_AMT,
SQ_GW_PREMIUM_TRANS1.FULLY_EARNED_COV_IND as FULLY_EARNED_COV_IND,
SQ_GW_PREMIUM_TRANS1.FULLY_EARNED_IND as FULLY_EARNED_IND,
SQ_GW_PREMIUM_TRANS1.EARNINGS_AS_OF_DT as EARNINGS_AS_OF_DT,
SQ_GW_PREMIUM_TRANS1.DAYS_IN_TERM as DAYS_IN_TERM,
SQ_GW_PREMIUM_TRANS1.PREM_PER_DAY as PREM_PER_DAY,
SQ_GW_PREMIUM_TRANS1.DAYS_EARNED as DAYS_EARNED,
SQ_GW_PREMIUM_TRANS1.DAYS_UNEARNED as DAYS_UNEARNED,
SQ_GW_PREMIUM_TRANS1.CREATE_TS as CREATE_TS,
SQ_GW_PREMIUM_TRANS1.TERRITORY_CD as TERRITORY_CD,
SQ_GW_PREMIUM_TRANS1.DRIVER_CLASS_CD as DRIVER_CLASS_CD,
SQ_GW_PREMIUM_TRANS1.GL_EXTR_MO as GL_EXTR_MO,
SQ_GW_PREMIUM_TRANS1.GL_EXTR_YR as GL_EXTR_YR,
SQ_GW_PREMIUM_TRANS1.GL_PREM_TYPE as GL_PREM_TYPE,
SQ_GW_PREMIUM_TRANS1.PS_ACCOUNTING_MO as PS_ACCOUNTING_MO,
SQ_GW_PREMIUM_TRANS1.PS_ACCOUNTING_YR as PS_ACCOUNTING_YR,
SQ_GW_PREMIUM_TRANS1.BUSINESS_UNIT as BUSINESS_UNIT,
SQ_GW_PREMIUM_TRANS1.TRANSACTION_ID as TRANSACTION_ID,
SQ_GW_PREMIUM_TRANS1.BILLING_REF_NBR as BILLING_REF_NBR,
SQ_GW_PREMIUM_TRANS1.PS_DTTM_STAMP as PS_DTTM_STAMP,
SQ_GW_PREMIUM_TRANS1.LEDGER as LEDGER,
SQ_GW_PREMIUM_TRANS1.JOURNAL_ID as JOURNAL_ID,
SQ_GW_PREMIUM_TRANS1.JOURNAL_LINE as JOURNAL_LINE,
SQ_GW_PREMIUM_TRANS1.JOURNAL_DATE as JOURNAL_DATE,
SQ_GW_PREMIUM_TRANS1.GL_ACCOUNT_NBR as GL_ACCOUNT_NBR,
SQ_GW_PREMIUM_TRANS1.DEPTID as DEPTID,
SQ_GW_PREMIUM_TRANS1.PRODUCT as PRODUCT,
SQ_GW_PREMIUM_TRANS1.INVOICE_NBR as INVOICE_NBR,
SQ_GW_PREMIUM_TRANS1.PS_COMPANY_CD as PS_COMPANY_CD,
SQ_GW_PREMIUM_TRANS1.PS_STATE as PS_STATE,
SQ_GW_PREMIUM_TRANS1.PS_POOL_CD as PS_POOL_CD,
SQ_GW_PREMIUM_TRANS1.GL_RECORD_TAG as GL_RECORD_TAG,
SQ_GW_PREMIUM_TRANS1.MASTER_CMPY_NBR as MASTER_CMPY_NBR,
SQ_GW_PREMIUM_TRANS1.BRANCH_NBR as BRANCH_NBR,
SQ_GW_PREMIUM_TRANS1.STATE_CD as STATE_CD,
SQ_GW_PREMIUM_TRANS1.COV_CD as COV_CD,
SQ_GW_PREMIUM_TRANS1.INSURANCE_LINE_CD as INSURANCE_LINE_CD,
SQ_GW_PREMIUM_TRANS1.TRANS_SOURCE_CD as TRANS_SOURCE_CD,
SQ_GW_PREMIUM_TRANS1.REINSURANCE_CD as REINSURANCE_CD,
SQ_GW_PREMIUM_TRANS1.GL_DISTRIB_STATUS as GL_DISTRIB_STATUS,
SQ_GW_PREMIUM_TRANS1.PROCESS_INSTANCE as PROCESS_INSTANCE,
SQ_GW_PREMIUM_TRANS1.ROW_PROC_IND as ROW_PROC_IND,
SQ_GW_PREMIUM_TRANS1.ROW_PROC_TS as ROW_PROC_TS,
SQ_GW_PREMIUM_TRANS1.ROW_PRC_IND_ERR as ROW_PRC_IND_ERR,
SQ_GW_PREMIUM_TRANS1.LAST_UPDATE_PROG as LAST_UPDATE_PROG,
SQ_GW_PREMIUM_TRANS1.INTG_EVNT_STG_ID as INTG_EVNT_STG_ID,
SQ_GW_PREMIUM_TRANS1.COMM_PROC_IND as COMM_PROC_IND,
SQ_GW_PREMIUM_TRANS1.COMM_PROC_TS as COMM_PROC_TS,
SQ_GW_PREMIUM_TRANS1.VEHREPL_PROC_CD as VEHREPL_PROC_CD,
SQ_GW_PREMIUM_TRANS1.VEHREPL_UNIT_REF_NBR as VEHREPL_UNIT_REF_NBR,
SQ_GW_PREMIUM_TRANS1.CAN_NONPMT_60DAYS_IND as CAN_NONPMT_60DAYS_IND,
SQ_GW_PREMIUM_TRANS1.FLAT_CAN_IND as FLAT_CAN_IND,
SQ_GW_PREMIUM_TRANS1.PRIOR_TRMCANNONPMT60DAY_IND as PRIOR_TRMCANNONPMT60DAY_IND,
SQ_GW_PREMIUM_TRANS1.PRIOR_TRM_FLAT_CAN_IND as PRIOR_TRM_FLAT_CAN_IND,
SQ_GW_PREMIUM_TRANS1.COMM_NB_IND as COMM_NB_IND,
SQ_GW_PREMIUM_TRANS1.COMM_RN_IND as COMM_RN_IND,
SQ_GW_PREMIUM_TRANS1.BUSINESS_TYPE as BUSINESS_TYPE,
SQ_GW_PREMIUM_TRANS1.BOPCHU_POLCHG_PREM_INCR_CD as BOPCHU_POLCHG_PREM_INCR_CD,
SQ_GW_PREMIUM_TRANS1.PROP_ONLY_IND as PROP_ONLY_IND,
SQ_GW_PREMIUM_TRANS1.LIAB_ONLY_IND as LIAB_ONLY_IND,
SQ_GW_PREMIUM_TRANS1.AGTRECD_PROC_CD as AGTRECD_PROC_CD,
1 as CTL_ID,
:PRCS_ID as PROCESS_ID,
:p_load_user as LOAD_USER,
CURRENT_TIMESTAMP as LOAD_DATE,
SQ_GW_PREMIUM_TRANS1.USER_ID as USER_ID,
SQ_GW_PREMIUM_TRANS1.source_record_id
FROM
SQ_GW_PREMIUM_TRANS1
);


-- Component GW_PREM_TRANS_GL_HIST, Type TARGET 
INSERT INTO db_t_prod_comn.GW_PREM_TRANS_GL_HIST
(
BATCH_TYPE,
BATCH_DATE,
BATCH_SEQ_NBR,
TRANS_SEQ_NBR,
SOURCE_CD,
ACCOUNTING_MO,
ACCOUNTING_YR,
ACCOUNTING_DT,
POLICY_NBR,
AGENT_NBR,
SERVICE_CENTER,
UNDERWRITING_CMPY_CD,
UNDERWRITING_CMPY_DESC,
RISK_STATE_CD,
ASSIGNED_RISK_IND,
POLICY_TYPE,
POLICY_TYPE_DESC,
LINE_OF_BUS_CD,
POLICY_CENTER_ACCT,
POLICY_EFF_DT,
POLICY_EXP_DT,
POLICY_TERM,
POLICY_TERM_NBR,
POLICY_MODEL_NBR,
POLICY_HLDR_LST_NM,
POLICY_HLDR_FST_NM,
TRANS_TYPE_CD,
TRANS_PUBLIC_ID,
PROP_PROTECT_CLASS,
PROP_CONSTR_TYPE,
PROP_CONSTR_NM,
PROP_OCCUPANCY,
COV_TYPE_CD,
COV_TYPE_DESC,
TRANS_EFF_DT,
TRANS_EXP_DT,
COMM_TRANS_CD,
COMM_IND,
COMM_MO,
COMM_YR,
COMM_RATE_OVERRIDE,
EFF_TYPE_CD,
EFF_TYPE_CD_DESC,
AGT_PROD_OVERRIDE,
SECTION_TYPE,
PERIL_TYPE,
PREMIUM_TRANS_AMT,
BUS_ACT_TRNS_OBJ,
BUS_ACT_TRNS_ACT,
PRIOR_TRM_CANCEL_DT,
PRIOR_TRM_CANCEL_RSN,
RNT_DAYS_ELAPSED,
COV_EFF_DT,
COV_EXP_DT,
BUSINESS_TYPE_CD,
TRANSACTION_CAT,
ISSUE_DT,
ISSUE_TM,
CANC_RSN_CD,
GW_CANC_RSN,
UNIT_REFERENCE_NBR,
MUNI_TAX_UNIT_ORIG_DT,
VEH_ORIG_EFF_DT,
VEH_REPLACEMENT_IND,
VEH_ADD_REMOVAL_CD,
NEW_BUSINESS_TERM,
INCEPTION_DT,
UNIT_TYPE_CD,
UNIT_TYPE_NM,
TAX_CD,
TAX_YR,
TAX_PREM_TYPE,
REWRITE_CD,
COMPANY_CHG_IND,
TIER_RATING_CD,
TRNS_EARN_PREM_AMT,
TRNS_UNEARN_PREM_AMT,
FULLY_EARNED_COV_IND,
FULLY_EARNED_IND,
EARNINGS_AS_OF_DT,
DAYS_IN_TERM,
PREM_PER_DAY,
DAYS_EARNED,
DAYS_UNEARNED,
CREATE_TS,
TERRITORY_CD,
DRIVER_CLASS_CD,
GL_EXTR_MO,
GL_EXTR_YR,
GL_PREM_TYPE,
PS_ACCOUNTING_MO,
PS_ACCOUNTING_YR,
BUSINESS_UNIT,
TRANSACTION_ID,
BILLING_REF_NBR,
PS_DTTM_STAMP,
LEDGER,
JOURNAL_ID,
JOURNAL_LINE,
JOURNAL_DATE,
GL_ACCOUNT_NBR,
DEPTID,
PRODUCT,
INVOICE_NBR,
PS_COMPANY_CD,
PS_STATE,
PS_POOL_CD,
GL_RECORD_TAG,
MASTER_CMPY_NBR,
BRANCH_NBR,
STATE_CD,
COV_CD,
INSURANCE_LINE_CD,
TRANS_SOURCE_CD,
REINSURANCE_CD,
GL_DISTRIB_STATUS,
PROCESS_INSTANCE,
ROW_PROC_IND,
ROW_PROC_TS,
ROW_PRC_IND_ERR,
LAST_UPDATE_PROG,
INTG_EVNT_STG_ID,
COMM_PROC_IND,
COMM_PROC_TS,
VEHREPL_PROC_CD,
VEHREPL_UNIT_REF_NBR,
CAN_NONPMT_60DAYS_IND,
FLAT_CAN_IND,
PRIOR_TRMCANNONPMT60DAY_IND,
PRIOR_TRM_FLAT_CAN_IND,
COMM_NB_IND,
COMM_RN_IND,
BUSINESS_TYPE,
BOPCHU_POLCHG_PREM_INCR_CD,
PROP_ONLY_IND,
LIAB_ONLY_IND,
AGTRECD_PROC_CD,
USER_ID,
CTL_ID,
PROCESS_ID,
LOAD_USER,
LOAD_DTTM
)
SELECT
EXPTRANS.BATCH_TYPE as BATCH_TYPE,
EXPTRANS.BATCH_DATE as BATCH_DATE,
EXPTRANS.BATCH_SEQ_NBR as BATCH_SEQ_NBR,
EXPTRANS.TRANS_SEQ_NBR as TRANS_SEQ_NBR,
EXPTRANS.SOURCE_CD as SOURCE_CD,
EXPTRANS.ACCOUNTING_MO as ACCOUNTING_MO,
EXPTRANS.ACCOUNTING_YR as ACCOUNTING_YR,
EXPTRANS.ACCOUNTING_DT as ACCOUNTING_DT,
EXPTRANS.POLICY_NBR as POLICY_NBR,
EXPTRANS.AGENT_NBR as AGENT_NBR,
EXPTRANS.SERVICE_CENTER as SERVICE_CENTER,
EXPTRANS.UNDERWRITING_CMPY_CD as UNDERWRITING_CMPY_CD,
EXPTRANS.UNDERWRITING_CMPY_DESC as UNDERWRITING_CMPY_DESC,
EXPTRANS.RISK_STATE_CD as RISK_STATE_CD,
EXPTRANS.ASSIGNED_RISK_IND as ASSIGNED_RISK_IND,
EXPTRANS.POLICY_TYPE as POLICY_TYPE,
EXPTRANS.POLICY_TYPE_DESC as POLICY_TYPE_DESC,
EXPTRANS.LINE_OF_BUS_CD as LINE_OF_BUS_CD,
EXPTRANS.POLICY_CENTER_ACCT as POLICY_CENTER_ACCT,
EXPTRANS.POLICY_EFF_DT as POLICY_EFF_DT,
EXPTRANS.POLICY_EXP_DT as POLICY_EXP_DT,
EXPTRANS.POLICY_TERM as POLICY_TERM,
EXPTRANS.POLICY_TERM_NBR as POLICY_TERM_NBR,
EXPTRANS.POLICY_MODEL_NBR as POLICY_MODEL_NBR,
EXPTRANS.POLICY_HLDR_LST_NM as POLICY_HLDR_LST_NM,
EXPTRANS.POLICY_HLDR_FST_NM as POLICY_HLDR_FST_NM,
EXPTRANS.TRANS_TYPE_CD as TRANS_TYPE_CD,
EXPTRANS.TRANS_PUBLIC_ID as TRANS_PUBLIC_ID,
EXPTRANS.PROP_PROTECT_CLASS as PROP_PROTECT_CLASS,
EXPTRANS.PROP_CONSTR_TYPE as PROP_CONSTR_TYPE,
EXPTRANS.PROP_CONSTR_NM as PROP_CONSTR_NM,
EXPTRANS.PROP_OCCUPANCY as PROP_OCCUPANCY,
EXPTRANS.COV_TYPE_CD as COV_TYPE_CD,
EXPTRANS.COV_TYPE_DESC as COV_TYPE_DESC,
EXPTRANS.TRANS_EFF_DT as TRANS_EFF_DT,
EXPTRANS.TRANS_EXP_DT as TRANS_EXP_DT,
EXPTRANS.COMM_TRANS_CD as COMM_TRANS_CD,
EXPTRANS.COMM_IND as COMM_IND,
EXPTRANS.COMM_MO as COMM_MO,
EXPTRANS.COMM_YR as COMM_YR,
EXPTRANS.COMM_RATE_OVERRIDE as COMM_RATE_OVERRIDE,
EXPTRANS.EFF_TYPE_CD as EFF_TYPE_CD,
EXPTRANS.EFF_TYPE_CD_DESC as EFF_TYPE_CD_DESC,
EXPTRANS.AGT_PROD_OVERRIDE as AGT_PROD_OVERRIDE,
EXPTRANS.SECTION_TYPE as SECTION_TYPE,
EXPTRANS.PERIL_TYPE as PERIL_TYPE,
EXPTRANS.PREMIUM_TRANS_AMT as PREMIUM_TRANS_AMT,
EXPTRANS.BUS_ACT_TRNS_OBJ as BUS_ACT_TRNS_OBJ,
EXPTRANS.BUS_ACT_TRNS_ACT as BUS_ACT_TRNS_ACT,
EXPTRANS.PRIOR_TRM_CANCEL_DT as PRIOR_TRM_CANCEL_DT,
EXPTRANS.PRIOR_TRM_CANCEL_RSN as PRIOR_TRM_CANCEL_RSN,
EXPTRANS.RNT_DAYS_ELAPSED as RNT_DAYS_ELAPSED,
EXPTRANS.COV_EFF_DT as COV_EFF_DT,
EXPTRANS.COV_EXP_DT as COV_EXP_DT,
EXPTRANS.BUSINESS_TYPE_CD as BUSINESS_TYPE_CD,
EXPTRANS.TRANSACTION_CAT as TRANSACTION_CAT,
EXPTRANS.ISSUE_DT as ISSUE_DT,
EXPTRANS.ISSUE_TM as ISSUE_TM,
EXPTRANS.CANC_RSN_CD as CANC_RSN_CD,
EXPTRANS.GW_CANC_RSN as GW_CANC_RSN,
EXPTRANS.UNIT_REFERENCE_NBR as UNIT_REFERENCE_NBR,
EXPTRANS.MUNI_TAX_UNIT_ORIG_DT as MUNI_TAX_UNIT_ORIG_DT,
EXPTRANS.VEH_ORIG_EFF_DT as VEH_ORIG_EFF_DT,
EXPTRANS.VEH_REPLACEMENT_IND as VEH_REPLACEMENT_IND,
EXPTRANS.VEH_ADD_REMOVAL_CD as VEH_ADD_REMOVAL_CD,
EXPTRANS.NEW_BUSINESS_TERM as NEW_BUSINESS_TERM,
EXPTRANS.INCEPTION_DT as INCEPTION_DT,
EXPTRANS.UNIT_TYPE_CD as UNIT_TYPE_CD,
EXPTRANS.UNIT_TYPE_NM as UNIT_TYPE_NM,
EXPTRANS.TAX_CD as TAX_CD,
EXPTRANS.TAX_YR as TAX_YR,
EXPTRANS.TAX_PREM_TYPE as TAX_PREM_TYPE,
EXPTRANS.REWRITE_CD as REWRITE_CD,
EXPTRANS.COMPANY_CHG_IND as COMPANY_CHG_IND,
EXPTRANS.TIER_RATING_CD as TIER_RATING_CD,
EXPTRANS.TRNS_EARN_PREM_AMT as TRNS_EARN_PREM_AMT,
EXPTRANS.TRNS_UNEARN_PREM_AMT as TRNS_UNEARN_PREM_AMT,
EXPTRANS.FULLY_EARNED_COV_IND as FULLY_EARNED_COV_IND,
EXPTRANS.FULLY_EARNED_IND as FULLY_EARNED_IND,
EXPTRANS.EARNINGS_AS_OF_DT as EARNINGS_AS_OF_DT,
EXPTRANS.DAYS_IN_TERM as DAYS_IN_TERM,
EXPTRANS.PREM_PER_DAY as PREM_PER_DAY,
EXPTRANS.DAYS_EARNED as DAYS_EARNED,
EXPTRANS.DAYS_UNEARNED as DAYS_UNEARNED,
EXPTRANS.CREATE_TS as CREATE_TS,
EXPTRANS.TERRITORY_CD as TERRITORY_CD,
EXPTRANS.DRIVER_CLASS_CD as DRIVER_CLASS_CD,
EXPTRANS.GL_EXTR_MO as GL_EXTR_MO,
EXPTRANS.GL_EXTR_YR as GL_EXTR_YR,
EXPTRANS.GL_PREM_TYPE as GL_PREM_TYPE,
EXPTRANS.PS_ACCOUNTING_MO as PS_ACCOUNTING_MO,
EXPTRANS.PS_ACCOUNTING_YR as PS_ACCOUNTING_YR,
EXPTRANS.BUSINESS_UNIT as BUSINESS_UNIT,
EXPTRANS.TRANSACTION_ID as TRANSACTION_ID,
EXPTRANS.BILLING_REF_NBR as BILLING_REF_NBR,
EXPTRANS.PS_DTTM_STAMP as PS_DTTM_STAMP,
EXPTRANS.LEDGER as LEDGER,
EXPTRANS.JOURNAL_ID as JOURNAL_ID,
EXPTRANS.JOURNAL_LINE as JOURNAL_LINE,
EXPTRANS.JOURNAL_DATE as JOURNAL_DATE,
EXPTRANS.GL_ACCOUNT_NBR as GL_ACCOUNT_NBR,
EXPTRANS.DEPTID as DEPTID,
EXPTRANS.PRODUCT as PRODUCT,
EXPTRANS.INVOICE_NBR as INVOICE_NBR,
EXPTRANS.PS_COMPANY_CD as PS_COMPANY_CD,
EXPTRANS.PS_STATE as PS_STATE,
EXPTRANS.PS_POOL_CD as PS_POOL_CD,
EXPTRANS.GL_RECORD_TAG as GL_RECORD_TAG,
EXPTRANS.MASTER_CMPY_NBR as MASTER_CMPY_NBR,
EXPTRANS.BRANCH_NBR as BRANCH_NBR,
EXPTRANS.STATE_CD as STATE_CD,
EXPTRANS.COV_CD as COV_CD,
EXPTRANS.INSURANCE_LINE_CD as INSURANCE_LINE_CD,
EXPTRANS.TRANS_SOURCE_CD as TRANS_SOURCE_CD,
EXPTRANS.REINSURANCE_CD as REINSURANCE_CD,
EXPTRANS.GL_DISTRIB_STATUS as GL_DISTRIB_STATUS,
EXPTRANS.PROCESS_INSTANCE as PROCESS_INSTANCE,
EXPTRANS.ROW_PROC_IND as ROW_PROC_IND,
EXPTRANS.ROW_PROC_TS as ROW_PROC_TS,
EXPTRANS.ROW_PRC_IND_ERR as ROW_PRC_IND_ERR,
EXPTRANS.LAST_UPDATE_PROG as LAST_UPDATE_PROG,
EXPTRANS.INTG_EVNT_STG_ID as INTG_EVNT_STG_ID,
EXPTRANS.COMM_PROC_IND as COMM_PROC_IND,
EXPTRANS.COMM_PROC_TS as COMM_PROC_TS,
EXPTRANS.VEHREPL_PROC_CD as VEHREPL_PROC_CD,
EXPTRANS.VEHREPL_UNIT_REF_NBR as VEHREPL_UNIT_REF_NBR,
EXPTRANS.CAN_NONPMT_60DAYS_IND as CAN_NONPMT_60DAYS_IND,
EXPTRANS.FLAT_CAN_IND as FLAT_CAN_IND,
EXPTRANS.PRIOR_TRMCANNONPMT60DAY_IND as PRIOR_TRMCANNONPMT60DAY_IND,
EXPTRANS.PRIOR_TRM_FLAT_CAN_IND as PRIOR_TRM_FLAT_CAN_IND,
EXPTRANS.COMM_NB_IND as COMM_NB_IND,
EXPTRANS.COMM_RN_IND as COMM_RN_IND,
EXPTRANS.BUSINESS_TYPE as BUSINESS_TYPE,
EXPTRANS.BOPCHU_POLCHG_PREM_INCR_CD as BOPCHU_POLCHG_PREM_INCR_CD,
EXPTRANS.PROP_ONLY_IND as PROP_ONLY_IND,
EXPTRANS.LIAB_ONLY_IND as LIAB_ONLY_IND,
EXPTRANS.AGTRECD_PROC_CD as AGTRECD_PROC_CD,
EXPTRANS.USER_ID as USER_ID,
EXPTRANS.CTL_ID as CTL_ID,
EXPTRANS.PROCESS_ID as PROCESS_ID,
EXPTRANS.LOAD_USER as LOAD_USER,
EXPTRANS.LOAD_DATE as LOAD_DTTM
FROM
EXPTRANS;


END; ';