-- Object Type: PROCEDURES
CREATE OR REPLACE PROCEDURE ALFA_EDW_DEV.PUBLIC.M_FARMPOLS("RUN_ID" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS ' DECLARE PMMAPPINGNAME varchar;
PROJ_ID varchar;
BATCH_ACTIVE_IND varchar;
BEGIN 

PMMAPPINGNAME:=''M_FARMPOLS''; 
BATCH_ACTIVE_IND:=(select  ectl_active_ind from DB_T_CTRL_FIN_PROD.ECTL_BATCH_INFO where ECTL_BATCH_ID= :run_id); 
PROJ_ID:=(select ectl_proj_id from DB_T_CTRL_FIN_PROD.ECTL_BATCH_INFO where ECTL_BATCH_ID= :run_id); 

-- Component LKP_STG_MEMBXREF_TRIGGER, Type Prerequisite Lookup Object 
CREATE OR REPLACE TEMPORARY TABLE LKP_STG_MEMBXREF_TRIGGER AS
(
SELECT
TABLENAME,
FEED_DT
FROM DB_T_STAG_MEMBXREF_PROD.STG_MEMBXREF_TRIGGER
);


-- PIPELINE START FOR 1

-- Component SQ_FARMPOLS, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_FARMPOLS AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as SC_POLICY_NUM,
$2 as CHG_EFF_DT,
$3 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT FARMPOLS.SC_POLICY_NUM ,FARMPOLS.CHG_EFF_DT 
FROM
 DB_T_CORE_MEMBXREF_PROD.FARMPOLS WHERE CHG_EXP_DT = CAST(''9999-12-31'' AS DATE )  
) SRC
)
);


-- Component exp_ASSIGN_DUMMY_TG, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_ASSIGN_DUMMY_TG AS
(
SELECT
SQ_FARMPOLS.SC_POLICY_NUM as SC_POLICY_NUM,
SQ_FARMPOLS.CHG_EFF_DT as CHG_EFF_DT,
''FARMPOLS'' as var_TABLENAME,
LKP_1.FEED_DT /* replaced lookup LKP_STG_MEMBXREF_TRIGGER */ as var_FEED_DT,
var_FEED_DT as out_FEED_DT,
SQ_FARMPOLS.source_record_id,
row_number() over (partition by SQ_FARMPOLS.source_record_id order by SQ_FARMPOLS.source_record_id) as RNK
FROM
SQ_FARMPOLS
LEFT JOIN LKP_STG_MEMBXREF_TRIGGER LKP_1 ON LKP_1.TABLENAME = var_TABLENAME
QUALIFY RNK = 1
);


-- Component LKP_STG_FARMPOLS, Type LOOKUP 
CREATE OR REPLACE TEMPORARY TABLE LKP_STG_FARMPOLS AS
(
SELECT
LKP.SC_POLICY_NUM,
exp_ASSIGN_DUMMY_TG.source_record_id,
ROW_NUMBER() OVER(PARTITION BY exp_ASSIGN_DUMMY_TG.source_record_id ORDER BY LKP.SC_POLICY_NUM asc) RNK
FROM
exp_ASSIGN_DUMMY_TG
LEFT JOIN (
SELECT LTRIM(RTRIM(STG_FARMPOLS.SC_POLICY_NUM)) as SC_POLICY_NUM FROM DB_T_STAG_MEMBXREF_PROD.STG_FARMPOLS
WHERE
 STG_FARMPOLS. LOAD_DT=(SELECT FEED_DT FROM DB_T_STAG_MEMBXREF_PROD.STG_MEMBXREF_TRIGGER WHERE TABLENAME=''FARMPOLS'')
) LKP ON LKP.SC_POLICY_NUM = exp_ASSIGN_DUMMY_TG.SC_POLICY_NUM
QUALIFY RNK = 1
);


-- Component fil_EXPIRED_POLS, Type FILTER 
CREATE OR REPLACE TEMPORARY TABLE fil_EXPIRED_POLS AS
(
SELECT
LKP_STG_FARMPOLS.SC_POLICY_NUM as SC_POLICY_NUM_tgt,
exp_ASSIGN_DUMMY_TG.CHG_EFF_DT as CHG_EFF_DT,
exp_ASSIGN_DUMMY_TG.SC_POLICY_NUM as SC_POLICY_NUM_src,
exp_ASSIGN_DUMMY_TG.out_FEED_DT as LOAD_DT,
exp_ASSIGN_DUMMY_TG.source_record_id
FROM
exp_ASSIGN_DUMMY_TG
LEFT JOIN LKP_STG_FARMPOLS ON exp_ASSIGN_DUMMY_TG.source_record_id = LKP_STG_FARMPOLS.source_record_id
WHERE LKP_STG_FARMPOLS.SC_POLICY_NUM IS NULL
);


-- Component exp_INPUT_ECTL_FIELDS, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_INPUT_ECTL_FIELDS AS
(
SELECT
fil_EXPIRED_POLS.CHG_EFF_DT as CHG_EFF_DT,
fil_EXPIRED_POLS.SC_POLICY_NUM_src as SC_POLICY_NUM_src,
LTRIM ( RTRIM ( :PMMappingName ) ) as out_PROJ_NAME,
:PROJ_ID as out_PROJ_ID,
:PROJ_ID as IN_ACT_PROJ_ID,
:BATCH_ACTIVE_IND as out_BATCH_ACTIVE_IND,
:BATCH_ACTIVE_IND as IN_BATCH_ACTIVE_IND,
''m_STG_FIN_CLM'' IN_PRGM_NM,
null IN_TABLE_NM,
''UPD'' as ECTL_TX_CD,
TO_CHAR ( ( DATE_PART(''YYYY'', TO_TIMESTAMP(fil_EXPIRED_POLS.LOAD_DT)) * 10000 ) + ( DATE_PART(''MM'', TO_TIMESTAMP(fil_EXPIRED_POLS.LOAD_DT)) * 100 ) + 1 ) as var_FIRST_DAY_EFF_DT,
 TO_DATE ( var_FIRST_DAY_EFF_DT  )  - 1  as var_CHG_EXP_DT_NEW,
CASE WHEN fil_EXPIRED_POLS.CHG_EFF_DT >= var_CHG_EXP_DT_NEW THEN fil_EXPIRED_POLS.CHG_EFF_DT ELSE var_CHG_EXP_DT_NEW END as out_CHG_EXP_DT_NEW,
CURRENT_TIMESTAMP as out_ECTL_END_DATE,
fil_EXPIRED_POLS.source_record_id
FROM
fil_EXPIRED_POLS
);


-- Component mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1, Type MAPPLET 
--MAPPLET NOT REGISTERED: mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, mapplet instance mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1;
call mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE(''exp_INPUT_ECTL_FIELDS'');



-- Component upd_FARMPOLS_EXPIRED_POLS, Type UPDATE 
CREATE OR REPLACE TEMPORARY TABLE upd_FARMPOLS_EXPIRED_POLS AS
(
/* UPDATE_STRATEGY_ACTION = 0 FOR INSERT / UPDATE_STRATEGY_ACTION = 1 FOR UPDATE / UPDATE_STRATEGY_ACTION = 2 FOR DELETE / UPDATE_STRATEGY_ACTION = 3 FOR REJECT */
SELECT
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1.out_ECTL_BATCH_ID as ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1.out_ORIG_INS_TS as ECTL_MODIFY_TS,
--''1'' as ECTL_BATCH_ID,
--''1900-01-01'' as ECTL_MODIFY_TS,
exp_INPUT_ECTL_FIELDS.out_ECTL_END_DATE as ECTL_END_DATE,
exp_INPUT_ECTL_FIELDS.SC_POLICY_NUM_src as SC_POLICY_NUM,
exp_INPUT_ECTL_FIELDS.CHG_EFF_DT as CHG_EFF_DT,
exp_INPUT_ECTL_FIELDS.ECTL_TX_CD as ECTL_TX_CD,
exp_INPUT_ECTL_FIELDS.out_CHG_EXP_DT_NEW as CHG_EXP_DT,
1 as UPDATE_STRATEGY_ACTION
FROM
exp_INPUT_ECTL_FIELDS
LEFT JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1 ON exp_INPUT_ECTL_FIELDS.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1.source_record_id
);


-- Component FARMPOLS_UPD_EXPIRED_POLS, Type TARGET 
/* Perform Updates */
MERGE INTO DB_T_core_MEMBXREF_PROD.FARMPOLS
USING upd_FARMPOLS_EXPIRED_POLS
ON (DB_T_core_MEMBXREF_PROD.FARMPOLS.SC_POLICY_NUM = upd_FARMPOLS_EXPIRED_POLS.SC_POLICY_NUM AND DB_T_core_MEMBXREF_PROD.FARMPOLS.CHG_EFF_DT = upd_FARMPOLS_EXPIRED_POLS.CHG_EFF_DT)
WHEN MATCHED THEN UPDATE SET
ECTL_BATCH_ID = upd_FARMPOLS_EXPIRED_POLS.ECTL_BATCH_ID,ECTL_END_DATE =upd_FARMPOLS_EXPIRED_POLS.ECTL_END_DATE,
ECTL_MODIFY_TS = upd_FARMPOLS_EXPIRED_POLS.ECTL_MODIFY_TS,
ECTL_TX_CD = upd_FARMPOLS_EXPIRED_POLS.ECTL_TX_CD,
CHG_EXP_DT = upd_FARMPOLS_EXPIRED_POLS.CHG_EXP_DT;


-- PIPELINE END FOR 1

-- PIPELINE START FOR 2

-- Component sq_STG_FARMPOLS, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE sq_STG_FARMPOLS AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as SC_DWNLD_PRIORITY,
$2 as SC_SERVICE_CENTER,
$3 as SC_POLICY_NUM,
$4 as SC_FLT_ITEM,
$5 as SC_FILE_TYPE,
$6 as SC_REC_TRANS_CODE,
$7 as SC_TRANS_DATE,
$8 as SC_TRANS_TYPE,
$9 as PC_ALPHA_CODE,
$10 as PC_NAME_1,
$11 as PC_NAME_2,
$12 as PC_ADDRESS_1,
$13 as PC_ADDRESS_2,
$14 as PC_CITYST,
$15 as PC_ZIP,
$16 as PC_TAX_CODE,
$17 as PC_AGENT,
$18 as PC_MEMBER_NUMBER,
$19 as PC_RATE_CODE,
$20 as PC_ENCUMBRANCE,
$21 as PC_PREM_FIN,
$22 as PC_MORT_IND,
$23 as PC_COMPANY,
$24 as PC_INCEPT_DATE,
$25 as PC_EXP_DATE,
$26 as PC_EFF_DATE,
$27 as PC_STATUS,
$28 as RFD_TOT_PREM,
$29 as RFD_REWRITE_IND,
$30 as RFD_REWRITE_DT,
$31 as RFD_OUTSTAND_AMT,
$32 as RFD_OUTSTAND_TYPE,
$33 as RFD_OUTSTAND_DT,
$34 as RFD_OUTSTAND_PD_DT,
$35 as RFD_SUSPENSE_CD,
$36 as RFD_SUSPENSE_CANCL,
$37 as RFD_SSNO_1,
$38 as RFD_SSNO_2,
$39 as RFD_REVIEW_DT,
$40 as RFD_UW_INIT,
$41 as RFD_MORT_NAME_1,
$42 as RFD_MORT_NAME_2,
$43 as RFD_MORT_ADD_1,
$44 as RFD_MORT_ADD_2,
$45 as RFD_MORT_CITYST,
$46 as RFD_MORT_ZIP,
$47 as RFD_STATE,
$48 as RFD_MORT_TYPE,
$49 as RFD_LOAN_NUM,
$50 as RFD_PRI_COV,
$51 as RFD_PRI_UNSCH,
$52 as RFD_PRI_ADDL,
$53 as RFD_PRI_HS,
$54 as RFD_PPRI_CLASS,
$55 as RFD_PRI_CONST,
$56 as RFD_PPRI_COV,
$57 as RFD_PPRI_UNSCH,
$58 as RFD_PRI_COV_DT,
$59 as RFD_PRI_BCOV_DT,
$60 as RFD_SEC_COV,
$61 as RFD_SEC_UNSCH,
$62 as RFD_SEC_ADDL,
$63 as RFD_SEC_HS,
$64 as RFD_PSEC_CLASS,
$65 as RFD_SEC_CONST,
$66 as RFD_PSEC_COV,
$67 as RFD_PSEC_BCOV,
$68 as RFD_SEC_COV_DT,
$69 as RFD_SEC_BCOV_DT,
$70 as RFD_PRI_CLASS,
$71 as RFD_PRI_DED,
$72 as RFD_SEC_CLASS,
$73 as RFD_SEC_DED,
$74 as RFD_PRI_PREM,
$75 as RFD_SEC_PREM,
$76 as RFD_ANICOLL_DT,
$77 as RFD_PPRI_DED,
$78 as RFD_PSEC_DED,
$79 as RFD_LIAB,
$80 as RFD_MED,
$81 as RFD_ADD_BLDGS,
$82 as RFD_PLIAB,
$83 as RFD_PMED,
$84 as RFD_PADD_BLDGS,
$85 as RFD_LIAB_MED_DT,
$86 as RFD_TOT_ACRES,
$87 as RFD_PTOT_ACRES,
$88 as RFD_PYRL_COV,
$89 as RFD_PPYRL_COV,
$90 as RFD_RECEIPTS,
$91 as RFD_PRECEIPTS,
$92 as RFD_SEC_DWELL,
$93 as RFD_PSEC_DWELL,
$94 as RFD_OFFICES,
$95 as RFD_POFFICES,
$96 as RFD_PONDS,
$97 as RFD_PPONDS,
$98 as RFD_NAMED_INSD,
$99 as RFD_PNAMED_INSD,
$100 as RFD_FO_06_NON_NAME,
$101 as RFD_PNON_NAMED,
$102 as RFD_NAMED_MED,
$103 as RFD_PNAMED_MED,
$104 as RFD_ADDL_RES,
$105 as RFD_PADDL_RES,
$106 as RFD_NAMED_MED_DT,
$107 as RFD_NAMED_MED_PRM,
$108 as RFD_LIAB_PRM,
$109 as RFD_LVSTK_COV,
$110 as RFD_LVSTK_PRM,
$111 as RFD_LVSTK_DED,
$112 as RFD_PLVSTK_COV,
$113 as RFD_PLVSTK_DED,
$114 as RFD_LVSTK_DT,
$115 as RFD_LVSTK_DED_DT,
$116 as RFD_ANICOLL_COV,
$117 as RFD_FDSD_COV,
$118 as RFD_FDSD_PRM,
$119 as RFD_FDSD_DED,
$120 as RFD_PFDSD_COV,
$121 as RFD_PFDSD_DED,
$122 as RFD_FDSD_DT,
$123 as RFD_FDSD_DED_DT,
$124 as RFD_ANICOLL_PRM,
$125 as RFD_MACH_COV,
$126 as RFD_MACH_PRM,
$127 as RFD_MACH_DED,
$128 as RFD_PMACH_COV,
$129 as RFD_PMACH_DED,
$130 as RFD_MACH_DT,
$131 as RFD_MACH_DED_DT,
$132 as RFD_PANICOLL_COV,
$133 as RFD_H_MACH_COV,
$134 as RFD_H_MACH_PRM,
$135 as RFD_H_MACH_DED,
$136 as RFD_PH_MACH_COV,
$137 as RFD_PH_MACH_DED,
$138 as RFD_H_MACH_DT,
$139 as RFD_H_MACH_DED_DT,
$140 as RFD_VC_DIS_DT,
$141 as RFD_VC_DISCT,
$142 as RFD_LOC1,
$143 as RFD_LOC2,
$144 as RFD_LOC3,
$145 as RFD_1YR_TOT,
$146 as RFD_1YR_DWELL,
$147 as RFD_1YR_UNSCH,
$148 as RFD_1YR_ADDL,
$149 as RFD_1YR_LIAB,
$150 as RFD_1YR_MED,
$151 as RFD_1YR_OUTBLDG,
$152 as RFD_1YR_PD,
$153 as RFD_1YR_NMED,
$154 as RFD_1YR_LVSTK,
$155 as RFD_1YR_MACH,
$156 as RFD_5YR_TOT,
$157 as RFD_5YR_DWELL,
$158 as RFD_5YR_UNSCH,
$159 as RFD_5YR_ADDL,
$160 as RFD_5YR_LIAB,
$161 as RFD_5YR_MED,
$162 as RFD_5YR_OUTBLDG,
$163 as RFD_5YR_PD,
$164 as RFD_5YR_NMED,
$165 as RFD_5YR_LVSTK,
$166 as RFD_5YR_MACH,
$167 as RFD_5YR_AMT,
$168 as RFD_INFL_PRI_COV,
$169 as RFD_INFL_PRI_UNSCH,
$170 as RFD_NAMED_MED1,
$171 as RFD_NAMED_MED2,
$172 as RFD_NAMED_MED3,
$173 as RFD_INFL_SEC_COV,
$174 as RFD_INFL_SEC_UNSCH,
$175 as RFD_PRI_CNTY,
$176 as RFD_SEC_CNTY,
$177 as RFD_OVER9,
$178 as RFD_EBLDG_CON_YR01,
$179 as RFD_EBLDG_CON_YR02,
$180 as RFD_EBLDG_CON_YR03,
$181 as RFD_EBLDG_CON_YR04,
$182 as RFD_EBLDG_CON_YR05,
$183 as RFD_EBLDG_CON_YR06,
$184 as RFD_EBLDG_CON_YR07,
$185 as RFD_EBLDG_CON_YR08,
$186 as RFD_EBLDG_CON_YR09,
$187 as RFD_MB_TYPE,
$188 as RFD_MB_ACCT_NUM,
$189 as RFD_FO_07,
$190 as RFD_FO_46,
$191 as RFD_FO_85,
$192 as RFD_ROLL_OVER_IND,
$193 as FEED_IND,
$194 as LOAD_DT,
$195 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT 
STG_FARMPOLS.SC_DWNLD_PRIORITY AS SC_DWNLD_PRIORITY,
STG_FARMPOLS.SC_SERVICE_CENTER AS SC_SERVICE_CENTER,
TRIM(STG_FARMPOLS.SC_POLICY_NUM) AS SC_POLICY_NUM,
TRIM(STG_FARMPOLS.SC_FLT_ITEM) AS SC_FLT_ITEM,
STG_FARMPOLS.SC_FILE_TYPE AS SC_FILE_TYPE,
STG_FARMPOLS.SC_REC_TRANS_CODE AS SC_REC_TRANS_CODE,
STG_FARMPOLS.SC_TRANS_DATE AS SC_TRANS_DATE,
STG_FARMPOLS.SC_TRANS_TYPE AS SC_TRANS_TYPE,
TRIM(STG_FARMPOLS.PC_ALPHA_CODE) AS PC_ALPHA_CODE,
TRIM(STG_FARMPOLS.PC_NAME_1) AS PC_NAME_1,
TRIM(STG_FARMPOLS.PC_NAME_2) AS PC_NAME_2,
TRIM(STG_FARMPOLS.PC_ADDRESS_1) AS PC_ADDRESS_1,
TRIM(STG_FARMPOLS.PC_ADDRESS_2) AS PC_ADDRESS_2,
TRIM(STG_FARMPOLS.PC_CITYST) AS PC_CITYST,
TRIM(STG_FARMPOLS.PC_ZIP) AS PC_ZIP,
TRIM(STG_FARMPOLS.PC_TAX_CODE) AS PC_TAX_CODE,
STG_FARMPOLS.PC_AGENT AS PC_AGENT,
TRIM(STG_FARMPOLS.PC_MEMBER_NUMBER) AS PC_MEMBER_NUMBER,
TRIM(STG_FARMPOLS.PC_RATE_CODE) AS PC_RATE_CODE,
TRIM(STG_FARMPOLS.PC_ENCUMBRANCE) AS PC_ENCUMBRANCE,
TRIM(STG_FARMPOLS.PC_PREM_FIN) AS PC_PREM_FIN,
TRIM(STG_FARMPOLS.PC_MORT_IND) AS PC_MORT_IND,
TRIM(STG_FARMPOLS.PC_COMPANY) AS PC_COMPANY,
STG_FARMPOLS.PC_INCEPT_DATE AS PC_INCEPT_DATE,
STG_FARMPOLS.PC_EXP_DATE AS PC_EXP_DATE,
STG_FARMPOLS.PC_EFF_DATE AS PC_EFF_DATE,
TRIM(STG_FARMPOLS.PC_STATUS) AS PC_STATUS,
STG_FARMPOLS.RFD_TOT_PREM AS RFD_TOT_PREM,
TRIM(STG_FARMPOLS.RFD_REWRITE_IND) AS RFD_REWRITE_IND,
STG_FARMPOLS.RFD_REWRITE_DT AS RFD_REWRITE_DT,
STG_FARMPOLS.RFD_OUTSTAND_AMT AS RFD_OUTSTAND_AMT,
TRIM(STG_FARMPOLS.RFD_OUTSTAND_TYPE) AS RFD_OUTSTAND_TYPE,
STG_FARMPOLS.RFD_OUTSTAND_DT AS RFD_OUTSTAND_DT,
STG_FARMPOLS.RFD_OUTSTAND_PD_DT AS RFD_OUTSTAND_PD_DT,
TRIM(STG_FARMPOLS.RFD_SUSPENSE_CD) AS RFD_SUSPENSE_CD,
TRIM(STG_FARMPOLS.RFD_SUSPENSE_CANCL) AS RFD_SUSPENSE_CANCL,
TRIM(STG_FARMPOLS.RFD_SSNO_1) AS RFD_SSNO_1,
TRIM(STG_FARMPOLS.RFD_SSNO_2) AS RFD_SSNO_2,
STG_FARMPOLS.RFD_REVIEW_DT AS RFD_REVIEW_DT,
TRIM(STG_FARMPOLS.RFD_UW_INIT) AS RFD_UW_INIT,
TRIM(STG_FARMPOLS.RFD_MORT_NAME_1) AS RFD_MORT_NAME_1,
TRIM(STG_FARMPOLS.RFD_MORT_NAME_2) AS RFD_MORT_NAME_2,
TRIM(STG_FARMPOLS.RFD_MORT_ADD_1) AS RFD_MORT_ADD_1,
TRIM(STG_FARMPOLS.RFD_MORT_ADD_2) AS RFD_MORT_ADD_2,
TRIM(STG_FARMPOLS.RFD_MORT_CITYST) AS RFD_MORT_CITYST,
TRIM(STG_FARMPOLS.RFD_MORT_ZIP) AS RFD_MORT_ZIP,
TRIM(STG_FARMPOLS.RFD_STATE) AS RFD_STATE,
STG_FARMPOLS.RFD_MORT_TYPE AS RFD_MORT_TYPE,
TRIM(STG_FARMPOLS.RFD_LOAN_NUM) AS RFD_LOAN_NUM,
STG_FARMPOLS.RFD_PRI_COV AS RFD_PRI_COV,
STG_FARMPOLS.RFD_PRI_UNSCH AS RFD_PRI_UNSCH,
STG_FARMPOLS.RFD_PRI_ADDL AS RFD_PRI_ADDL,
STG_FARMPOLS.RFD_PRI_HS AS RFD_PRI_HS,
TRIM(STG_FARMPOLS.RFD_PPRI_CLASS) AS RFD_PPRI_CLASS,
STG_FARMPOLS.RFD_PRI_CONST AS RFD_PRI_CONST,
STG_FARMPOLS.RFD_PPRI_COV AS RFD_PPRI_COV,
STG_FARMPOLS.RFD_PPRI_UNSCH AS RFD_PPRI_UNSCH,
STG_FARMPOLS.RFD_PRI_COV_DT AS RFD_PRI_COV_DT,
STG_FARMPOLS.RFD_PRI_BCOV_DT AS RFD_PRI_BCOV_DT,
STG_FARMPOLS.RFD_SEC_COV AS RFD_SEC_COV,
STG_FARMPOLS.RFD_SEC_UNSCH AS RFD_SEC_UNSCH,
STG_FARMPOLS.RFD_SEC_ADDL AS RFD_SEC_ADDL,
STG_FARMPOLS.RFD_SEC_HS AS RFD_SEC_HS,
TRIM(STG_FARMPOLS.RFD_PSEC_CLASS) AS RFD_PSEC_CLASS,
STG_FARMPOLS.RFD_SEC_CONST AS RFD_SEC_CONST,
STG_FARMPOLS.RFD_PSEC_COV AS RFD_PSEC_COV,
STG_FARMPOLS.RFD_PSEC_BCOV AS RFD_PSEC_BCOV,
STG_FARMPOLS.RFD_SEC_COV_DT AS RFD_SEC_COV_DT,
STG_FARMPOLS.RFD_SEC_BCOV_DT AS RFD_SEC_BCOV_DT,
TRIM(STG_FARMPOLS.RFD_PRI_CLASS) AS RFD_PRI_CLASS,
STG_FARMPOLS.RFD_PRI_DED AS RFD_PRI_DED,
TRIM(STG_FARMPOLS.RFD_SEC_CLASS) AS RFD_SEC_CLASS,
STG_FARMPOLS.RFD_SEC_DED AS RFD_SEC_DED,
STG_FARMPOLS.RFD_PRI_PREM AS RFD_PRI_PREM,
STG_FARMPOLS.RFD_SEC_PREM AS RFD_SEC_PREM,
STG_FARMPOLS.RFD_ANICOLL_DT AS RFD_ANICOLL_DT,
STG_FARMPOLS.RFD_PPRI_DED AS RFD_PPRI_DED,
STG_FARMPOLS.RFD_PSEC_DED AS RFD_PSEC_DED,
STG_FARMPOLS.RFD_LIAB AS RFD_LIAB,
STG_FARMPOLS.RFD_MED AS RFD_MED,
STG_FARMPOLS.RFD_ADD_BLDGS AS RFD_ADD_BLDGS,
STG_FARMPOLS.RFD_PLIAB AS RFD_PLIAB,
STG_FARMPOLS.RFD_PMED AS RFD_PMED,
STG_FARMPOLS.RFD_PADD_BLDGS AS RFD_PADD_BLDGS,
STG_FARMPOLS.RFD_LIAB_MED_DT AS RFD_LIAB_MED_DT,
STG_FARMPOLS.RFD_TOT_ACRES AS RFD_TOT_ACRES,
STG_FARMPOLS.RFD_PTOT_ACRES AS RFD_PTOT_ACRES,
STG_FARMPOLS.RFD_PYRL_COV AS RFD_PYRL_COV,
STG_FARMPOLS.RFD_PPYRL_COV AS RFD_PPYRL_COV,
STG_FARMPOLS.RFD_RECEIPTS AS RFD_RECEIPTS,
STG_FARMPOLS.RFD_PRECEIPTS AS RFD_PRECEIPTS,
STG_FARMPOLS.RFD_SEC_DWELL AS RFD_SEC_DWELL,
STG_FARMPOLS.RFD_PSEC_DWELL AS RFD_PSEC_DWELL,
STG_FARMPOLS.RFD_OFFICES AS RFD_OFFICES,
STG_FARMPOLS.RFD_POFFICES AS RFD_POFFICES,
STG_FARMPOLS.RFD_PONDS AS RFD_PONDS,
STG_FARMPOLS.RFD_PPONDS AS RFD_PPONDS,
STG_FARMPOLS.RFD_NAMED_INSD AS RFD_NAMED_INSD,
STG_FARMPOLS.RFD_PNAMED_INSD AS RFD_PNAMED_INSD,
STG_FARMPOLS.RFD_FO_06_NON_NAME AS RFD_FO_06_NON_NAME,
STG_FARMPOLS.RFD_PNON_NAMED AS RFD_PNON_NAMED,
STG_FARMPOLS.RFD_NAMED_MED AS RFD_NAMED_MED,
STG_FARMPOLS.RFD_PNAMED_MED AS RFD_PNAMED_MED,
STG_FARMPOLS.RFD_ADDL_RES AS RFD_ADDL_RES,
STG_FARMPOLS.RFD_PADDL_RES AS RFD_PADDL_RES,
STG_FARMPOLS.RFD_NAMED_MED_DT AS RFD_NAMED_MED_DT,
STG_FARMPOLS.RFD_NAMED_MED_PRM AS RFD_NAMED_MED_PRM,
STG_FARMPOLS.RFD_LIAB_PRM AS RFD_LIAB_PRM,
STG_FARMPOLS.RFD_LVSTK_COV AS RFD_LVSTK_COV,
STG_FARMPOLS.RFD_LVSTK_PRM AS RFD_LVSTK_PRM,
STG_FARMPOLS.RFD_LVSTK_DED AS RFD_LVSTK_DED,
STG_FARMPOLS.RFD_PLVSTK_COV AS RFD_PLVSTK_COV,
STG_FARMPOLS.RFD_PLVSTK_DED AS RFD_PLVSTK_DED,
STG_FARMPOLS.RFD_LVSTK_DT AS RFD_LVSTK_DT,
STG_FARMPOLS.RFD_LVSTK_DED_DT AS RFD_LVSTK_DED_DT,
STG_FARMPOLS.RFD_ANICOLL_COV AS RFD_ANICOLL_COV,
STG_FARMPOLS.RFD_FDSD_COV AS RFD_FDSD_COV,
STG_FARMPOLS.RFD_FDSD_PRM AS RFD_FDSD_PRM,
STG_FARMPOLS.RFD_FDSD_DED AS RFD_FDSD_DED,
STG_FARMPOLS.RFD_PFDSD_COV AS RFD_PFDSD_COV,
STG_FARMPOLS.RFD_PFDSD_DED AS RFD_PFDSD_DED,
STG_FARMPOLS.RFD_FDSD_DT AS RFD_FDSD_DT,
STG_FARMPOLS.RFD_FDSD_DED_DT AS RFD_FDSD_DED_DT,
STG_FARMPOLS.RFD_ANICOLL_PRM AS RFD_ANICOLL_PRM,
STG_FARMPOLS.RFD_MACH_COV AS RFD_MACH_COV,
STG_FARMPOLS.RFD_MACH_PRM AS RFD_MACH_PRM,
STG_FARMPOLS.RFD_MACH_DED AS RFD_MACH_DED,
STG_FARMPOLS.RFD_PMACH_COV AS RFD_PMACH_COV,
STG_FARMPOLS.RFD_PMACH_DED AS RFD_PMACH_DED,
STG_FARMPOLS.RFD_MACH_DT AS RFD_MACH_DT,
STG_FARMPOLS.RFD_MACH_DED_DT AS RFD_MACH_DED_DT,
STG_FARMPOLS.RFD_PANICOLL_COV AS RFD_PANICOLL_COV,
STG_FARMPOLS.RFD_H_MACH_COV AS RFD_H_MACH_COV,
STG_FARMPOLS.RFD_H_MACH_PRM AS RFD_H_MACH_PRM,
STG_FARMPOLS.RFD_H_MACH_DED AS RFD_H_MACH_DED,
STG_FARMPOLS.RFD_PH_MACH_COV AS RFD_PH_MACH_COV,
STG_FARMPOLS.RFD_PH_MACH_DED AS RFD_PH_MACH_DED,
STG_FARMPOLS.RFD_H_MACH_DT AS RFD_H_MACH_DT,
STG_FARMPOLS.RFD_H_MACH_DED_DT AS RFD_H_MACH_DED_DT,
STG_FARMPOLS.RFD_VC_DIS_DT AS RFD_VC_DIS_DT,
STG_FARMPOLS.RFD_VC_DISCT AS RFD_VC_DISCT,
TRIM(STG_FARMPOLS.RFD_LOC1) AS RFD_LOC1,
TRIM(STG_FARMPOLS.RFD_LOC2) AS RFD_LOC2,
TRIM(STG_FARMPOLS.RFD_LOC3) AS RFD_LOC3,
STG_FARMPOLS.RFD_1YR_TOT AS RFD_1YR_TOT,
STG_FARMPOLS.RFD_1YR_DWELL AS RFD_1YR_DWELL,
STG_FARMPOLS.RFD_1YR_UNSCH AS RFD_1YR_UNSCH,
STG_FARMPOLS.RFD_1YR_ADDL AS RFD_1YR_ADDL,
STG_FARMPOLS.RFD_1YR_LIAB AS RFD_1YR_LIAB,
STG_FARMPOLS.RFD_1YR_MED AS RFD_1YR_MED,
STG_FARMPOLS.RFD_1YR_OUTBLDG AS RFD_1YR_OUTBLDG,
STG_FARMPOLS.RFD_1YR_PD AS RFD_1YR_PD,
STG_FARMPOLS.RFD_1YR_NMED AS RFD_1YR_NMED,
STG_FARMPOLS.RFD_1YR_LVSTK AS RFD_1YR_LVSTK,
STG_FARMPOLS.RFD_1YR_MACH AS RFD_1YR_MACH,
STG_FARMPOLS.RFD_5YR_TOT AS RFD_5YR_TOT,
STG_FARMPOLS.RFD_5YR_DWELL AS RFD_5YR_DWELL,
STG_FARMPOLS.RFD_5YR_UNSCH AS RFD_5YR_UNSCH,
STG_FARMPOLS.RFD_5YR_ADDL AS RFD_5YR_ADDL,
STG_FARMPOLS.RFD_5YR_LIAB AS RFD_5YR_LIAB,
STG_FARMPOLS.RFD_5YR_MED AS RFD_5YR_MED,
STG_FARMPOLS.RFD_5YR_OUTBLDG AS RFD_5YR_OUTBLDG,
STG_FARMPOLS.RFD_5YR_PD AS RFD_5YR_PD,
STG_FARMPOLS.RFD_5YR_NMED AS RFD_5YR_NMED,
STG_FARMPOLS.RFD_5YR_LVSTK AS RFD_5YR_LVSTK,
STG_FARMPOLS.RFD_5YR_MACH AS RFD_5YR_MACH,
STG_FARMPOLS.RFD_5YR_AMT AS RFD_5YR_AMT,
STG_FARMPOLS.RFD_INFL_PRI_COV AS RFD_INFL_PRI_COV,
STG_FARMPOLS.RFD_INFL_PRI_UNSCH AS RFD_INFL_PRI_UNSCH,
TRIM(STG_FARMPOLS.RFD_NAMED_MED1) AS RFD_NAMED_MED1,
TRIM(STG_FARMPOLS.RFD_NAMED_MED2) AS RFD_NAMED_MED2,
TRIM(STG_FARMPOLS.RFD_NAMED_MED3) AS RFD_NAMED_MED3,
STG_FARMPOLS.RFD_INFL_SEC_COV AS RFD_INFL_SEC_COV,
STG_FARMPOLS.RFD_INFL_SEC_UNSCH AS RFD_INFL_SEC_UNSCH,
TRIM(STG_FARMPOLS.RFD_PRI_CNTY) AS RFD_PRI_CNTY,
TRIM(STG_FARMPOLS.RFD_SEC_CNTY) AS RFD_SEC_CNTY,
TRIM(STG_FARMPOLS.RFD_OVER9) AS RFD_OVER9,
TRIM(STG_FARMPOLS.RFD_EBLDG_CON_YR01) AS RFD_EBLDG_CON_YR01,
TRIM(STG_FARMPOLS.RFD_EBLDG_CON_YR02) AS RFD_EBLDG_CON_YR02,
TRIM(STG_FARMPOLS.RFD_EBLDG_CON_YR03) AS RFD_EBLDG_CON_YR03,
TRIM(STG_FARMPOLS.RFD_EBLDG_CON_YR04) AS RFD_EBLDG_CON_YR04,
TRIM(STG_FARMPOLS.RFD_EBLDG_CON_YR05) AS RFD_EBLDG_CON_YR05,
TRIM(STG_FARMPOLS.RFD_EBLDG_CON_YR06) AS RFD_EBLDG_CON_YR06,
TRIM(STG_FARMPOLS.RFD_EBLDG_CON_YR07) AS RFD_EBLDG_CON_YR07,
TRIM(STG_FARMPOLS.RFD_EBLDG_CON_YR08) AS RFD_EBLDG_CON_YR08,
TRIM(STG_FARMPOLS.RFD_EBLDG_CON_YR09) AS RFD_EBLDG_CON_YR09,
TRIM(STG_FARMPOLS.RFD_MB_TYPE) AS RFD_MB_TYPE,
TRIM(STG_FARMPOLS.RFD_MB_ACCT_NUM) AS RFD_MB_ACCT_NUM,
STG_FARMPOLS.RFD_FO_07 AS RFD_FO_07,
STG_FARMPOLS.RFD_FO_46 AS RFD_FO_46,
TRIM(STG_FARMPOLS.RFD_FO_85) AS RFD_FO_85,
TRIM(STG_FARMPOLS.RFD_ROLL_OVER_IND) AS RFD_ROLL_OVER_IND,
TRIM(STG_FARMPOLS.FEED_IND) AS FEED_IND,
STG_FARMPOLS.LOAD_DT AS LOAD_DT
FROM
 DB_T_STAG_MEMBXREF_PROD.STG_FARMPOLS
WHERE LOAD_DT=(SELECT FEED_DT FROM DB_T_STAG_MEMBXREF_PROD.STG_MEMBXREF_TRIGGER WHERE TABLENAME=''FARMPOLS'')
) SRC
)
);


-- Component LKP_FARMPOLS, Type LOOKUP 
CREATE OR REPLACE TEMPORARY TABLE LKP_FARMPOLS AS
(
SELECT
LKP.SC_DWNLD_PRIORITY,
LKP.SC_SERVICE_CENTER,
LKP.SC_POLICY_NUM,
LKP.CHG_EFF_DT,
LKP.SC_FLT_ITEM,
LKP.SC_FILE_TYPE,
LKP.SC_REC_TRANS_CODE,
LKP.SC_TRANS_DATE,
LKP.SC_TRANS_TYPE,
LKP.PC_ALPHA_CODE,
LKP.PC_NAME_1,
LKP.PC_NAME_2,
LKP.PC_ADDRESS_1,
LKP.PC_ADDRESS_2,
LKP.PC_CITYST,
LKP.PC_ZIP,
LKP.PC_TAX_CODE,
LKP.PC_AGENT,
LKP.PC_MEMBER_NUMBER,
LKP.PC_RATE_CODE,
LKP.PC_ENCUMBRANCE,
LKP.PC_PREM_FIN,
LKP.PC_MORT_IND,
LKP.PC_COMPANY,
LKP.PC_INCEPT_DATE,
LKP.PC_EXP_DATE,
LKP.PC_EFF_DATE,
LKP.PC_STATUS,
LKP.RFD_TOT_PREM,
LKP.RFD_REWRITE_IND,
LKP.RFD_REWRITE_DT,
LKP.RFD_OUTSTAND_AMT,
LKP.RFD_OUTSTAND_TYPE,
LKP.RFD_OUTSTAND_DT,
LKP.RFD_OUTSTAND_PD_DT,
LKP.RFD_SUSPENSE_CD,
LKP.RFD_SUSPENSE_CANCL,
LKP.RFD_SSNO_1,
LKP.RFD_SSNO_2,
LKP.RFD_REVIEW_DT,
LKP.RFD_UW_INIT,
LKP.RFD_MORT_NAME_1,
LKP.RFD_MORT_NAME_2,
LKP.RFD_MORT_ADD_1,
LKP.RFD_MORT_ADD_2,
LKP.RFD_MORT_CITYST,
LKP.RFD_MORT_ZIP,
LKP.RFD_STATE,
LKP.RFD_MORT_TYPE,
LKP.RFD_LOAN_NUM,
LKP.RFD_PRI_COV,
LKP.RFD_PRI_UNSCH,
LKP.RFD_PRI_ADDL,
LKP.RFD_PRI_HS,
LKP.RFD_PPRI_CLASS,
LKP.RFD_PRI_CONST,
LKP.RFD_PPRI_COV,
LKP.RFD_PPRI_UNSCH,
LKP.RFD_PRI_COV_DT,
LKP.RFD_PRI_BCOV_DT,
LKP.RFD_SEC_COV,
LKP.RFD_SEC_UNSCH,
LKP.RFD_SEC_ADDL,
LKP.RFD_SEC_HS,
LKP.RFD_PSEC_CLASS,
LKP.RFD_SEC_CONST,
LKP.RFD_PSEC_COV,
LKP.RFD_PSEC_BCOV,
LKP.RFD_SEC_COV_DT,
LKP.RFD_SEC_BCOV_DT,
LKP.RFD_PRI_CLASS,
LKP.RFD_PRI_DED,
LKP.RFD_SEC_CLASS,
LKP.RFD_SEC_DED,
LKP.RFD_PRI_PREM,
LKP.RFD_SEC_PREM,
LKP.RFD_ANICOLL_DT,
LKP.RFD_PPRI_DED,
LKP.RFD_PSEC_DED,
LKP.RFD_LIAB,
LKP.RFD_MED,
LKP.RFD_ADD_BLDGS,
LKP.RFD_PLIAB,
LKP.RFD_PMED,
LKP.RFD_PADD_BLDGS,
LKP.RFD_LIAB_MED_DT,
LKP.RFD_TOT_ACRES,
LKP.RFD_PTOT_ACRES,
LKP.RFD_PYRL_COV,
LKP.RFD_PPYRL_COV,
LKP.RFD_RECEIPTS,
LKP.RFD_PRECEIPTS,
LKP.RFD_SEC_DWELL,
LKP.RFD_PSEC_DWELL,
LKP.RFD_OFFICES,
LKP.RFD_POFFICES,
LKP.RFD_PONDS,
LKP.RFD_PPONDS,
LKP.RFD_NAMED_INSD,
LKP.RFD_PNAMED_INSD,
LKP.RFD_FO_06_NON_NAME,
LKP.RFD_PNON_NAMED,
LKP.RFD_NAMED_MED,
LKP.RFD_PNAMED_MED,
LKP.RFD_ADDL_RES,
LKP.RFD_PADDL_RES,
LKP.RFD_NAMED_MED_DT,
LKP.RFD_NAMED_MED_PRM,
LKP.RFD_LIAB_PRM,
LKP.RFD_LVSTK_COV,
LKP.RFD_LVSTK_PRM,
LKP.RFD_LVSTK_DED,
LKP.RFD_PLVSTK_COV,
LKP.RFD_PLVSTK_DED,
LKP.RFD_LVSTK_DT,
LKP.RFD_LVSTK_DED_DT,
LKP.RFD_ANICOLL_COV,
LKP.RFD_FDSD_COV,
LKP.RFD_FDSD_PRM,
LKP.RFD_FDSD_DED,
LKP.RFD_PFDSD_COV,
LKP.RFD_PFDSD_DED,
LKP.RFD_FDSD_DT,
LKP.RFD_FDSD_DED_DT,
LKP.RFD_ANICOLL_PRM,
LKP.RFD_MACH_COV,
LKP.RFD_MACH_PRM,
LKP.RFD_MACH_DED,
LKP.RFD_PMACH_COV,
LKP.RFD_PMACH_DED,
LKP.RFD_MACH_DT,
LKP.RFD_MACH_DED_DT,
LKP.RFD_PANICOLL_COV,
LKP.RFD_H_MACH_COV,
LKP.RFD_H_MACH_PRM,
LKP.RFD_H_MACH_DED,
LKP.RFD_PH_MACH_COV,
LKP.RFD_PH_MACH_DED,
LKP.RFD_H_MACH_DT,
LKP.RFD_H_MACH_DED_DT,
LKP.RFD_VC_DIS_DT,
LKP.RFD_VC_DISCT,
LKP.RFD_LOC1,
LKP.RFD_LOC2,
LKP.RFD_LOC3,
LKP.RFD_1YR_TOT,
LKP.RFD_1YR_DWELL,
LKP.RFD_1YR_UNSCH,
LKP.RFD_1YR_ADDL,
LKP.RFD_1YR_LIAB,
LKP.RFD_1YR_MED,
LKP.RFD_1YR_OUTBLDG,
LKP.RFD_1YR_PD,
LKP.RFD_1YR_NMED,
LKP.RFD_1YR_LVSTK,
LKP.RFD_1YR_MACH,
LKP.RFD_5YR_TOT,
LKP.RFD_5YR_DWELL,
LKP.RFD_5YR_UNSCH,
LKP.RFD_5YR_ADDL,
LKP.RFD_5YR_LIAB,
LKP.RFD_5YR_MED,
LKP.RFD_5YR_OUTBLDG,
LKP.RFD_5YR_PD,
LKP.RFD_5YR_NMED,
LKP.RFD_5YR_LVSTK,
LKP.RFD_5YR_MACH,
LKP.RFD_5YR_AMT,
LKP.RFD_INFL_PRI_COV,
LKP.RFD_INFL_PRI_UNSCH,
LKP.RFD_NAMED_MED1,
LKP.RFD_NAMED_MED2,
LKP.RFD_NAMED_MED3,
LKP.RFD_INFL_SEC_COV,
LKP.RFD_INFL_SEC_UNSCH,
LKP.RFD_PRI_CNTY,
LKP.RFD_SEC_CNTY,
LKP.RFD_OVER9,
LKP.RFD_EBLDG_CON_YR01,
LKP.RFD_EBLDG_CON_YR02,
LKP.RFD_EBLDG_CON_YR03,
LKP.RFD_EBLDG_CON_YR04,
LKP.RFD_EBLDG_CON_YR05,
LKP.RFD_EBLDG_CON_YR06,
LKP.RFD_EBLDG_CON_YR07,
LKP.RFD_EBLDG_CON_YR08,
LKP.RFD_EBLDG_CON_YR09,
LKP.RFD_MB_TYPE,
LKP.RFD_MB_ACCT_NUM,
LKP.RFD_FO_07,
LKP.RFD_FO_46,
LKP.RFD_FO_85,
LKP.RFD_ROLL_OVER_IND,
sq_STG_FARMPOLS.source_record_id,
ROW_NUMBER() OVER(PARTITION BY sq_STG_FARMPOLS.source_record_id ORDER BY LKP.SC_DWNLD_PRIORITY asc,LKP.SC_SERVICE_CENTER asc,LKP.SC_POLICY_NUM asc,LKP.CHG_EFF_DT asc,LKP.CHG_EXP_DT asc,LKP.SC_FLT_ITEM asc,LKP.SC_FILE_TYPE asc,LKP.SC_REC_TRANS_CODE asc,LKP.SC_TRANS_DATE asc,LKP.SC_TRANS_TYPE asc,LKP.PC_ALPHA_CODE asc,LKP.PC_NAME_1 asc,LKP.PC_NAME_2 asc,LKP.PC_ADDRESS_1 asc,LKP.PC_ADDRESS_2 asc,LKP.PC_CITYST asc,LKP.PC_ZIP asc,LKP.PC_TAX_CODE asc,LKP.PC_AGENT asc,LKP.PC_MEMBER_NUMBER asc,LKP.PC_RATE_CODE asc,LKP.PC_ENCUMBRANCE asc,LKP.PC_PREM_FIN asc,LKP.PC_MORT_IND asc,LKP.PC_COMPANY asc,LKP.PC_INCEPT_DATE asc,LKP.PC_EXP_DATE asc,LKP.PC_EFF_DATE asc,LKP.PC_STATUS asc,LKP.RFD_TOT_PREM asc,LKP.RFD_REWRITE_IND asc,LKP.RFD_REWRITE_DT asc,LKP.RFD_OUTSTAND_AMT asc,LKP.RFD_OUTSTAND_TYPE asc,LKP.RFD_OUTSTAND_DT asc,LKP.RFD_OUTSTAND_PD_DT asc,LKP.RFD_SUSPENSE_CD asc,LKP.RFD_SUSPENSE_CANCL asc,LKP.RFD_SSNO_1 asc,LKP.RFD_SSNO_2 asc,LKP.RFD_REVIEW_DT asc,LKP.RFD_UW_INIT asc,LKP.RFD_MORT_NAME_1 asc,LKP.RFD_MORT_NAME_2 asc,LKP.RFD_MORT_ADD_1 asc,LKP.RFD_MORT_ADD_2 asc,LKP.RFD_MORT_CITYST asc,LKP.RFD_MORT_ZIP asc,LKP.RFD_STATE asc,LKP.RFD_MORT_TYPE asc,LKP.RFD_LOAN_NUM asc,LKP.RFD_PRI_COV asc,LKP.RFD_PRI_UNSCH asc,LKP.RFD_PRI_ADDL asc,LKP.RFD_PRI_HS asc,LKP.RFD_PPRI_CLASS asc,LKP.RFD_PRI_CONST asc,LKP.RFD_PPRI_COV asc,LKP.RFD_PPRI_UNSCH asc,LKP.RFD_PRI_COV_DT asc,LKP.RFD_PRI_BCOV_DT asc,LKP.RFD_SEC_COV asc,LKP.RFD_SEC_UNSCH asc,LKP.RFD_SEC_ADDL asc,LKP.RFD_SEC_HS asc,LKP.RFD_PSEC_CLASS asc,LKP.RFD_SEC_CONST asc,LKP.RFD_PSEC_COV asc,LKP.RFD_PSEC_BCOV asc,LKP.RFD_SEC_COV_DT asc,LKP.RFD_SEC_BCOV_DT asc,LKP.RFD_PRI_CLASS asc,LKP.RFD_PRI_DED asc,LKP.RFD_SEC_CLASS asc,LKP.RFD_SEC_DED asc,LKP.RFD_PRI_PREM asc,LKP.RFD_SEC_PREM asc,LKP.RFD_ANICOLL_DT asc,LKP.RFD_PPRI_DED asc,LKP.RFD_PSEC_DED asc,LKP.RFD_LIAB asc,LKP.RFD_MED asc,LKP.RFD_ADD_BLDGS asc,LKP.RFD_PLIAB asc,LKP.RFD_PMED asc,LKP.RFD_PADD_BLDGS asc,LKP.RFD_LIAB_MED_DT asc,LKP.RFD_TOT_ACRES asc,LKP.RFD_PTOT_ACRES asc,LKP.RFD_PYRL_COV asc,LKP.RFD_PPYRL_COV asc,LKP.RFD_RECEIPTS asc,LKP.RFD_PRECEIPTS asc,LKP.RFD_SEC_DWELL asc,LKP.RFD_PSEC_DWELL asc,LKP.RFD_OFFICES asc,LKP.RFD_POFFICES asc,LKP.RFD_PONDS asc,LKP.RFD_PPONDS asc,LKP.RFD_NAMED_INSD asc,LKP.RFD_PNAMED_INSD asc,LKP.RFD_FO_06_NON_NAME asc,LKP.RFD_PNON_NAMED asc,LKP.RFD_NAMED_MED asc,LKP.RFD_PNAMED_MED asc,LKP.RFD_ADDL_RES asc,LKP.RFD_PADDL_RES asc,LKP.RFD_NAMED_MED_DT asc,LKP.RFD_NAMED_MED_PRM asc,LKP.RFD_LIAB_PRM asc,LKP.RFD_LVSTK_COV asc,LKP.RFD_LVSTK_PRM asc,LKP.RFD_LVSTK_DED asc,LKP.RFD_PLVSTK_COV asc,LKP.RFD_PLVSTK_DED asc,LKP.RFD_LVSTK_DT asc,LKP.RFD_LVSTK_DED_DT asc,LKP.RFD_ANICOLL_COV asc,LKP.RFD_FDSD_COV asc,LKP.RFD_FDSD_PRM asc,LKP.RFD_FDSD_DED asc,LKP.RFD_PFDSD_COV asc,LKP.RFD_PFDSD_DED asc,LKP.RFD_FDSD_DT asc,LKP.RFD_FDSD_DED_DT asc,LKP.RFD_ANICOLL_PRM asc,LKP.RFD_MACH_COV asc,LKP.RFD_MACH_PRM asc,LKP.RFD_MACH_DED asc,LKP.RFD_PMACH_COV asc,LKP.RFD_PMACH_DED asc,LKP.RFD_MACH_DT asc,LKP.RFD_MACH_DED_DT asc,LKP.RFD_PANICOLL_COV asc,LKP.RFD_H_MACH_COV asc,LKP.RFD_H_MACH_PRM asc,LKP.RFD_H_MACH_DED asc,LKP.RFD_PH_MACH_COV asc,LKP.RFD_PH_MACH_DED asc,LKP.RFD_H_MACH_DT asc,LKP.RFD_H_MACH_DED_DT asc,LKP.RFD_VC_DIS_DT asc,LKP.RFD_VC_DISCT asc,LKP.RFD_LOC1 asc,LKP.RFD_LOC2 asc,LKP.RFD_LOC3 asc,LKP.RFD_1YR_TOT asc,LKP.RFD_1YR_DWELL asc,LKP.RFD_1YR_UNSCH asc,LKP.RFD_1YR_ADDL asc,LKP.RFD_1YR_LIAB asc,LKP.RFD_1YR_MED asc,LKP.RFD_1YR_OUTBLDG asc,LKP.RFD_1YR_PD asc,LKP.RFD_1YR_NMED asc,LKP.RFD_1YR_LVSTK asc,LKP.RFD_1YR_MACH asc,LKP.RFD_5YR_TOT asc,LKP.RFD_5YR_DWELL asc,LKP.RFD_5YR_UNSCH asc,LKP.RFD_5YR_ADDL asc,LKP.RFD_5YR_LIAB asc,LKP.RFD_5YR_MED asc,LKP.RFD_5YR_OUTBLDG asc,LKP.RFD_5YR_PD asc,LKP.RFD_5YR_NMED asc,LKP.RFD_5YR_LVSTK asc,LKP.RFD_5YR_MACH asc,LKP.RFD_5YR_AMT asc,LKP.RFD_INFL_PRI_COV asc,LKP.RFD_INFL_PRI_UNSCH asc,LKP.RFD_NAMED_MED1 asc,LKP.RFD_NAMED_MED2 asc,LKP.RFD_NAMED_MED3 asc,LKP.RFD_INFL_SEC_COV asc,LKP.RFD_INFL_SEC_UNSCH asc,LKP.RFD_PRI_CNTY asc,LKP.RFD_SEC_CNTY asc,LKP.RFD_OVER9 asc,LKP.RFD_EBLDG_CON_YR01 asc,LKP.RFD_EBLDG_CON_YR02 asc,LKP.RFD_EBLDG_CON_YR03 asc,LKP.RFD_EBLDG_CON_YR04 asc,LKP.RFD_EBLDG_CON_YR05 asc,LKP.RFD_EBLDG_CON_YR06 asc,LKP.RFD_EBLDG_CON_YR07 asc,LKP.RFD_EBLDG_CON_YR08 asc,LKP.RFD_EBLDG_CON_YR09 asc,LKP.RFD_MB_TYPE asc,LKP.RFD_MB_ACCT_NUM asc,LKP.RFD_FO_07 asc,LKP.RFD_FO_46 asc,LKP.RFD_FO_85 asc,LKP.RFD_ROLL_OVER_IND asc) RNK
FROM
sq_STG_FARMPOLS
LEFT JOIN (
SELECT FARMPOLS.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY, FARMPOLS.SC_SERVICE_CENTER as SC_SERVICE_CENTER, FARMPOLS.CHG_EFF_DT as CHG_EFF_DT, FARMPOLS.CHG_EXP_DT as CHG_EXP_DT, FARMPOLS.SC_FLT_ITEM as SC_FLT_ITEM, FARMPOLS.SC_FILE_TYPE as SC_FILE_TYPE, FARMPOLS.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE, FARMPOLS.SC_TRANS_DATE as SC_TRANS_DATE, FARMPOLS.SC_TRANS_TYPE as SC_TRANS_TYPE, FARMPOLS.PC_ALPHA_CODE as PC_ALPHA_CODE, FARMPOLS.PC_NAME_1 as PC_NAME_1, FARMPOLS.PC_NAME_2 as PC_NAME_2, FARMPOLS.PC_ADDRESS_1 as PC_ADDRESS_1, FARMPOLS.PC_ADDRESS_2 as PC_ADDRESS_2, FARMPOLS.PC_CITYST as PC_CITYST, FARMPOLS.PC_ZIP as PC_ZIP, FARMPOLS.PC_TAX_CODE as PC_TAX_CODE, FARMPOLS.PC_AGENT as PC_AGENT, FARMPOLS.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER, FARMPOLS.PC_RATE_CODE as PC_RATE_CODE, FARMPOLS.PC_ENCUMBRANCE as PC_ENCUMBRANCE, FARMPOLS.PC_PREM_FIN as PC_PREM_FIN, FARMPOLS.PC_MORT_IND as PC_MORT_IND, FARMPOLS.PC_COMPANY as PC_COMPANY, FARMPOLS.PC_INCEPT_DATE as PC_INCEPT_DATE, FARMPOLS.PC_EXP_DATE as PC_EXP_DATE, FARMPOLS.PC_EFF_DATE as PC_EFF_DATE, FARMPOLS.PC_STATUS as PC_STATUS, FARMPOLS.RFD_TOT_PREM as RFD_TOT_PREM, FARMPOLS.RFD_REWRITE_IND as RFD_REWRITE_IND, FARMPOLS.RFD_REWRITE_DT as RFD_REWRITE_DT, FARMPOLS.RFD_OUTSTAND_AMT as RFD_OUTSTAND_AMT, FARMPOLS.RFD_OUTSTAND_TYPE as RFD_OUTSTAND_TYPE, FARMPOLS.RFD_OUTSTAND_DT as RFD_OUTSTAND_DT, FARMPOLS.RFD_OUTSTAND_PD_DT as RFD_OUTSTAND_PD_DT, FARMPOLS.RFD_SUSPENSE_CD as RFD_SUSPENSE_CD, FARMPOLS.RFD_SUSPENSE_CANCL as RFD_SUSPENSE_CANCL, FARMPOLS.RFD_SSNO_1 as RFD_SSNO_1, FARMPOLS.RFD_SSNO_2 as RFD_SSNO_2, FARMPOLS.RFD_REVIEW_DT as RFD_REVIEW_DT, FARMPOLS.RFD_UW_INIT as RFD_UW_INIT, FARMPOLS.RFD_MORT_NAME_1 as RFD_MORT_NAME_1, FARMPOLS.RFD_MORT_NAME_2 as RFD_MORT_NAME_2, FARMPOLS.RFD_MORT_ADD_1 as RFD_MORT_ADD_1, FARMPOLS.RFD_MORT_ADD_2 as RFD_MORT_ADD_2, FARMPOLS.RFD_MORT_CITYST as RFD_MORT_CITYST, FARMPOLS.RFD_MORT_ZIP as RFD_MORT_ZIP, FARMPOLS.RFD_STATE as RFD_STATE, FARMPOLS.RFD_MORT_TYPE as RFD_MORT_TYPE, FARMPOLS.RFD_LOAN_NUM as RFD_LOAN_NUM, FARMPOLS.RFD_PRI_COV as RFD_PRI_COV, FARMPOLS.RFD_PRI_UNSCH as RFD_PRI_UNSCH, FARMPOLS.RFD_PRI_ADDL as RFD_PRI_ADDL, FARMPOLS.RFD_PRI_HS as RFD_PRI_HS, FARMPOLS.RFD_PPRI_CLASS as RFD_PPRI_CLASS, FARMPOLS.RFD_PRI_CONST as RFD_PRI_CONST, FARMPOLS.RFD_PPRI_COV as RFD_PPRI_COV, FARMPOLS.RFD_PPRI_UNSCH as RFD_PPRI_UNSCH, FARMPOLS.RFD_PRI_COV_DT as RFD_PRI_COV_DT, FARMPOLS.RFD_PRI_BCOV_DT as RFD_PRI_BCOV_DT, FARMPOLS.RFD_SEC_COV as RFD_SEC_COV, FARMPOLS.RFD_SEC_UNSCH as RFD_SEC_UNSCH, FARMPOLS.RFD_SEC_ADDL as RFD_SEC_ADDL, FARMPOLS.RFD_SEC_HS as RFD_SEC_HS, FARMPOLS.RFD_PSEC_CLASS as RFD_PSEC_CLASS, FARMPOLS.RFD_SEC_CONST as RFD_SEC_CONST, FARMPOLS.RFD_PSEC_COV as RFD_PSEC_COV, FARMPOLS.RFD_PSEC_BCOV as RFD_PSEC_BCOV, FARMPOLS.RFD_SEC_COV_DT as RFD_SEC_COV_DT, FARMPOLS.RFD_SEC_BCOV_DT as RFD_SEC_BCOV_DT, FARMPOLS.RFD_PRI_CLASS as RFD_PRI_CLASS, FARMPOLS.RFD_PRI_DED as RFD_PRI_DED, FARMPOLS.RFD_SEC_CLASS as RFD_SEC_CLASS, FARMPOLS.RFD_SEC_DED as RFD_SEC_DED, FARMPOLS.RFD_PRI_PREM as RFD_PRI_PREM, FARMPOLS.RFD_SEC_PREM as RFD_SEC_PREM, FARMPOLS.RFD_ANICOLL_DT as RFD_ANICOLL_DT, FARMPOLS.RFD_PPRI_DED as RFD_PPRI_DED, FARMPOLS.RFD_PSEC_DED as RFD_PSEC_DED, FARMPOLS.RFD_LIAB as RFD_LIAB, FARMPOLS.RFD_MED as RFD_MED, FARMPOLS.RFD_ADD_BLDGS as RFD_ADD_BLDGS, FARMPOLS.RFD_PLIAB as RFD_PLIAB, FARMPOLS.RFD_PMED as RFD_PMED, FARMPOLS.RFD_PADD_BLDGS as RFD_PADD_BLDGS, FARMPOLS.RFD_LIAB_MED_DT as RFD_LIAB_MED_DT, FARMPOLS.RFD_TOT_ACRES as RFD_TOT_ACRES, FARMPOLS.RFD_PTOT_ACRES as RFD_PTOT_ACRES, FARMPOLS.RFD_PYRL_COV as RFD_PYRL_COV, FARMPOLS.RFD_PPYRL_COV as RFD_PPYRL_COV, FARMPOLS.RFD_RECEIPTS as RFD_RECEIPTS, FARMPOLS.RFD_PRECEIPTS as RFD_PRECEIPTS, FARMPOLS.RFD_SEC_DWELL as RFD_SEC_DWELL, FARMPOLS.RFD_PSEC_DWELL as RFD_PSEC_DWELL, FARMPOLS.RFD_OFFICES as RFD_OFFICES, FARMPOLS.RFD_POFFICES as RFD_POFFICES, FARMPOLS.RFD_PONDS as RFD_PONDS, FARMPOLS.RFD_PPONDS as RFD_PPONDS, FARMPOLS.RFD_NAMED_INSD as RFD_NAMED_INSD, FARMPOLS.RFD_PNAMED_INSD as RFD_PNAMED_INSD, FARMPOLS.RFD_FO_06_NON_NAME as RFD_FO_06_NON_NAME, FARMPOLS.RFD_PNON_NAMED as RFD_PNON_NAMED, FARMPOLS.RFD_NAMED_MED as RFD_NAMED_MED, FARMPOLS.RFD_PNAMED_MED as RFD_PNAMED_MED, FARMPOLS.RFD_ADDL_RES as RFD_ADDL_RES, FARMPOLS.RFD_PADDL_RES as RFD_PADDL_RES, FARMPOLS.RFD_NAMED_MED_DT as RFD_NAMED_MED_DT, FARMPOLS.RFD_NAMED_MED_PRM as RFD_NAMED_MED_PRM, FARMPOLS.RFD_LIAB_PRM as RFD_LIAB_PRM, FARMPOLS.RFD_LVSTK_COV as RFD_LVSTK_COV, FARMPOLS.RFD_LVSTK_PRM as RFD_LVSTK_PRM, FARMPOLS.RFD_LVSTK_DED as RFD_LVSTK_DED, FARMPOLS.RFD_PLVSTK_COV as RFD_PLVSTK_COV, FARMPOLS.RFD_PLVSTK_DED as RFD_PLVSTK_DED, FARMPOLS.RFD_LVSTK_DT as RFD_LVSTK_DT, FARMPOLS.RFD_LVSTK_DED_DT as RFD_LVSTK_DED_DT, FARMPOLS.RFD_ANICOLL_COV as RFD_ANICOLL_COV, FARMPOLS.RFD_FDSD_COV as RFD_FDSD_COV, FARMPOLS.RFD_FDSD_PRM as RFD_FDSD_PRM, FARMPOLS.RFD_FDSD_DED as RFD_FDSD_DED, FARMPOLS.RFD_PFDSD_COV as RFD_PFDSD_COV, FARMPOLS.RFD_PFDSD_DED as RFD_PFDSD_DED, FARMPOLS.RFD_FDSD_DT as RFD_FDSD_DT, FARMPOLS.RFD_FDSD_DED_DT as RFD_FDSD_DED_DT, FARMPOLS.RFD_ANICOLL_PRM as RFD_ANICOLL_PRM, FARMPOLS.RFD_MACH_COV as RFD_MACH_COV, FARMPOLS.RFD_MACH_PRM as RFD_MACH_PRM, FARMPOLS.RFD_MACH_DED as RFD_MACH_DED, FARMPOLS.RFD_PMACH_COV as RFD_PMACH_COV, FARMPOLS.RFD_PMACH_DED as RFD_PMACH_DED, FARMPOLS.RFD_MACH_DT as RFD_MACH_DT, FARMPOLS.RFD_MACH_DED_DT as RFD_MACH_DED_DT, FARMPOLS.RFD_PANICOLL_COV as RFD_PANICOLL_COV, FARMPOLS.RFD_H_MACH_COV as RFD_H_MACH_COV, FARMPOLS.RFD_H_MACH_PRM as RFD_H_MACH_PRM, FARMPOLS.RFD_H_MACH_DED as RFD_H_MACH_DED, FARMPOLS.RFD_PH_MACH_COV as RFD_PH_MACH_COV, FARMPOLS.RFD_PH_MACH_DED as RFD_PH_MACH_DED, FARMPOLS.RFD_H_MACH_DT as RFD_H_MACH_DT, FARMPOLS.RFD_H_MACH_DED_DT as RFD_H_MACH_DED_DT, FARMPOLS.RFD_VC_DIS_DT as RFD_VC_DIS_DT, FARMPOLS.RFD_VC_DISCT as RFD_VC_DISCT, FARMPOLS.RFD_LOC1 as RFD_LOC1, FARMPOLS.RFD_LOC2 as RFD_LOC2, FARMPOLS.RFD_LOC3 as RFD_LOC3, FARMPOLS.RFD_1YR_TOT as RFD_1YR_TOT, FARMPOLS.RFD_1YR_DWELL as RFD_1YR_DWELL, FARMPOLS.RFD_1YR_UNSCH as RFD_1YR_UNSCH, FARMPOLS.RFD_1YR_ADDL as RFD_1YR_ADDL, FARMPOLS.RFD_1YR_LIAB as RFD_1YR_LIAB, FARMPOLS.RFD_1YR_MED as RFD_1YR_MED, FARMPOLS.RFD_1YR_OUTBLDG as RFD_1YR_OUTBLDG, FARMPOLS.RFD_1YR_PD as RFD_1YR_PD, FARMPOLS.RFD_1YR_NMED as RFD_1YR_NMED, FARMPOLS.RFD_1YR_LVSTK as RFD_1YR_LVSTK, FARMPOLS.RFD_1YR_MACH as RFD_1YR_MACH, FARMPOLS.RFD_5YR_TOT as RFD_5YR_TOT, FARMPOLS.RFD_5YR_DWELL as RFD_5YR_DWELL, FARMPOLS.RFD_5YR_UNSCH as RFD_5YR_UNSCH, FARMPOLS.RFD_5YR_ADDL as RFD_5YR_ADDL, FARMPOLS.RFD_5YR_LIAB as RFD_5YR_LIAB, FARMPOLS.RFD_5YR_MED as RFD_5YR_MED, FARMPOLS.RFD_5YR_OUTBLDG as RFD_5YR_OUTBLDG, FARMPOLS.RFD_5YR_PD as RFD_5YR_PD, FARMPOLS.RFD_5YR_NMED as RFD_5YR_NMED, FARMPOLS.RFD_5YR_LVSTK as RFD_5YR_LVSTK, FARMPOLS.RFD_5YR_MACH as RFD_5YR_MACH, FARMPOLS.RFD_5YR_AMT as RFD_5YR_AMT, FARMPOLS.RFD_INFL_PRI_COV as RFD_INFL_PRI_COV, FARMPOLS.RFD_INFL_PRI_UNSCH as RFD_INFL_PRI_UNSCH, FARMPOLS.RFD_NAMED_MED1 as RFD_NAMED_MED1, FARMPOLS.RFD_NAMED_MED2 as RFD_NAMED_MED2, FARMPOLS.RFD_NAMED_MED3 as RFD_NAMED_MED3, FARMPOLS.RFD_INFL_SEC_COV as RFD_INFL_SEC_COV, FARMPOLS.RFD_INFL_SEC_UNSCH as RFD_INFL_SEC_UNSCH, FARMPOLS.RFD_PRI_CNTY as RFD_PRI_CNTY, FARMPOLS.RFD_SEC_CNTY as RFD_SEC_CNTY, FARMPOLS.RFD_OVER9 as RFD_OVER9, FARMPOLS.RFD_EBLDG_CON_YR01 as RFD_EBLDG_CON_YR01, FARMPOLS.RFD_EBLDG_CON_YR02 as RFD_EBLDG_CON_YR02, FARMPOLS.RFD_EBLDG_CON_YR03 as RFD_EBLDG_CON_YR03, FARMPOLS.RFD_EBLDG_CON_YR04 as RFD_EBLDG_CON_YR04, FARMPOLS.RFD_EBLDG_CON_YR05 as RFD_EBLDG_CON_YR05, FARMPOLS.RFD_EBLDG_CON_YR06 as RFD_EBLDG_CON_YR06, FARMPOLS.RFD_EBLDG_CON_YR07 as RFD_EBLDG_CON_YR07, FARMPOLS.RFD_EBLDG_CON_YR08 as RFD_EBLDG_CON_YR08, FARMPOLS.RFD_EBLDG_CON_YR09 as RFD_EBLDG_CON_YR09, FARMPOLS.RFD_MB_TYPE as RFD_MB_TYPE, FARMPOLS.RFD_MB_ACCT_NUM as RFD_MB_ACCT_NUM, FARMPOLS.RFD_FO_07 as RFD_FO_07, FARMPOLS.RFD_FO_46 as RFD_FO_46, FARMPOLS.RFD_FO_85 as RFD_FO_85, FARMPOLS.RFD_ROLL_OVER_IND as RFD_ROLL_OVER_IND, FARMPOLS.SC_POLICY_NUM as SC_POLICY_NUM FROM DB_T_core_MEMBXREF_PROD.FARMPOLS WHERE FARMPOLS.ECTL_TX_CD=''NEW''
) LKP ON LKP.SC_POLICY_NUM = sq_STG_FARMPOLS.SC_POLICY_NUM
QUALIFY RNK = 1
);


-- Component exp_DERIVE_FLAG, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_DERIVE_FLAG AS
(
SELECT
sq_STG_FARMPOLS.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY,
sq_STG_FARMPOLS.SC_SERVICE_CENTER as SC_SERVICE_CENTER,
sq_STG_FARMPOLS.SC_POLICY_NUM as SC_POLICY_NUM,
sq_STG_FARMPOLS.SC_FLT_ITEM as SC_FLT_ITEM,
sq_STG_FARMPOLS.SC_FILE_TYPE as SC_FILE_TYPE,
sq_STG_FARMPOLS.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE,
sq_STG_FARMPOLS.SC_TRANS_DATE as SC_TRANS_DATE,
sq_STG_FARMPOLS.SC_TRANS_TYPE as SC_TRANS_TYPE,
sq_STG_FARMPOLS.PC_ALPHA_CODE as PC_ALPHA_CODE,
sq_STG_FARMPOLS.PC_NAME_1 as PC_NAME_1,
sq_STG_FARMPOLS.PC_NAME_2 as PC_NAME_2,
sq_STG_FARMPOLS.PC_ADDRESS_1 as PC_ADDRESS_1,
sq_STG_FARMPOLS.PC_ADDRESS_2 as PC_ADDRESS_2,
sq_STG_FARMPOLS.PC_CITYST as PC_CITYST,
sq_STG_FARMPOLS.PC_ZIP as PC_ZIP,
sq_STG_FARMPOLS.PC_TAX_CODE as PC_TAX_CODE,
sq_STG_FARMPOLS.PC_AGENT as PC_AGENT,
sq_STG_FARMPOLS.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER,
sq_STG_FARMPOLS.PC_RATE_CODE as PC_RATE_CODE,
sq_STG_FARMPOLS.PC_ENCUMBRANCE as PC_ENCUMBRANCE,
sq_STG_FARMPOLS.PC_PREM_FIN as PC_PREM_FIN,
sq_STG_FARMPOLS.PC_MORT_IND as PC_MORT_IND,
sq_STG_FARMPOLS.PC_COMPANY as PC_COMPANY,
sq_STG_FARMPOLS.PC_INCEPT_DATE as PC_INCEPT_DATE,
sq_STG_FARMPOLS.PC_EXP_DATE as PC_EXP_DATE,
sq_STG_FARMPOLS.PC_EFF_DATE as PC_EFF_DATE,
sq_STG_FARMPOLS.PC_STATUS as PC_STATUS,
sq_STG_FARMPOLS.RFD_TOT_PREM as RFD_TOT_PREM,
sq_STG_FARMPOLS.RFD_REWRITE_IND as RFD_REWRITE_IND,
sq_STG_FARMPOLS.RFD_REWRITE_DT as RFD_REWRITE_DT,
sq_STG_FARMPOLS.RFD_OUTSTAND_AMT as RFD_OUTSTAND_AMT,
sq_STG_FARMPOLS.RFD_OUTSTAND_TYPE as RFD_OUTSTAND_TYPE,
sq_STG_FARMPOLS.RFD_OUTSTAND_DT as RFD_OUTSTAND_DT,
sq_STG_FARMPOLS.RFD_OUTSTAND_PD_DT as RFD_OUTSTAND_PD_DT,
sq_STG_FARMPOLS.RFD_SUSPENSE_CD as RFD_SUSPENSE_CD,
sq_STG_FARMPOLS.RFD_SUSPENSE_CANCL as RFD_SUSPENSE_CANCL,
sq_STG_FARMPOLS.RFD_SSNO_1 as RFD_SSNO_1,
sq_STG_FARMPOLS.RFD_SSNO_2 as RFD_SSNO_2,
sq_STG_FARMPOLS.RFD_REVIEW_DT as RFD_REVIEW_DT,
sq_STG_FARMPOLS.RFD_UW_INIT as RFD_UW_INIT,
sq_STG_FARMPOLS.RFD_MORT_NAME_1 as RFD_MORT_NAME_1,
sq_STG_FARMPOLS.RFD_MORT_NAME_2 as RFD_MORT_NAME_2,
sq_STG_FARMPOLS.RFD_MORT_ADD_1 as RFD_MORT_ADD_1,
sq_STG_FARMPOLS.RFD_MORT_ADD_2 as RFD_MORT_ADD_2,
sq_STG_FARMPOLS.RFD_MORT_CITYST as RFD_MORT_CITYST,
sq_STG_FARMPOLS.RFD_MORT_ZIP as RFD_MORT_ZIP,
sq_STG_FARMPOLS.RFD_STATE as RFD_STATE,
sq_STG_FARMPOLS.RFD_MORT_TYPE as RFD_MORT_TYPE,
sq_STG_FARMPOLS.RFD_LOAN_NUM as RFD_LOAN_NUM,
sq_STG_FARMPOLS.RFD_PRI_COV as RFD_PRI_COV,
sq_STG_FARMPOLS.RFD_PRI_UNSCH as RFD_PRI_UNSCH,
sq_STG_FARMPOLS.RFD_PRI_ADDL as RFD_PRI_ADDL,
sq_STG_FARMPOLS.RFD_PRI_HS as RFD_PRI_HS,
sq_STG_FARMPOLS.RFD_PPRI_CLASS as RFD_PPRI_CLASS,
sq_STG_FARMPOLS.RFD_PRI_CONST as RFD_PRI_CONST,
sq_STG_FARMPOLS.RFD_PPRI_COV as RFD_PPRI_COV,
sq_STG_FARMPOLS.RFD_PPRI_UNSCH as RFD_PPRI_UNSCH,
sq_STG_FARMPOLS.RFD_PRI_COV_DT as RFD_PRI_COV_DT,
sq_STG_FARMPOLS.RFD_PRI_BCOV_DT as RFD_PRI_BCOV_DT,
sq_STG_FARMPOLS.RFD_SEC_COV as RFD_SEC_COV,
sq_STG_FARMPOLS.RFD_SEC_UNSCH as RFD_SEC_UNSCH,
sq_STG_FARMPOLS.RFD_SEC_ADDL as RFD_SEC_ADDL,
sq_STG_FARMPOLS.RFD_SEC_HS as RFD_SEC_HS,
sq_STG_FARMPOLS.RFD_PSEC_CLASS as RFD_PSEC_CLASS,
sq_STG_FARMPOLS.RFD_SEC_CONST as RFD_SEC_CONST,
sq_STG_FARMPOLS.RFD_PSEC_COV as RFD_PSEC_COV,
sq_STG_FARMPOLS.RFD_PSEC_BCOV as RFD_PSEC_BCOV,
sq_STG_FARMPOLS.RFD_SEC_COV_DT as RFD_SEC_COV_DT,
sq_STG_FARMPOLS.RFD_SEC_BCOV_DT as RFD_SEC_BCOV_DT,
sq_STG_FARMPOLS.RFD_PRI_CLASS as RFD_PRI_CLASS,
sq_STG_FARMPOLS.RFD_PRI_DED as RFD_PRI_DED,
sq_STG_FARMPOLS.RFD_SEC_CLASS as RFD_SEC_CLASS,
sq_STG_FARMPOLS.RFD_SEC_DED as RFD_SEC_DED,
sq_STG_FARMPOLS.RFD_PRI_PREM as RFD_PRI_PREM,
sq_STG_FARMPOLS.RFD_SEC_PREM as RFD_SEC_PREM,
sq_STG_FARMPOLS.RFD_ANICOLL_DT as RFD_ANICOLL_DT,
sq_STG_FARMPOLS.RFD_PPRI_DED as RFD_PPRI_DED,
sq_STG_FARMPOLS.RFD_PSEC_DED as RFD_PSEC_DED,
sq_STG_FARMPOLS.RFD_LIAB as RFD_LIAB,
sq_STG_FARMPOLS.RFD_MED as RFD_MED,
sq_STG_FARMPOLS.RFD_ADD_BLDGS as RFD_ADD_BLDGS,
sq_STG_FARMPOLS.RFD_PLIAB as RFD_PLIAB,
sq_STG_FARMPOLS.RFD_PMED as RFD_PMED,
sq_STG_FARMPOLS.RFD_PADD_BLDGS as RFD_PADD_BLDGS,
sq_STG_FARMPOLS.RFD_LIAB_MED_DT as RFD_LIAB_MED_DT,
sq_STG_FARMPOLS.RFD_TOT_ACRES as RFD_TOT_ACRES,
sq_STG_FARMPOLS.RFD_PTOT_ACRES as RFD_PTOT_ACRES,
sq_STG_FARMPOLS.RFD_PYRL_COV as RFD_PYRL_COV,
sq_STG_FARMPOLS.RFD_PPYRL_COV as RFD_PPYRL_COV,
sq_STG_FARMPOLS.RFD_RECEIPTS as RFD_RECEIPTS,
sq_STG_FARMPOLS.RFD_PRECEIPTS as RFD_PRECEIPTS,
sq_STG_FARMPOLS.RFD_SEC_DWELL as RFD_SEC_DWELL,
sq_STG_FARMPOLS.RFD_PSEC_DWELL as RFD_PSEC_DWELL,
sq_STG_FARMPOLS.RFD_OFFICES as RFD_OFFICES,
sq_STG_FARMPOLS.RFD_POFFICES as RFD_POFFICES,
sq_STG_FARMPOLS.RFD_PONDS as RFD_PONDS,
sq_STG_FARMPOLS.RFD_PPONDS as RFD_PPONDS,
sq_STG_FARMPOLS.RFD_NAMED_INSD as RFD_NAMED_INSD,
sq_STG_FARMPOLS.RFD_PNAMED_INSD as RFD_PNAMED_INSD,
sq_STG_FARMPOLS.RFD_FO_06_NON_NAME as RFD_FO_06_NON_NAME,
sq_STG_FARMPOLS.RFD_PNON_NAMED as RFD_PNON_NAMED,
sq_STG_FARMPOLS.RFD_NAMED_MED as RFD_NAMED_MED,
sq_STG_FARMPOLS.RFD_PNAMED_MED as RFD_PNAMED_MED,
sq_STG_FARMPOLS.RFD_ADDL_RES as RFD_ADDL_RES,
sq_STG_FARMPOLS.RFD_PADDL_RES as RFD_PADDL_RES,
sq_STG_FARMPOLS.RFD_NAMED_MED_DT as RFD_NAMED_MED_DT,
sq_STG_FARMPOLS.RFD_NAMED_MED_PRM as RFD_NAMED_MED_PRM,
sq_STG_FARMPOLS.RFD_LIAB_PRM as RFD_LIAB_PRM,
sq_STG_FARMPOLS.RFD_LVSTK_COV as RFD_LVSTK_COV,
sq_STG_FARMPOLS.RFD_LVSTK_PRM as RFD_LVSTK_PRM,
sq_STG_FARMPOLS.RFD_LVSTK_DED as RFD_LVSTK_DED,
sq_STG_FARMPOLS.RFD_PLVSTK_COV as RFD_PLVSTK_COV,
sq_STG_FARMPOLS.RFD_PLVSTK_DED as RFD_PLVSTK_DED,
sq_STG_FARMPOLS.RFD_LVSTK_DT as RFD_LVSTK_DT,
sq_STG_FARMPOLS.RFD_LVSTK_DED_DT as RFD_LVSTK_DED_DT,
sq_STG_FARMPOLS.RFD_ANICOLL_COV as RFD_ANICOLL_COV,
sq_STG_FARMPOLS.RFD_FDSD_COV as RFD_FDSD_COV,
sq_STG_FARMPOLS.RFD_FDSD_PRM as RFD_FDSD_PRM,
sq_STG_FARMPOLS.RFD_FDSD_DED as RFD_FDSD_DED,
sq_STG_FARMPOLS.RFD_PFDSD_COV as RFD_PFDSD_COV,
sq_STG_FARMPOLS.RFD_PFDSD_DED as RFD_PFDSD_DED,
sq_STG_FARMPOLS.RFD_FDSD_DT as RFD_FDSD_DT,
sq_STG_FARMPOLS.RFD_FDSD_DED_DT as RFD_FDSD_DED_DT,
sq_STG_FARMPOLS.RFD_ANICOLL_PRM as RFD_ANICOLL_PRM,
sq_STG_FARMPOLS.RFD_MACH_COV as RFD_MACH_COV,
sq_STG_FARMPOLS.RFD_MACH_PRM as RFD_MACH_PRM,
sq_STG_FARMPOLS.RFD_MACH_DED as RFD_MACH_DED,
sq_STG_FARMPOLS.RFD_PMACH_COV as RFD_PMACH_COV,
sq_STG_FARMPOLS.RFD_PMACH_DED as RFD_PMACH_DED,
sq_STG_FARMPOLS.RFD_MACH_DT as RFD_MACH_DT,
sq_STG_FARMPOLS.RFD_MACH_DED_DT as RFD_MACH_DED_DT,
sq_STG_FARMPOLS.RFD_PANICOLL_COV as RFD_PANICOLL_COV,
sq_STG_FARMPOLS.RFD_H_MACH_COV as RFD_H_MACH_COV,
sq_STG_FARMPOLS.RFD_H_MACH_PRM as RFD_H_MACH_PRM,
sq_STG_FARMPOLS.RFD_H_MACH_DED as RFD_H_MACH_DED,
sq_STG_FARMPOLS.RFD_PH_MACH_COV as RFD_PH_MACH_COV,
sq_STG_FARMPOLS.RFD_PH_MACH_DED as RFD_PH_MACH_DED,
sq_STG_FARMPOLS.RFD_H_MACH_DT as RFD_H_MACH_DT,
sq_STG_FARMPOLS.RFD_H_MACH_DED_DT as RFD_H_MACH_DED_DT,
sq_STG_FARMPOLS.RFD_VC_DIS_DT as RFD_VC_DIS_DT,
sq_STG_FARMPOLS.RFD_VC_DISCT as RFD_VC_DISCT,
sq_STG_FARMPOLS.RFD_LOC1 as RFD_LOC1,
sq_STG_FARMPOLS.RFD_LOC2 as RFD_LOC2,
sq_STG_FARMPOLS.RFD_LOC3 as RFD_LOC3,
sq_STG_FARMPOLS.RFD_1YR_TOT as RFD_1YR_TOT,
sq_STG_FARMPOLS.RFD_1YR_DWELL as RFD_1YR_DWELL,
sq_STG_FARMPOLS.RFD_1YR_UNSCH as RFD_1YR_UNSCH,
sq_STG_FARMPOLS.RFD_1YR_ADDL as RFD_1YR_ADDL,
sq_STG_FARMPOLS.RFD_1YR_LIAB as RFD_1YR_LIAB,
sq_STG_FARMPOLS.RFD_1YR_MED as RFD_1YR_MED,
sq_STG_FARMPOLS.RFD_1YR_OUTBLDG as RFD_1YR_OUTBLDG,
sq_STG_FARMPOLS.RFD_1YR_PD as RFD_1YR_PD,
sq_STG_FARMPOLS.RFD_1YR_NMED as RFD_1YR_NMED,
sq_STG_FARMPOLS.RFD_1YR_LVSTK as RFD_1YR_LVSTK,
sq_STG_FARMPOLS.RFD_1YR_MACH as RFD_1YR_MACH,
sq_STG_FARMPOLS.RFD_5YR_TOT as RFD_5YR_TOT,
sq_STG_FARMPOLS.RFD_5YR_DWELL as RFD_5YR_DWELL,
sq_STG_FARMPOLS.RFD_5YR_UNSCH as RFD_5YR_UNSCH,
sq_STG_FARMPOLS.RFD_5YR_ADDL as RFD_5YR_ADDL,
sq_STG_FARMPOLS.RFD_5YR_LIAB as RFD_5YR_LIAB,
sq_STG_FARMPOLS.RFD_5YR_MED as RFD_5YR_MED,
sq_STG_FARMPOLS.RFD_5YR_OUTBLDG as RFD_5YR_OUTBLDG,
sq_STG_FARMPOLS.RFD_5YR_PD as RFD_5YR_PD,
sq_STG_FARMPOLS.RFD_5YR_NMED as RFD_5YR_NMED,
sq_STG_FARMPOLS.RFD_5YR_LVSTK as RFD_5YR_LVSTK,
sq_STG_FARMPOLS.RFD_5YR_MACH as RFD_5YR_MACH,
sq_STG_FARMPOLS.RFD_5YR_AMT as RFD_5YR_AMT,
sq_STG_FARMPOLS.RFD_INFL_PRI_COV as RFD_INFL_PRI_COV,
sq_STG_FARMPOLS.RFD_INFL_PRI_UNSCH as RFD_INFL_PRI_UNSCH,
sq_STG_FARMPOLS.RFD_NAMED_MED1 as RFD_NAMED_MED1,
sq_STG_FARMPOLS.RFD_NAMED_MED2 as RFD_NAMED_MED2,
sq_STG_FARMPOLS.RFD_NAMED_MED3 as RFD_NAMED_MED3,
sq_STG_FARMPOLS.RFD_INFL_SEC_COV as RFD_INFL_SEC_COV,
sq_STG_FARMPOLS.RFD_INFL_SEC_UNSCH as RFD_INFL_SEC_UNSCH,
sq_STG_FARMPOLS.RFD_PRI_CNTY as RFD_PRI_CNTY,
sq_STG_FARMPOLS.RFD_SEC_CNTY as RFD_SEC_CNTY,
sq_STG_FARMPOLS.RFD_OVER9 as RFD_OVER9,
sq_STG_FARMPOLS.RFD_EBLDG_CON_YR01 as RFD_EBLDG_CON_YR01,
sq_STG_FARMPOLS.RFD_EBLDG_CON_YR02 as RFD_EBLDG_CON_YR02,
sq_STG_FARMPOLS.RFD_EBLDG_CON_YR03 as RFD_EBLDG_CON_YR03,
sq_STG_FARMPOLS.RFD_EBLDG_CON_YR04 as RFD_EBLDG_CON_YR04,
sq_STG_FARMPOLS.RFD_EBLDG_CON_YR05 as RFD_EBLDG_CON_YR05,
sq_STG_FARMPOLS.RFD_EBLDG_CON_YR06 as RFD_EBLDG_CON_YR06,
sq_STG_FARMPOLS.RFD_EBLDG_CON_YR07 as RFD_EBLDG_CON_YR07,
sq_STG_FARMPOLS.RFD_EBLDG_CON_YR08 as RFD_EBLDG_CON_YR08,
sq_STG_FARMPOLS.RFD_EBLDG_CON_YR09 as RFD_EBLDG_CON_YR09,
sq_STG_FARMPOLS.RFD_MB_TYPE as RFD_MB_TYPE,
sq_STG_FARMPOLS.RFD_MB_ACCT_NUM as RFD_MB_ACCT_NUM,
sq_STG_FARMPOLS.RFD_FO_07 as RFD_FO_07,
sq_STG_FARMPOLS.RFD_FO_46 as RFD_FO_46,
sq_STG_FARMPOLS.RFD_FO_85 as RFD_FO_85,
sq_STG_FARMPOLS.RFD_ROLL_OVER_IND as RFD_ROLL_OVER_IND,
sq_STG_FARMPOLS.FEED_IND as FEED_IND,
sq_STG_FARMPOLS.LOAD_DT as LOAD_DT,
LKP_FARMPOLS.CHG_EFF_DT as CHG_EFF_DT_lkp,
CASE WHEN LKP_FARMPOLS.SC_POLICY_NUM IS NULL THEN ''NEW'' ELSE CASE WHEN CASE WHEN LKP_FARMPOLS.SC_DWNLD_PRIORITY IS NULL THEN 0 ELSE LKP_FARMPOLS.SC_DWNLD_PRIORITY END <> CASE WHEN sq_STG_FARMPOLS.SC_DWNLD_PRIORITY IS NULL THEN 0 ELSE sq_STG_FARMPOLS.SC_DWNLD_PRIORITY END OR CASE WHEN LKP_FARMPOLS.SC_SERVICE_CENTER IS NULL THEN 0 ELSE LKP_FARMPOLS.SC_SERVICE_CENTER END <> CASE WHEN sq_STG_FARMPOLS.SC_SERVICE_CENTER IS NULL THEN 0 ELSE sq_STG_FARMPOLS.SC_SERVICE_CENTER END OR CASE WHEN LKP_FARMPOLS.SC_FLT_ITEM IS NULL THEN ''~'' ELSE LKP_FARMPOLS.SC_FLT_ITEM END <> CASE WHEN sq_STG_FARMPOLS.SC_FLT_ITEM IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.SC_FLT_ITEM END OR CASE WHEN LKP_FARMPOLS.SC_FILE_TYPE IS NULL THEN 0 ELSE LKP_FARMPOLS.SC_FILE_TYPE END <> CASE WHEN sq_STG_FARMPOLS.SC_FILE_TYPE IS NULL THEN 0 ELSE sq_STG_FARMPOLS.SC_FILE_TYPE END OR CASE WHEN LKP_FARMPOLS.SC_REC_TRANS_CODE IS NULL THEN 0 ELSE LKP_FARMPOLS.SC_REC_TRANS_CODE END <> CASE WHEN sq_STG_FARMPOLS.SC_REC_TRANS_CODE IS NULL THEN 0 ELSE sq_STG_FARMPOLS.SC_REC_TRANS_CODE END OR CASE WHEN LKP_FARMPOLS.SC_TRANS_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.SC_TRANS_DATE END <> CASE WHEN sq_STG_FARMPOLS.SC_TRANS_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.SC_TRANS_DATE END OR CASE WHEN LKP_FARMPOLS.SC_TRANS_TYPE IS NULL THEN 0 ELSE LKP_FARMPOLS.SC_TRANS_TYPE END <> CASE WHEN sq_STG_FARMPOLS.SC_TRANS_TYPE IS NULL THEN 0 ELSE sq_STG_FARMPOLS.SC_TRANS_TYPE END OR CASE WHEN LKP_FARMPOLS.PC_ALPHA_CODE IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_ALPHA_CODE END <> CASE WHEN sq_STG_FARMPOLS.PC_ALPHA_CODE IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_ALPHA_CODE END OR CASE WHEN LKP_FARMPOLS.PC_NAME_1 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_NAME_1 END <> CASE WHEN sq_STG_FARMPOLS.PC_NAME_1 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_NAME_1 END OR CASE WHEN LKP_FARMPOLS.PC_NAME_2 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_NAME_2 END <> CASE WHEN sq_STG_FARMPOLS.PC_NAME_2 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_NAME_2 END OR CASE WHEN LKP_FARMPOLS.PC_ADDRESS_1 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_ADDRESS_1 END <> CASE WHEN sq_STG_FARMPOLS.PC_ADDRESS_1 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_ADDRESS_1 END OR CASE WHEN LKP_FARMPOLS.PC_ADDRESS_2 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_ADDRESS_2 END <> CASE WHEN sq_STG_FARMPOLS.PC_ADDRESS_2 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_ADDRESS_2 END OR CASE WHEN LKP_FARMPOLS.PC_CITYST IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_CITYST END <> CASE WHEN sq_STG_FARMPOLS.PC_CITYST IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_CITYST END OR CASE WHEN LKP_FARMPOLS.PC_ZIP IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_ZIP END <> CASE WHEN sq_STG_FARMPOLS.PC_ZIP IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_ZIP END OR CASE WHEN LKP_FARMPOLS.PC_TAX_CODE IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_TAX_CODE END <> CASE WHEN sq_STG_FARMPOLS.PC_TAX_CODE IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_TAX_CODE END OR CASE WHEN LKP_FARMPOLS.PC_AGENT IS NULL THEN 0 ELSE LKP_FARMPOLS.PC_AGENT END <> CASE WHEN sq_STG_FARMPOLS.PC_AGENT IS NULL THEN 0 ELSE sq_STG_FARMPOLS.PC_AGENT END OR CASE WHEN LKP_FARMPOLS.PC_MEMBER_NUMBER IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_MEMBER_NUMBER END <> CASE WHEN sq_STG_FARMPOLS.PC_MEMBER_NUMBER IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_MEMBER_NUMBER END OR CASE WHEN LKP_FARMPOLS.PC_RATE_CODE IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_RATE_CODE END <> CASE WHEN sq_STG_FARMPOLS.PC_RATE_CODE IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_RATE_CODE END OR CASE WHEN LKP_FARMPOLS.PC_ENCUMBRANCE IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_ENCUMBRANCE END <> CASE WHEN sq_STG_FARMPOLS.PC_ENCUMBRANCE IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_ENCUMBRANCE END OR CASE WHEN LKP_FARMPOLS.PC_PREM_FIN IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_PREM_FIN END <> CASE WHEN sq_STG_FARMPOLS.PC_PREM_FIN IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_PREM_FIN END OR CASE WHEN LKP_FARMPOLS.PC_MORT_IND IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_MORT_IND END <> CASE WHEN sq_STG_FARMPOLS.PC_MORT_IND IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_MORT_IND END OR CASE WHEN LKP_FARMPOLS.PC_COMPANY IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_COMPANY END <> CASE WHEN sq_STG_FARMPOLS.PC_COMPANY IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_COMPANY END OR CASE WHEN LKP_FARMPOLS.PC_INCEPT_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.PC_INCEPT_DATE END <> CASE WHEN sq_STG_FARMPOLS.PC_INCEPT_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.PC_INCEPT_DATE END OR CASE WHEN LKP_FARMPOLS.PC_EXP_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.PC_EXP_DATE END <> CASE WHEN sq_STG_FARMPOLS.PC_EXP_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.PC_EXP_DATE END OR CASE WHEN LKP_FARMPOLS.PC_EFF_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.PC_EFF_DATE END <> CASE WHEN sq_STG_FARMPOLS.PC_EFF_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.PC_EFF_DATE END OR CASE WHEN LKP_FARMPOLS.PC_STATUS IS NULL THEN ''~'' ELSE LKP_FARMPOLS.PC_STATUS END <> CASE WHEN sq_STG_FARMPOLS.PC_STATUS IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.PC_STATUS END OR CASE WHEN LKP_FARMPOLS.RFD_TOT_PREM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_TOT_PREM END <> CASE WHEN sq_STG_FARMPOLS.RFD_TOT_PREM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_TOT_PREM END OR CASE WHEN LKP_FARMPOLS.RFD_REWRITE_IND IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_REWRITE_IND END <> CASE WHEN sq_STG_FARMPOLS.RFD_REWRITE_IND IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_REWRITE_IND END OR CASE WHEN LKP_FARMPOLS.RFD_REWRITE_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_REWRITE_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_REWRITE_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_REWRITE_DT END OR CASE WHEN LKP_FARMPOLS.RFD_OUTSTAND_AMT IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_OUTSTAND_AMT END <> CASE WHEN sq_STG_FARMPOLS.RFD_OUTSTAND_AMT IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_OUTSTAND_AMT END OR CASE WHEN LKP_FARMPOLS.RFD_OUTSTAND_TYPE IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_OUTSTAND_TYPE END <> CASE WHEN sq_STG_FARMPOLS.RFD_OUTSTAND_TYPE IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_OUTSTAND_TYPE END OR CASE WHEN LKP_FARMPOLS.RFD_OUTSTAND_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_OUTSTAND_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_OUTSTAND_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_OUTSTAND_DT END OR CASE WHEN LKP_FARMPOLS.RFD_OUTSTAND_PD_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_OUTSTAND_PD_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_OUTSTAND_PD_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_OUTSTAND_PD_DT END OR CASE WHEN LKP_FARMPOLS.RFD_SUSPENSE_CD IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_SUSPENSE_CD END <> CASE WHEN sq_STG_FARMPOLS.RFD_SUSPENSE_CD IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_SUSPENSE_CD END OR CASE WHEN LKP_FARMPOLS.RFD_SUSPENSE_CANCL IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_SUSPENSE_CANCL END <> CASE WHEN sq_STG_FARMPOLS.RFD_SUSPENSE_CANCL IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_SUSPENSE_CANCL END OR CASE WHEN LKP_FARMPOLS.RFD_SSNO_1 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_SSNO_1 END <> CASE WHEN sq_STG_FARMPOLS.RFD_SSNO_1 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_SSNO_1 END OR CASE WHEN LKP_FARMPOLS.RFD_SSNO_2 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_SSNO_2 END <> CASE WHEN sq_STG_FARMPOLS.RFD_SSNO_2 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_SSNO_2 END OR CASE WHEN LKP_FARMPOLS.RFD_REVIEW_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_REVIEW_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_REVIEW_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_REVIEW_DT END OR CASE WHEN LKP_FARMPOLS.RFD_UW_INIT IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_UW_INIT END <> CASE WHEN sq_STG_FARMPOLS.RFD_UW_INIT IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_UW_INIT END OR CASE WHEN LKP_FARMPOLS.RFD_MORT_NAME_1 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_MORT_NAME_1 END <> CASE WHEN sq_STG_FARMPOLS.RFD_MORT_NAME_1 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_MORT_NAME_1 END OR CASE WHEN LKP_FARMPOLS.RFD_MORT_NAME_2 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_MORT_NAME_2 END <> CASE WHEN sq_STG_FARMPOLS.RFD_MORT_NAME_2 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_MORT_NAME_2 END OR CASE WHEN LKP_FARMPOLS.RFD_MORT_ADD_1 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_MORT_ADD_1 END <> CASE WHEN sq_STG_FARMPOLS.RFD_MORT_ADD_1 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_MORT_ADD_1 END OR CASE WHEN LKP_FARMPOLS.RFD_MORT_ADD_2 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_MORT_ADD_2 END <> CASE WHEN sq_STG_FARMPOLS.RFD_MORT_ADD_2 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_MORT_ADD_2 END OR CASE WHEN LKP_FARMPOLS.RFD_MORT_CITYST IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_MORT_CITYST END <> CASE WHEN sq_STG_FARMPOLS.RFD_MORT_CITYST IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_MORT_CITYST END OR CASE WHEN LKP_FARMPOLS.RFD_MORT_ZIP IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_MORT_ZIP END <> CASE WHEN sq_STG_FARMPOLS.RFD_MORT_ZIP IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_MORT_ZIP END OR CASE WHEN LKP_FARMPOLS.RFD_STATE IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_STATE END <> CASE WHEN sq_STG_FARMPOLS.RFD_STATE IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_STATE END OR CASE WHEN LKP_FARMPOLS.RFD_MORT_TYPE IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_MORT_TYPE END <> CASE WHEN sq_STG_FARMPOLS.RFD_MORT_TYPE IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_MORT_TYPE END OR CASE WHEN LKP_FARMPOLS.RFD_LOAN_NUM IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_LOAN_NUM END <> CASE WHEN sq_STG_FARMPOLS.RFD_LOAN_NUM IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_LOAN_NUM END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PRI_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PRI_COV END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_UNSCH IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PRI_UNSCH END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_UNSCH IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PRI_UNSCH END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_ADDL IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PRI_ADDL END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_ADDL IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PRI_ADDL END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_HS IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PRI_HS END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_HS IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PRI_HS END OR CASE WHEN LKP_FARMPOLS.RFD_PPRI_CLASS IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_PPRI_CLASS END <> CASE WHEN sq_STG_FARMPOLS.RFD_PPRI_CLASS IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_PPRI_CLASS END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_CONST IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PRI_CONST END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_CONST IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PRI_CONST END OR CASE WHEN LKP_FARMPOLS.RFD_PPRI_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PPRI_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PPRI_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PPRI_COV END OR CASE WHEN LKP_FARMPOLS.RFD_PPRI_UNSCH IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PPRI_UNSCH END <> CASE WHEN sq_STG_FARMPOLS.RFD_PPRI_UNSCH IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PPRI_UNSCH END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_COV_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_PRI_COV_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_COV_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_PRI_COV_DT END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_BCOV_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_PRI_BCOV_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_BCOV_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_PRI_BCOV_DT END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_SEC_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_SEC_COV END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_UNSCH IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_SEC_UNSCH END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_UNSCH IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_SEC_UNSCH END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_ADDL IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_SEC_ADDL END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_ADDL IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_SEC_ADDL END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_HS IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_SEC_HS END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_HS IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_SEC_HS END OR CASE WHEN LKP_FARMPOLS.RFD_PSEC_CLASS IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_PSEC_CLASS END <> CASE WHEN sq_STG_FARMPOLS.RFD_PSEC_CLASS IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_PSEC_CLASS END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_CONST IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_SEC_CONST END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_CONST IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_SEC_CONST END OR CASE WHEN LKP_FARMPOLS.RFD_PSEC_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PSEC_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PSEC_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PSEC_COV END OR CASE WHEN LKP_FARMPOLS.RFD_PSEC_BCOV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PSEC_BCOV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PSEC_BCOV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PSEC_BCOV END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_COV_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_SEC_COV_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_COV_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_SEC_COV_DT END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_BCOV_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_SEC_BCOV_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_BCOV_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_SEC_BCOV_DT END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_CLASS IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_PRI_CLASS END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_CLASS IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_PRI_CLASS END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PRI_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PRI_DED END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_CLASS IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_SEC_CLASS END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_CLASS IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_SEC_CLASS END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_SEC_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_SEC_DED END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_PREM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PRI_PREM END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_PREM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PRI_PREM END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_PREM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_SEC_PREM END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_PREM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_SEC_PREM END OR CASE WHEN LKP_FARMPOLS.RFD_ANICOLL_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_ANICOLL_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_ANICOLL_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_ANICOLL_DT END OR CASE WHEN LKP_FARMPOLS.RFD_PPRI_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PPRI_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PPRI_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PPRI_DED END OR CASE WHEN LKP_FARMPOLS.RFD_PSEC_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PSEC_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PSEC_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PSEC_DED END OR CASE WHEN LKP_FARMPOLS.RFD_LIAB IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_LIAB END <> CASE WHEN sq_STG_FARMPOLS.RFD_LIAB IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_LIAB END OR CASE WHEN LKP_FARMPOLS.RFD_MED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_MED END <> CASE WHEN sq_STG_FARMPOLS.RFD_MED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_MED END OR CASE WHEN LKP_FARMPOLS.RFD_ADD_BLDGS IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_ADD_BLDGS END <> CASE WHEN sq_STG_FARMPOLS.RFD_ADD_BLDGS IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_ADD_BLDGS END OR CASE WHEN LKP_FARMPOLS.RFD_PLIAB IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PLIAB END <> CASE WHEN sq_STG_FARMPOLS.RFD_PLIAB IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PLIAB END OR CASE WHEN LKP_FARMPOLS.RFD_PMED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PMED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PMED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PMED END OR CASE WHEN LKP_FARMPOLS.RFD_PADD_BLDGS IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PADD_BLDGS END <> CASE WHEN sq_STG_FARMPOLS.RFD_PADD_BLDGS IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PADD_BLDGS END OR CASE WHEN LKP_FARMPOLS.RFD_LIAB_MED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_LIAB_MED_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_LIAB_MED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_LIAB_MED_DT END OR CASE WHEN LKP_FARMPOLS.RFD_TOT_ACRES IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_TOT_ACRES END <> CASE WHEN sq_STG_FARMPOLS.RFD_TOT_ACRES IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_TOT_ACRES END OR CASE WHEN LKP_FARMPOLS.RFD_PTOT_ACRES IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PTOT_ACRES END <> CASE WHEN sq_STG_FARMPOLS.RFD_PTOT_ACRES IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PTOT_ACRES END OR CASE WHEN LKP_FARMPOLS.RFD_PYRL_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PYRL_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PYRL_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PYRL_COV END OR CASE WHEN LKP_FARMPOLS.RFD_PPYRL_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PPYRL_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PPYRL_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PPYRL_COV END OR CASE WHEN LKP_FARMPOLS.RFD_RECEIPTS IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_RECEIPTS END <> CASE WHEN sq_STG_FARMPOLS.RFD_RECEIPTS IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_RECEIPTS END OR CASE WHEN LKP_FARMPOLS.RFD_PRECEIPTS IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PRECEIPTS END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRECEIPTS IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PRECEIPTS END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_DWELL IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_SEC_DWELL END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_DWELL IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_SEC_DWELL END OR CASE WHEN LKP_FARMPOLS.RFD_PSEC_DWELL IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PSEC_DWELL END <> CASE WHEN sq_STG_FARMPOLS.RFD_PSEC_DWELL IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PSEC_DWELL END OR CASE WHEN LKP_FARMPOLS.RFD_OFFICES IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_OFFICES END <> CASE WHEN sq_STG_FARMPOLS.RFD_OFFICES IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_OFFICES END OR CASE WHEN LKP_FARMPOLS.RFD_POFFICES IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_POFFICES END <> CASE WHEN sq_STG_FARMPOLS.RFD_POFFICES IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_POFFICES END OR CASE WHEN LKP_FARMPOLS.RFD_PONDS IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PONDS END <> CASE WHEN sq_STG_FARMPOLS.RFD_PONDS IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PONDS END OR CASE WHEN LKP_FARMPOLS.RFD_PPONDS IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PPONDS END <> CASE WHEN sq_STG_FARMPOLS.RFD_PPONDS IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PPONDS END OR CASE WHEN LKP_FARMPOLS.RFD_NAMED_INSD IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_NAMED_INSD END <> CASE WHEN sq_STG_FARMPOLS.RFD_NAMED_INSD IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_NAMED_INSD END OR CASE WHEN LKP_FARMPOLS.RFD_PNAMED_INSD IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PNAMED_INSD END <> CASE WHEN sq_STG_FARMPOLS.RFD_PNAMED_INSD IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PNAMED_INSD END OR CASE WHEN LKP_FARMPOLS.RFD_FO_06_NON_NAME IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_FO_06_NON_NAME END <> CASE WHEN sq_STG_FARMPOLS.RFD_FO_06_NON_NAME IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_FO_06_NON_NAME END OR CASE WHEN LKP_FARMPOLS.RFD_PNON_NAMED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PNON_NAMED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PNON_NAMED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PNON_NAMED END OR CASE WHEN LKP_FARMPOLS.RFD_NAMED_MED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_NAMED_MED END <> CASE WHEN sq_STG_FARMPOLS.RFD_NAMED_MED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_NAMED_MED END OR CASE WHEN LKP_FARMPOLS.RFD_PNAMED_MED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PNAMED_MED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PNAMED_MED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PNAMED_MED END OR CASE WHEN LKP_FARMPOLS.RFD_ADDL_RES IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_ADDL_RES END <> CASE WHEN sq_STG_FARMPOLS.RFD_ADDL_RES IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_ADDL_RES END OR CASE WHEN LKP_FARMPOLS.RFD_PADDL_RES IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PADDL_RES END <> CASE WHEN sq_STG_FARMPOLS.RFD_PADDL_RES IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PADDL_RES END OR CASE WHEN LKP_FARMPOLS.RFD_NAMED_MED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_NAMED_MED_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_NAMED_MED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_NAMED_MED_DT END OR CASE WHEN LKP_FARMPOLS.RFD_NAMED_MED_PRM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_NAMED_MED_PRM END <> CASE WHEN sq_STG_FARMPOLS.RFD_NAMED_MED_PRM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_NAMED_MED_PRM END OR CASE WHEN LKP_FARMPOLS.RFD_LIAB_PRM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_LIAB_PRM END <> CASE WHEN sq_STG_FARMPOLS.RFD_LIAB_PRM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_LIAB_PRM END OR CASE WHEN LKP_FARMPOLS.RFD_LVSTK_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_LVSTK_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_LVSTK_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_LVSTK_COV END OR CASE WHEN LKP_FARMPOLS.RFD_LVSTK_PRM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_LVSTK_PRM END <> CASE WHEN sq_STG_FARMPOLS.RFD_LVSTK_PRM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_LVSTK_PRM END OR CASE WHEN LKP_FARMPOLS.RFD_LVSTK_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_LVSTK_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_LVSTK_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_LVSTK_DED END OR CASE WHEN LKP_FARMPOLS.RFD_PLVSTK_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PLVSTK_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PLVSTK_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PLVSTK_COV END OR CASE WHEN LKP_FARMPOLS.RFD_PLVSTK_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PLVSTK_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PLVSTK_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PLVSTK_DED END OR CASE WHEN LKP_FARMPOLS.RFD_LVSTK_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_LVSTK_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_LVSTK_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_LVSTK_DT END OR CASE WHEN LKP_FARMPOLS.RFD_LVSTK_DED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_LVSTK_DED_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_LVSTK_DED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_LVSTK_DED_DT END OR CASE WHEN LKP_FARMPOLS.RFD_ANICOLL_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_ANICOLL_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_ANICOLL_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_ANICOLL_COV END OR CASE WHEN LKP_FARMPOLS.RFD_FDSD_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_FDSD_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_FDSD_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_FDSD_COV END OR CASE WHEN LKP_FARMPOLS.RFD_FDSD_PRM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_FDSD_PRM END <> CASE WHEN sq_STG_FARMPOLS.RFD_FDSD_PRM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_FDSD_PRM END OR CASE WHEN LKP_FARMPOLS.RFD_FDSD_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_FDSD_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_FDSD_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_FDSD_DED END OR CASE WHEN LKP_FARMPOLS.RFD_PFDSD_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PFDSD_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PFDSD_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PFDSD_COV END OR CASE WHEN LKP_FARMPOLS.RFD_PFDSD_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PFDSD_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PFDSD_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PFDSD_DED END OR CASE WHEN LKP_FARMPOLS.RFD_FDSD_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_FDSD_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_FDSD_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_FDSD_DT END OR CASE WHEN LKP_FARMPOLS.RFD_FDSD_DED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_FDSD_DED_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_FDSD_DED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_FDSD_DED_DT END OR CASE WHEN LKP_FARMPOLS.RFD_ANICOLL_PRM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_ANICOLL_PRM END <> CASE WHEN sq_STG_FARMPOLS.RFD_ANICOLL_PRM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_ANICOLL_PRM END OR CASE WHEN LKP_FARMPOLS.RFD_MACH_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_MACH_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_MACH_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_MACH_COV END OR CASE WHEN LKP_FARMPOLS.RFD_MACH_PRM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_MACH_PRM END <> CASE WHEN sq_STG_FARMPOLS.RFD_MACH_PRM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_MACH_PRM END OR CASE WHEN LKP_FARMPOLS.RFD_MACH_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_MACH_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_MACH_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_MACH_DED END OR CASE WHEN LKP_FARMPOLS.RFD_PMACH_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PMACH_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PMACH_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PMACH_COV END OR CASE WHEN LKP_FARMPOLS.RFD_PMACH_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PMACH_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PMACH_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PMACH_DED END OR CASE WHEN LKP_FARMPOLS.RFD_MACH_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_MACH_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_MACH_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_MACH_DT END OR CASE WHEN LKP_FARMPOLS.RFD_MACH_DED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_MACH_DED_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_MACH_DED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_MACH_DED_DT END OR CASE WHEN LKP_FARMPOLS.RFD_PANICOLL_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PANICOLL_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PANICOLL_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PANICOLL_COV END OR CASE WHEN LKP_FARMPOLS.RFD_H_MACH_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_H_MACH_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_H_MACH_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_H_MACH_COV END OR CASE WHEN LKP_FARMPOLS.RFD_H_MACH_PRM IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_H_MACH_PRM END <> CASE WHEN sq_STG_FARMPOLS.RFD_H_MACH_PRM IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_H_MACH_PRM END OR CASE WHEN LKP_FARMPOLS.RFD_H_MACH_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_H_MACH_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_H_MACH_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_H_MACH_DED END OR CASE WHEN LKP_FARMPOLS.RFD_PH_MACH_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PH_MACH_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_PH_MACH_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PH_MACH_COV END OR CASE WHEN LKP_FARMPOLS.RFD_PH_MACH_DED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_PH_MACH_DED END <> CASE WHEN sq_STG_FARMPOLS.RFD_PH_MACH_DED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_PH_MACH_DED END OR CASE WHEN LKP_FARMPOLS.RFD_H_MACH_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_H_MACH_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_H_MACH_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_H_MACH_DT END OR CASE WHEN LKP_FARMPOLS.RFD_H_MACH_DED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_H_MACH_DED_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_H_MACH_DED_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_H_MACH_DED_DT END OR CASE WHEN LKP_FARMPOLS.RFD_VC_DIS_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FARMPOLS.RFD_VC_DIS_DT END <> CASE WHEN sq_STG_FARMPOLS.RFD_VC_DIS_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE sq_STG_FARMPOLS.RFD_VC_DIS_DT END OR CASE WHEN LKP_FARMPOLS.RFD_VC_DISCT IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_VC_DISCT END <> CASE WHEN sq_STG_FARMPOLS.RFD_VC_DISCT IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_VC_DISCT END OR CASE WHEN LKP_FARMPOLS.RFD_LOC1 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_LOC1 END <> CASE WHEN sq_STG_FARMPOLS.RFD_LOC1 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_LOC1 END OR CASE WHEN LKP_FARMPOLS.RFD_LOC2 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_LOC2 END <> CASE WHEN sq_STG_FARMPOLS.RFD_LOC2 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_LOC2 END OR CASE WHEN LKP_FARMPOLS.RFD_LOC3 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_LOC3 END <> CASE WHEN sq_STG_FARMPOLS.RFD_LOC3 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_LOC3 END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_TOT IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_TOT END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_TOT IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_TOT END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_DWELL IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_DWELL END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_DWELL IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_DWELL END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_UNSCH IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_UNSCH END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_UNSCH IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_UNSCH END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_ADDL IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_ADDL END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_ADDL IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_ADDL END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_LIAB IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_LIAB END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_LIAB IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_LIAB END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_MED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_MED END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_MED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_MED END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_OUTBLDG IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_OUTBLDG END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_OUTBLDG IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_OUTBLDG END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_PD IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_PD END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_PD IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_PD END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_NMED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_NMED END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_NMED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_NMED END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_LVSTK IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_LVSTK END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_LVSTK IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_LVSTK END OR CASE WHEN LKP_FARMPOLS.RFD_1YR_MACH IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_1YR_MACH END <> CASE WHEN sq_STG_FARMPOLS.RFD_1YR_MACH IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_1YR_MACH END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_TOT IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_TOT END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_TOT IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_TOT END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_DWELL IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_DWELL END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_DWELL IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_DWELL END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_UNSCH IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_UNSCH END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_UNSCH IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_UNSCH END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_ADDL IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_ADDL END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_ADDL IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_ADDL END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_LIAB IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_LIAB END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_LIAB IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_LIAB END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_MED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_MED END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_MED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_MED END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_OUTBLDG IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_OUTBLDG END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_OUTBLDG IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_OUTBLDG END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_PD IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_PD END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_PD IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_PD END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_NMED IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_NMED END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_NMED IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_NMED END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_LVSTK IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_LVSTK END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_LVSTK IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_LVSTK END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_MACH IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_MACH END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_MACH IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_MACH END OR CASE WHEN LKP_FARMPOLS.RFD_5YR_AMT IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_5YR_AMT END <> CASE WHEN sq_STG_FARMPOLS.RFD_5YR_AMT IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_5YR_AMT END OR CASE WHEN LKP_FARMPOLS.RFD_INFL_PRI_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_INFL_PRI_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_INFL_PRI_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_INFL_PRI_COV END OR CASE WHEN LKP_FARMPOLS.RFD_INFL_PRI_UNSCH IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_INFL_PRI_UNSCH END <> CASE WHEN sq_STG_FARMPOLS.RFD_INFL_PRI_UNSCH IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_INFL_PRI_UNSCH END OR CASE WHEN LKP_FARMPOLS.RFD_NAMED_MED1 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_NAMED_MED1 END <> CASE WHEN sq_STG_FARMPOLS.RFD_NAMED_MED1 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_NAMED_MED1 END OR CASE WHEN LKP_FARMPOLS.RFD_NAMED_MED2 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_NAMED_MED2 END <> CASE WHEN sq_STG_FARMPOLS.RFD_NAMED_MED2 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_NAMED_MED2 END OR CASE WHEN LKP_FARMPOLS.RFD_NAMED_MED3 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_NAMED_MED3 END <> CASE WHEN sq_STG_FARMPOLS.RFD_NAMED_MED3 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_NAMED_MED3 END OR CASE WHEN LKP_FARMPOLS.RFD_INFL_SEC_COV IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_INFL_SEC_COV END <> CASE WHEN sq_STG_FARMPOLS.RFD_INFL_SEC_COV IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_INFL_SEC_COV END OR CASE WHEN LKP_FARMPOLS.RFD_INFL_SEC_UNSCH IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_INFL_SEC_UNSCH END <> CASE WHEN sq_STG_FARMPOLS.RFD_INFL_SEC_UNSCH IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_INFL_SEC_UNSCH END OR CASE WHEN LKP_FARMPOLS.RFD_PRI_CNTY IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_PRI_CNTY END <> CASE WHEN sq_STG_FARMPOLS.RFD_PRI_CNTY IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_PRI_CNTY END OR CASE WHEN LKP_FARMPOLS.RFD_SEC_CNTY IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_SEC_CNTY END <> CASE WHEN sq_STG_FARMPOLS.RFD_SEC_CNTY IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_SEC_CNTY END OR CASE WHEN LKP_FARMPOLS.RFD_OVER9 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_OVER9 END <> CASE WHEN sq_STG_FARMPOLS.RFD_OVER9 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_OVER9 END OR CASE WHEN LKP_FARMPOLS.RFD_EBLDG_CON_YR01 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_EBLDG_CON_YR01 END <> CASE WHEN sq_STG_FARMPOLS.RFD_EBLDG_CON_YR01 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_EBLDG_CON_YR01 END OR CASE WHEN LKP_FARMPOLS.RFD_EBLDG_CON_YR02 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_EBLDG_CON_YR02 END <> CASE WHEN sq_STG_FARMPOLS.RFD_EBLDG_CON_YR02 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_EBLDG_CON_YR02 END OR CASE WHEN LKP_FARMPOLS.RFD_EBLDG_CON_YR03 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_EBLDG_CON_YR03 END <> CASE WHEN sq_STG_FARMPOLS.RFD_EBLDG_CON_YR03 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_EBLDG_CON_YR03 END OR CASE WHEN LKP_FARMPOLS.RFD_EBLDG_CON_YR04 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_EBLDG_CON_YR04 END <> CASE WHEN sq_STG_FARMPOLS.RFD_EBLDG_CON_YR04 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_EBLDG_CON_YR04 END OR CASE WHEN LKP_FARMPOLS.RFD_EBLDG_CON_YR05 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_EBLDG_CON_YR05 END <> CASE WHEN sq_STG_FARMPOLS.RFD_EBLDG_CON_YR05 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_EBLDG_CON_YR05 END OR CASE WHEN LKP_FARMPOLS.RFD_EBLDG_CON_YR06 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_EBLDG_CON_YR06 END <> CASE WHEN sq_STG_FARMPOLS.RFD_EBLDG_CON_YR06 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_EBLDG_CON_YR06 END OR CASE WHEN LKP_FARMPOLS.RFD_EBLDG_CON_YR07 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_EBLDG_CON_YR07 END <> CASE WHEN sq_STG_FARMPOLS.RFD_EBLDG_CON_YR07 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_EBLDG_CON_YR07 END OR CASE WHEN LKP_FARMPOLS.RFD_EBLDG_CON_YR08 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_EBLDG_CON_YR08 END <> CASE WHEN sq_STG_FARMPOLS.RFD_EBLDG_CON_YR08 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_EBLDG_CON_YR08 END OR CASE WHEN LKP_FARMPOLS.RFD_EBLDG_CON_YR09 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_EBLDG_CON_YR09 END <> CASE WHEN sq_STG_FARMPOLS.RFD_EBLDG_CON_YR09 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_EBLDG_CON_YR09 END OR CASE WHEN LKP_FARMPOLS.RFD_MB_TYPE IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_MB_TYPE END <> CASE WHEN sq_STG_FARMPOLS.RFD_MB_TYPE IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_MB_TYPE END OR CASE WHEN LKP_FARMPOLS.RFD_MB_ACCT_NUM IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_MB_ACCT_NUM END <> CASE WHEN sq_STG_FARMPOLS.RFD_MB_ACCT_NUM IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_MB_ACCT_NUM END OR CASE WHEN LKP_FARMPOLS.RFD_FO_07 IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_FO_07 END <> CASE WHEN sq_STG_FARMPOLS.RFD_FO_07 IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_FO_07 END OR CASE WHEN LKP_FARMPOLS.RFD_FO_46 IS NULL THEN 0 ELSE LKP_FARMPOLS.RFD_FO_46 END <> CASE WHEN sq_STG_FARMPOLS.RFD_FO_46 IS NULL THEN 0 ELSE sq_STG_FARMPOLS.RFD_FO_46 END OR CASE WHEN LKP_FARMPOLS.RFD_FO_85 IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_FO_85 END <> CASE WHEN sq_STG_FARMPOLS.RFD_FO_85 IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_FO_85 END OR CASE WHEN LKP_FARMPOLS.RFD_ROLL_OVER_IND IS NULL THEN ''~'' ELSE LKP_FARMPOLS.RFD_ROLL_OVER_IND END <> CASE WHEN sq_STG_FARMPOLS.RFD_ROLL_OVER_IND IS NULL THEN ''~'' ELSE sq_STG_FARMPOLS.RFD_ROLL_OVER_IND END THEN ''UPD'' ELSE ''REJ'' END END as out_FLAG,
:PMMappingName as out_PRGM_NM,
:PROJ_ID as out_ACT_PROJ_ID,
:BATCH_ACTIVE_IND as out_BATCH_ACTIVE_IND,
sq_STG_FARMPOLS.source_record_id
FROM
sq_STG_FARMPOLS
INNER JOIN LKP_FARMPOLS ON sq_STG_FARMPOLS.source_record_id = LKP_FARMPOLS.source_record_id
);


-- Component mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, Type MAPPLET 
--MAPPLET NOT REGISTERED: mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, mapplet instance mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE;


-- Component exp_FARMPOLS, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_FARMPOLS AS
(
SELECT
exp_DERIVE_FLAG.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY,
exp_DERIVE_FLAG.SC_SERVICE_CENTER as SC_SERVICE_CENTER,
exp_DERIVE_FLAG.SC_POLICY_NUM as SC_POLICY_NUM,
exp_DERIVE_FLAG.SC_FLT_ITEM as SC_FLT_ITEM,
exp_DERIVE_FLAG.SC_FILE_TYPE as SC_FILE_TYPE,
exp_DERIVE_FLAG.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE,
exp_DERIVE_FLAG.SC_TRANS_DATE as SC_TRANS_DATE,
exp_DERIVE_FLAG.SC_TRANS_TYPE as SC_TRANS_TYPE,
exp_DERIVE_FLAG.PC_ALPHA_CODE as PC_ALPHA_CODE,
exp_DERIVE_FLAG.PC_NAME_1 as PC_NAME_1,
exp_DERIVE_FLAG.PC_NAME_2 as PC_NAME_2,
exp_DERIVE_FLAG.PC_ADDRESS_1 as PC_ADDRESS_1,
exp_DERIVE_FLAG.PC_ADDRESS_2 as PC_ADDRESS_2,
exp_DERIVE_FLAG.PC_CITYST as PC_CITYST,
exp_DERIVE_FLAG.PC_ZIP as PC_ZIP,
exp_DERIVE_FLAG.PC_TAX_CODE as PC_TAX_CODE,
exp_DERIVE_FLAG.PC_AGENT as PC_AGENT,
exp_DERIVE_FLAG.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER,
exp_DERIVE_FLAG.PC_RATE_CODE as PC_RATE_CODE,
exp_DERIVE_FLAG.PC_ENCUMBRANCE as PC_ENCUMBRANCE,
exp_DERIVE_FLAG.PC_PREM_FIN as PC_PREM_FIN,
exp_DERIVE_FLAG.PC_MORT_IND as PC_MORT_IND,
exp_DERIVE_FLAG.PC_COMPANY as PC_COMPANY,
exp_DERIVE_FLAG.PC_INCEPT_DATE as PC_INCEPT_DATE,
exp_DERIVE_FLAG.PC_EXP_DATE as PC_EXP_DATE,
exp_DERIVE_FLAG.PC_EFF_DATE as PC_EFF_DATE,
exp_DERIVE_FLAG.PC_STATUS as PC_STATUS,
exp_DERIVE_FLAG.RFD_TOT_PREM as RFD_TOT_PREM,
exp_DERIVE_FLAG.RFD_REWRITE_IND as RFD_REWRITE_IND,
exp_DERIVE_FLAG.RFD_REWRITE_DT as RFD_REWRITE_DT,
exp_DERIVE_FLAG.RFD_OUTSTAND_AMT as RFD_OUTSTAND_AMT,
exp_DERIVE_FLAG.RFD_OUTSTAND_TYPE as RFD_OUTSTAND_TYPE,
exp_DERIVE_FLAG.RFD_OUTSTAND_DT as RFD_OUTSTAND_DT,
exp_DERIVE_FLAG.RFD_OUTSTAND_PD_DT as RFD_OUTSTAND_PD_DT,
exp_DERIVE_FLAG.RFD_SUSPENSE_CD as RFD_SUSPENSE_CD,
exp_DERIVE_FLAG.RFD_SUSPENSE_CANCL as RFD_SUSPENSE_CANCL,
exp_DERIVE_FLAG.RFD_SSNO_1 as RFD_SSNO_1,
exp_DERIVE_FLAG.RFD_SSNO_2 as RFD_SSNO_2,
exp_DERIVE_FLAG.RFD_REVIEW_DT as RFD_REVIEW_DT,
exp_DERIVE_FLAG.RFD_UW_INIT as RFD_UW_INIT,
exp_DERIVE_FLAG.RFD_MORT_NAME_1 as RFD_MORT_NAME_1,
exp_DERIVE_FLAG.RFD_MORT_NAME_2 as RFD_MORT_NAME_2,
exp_DERIVE_FLAG.RFD_MORT_ADD_1 as RFD_MORT_ADD_1,
exp_DERIVE_FLAG.RFD_MORT_ADD_2 as RFD_MORT_ADD_2,
exp_DERIVE_FLAG.RFD_MORT_CITYST as RFD_MORT_CITYST,
exp_DERIVE_FLAG.RFD_MORT_ZIP as RFD_MORT_ZIP,
exp_DERIVE_FLAG.RFD_STATE as RFD_STATE,
exp_DERIVE_FLAG.RFD_MORT_TYPE as RFD_MORT_TYPE,
exp_DERIVE_FLAG.RFD_LOAN_NUM as RFD_LOAN_NUM,
exp_DERIVE_FLAG.RFD_PRI_COV as RFD_PRI_COV,
exp_DERIVE_FLAG.RFD_PRI_UNSCH as RFD_PRI_UNSCH,
exp_DERIVE_FLAG.RFD_PRI_ADDL as RFD_PRI_ADDL,
exp_DERIVE_FLAG.RFD_PRI_HS as RFD_PRI_HS,
exp_DERIVE_FLAG.RFD_PPRI_CLASS as RFD_PPRI_CLASS,
exp_DERIVE_FLAG.RFD_PRI_CONST as RFD_PRI_CONST,
exp_DERIVE_FLAG.RFD_PPRI_COV as RFD_PPRI_COV,
exp_DERIVE_FLAG.RFD_PPRI_UNSCH as RFD_PPRI_UNSCH,
exp_DERIVE_FLAG.RFD_PRI_COV_DT as RFD_PRI_COV_DT,
exp_DERIVE_FLAG.RFD_PRI_BCOV_DT as RFD_PRI_BCOV_DT,
exp_DERIVE_FLAG.RFD_SEC_COV as RFD_SEC_COV,
exp_DERIVE_FLAG.RFD_SEC_UNSCH as RFD_SEC_UNSCH,
exp_DERIVE_FLAG.RFD_SEC_ADDL as RFD_SEC_ADDL,
exp_DERIVE_FLAG.RFD_SEC_HS as RFD_SEC_HS,
exp_DERIVE_FLAG.RFD_PSEC_CLASS as RFD_PSEC_CLASS,
exp_DERIVE_FLAG.RFD_SEC_CONST as RFD_SEC_CONST,
exp_DERIVE_FLAG.RFD_PSEC_COV as RFD_PSEC_COV,
exp_DERIVE_FLAG.RFD_PSEC_BCOV as RFD_PSEC_BCOV,
exp_DERIVE_FLAG.RFD_SEC_COV_DT as RFD_SEC_COV_DT,
exp_DERIVE_FLAG.RFD_SEC_BCOV_DT as RFD_SEC_BCOV_DT,
exp_DERIVE_FLAG.RFD_PRI_CLASS as RFD_PRI_CLASS,
exp_DERIVE_FLAG.RFD_PRI_DED as RFD_PRI_DED,
exp_DERIVE_FLAG.RFD_SEC_CLASS as RFD_SEC_CLASS,
exp_DERIVE_FLAG.RFD_SEC_DED as RFD_SEC_DED,
exp_DERIVE_FLAG.RFD_PRI_PREM as RFD_PRI_PREM,
exp_DERIVE_FLAG.RFD_SEC_PREM as RFD_SEC_PREM,
exp_DERIVE_FLAG.RFD_ANICOLL_DT as RFD_ANICOLL_DT,
exp_DERIVE_FLAG.RFD_PPRI_DED as RFD_PPRI_DED,
exp_DERIVE_FLAG.RFD_PSEC_DED as RFD_PSEC_DED,
exp_DERIVE_FLAG.RFD_LIAB as RFD_LIAB,
exp_DERIVE_FLAG.RFD_MED as RFD_MED,
exp_DERIVE_FLAG.RFD_ADD_BLDGS as RFD_ADD_BLDGS,
exp_DERIVE_FLAG.RFD_PLIAB as RFD_PLIAB,
exp_DERIVE_FLAG.RFD_PMED as RFD_PMED,
exp_DERIVE_FLAG.RFD_PADD_BLDGS as RFD_PADD_BLDGS,
exp_DERIVE_FLAG.RFD_LIAB_MED_DT as RFD_LIAB_MED_DT,
exp_DERIVE_FLAG.RFD_TOT_ACRES as RFD_TOT_ACRES,
exp_DERIVE_FLAG.RFD_PTOT_ACRES as RFD_PTOT_ACRES,
exp_DERIVE_FLAG.RFD_PYRL_COV as RFD_PYRL_COV,
exp_DERIVE_FLAG.RFD_PPYRL_COV as RFD_PPYRL_COV,
exp_DERIVE_FLAG.RFD_RECEIPTS as RFD_RECEIPTS,
exp_DERIVE_FLAG.RFD_PRECEIPTS as RFD_PRECEIPTS,
exp_DERIVE_FLAG.RFD_SEC_DWELL as RFD_SEC_DWELL,
exp_DERIVE_FLAG.RFD_PSEC_DWELL as RFD_PSEC_DWELL,
exp_DERIVE_FLAG.RFD_OFFICES as RFD_OFFICES,
exp_DERIVE_FLAG.RFD_POFFICES as RFD_POFFICES,
exp_DERIVE_FLAG.RFD_PONDS as RFD_PONDS,
exp_DERIVE_FLAG.RFD_PPONDS as RFD_PPONDS,
exp_DERIVE_FLAG.RFD_NAMED_INSD as RFD_NAMED_INSD,
exp_DERIVE_FLAG.RFD_PNAMED_INSD as RFD_PNAMED_INSD,
exp_DERIVE_FLAG.RFD_FO_06_NON_NAME as RFD_FO_06_NON_NAME,
exp_DERIVE_FLAG.RFD_PNON_NAMED as RFD_PNON_NAMED,
exp_DERIVE_FLAG.RFD_NAMED_MED as RFD_NAMED_MED,
exp_DERIVE_FLAG.RFD_PNAMED_MED as RFD_PNAMED_MED,
exp_DERIVE_FLAG.RFD_ADDL_RES as RFD_ADDL_RES,
exp_DERIVE_FLAG.RFD_PADDL_RES as RFD_PADDL_RES,
exp_DERIVE_FLAG.RFD_NAMED_MED_DT as RFD_NAMED_MED_DT,
exp_DERIVE_FLAG.RFD_NAMED_MED_PRM as RFD_NAMED_MED_PRM,
exp_DERIVE_FLAG.RFD_LIAB_PRM as RFD_LIAB_PRM,
exp_DERIVE_FLAG.RFD_LVSTK_COV as RFD_LVSTK_COV,
exp_DERIVE_FLAG.RFD_LVSTK_PRM as RFD_LVSTK_PRM,
exp_DERIVE_FLAG.RFD_LVSTK_DED as RFD_LVSTK_DED,
exp_DERIVE_FLAG.RFD_PLVSTK_COV as RFD_PLVSTK_COV,
exp_DERIVE_FLAG.RFD_PLVSTK_DED as RFD_PLVSTK_DED,
exp_DERIVE_FLAG.RFD_LVSTK_DT as RFD_LVSTK_DT,
exp_DERIVE_FLAG.RFD_LVSTK_DED_DT as RFD_LVSTK_DED_DT,
exp_DERIVE_FLAG.RFD_ANICOLL_COV as RFD_ANICOLL_COV,
exp_DERIVE_FLAG.RFD_FDSD_COV as RFD_FDSD_COV,
exp_DERIVE_FLAG.RFD_FDSD_PRM as RFD_FDSD_PRM,
exp_DERIVE_FLAG.RFD_FDSD_DED as RFD_FDSD_DED,
exp_DERIVE_FLAG.RFD_PFDSD_COV as RFD_PFDSD_COV,
exp_DERIVE_FLAG.RFD_PFDSD_DED as RFD_PFDSD_DED,
exp_DERIVE_FLAG.RFD_FDSD_DT as RFD_FDSD_DT,
exp_DERIVE_FLAG.RFD_FDSD_DED_DT as RFD_FDSD_DED_DT,
exp_DERIVE_FLAG.RFD_ANICOLL_PRM as RFD_ANICOLL_PRM,
exp_DERIVE_FLAG.RFD_MACH_COV as RFD_MACH_COV,
exp_DERIVE_FLAG.RFD_MACH_PRM as RFD_MACH_PRM,
exp_DERIVE_FLAG.RFD_MACH_DED as RFD_MACH_DED,
exp_DERIVE_FLAG.RFD_PMACH_COV as RFD_PMACH_COV,
exp_DERIVE_FLAG.RFD_PMACH_DED as RFD_PMACH_DED,
exp_DERIVE_FLAG.RFD_MACH_DT as RFD_MACH_DT,
exp_DERIVE_FLAG.RFD_MACH_DED_DT as RFD_MACH_DED_DT,
exp_DERIVE_FLAG.RFD_PANICOLL_COV as RFD_PANICOLL_COV,
exp_DERIVE_FLAG.RFD_H_MACH_COV as RFD_H_MACH_COV,
exp_DERIVE_FLAG.RFD_H_MACH_PRM as RFD_H_MACH_PRM,
exp_DERIVE_FLAG.RFD_H_MACH_DED as RFD_H_MACH_DED,
exp_DERIVE_FLAG.RFD_PH_MACH_COV as RFD_PH_MACH_COV,
exp_DERIVE_FLAG.RFD_PH_MACH_DED as RFD_PH_MACH_DED,
exp_DERIVE_FLAG.RFD_H_MACH_DT as RFD_H_MACH_DT,
exp_DERIVE_FLAG.RFD_H_MACH_DED_DT as RFD_H_MACH_DED_DT,
exp_DERIVE_FLAG.RFD_VC_DIS_DT as RFD_VC_DIS_DT,
exp_DERIVE_FLAG.RFD_VC_DISCT as RFD_VC_DISCT,
exp_DERIVE_FLAG.RFD_LOC1 as RFD_LOC1,
exp_DERIVE_FLAG.RFD_LOC2 as RFD_LOC2,
exp_DERIVE_FLAG.RFD_LOC3 as RFD_LOC3,
exp_DERIVE_FLAG.RFD_1YR_TOT as RFD_1YR_TOT,
exp_DERIVE_FLAG.RFD_1YR_DWELL as RFD_1YR_DWELL,
exp_DERIVE_FLAG.RFD_1YR_UNSCH as RFD_1YR_UNSCH,
exp_DERIVE_FLAG.RFD_1YR_ADDL as RFD_1YR_ADDL,
exp_DERIVE_FLAG.RFD_1YR_LIAB as RFD_1YR_LIAB,
exp_DERIVE_FLAG.RFD_1YR_MED as RFD_1YR_MED,
exp_DERIVE_FLAG.RFD_1YR_OUTBLDG as RFD_1YR_OUTBLDG,
exp_DERIVE_FLAG.RFD_1YR_PD as RFD_1YR_PD,
exp_DERIVE_FLAG.RFD_1YR_NMED as RFD_1YR_NMED,
exp_DERIVE_FLAG.RFD_1YR_LVSTK as RFD_1YR_LVSTK,
exp_DERIVE_FLAG.RFD_1YR_MACH as RFD_1YR_MACH,
exp_DERIVE_FLAG.RFD_5YR_TOT as RFD_5YR_TOT,
exp_DERIVE_FLAG.RFD_5YR_DWELL as RFD_5YR_DWELL,
exp_DERIVE_FLAG.RFD_5YR_UNSCH as RFD_5YR_UNSCH,
exp_DERIVE_FLAG.RFD_5YR_ADDL as RFD_5YR_ADDL,
exp_DERIVE_FLAG.RFD_5YR_LIAB as RFD_5YR_LIAB,
exp_DERIVE_FLAG.RFD_5YR_MED as RFD_5YR_MED,
exp_DERIVE_FLAG.RFD_5YR_OUTBLDG as RFD_5YR_OUTBLDG,
exp_DERIVE_FLAG.RFD_5YR_PD as RFD_5YR_PD,
exp_DERIVE_FLAG.RFD_5YR_NMED as RFD_5YR_NMED,
exp_DERIVE_FLAG.RFD_5YR_LVSTK as RFD_5YR_LVSTK,
exp_DERIVE_FLAG.RFD_5YR_MACH as RFD_5YR_MACH,
exp_DERIVE_FLAG.RFD_5YR_AMT as RFD_5YR_AMT,
exp_DERIVE_FLAG.RFD_INFL_PRI_COV as RFD_INFL_PRI_COV,
exp_DERIVE_FLAG.RFD_INFL_PRI_UNSCH as RFD_INFL_PRI_UNSCH,
exp_DERIVE_FLAG.RFD_NAMED_MED1 as RFD_NAMED_MED1,
exp_DERIVE_FLAG.RFD_NAMED_MED2 as RFD_NAMED_MED2,
exp_DERIVE_FLAG.RFD_NAMED_MED3 as RFD_NAMED_MED3,
exp_DERIVE_FLAG.RFD_INFL_SEC_COV as RFD_INFL_SEC_COV,
exp_DERIVE_FLAG.RFD_INFL_SEC_UNSCH as RFD_INFL_SEC_UNSCH,
exp_DERIVE_FLAG.RFD_PRI_CNTY as RFD_PRI_CNTY,
exp_DERIVE_FLAG.RFD_SEC_CNTY as RFD_SEC_CNTY,
exp_DERIVE_FLAG.RFD_OVER9 as RFD_OVER9,
exp_DERIVE_FLAG.RFD_EBLDG_CON_YR01 as RFD_EBLDG_CON_YR01,
exp_DERIVE_FLAG.RFD_EBLDG_CON_YR02 as RFD_EBLDG_CON_YR02,
exp_DERIVE_FLAG.RFD_EBLDG_CON_YR03 as RFD_EBLDG_CON_YR03,
exp_DERIVE_FLAG.RFD_EBLDG_CON_YR04 as RFD_EBLDG_CON_YR04,
exp_DERIVE_FLAG.RFD_EBLDG_CON_YR05 as RFD_EBLDG_CON_YR05,
exp_DERIVE_FLAG.RFD_EBLDG_CON_YR06 as RFD_EBLDG_CON_YR06,
exp_DERIVE_FLAG.RFD_EBLDG_CON_YR07 as RFD_EBLDG_CON_YR07,
exp_DERIVE_FLAG.RFD_EBLDG_CON_YR08 as RFD_EBLDG_CON_YR08,
exp_DERIVE_FLAG.RFD_EBLDG_CON_YR09 as RFD_EBLDG_CON_YR09,
exp_DERIVE_FLAG.RFD_MB_TYPE as RFD_MB_TYPE,
exp_DERIVE_FLAG.RFD_MB_ACCT_NUM as RFD_MB_ACCT_NUM,
exp_DERIVE_FLAG.RFD_FO_07 as RFD_FO_07,
exp_DERIVE_FLAG.RFD_FO_46 as RFD_FO_46,
exp_DERIVE_FLAG.RFD_FO_85 as RFD_FO_85,
exp_DERIVE_FLAG.RFD_ROLL_OVER_IND as RFD_ROLL_OVER_IND,
exp_DERIVE_FLAG.FEED_IND as FEED_IND,
exp_DERIVE_FLAG.LOAD_DT as LOAD_DT,
exp_DERIVE_FLAG.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_DERIVE_FLAG.out_FLAG as FLAG,
--''1'' as ECTL_PRGM_ID,
--''1'' as ECTL_SRC_ID,
--''1'' as ECTL_SRC_INST_ID,
--''1'' as ECTL_BATCH_ID,
--''1900-01-01'' as ORIG_INS_TS,
--''1900-01-01'' as ECTL_BATCH_START_DATE,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_PRGM_ID as ECTL_PRGM_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_ID as ECTL_SRC_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_INST_ID as ECTL_SRC_INST_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_ID as ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ORIG_INS_TS as ORIG_INS_TS,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE,
exp_DERIVE_FLAG.source_record_id
FROM
exp_DERIVE_FLAG
INNER JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE ON exp_DERIVE_FLAG.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.source_record_id
);


-- Component rtr_INS_UPD_INSERT, Type ROUTER Output Group INSERT
create or replace temp table RTR_INS_UPD_insert as
SELECT
exp_FARMPOLS.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY,
exp_FARMPOLS.SC_SERVICE_CENTER as SC_SERVICE_CENTER,
exp_FARMPOLS.SC_POLICY_NUM as SC_POLICY_NUM,
exp_FARMPOLS.SC_FLT_ITEM as SC_FLT_ITEM,
exp_FARMPOLS.SC_FILE_TYPE as SC_FILE_TYPE,
exp_FARMPOLS.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE,
exp_FARMPOLS.SC_TRANS_DATE as SC_TRANS_DATE,
exp_FARMPOLS.SC_TRANS_TYPE as SC_TRANS_TYPE,
exp_FARMPOLS.PC_ALPHA_CODE as PC_ALPHA_CODE,
exp_FARMPOLS.PC_NAME_1 as PC_NAME_1,
exp_FARMPOLS.PC_NAME_2 as PC_NAME_2,
exp_FARMPOLS.PC_ADDRESS_1 as PC_ADDRESS_1,
exp_FARMPOLS.PC_ADDRESS_2 as PC_ADDRESS_2,
exp_FARMPOLS.PC_CITYST as PC_CITYST,
exp_FARMPOLS.PC_ZIP as PC_ZIP,
exp_FARMPOLS.PC_TAX_CODE as PC_TAX_CODE,
exp_FARMPOLS.PC_AGENT as PC_AGENT,
exp_FARMPOLS.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER,
exp_FARMPOLS.PC_RATE_CODE as PC_RATE_CODE,
exp_FARMPOLS.PC_ENCUMBRANCE as PC_ENCUMBRANCE,
exp_FARMPOLS.PC_PREM_FIN as PC_PREM_FIN,
exp_FARMPOLS.PC_MORT_IND as PC_MORT_IND,
exp_FARMPOLS.PC_COMPANY as PC_COMPANY,
exp_FARMPOLS.PC_INCEPT_DATE as PC_INCEPT_DATE,
exp_FARMPOLS.PC_EXP_DATE as PC_EXP_DATE,
exp_FARMPOLS.PC_EFF_DATE as PC_EFF_DATE,
exp_FARMPOLS.PC_STATUS as PC_STATUS,
exp_FARMPOLS.RFD_TOT_PREM as RFD_TOT_PREM,
exp_FARMPOLS.RFD_REWRITE_IND as RFD_REWRITE_IND,
exp_FARMPOLS.RFD_REWRITE_DT as RFD_REWRITE_DT,
exp_FARMPOLS.RFD_OUTSTAND_AMT as RFD_OUTSTAND_AMT,
exp_FARMPOLS.RFD_OUTSTAND_TYPE as RFD_OUTSTAND_TYPE,
exp_FARMPOLS.RFD_OUTSTAND_DT as RFD_OUTSTAND_DT,
exp_FARMPOLS.RFD_OUTSTAND_PD_DT as RFD_OUTSTAND_PD_DT,
exp_FARMPOLS.RFD_SUSPENSE_CD as RFD_SUSPENSE_CD,
exp_FARMPOLS.RFD_SUSPENSE_CANCL as RFD_SUSPENSE_CANCL,
exp_FARMPOLS.RFD_SSNO_1 as RFD_SSNO_1,
exp_FARMPOLS.RFD_SSNO_2 as RFD_SSNO_2,
exp_FARMPOLS.RFD_REVIEW_DT as RFD_REVIEW_DT,
exp_FARMPOLS.RFD_UW_INIT as RFD_UW_INIT,
exp_FARMPOLS.RFD_MORT_NAME_1 as RFD_MORT_NAME_1,
exp_FARMPOLS.RFD_MORT_NAME_2 as RFD_MORT_NAME_2,
exp_FARMPOLS.RFD_MORT_ADD_1 as RFD_MORT_ADD_1,
exp_FARMPOLS.RFD_MORT_ADD_2 as RFD_MORT_ADD_2,
exp_FARMPOLS.RFD_MORT_CITYST as RFD_MORT_CITYST,
exp_FARMPOLS.RFD_MORT_ZIP as RFD_MORT_ZIP,
exp_FARMPOLS.RFD_STATE as RFD_STATE,
exp_FARMPOLS.RFD_MORT_TYPE as RFD_MORT_TYPE,
exp_FARMPOLS.RFD_LOAN_NUM as RFD_LOAN_NUM,
exp_FARMPOLS.RFD_PRI_COV as RFD_PRI_COV,
exp_FARMPOLS.RFD_PRI_UNSCH as RFD_PRI_UNSCH,
exp_FARMPOLS.RFD_PRI_ADDL as RFD_PRI_ADDL,
exp_FARMPOLS.RFD_PRI_HS as RFD_PRI_HS,
exp_FARMPOLS.RFD_PPRI_CLASS as RFD_PPRI_CLASS,
exp_FARMPOLS.RFD_PRI_CONST as RFD_PRI_CONST,
exp_FARMPOLS.RFD_PPRI_COV as RFD_PPRI_COV,
exp_FARMPOLS.RFD_PPRI_UNSCH as RFD_PPRI_UNSCH,
exp_FARMPOLS.RFD_PRI_COV_DT as RFD_PRI_COV_DT,
exp_FARMPOLS.RFD_PRI_BCOV_DT as RFD_PRI_BCOV_DT,
exp_FARMPOLS.RFD_SEC_COV as RFD_SEC_COV,
exp_FARMPOLS.RFD_SEC_UNSCH as RFD_SEC_UNSCH,
exp_FARMPOLS.RFD_SEC_ADDL as RFD_SEC_ADDL,
exp_FARMPOLS.RFD_SEC_HS as RFD_SEC_HS,
exp_FARMPOLS.RFD_PSEC_CLASS as RFD_PSEC_CLASS,
exp_FARMPOLS.RFD_SEC_CONST as RFD_SEC_CONST,
exp_FARMPOLS.RFD_PSEC_COV as RFD_PSEC_COV,
exp_FARMPOLS.RFD_PSEC_BCOV as RFD_PSEC_BCOV,
exp_FARMPOLS.RFD_SEC_COV_DT as RFD_SEC_COV_DT,
exp_FARMPOLS.RFD_SEC_BCOV_DT as RFD_SEC_BCOV_DT,
exp_FARMPOLS.RFD_PRI_CLASS as RFD_PRI_CLASS,
exp_FARMPOLS.RFD_PRI_DED as RFD_PRI_DED,
exp_FARMPOLS.RFD_SEC_CLASS as RFD_SEC_CLASS,
exp_FARMPOLS.RFD_SEC_DED as RFD_SEC_DED,
exp_FARMPOLS.RFD_PRI_PREM as RFD_PRI_PREM,
exp_FARMPOLS.RFD_SEC_PREM as RFD_SEC_PREM,
exp_FARMPOLS.RFD_ANICOLL_DT as RFD_ANICOLL_DT,
exp_FARMPOLS.RFD_PPRI_DED as RFD_PPRI_DED,
exp_FARMPOLS.RFD_PSEC_DED as RFD_PSEC_DED,
exp_FARMPOLS.RFD_LIAB as RFD_LIAB,
exp_FARMPOLS.RFD_MED as RFD_MED,
exp_FARMPOLS.RFD_ADD_BLDGS as RFD_ADD_BLDGS,
exp_FARMPOLS.RFD_PLIAB as RFD_PLIAB,
exp_FARMPOLS.RFD_PMED as RFD_PMED,
exp_FARMPOLS.RFD_PADD_BLDGS as RFD_PADD_BLDGS,
exp_FARMPOLS.RFD_LIAB_MED_DT as RFD_LIAB_MED_DT,
exp_FARMPOLS.RFD_TOT_ACRES as RFD_TOT_ACRES,
exp_FARMPOLS.RFD_PTOT_ACRES as RFD_PTOT_ACRES,
exp_FARMPOLS.RFD_PYRL_COV as RFD_PYRL_COV,
exp_FARMPOLS.RFD_PPYRL_COV as RFD_PPYRL_COV,
exp_FARMPOLS.RFD_RECEIPTS as RFD_RECEIPTS,
exp_FARMPOLS.RFD_PRECEIPTS as RFD_PRECEIPTS,
exp_FARMPOLS.RFD_SEC_DWELL as RFD_SEC_DWELL,
exp_FARMPOLS.RFD_PSEC_DWELL as RFD_PSEC_DWELL,
exp_FARMPOLS.RFD_OFFICES as RFD_OFFICES,
exp_FARMPOLS.RFD_POFFICES as RFD_POFFICES,
exp_FARMPOLS.RFD_PONDS as RFD_PONDS,
exp_FARMPOLS.RFD_PPONDS as RFD_PPONDS,
exp_FARMPOLS.RFD_NAMED_INSD as RFD_NAMED_INSD,
exp_FARMPOLS.RFD_PNAMED_INSD as RFD_PNAMED_INSD,
exp_FARMPOLS.RFD_FO_06_NON_NAME as RFD_FO_06_NON_NAME,
exp_FARMPOLS.RFD_PNON_NAMED as RFD_PNON_NAMED,
exp_FARMPOLS.RFD_NAMED_MED as RFD_NAMED_MED,
exp_FARMPOLS.RFD_PNAMED_MED as RFD_PNAMED_MED,
exp_FARMPOLS.RFD_ADDL_RES as RFD_ADDL_RES,
exp_FARMPOLS.RFD_PADDL_RES as RFD_PADDL_RES,
exp_FARMPOLS.RFD_NAMED_MED_DT as RFD_NAMED_MED_DT,
exp_FARMPOLS.RFD_NAMED_MED_PRM as RFD_NAMED_MED_PRM,
exp_FARMPOLS.RFD_LIAB_PRM as RFD_LIAB_PRM,
exp_FARMPOLS.RFD_LVSTK_COV as RFD_LVSTK_COV,
exp_FARMPOLS.RFD_LVSTK_PRM as RFD_LVSTK_PRM,
exp_FARMPOLS.RFD_LVSTK_DED as RFD_LVSTK_DED,
exp_FARMPOLS.RFD_PLVSTK_COV as RFD_PLVSTK_COV,
exp_FARMPOLS.RFD_PLVSTK_DED as RFD_PLVSTK_DED,
exp_FARMPOLS.RFD_LVSTK_DT as RFD_LVSTK_DT,
exp_FARMPOLS.RFD_LVSTK_DED_DT as RFD_LVSTK_DED_DT,
exp_FARMPOLS.RFD_ANICOLL_COV as RFD_ANICOLL_COV,
exp_FARMPOLS.RFD_FDSD_COV as RFD_FDSD_COV,
exp_FARMPOLS.RFD_FDSD_PRM as RFD_FDSD_PRM,
exp_FARMPOLS.RFD_FDSD_DED as RFD_FDSD_DED,
exp_FARMPOLS.RFD_PFDSD_COV as RFD_PFDSD_COV,
exp_FARMPOLS.RFD_PFDSD_DED as RFD_PFDSD_DED,
exp_FARMPOLS.RFD_FDSD_DT as RFD_FDSD_DT,
exp_FARMPOLS.RFD_FDSD_DED_DT as RFD_FDSD_DED_DT,
exp_FARMPOLS.RFD_ANICOLL_PRM as RFD_ANICOLL_PRM,
exp_FARMPOLS.RFD_MACH_COV as RFD_MACH_COV,
exp_FARMPOLS.RFD_MACH_PRM as RFD_MACH_PRM,
exp_FARMPOLS.RFD_MACH_DED as RFD_MACH_DED,
exp_FARMPOLS.RFD_PMACH_COV as RFD_PMACH_COV,
exp_FARMPOLS.RFD_PMACH_DED as RFD_PMACH_DED,
exp_FARMPOLS.RFD_MACH_DT as RFD_MACH_DT,
exp_FARMPOLS.RFD_MACH_DED_DT as RFD_MACH_DED_DT,
exp_FARMPOLS.RFD_PANICOLL_COV as RFD_PANICOLL_COV,
exp_FARMPOLS.RFD_H_MACH_COV as RFD_H_MACH_COV,
exp_FARMPOLS.RFD_H_MACH_PRM as RFD_H_MACH_PRM,
exp_FARMPOLS.RFD_H_MACH_DED as RFD_H_MACH_DED,
exp_FARMPOLS.RFD_PH_MACH_COV as RFD_PH_MACH_COV,
exp_FARMPOLS.RFD_PH_MACH_DED as RFD_PH_MACH_DED,
exp_FARMPOLS.RFD_H_MACH_DT as RFD_H_MACH_DT,
exp_FARMPOLS.RFD_H_MACH_DED_DT as RFD_H_MACH_DED_DT,
exp_FARMPOLS.RFD_VC_DIS_DT as RFD_VC_DIS_DT,
exp_FARMPOLS.RFD_VC_DISCT as RFD_VC_DISCT,
exp_FARMPOLS.RFD_LOC1 as RFD_LOC1,
exp_FARMPOLS.RFD_LOC2 as RFD_LOC2,
exp_FARMPOLS.RFD_LOC3 as RFD_LOC3,
exp_FARMPOLS.RFD_1YR_TOT as RFD_1YR_TOT,
exp_FARMPOLS.RFD_1YR_DWELL as RFD_1YR_DWELL,
exp_FARMPOLS.RFD_1YR_UNSCH as RFD_1YR_UNSCH,
exp_FARMPOLS.RFD_1YR_ADDL as RFD_1YR_ADDL,
exp_FARMPOLS.RFD_1YR_LIAB as RFD_1YR_LIAB,
exp_FARMPOLS.RFD_1YR_MED as RFD_1YR_MED,
exp_FARMPOLS.RFD_1YR_OUTBLDG as RFD_1YR_OUTBLDG,
exp_FARMPOLS.RFD_1YR_PD as RFD_1YR_PD,
exp_FARMPOLS.RFD_1YR_NMED as RFD_1YR_NMED,
exp_FARMPOLS.RFD_1YR_LVSTK as RFD_1YR_LVSTK,
exp_FARMPOLS.RFD_1YR_MACH as RFD_1YR_MACH,
exp_FARMPOLS.RFD_5YR_TOT as RFD_5YR_TOT,
exp_FARMPOLS.RFD_5YR_DWELL as RFD_5YR_DWELL,
exp_FARMPOLS.RFD_5YR_UNSCH as RFD_5YR_UNSCH,
exp_FARMPOLS.RFD_5YR_ADDL as RFD_5YR_ADDL,
exp_FARMPOLS.RFD_5YR_LIAB as RFD_5YR_LIAB,
exp_FARMPOLS.RFD_5YR_MED as RFD_5YR_MED,
exp_FARMPOLS.RFD_5YR_OUTBLDG as RFD_5YR_OUTBLDG,
exp_FARMPOLS.RFD_5YR_PD as RFD_5YR_PD,
exp_FARMPOLS.RFD_5YR_NMED as RFD_5YR_NMED,
exp_FARMPOLS.RFD_5YR_LVSTK as RFD_5YR_LVSTK,
exp_FARMPOLS.RFD_5YR_MACH as RFD_5YR_MACH,
exp_FARMPOLS.RFD_5YR_AMT as RFD_5YR_AMT,
exp_FARMPOLS.RFD_INFL_PRI_COV as RFD_INFL_PRI_COV,
exp_FARMPOLS.RFD_INFL_PRI_UNSCH as RFD_INFL_PRI_UNSCH,
exp_FARMPOLS.RFD_NAMED_MED1 as RFD_NAMED_MED1,
exp_FARMPOLS.RFD_NAMED_MED2 as RFD_NAMED_MED2,
exp_FARMPOLS.RFD_NAMED_MED3 as RFD_NAMED_MED3,
exp_FARMPOLS.RFD_INFL_SEC_COV as RFD_INFL_SEC_COV,
exp_FARMPOLS.RFD_INFL_SEC_UNSCH as RFD_INFL_SEC_UNSCH,
exp_FARMPOLS.RFD_PRI_CNTY as RFD_PRI_CNTY,
exp_FARMPOLS.RFD_SEC_CNTY as RFD_SEC_CNTY,
exp_FARMPOLS.RFD_OVER9 as RFD_OVER9,
exp_FARMPOLS.RFD_EBLDG_CON_YR01 as RFD_EBLDG_CON_YR01,
exp_FARMPOLS.RFD_EBLDG_CON_YR02 as RFD_EBLDG_CON_YR02,
exp_FARMPOLS.RFD_EBLDG_CON_YR03 as RFD_EBLDG_CON_YR03,
exp_FARMPOLS.RFD_EBLDG_CON_YR04 as RFD_EBLDG_CON_YR04,
exp_FARMPOLS.RFD_EBLDG_CON_YR05 as RFD_EBLDG_CON_YR05,
exp_FARMPOLS.RFD_EBLDG_CON_YR06 as RFD_EBLDG_CON_YR06,
exp_FARMPOLS.RFD_EBLDG_CON_YR07 as RFD_EBLDG_CON_YR07,
exp_FARMPOLS.RFD_EBLDG_CON_YR08 as RFD_EBLDG_CON_YR08,
exp_FARMPOLS.RFD_EBLDG_CON_YR09 as RFD_EBLDG_CON_YR09,
exp_FARMPOLS.RFD_MB_TYPE as RFD_MB_TYPE,
exp_FARMPOLS.RFD_MB_ACCT_NUM as RFD_MB_ACCT_NUM,
exp_FARMPOLS.RFD_FO_07 as RFD_FO_07,
exp_FARMPOLS.RFD_FO_46 as RFD_FO_46,
exp_FARMPOLS.RFD_FO_85 as RFD_FO_85,
exp_FARMPOLS.RFD_ROLL_OVER_IND as RFD_ROLL_OVER_IND,
exp_FARMPOLS.FEED_IND as FEED_IND,
exp_FARMPOLS.FLAG as FLAG,
exp_FARMPOLS.ECTL_PRGM_ID as ECTL_PRGM_ID,
exp_FARMPOLS.ECTL_SRC_ID as ECTL_SRC_ID,
exp_FARMPOLS.ECTL_SRC_INST_ID as ECTL_SRC_INST_ID,
exp_FARMPOLS.ECTL_BATCH_ID as ECTL_BATCH_ID,
exp_FARMPOLS.ORIG_INS_TS as ORIG_INS_TS,
exp_FARMPOLS.ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE,
exp_FARMPOLS.LOAD_DT as LOAD_DT,
exp_FARMPOLS.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_FARMPOLS.source_record_id
FROM
exp_FARMPOLS
WHERE exp_FARMPOLS.FLAG = ''NEW'' OR exp_FARMPOLS.FLAG = ''UPD'';


-- Component rtr_INS_UPD_UPDATE, Type ROUTER Output Group UPDATE
create or replace temp table RTR_INS_UPD_UPDATE as 
SELECT
exp_FARMPOLS.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY,
exp_FARMPOLS.SC_SERVICE_CENTER as SC_SERVICE_CENTER,
exp_FARMPOLS.SC_POLICY_NUM as SC_POLICY_NUM,
exp_FARMPOLS.SC_FLT_ITEM as SC_FLT_ITEM,
exp_FARMPOLS.SC_FILE_TYPE as SC_FILE_TYPE,
exp_FARMPOLS.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE,
exp_FARMPOLS.SC_TRANS_DATE as SC_TRANS_DATE,
exp_FARMPOLS.SC_TRANS_TYPE as SC_TRANS_TYPE,
exp_FARMPOLS.PC_ALPHA_CODE as PC_ALPHA_CODE,
exp_FARMPOLS.PC_NAME_1 as PC_NAME_1,
exp_FARMPOLS.PC_NAME_2 as PC_NAME_2,
exp_FARMPOLS.PC_ADDRESS_1 as PC_ADDRESS_1,
exp_FARMPOLS.PC_ADDRESS_2 as PC_ADDRESS_2,
exp_FARMPOLS.PC_CITYST as PC_CITYST,
exp_FARMPOLS.PC_ZIP as PC_ZIP,
exp_FARMPOLS.PC_TAX_CODE as PC_TAX_CODE,
exp_FARMPOLS.PC_AGENT as PC_AGENT,
exp_FARMPOLS.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER,
exp_FARMPOLS.PC_RATE_CODE as PC_RATE_CODE,
exp_FARMPOLS.PC_ENCUMBRANCE as PC_ENCUMBRANCE,
exp_FARMPOLS.PC_PREM_FIN as PC_PREM_FIN,
exp_FARMPOLS.PC_MORT_IND as PC_MORT_IND,
exp_FARMPOLS.PC_COMPANY as PC_COMPANY,
exp_FARMPOLS.PC_INCEPT_DATE as PC_INCEPT_DATE,
exp_FARMPOLS.PC_EXP_DATE as PC_EXP_DATE,
exp_FARMPOLS.PC_EFF_DATE as PC_EFF_DATE,
exp_FARMPOLS.PC_STATUS as PC_STATUS,
exp_FARMPOLS.RFD_TOT_PREM as RFD_TOT_PREM,
exp_FARMPOLS.RFD_REWRITE_IND as RFD_REWRITE_IND,
exp_FARMPOLS.RFD_REWRITE_DT as RFD_REWRITE_DT,
exp_FARMPOLS.RFD_OUTSTAND_AMT as RFD_OUTSTAND_AMT,
exp_FARMPOLS.RFD_OUTSTAND_TYPE as RFD_OUTSTAND_TYPE,
exp_FARMPOLS.RFD_OUTSTAND_DT as RFD_OUTSTAND_DT,
exp_FARMPOLS.RFD_OUTSTAND_PD_DT as RFD_OUTSTAND_PD_DT,
exp_FARMPOLS.RFD_SUSPENSE_CD as RFD_SUSPENSE_CD,
exp_FARMPOLS.RFD_SUSPENSE_CANCL as RFD_SUSPENSE_CANCL,
exp_FARMPOLS.RFD_SSNO_1 as RFD_SSNO_1,
exp_FARMPOLS.RFD_SSNO_2 as RFD_SSNO_2,
exp_FARMPOLS.RFD_REVIEW_DT as RFD_REVIEW_DT,
exp_FARMPOLS.RFD_UW_INIT as RFD_UW_INIT,
exp_FARMPOLS.RFD_MORT_NAME_1 as RFD_MORT_NAME_1,
exp_FARMPOLS.RFD_MORT_NAME_2 as RFD_MORT_NAME_2,
exp_FARMPOLS.RFD_MORT_ADD_1 as RFD_MORT_ADD_1,
exp_FARMPOLS.RFD_MORT_ADD_2 as RFD_MORT_ADD_2,
exp_FARMPOLS.RFD_MORT_CITYST as RFD_MORT_CITYST,
exp_FARMPOLS.RFD_MORT_ZIP as RFD_MORT_ZIP,
exp_FARMPOLS.RFD_STATE as RFD_STATE,
exp_FARMPOLS.RFD_MORT_TYPE as RFD_MORT_TYPE,
exp_FARMPOLS.RFD_LOAN_NUM as RFD_LOAN_NUM,
exp_FARMPOLS.RFD_PRI_COV as RFD_PRI_COV,
exp_FARMPOLS.RFD_PRI_UNSCH as RFD_PRI_UNSCH,
exp_FARMPOLS.RFD_PRI_ADDL as RFD_PRI_ADDL,
exp_FARMPOLS.RFD_PRI_HS as RFD_PRI_HS,
exp_FARMPOLS.RFD_PPRI_CLASS as RFD_PPRI_CLASS,
exp_FARMPOLS.RFD_PRI_CONST as RFD_PRI_CONST,
exp_FARMPOLS.RFD_PPRI_COV as RFD_PPRI_COV,
exp_FARMPOLS.RFD_PPRI_UNSCH as RFD_PPRI_UNSCH,
exp_FARMPOLS.RFD_PRI_COV_DT as RFD_PRI_COV_DT,
exp_FARMPOLS.RFD_PRI_BCOV_DT as RFD_PRI_BCOV_DT,
exp_FARMPOLS.RFD_SEC_COV as RFD_SEC_COV,
exp_FARMPOLS.RFD_SEC_UNSCH as RFD_SEC_UNSCH,
exp_FARMPOLS.RFD_SEC_ADDL as RFD_SEC_ADDL,
exp_FARMPOLS.RFD_SEC_HS as RFD_SEC_HS,
exp_FARMPOLS.RFD_PSEC_CLASS as RFD_PSEC_CLASS,
exp_FARMPOLS.RFD_SEC_CONST as RFD_SEC_CONST,
exp_FARMPOLS.RFD_PSEC_COV as RFD_PSEC_COV,
exp_FARMPOLS.RFD_PSEC_BCOV as RFD_PSEC_BCOV,
exp_FARMPOLS.RFD_SEC_COV_DT as RFD_SEC_COV_DT,
exp_FARMPOLS.RFD_SEC_BCOV_DT as RFD_SEC_BCOV_DT,
exp_FARMPOLS.RFD_PRI_CLASS as RFD_PRI_CLASS,
exp_FARMPOLS.RFD_PRI_DED as RFD_PRI_DED,
exp_FARMPOLS.RFD_SEC_CLASS as RFD_SEC_CLASS,
exp_FARMPOLS.RFD_SEC_DED as RFD_SEC_DED,
exp_FARMPOLS.RFD_PRI_PREM as RFD_PRI_PREM,
exp_FARMPOLS.RFD_SEC_PREM as RFD_SEC_PREM,
exp_FARMPOLS.RFD_ANICOLL_DT as RFD_ANICOLL_DT,
exp_FARMPOLS.RFD_PPRI_DED as RFD_PPRI_DED,
exp_FARMPOLS.RFD_PSEC_DED as RFD_PSEC_DED,
exp_FARMPOLS.RFD_LIAB as RFD_LIAB,
exp_FARMPOLS.RFD_MED as RFD_MED,
exp_FARMPOLS.RFD_ADD_BLDGS as RFD_ADD_BLDGS,
exp_FARMPOLS.RFD_PLIAB as RFD_PLIAB,
exp_FARMPOLS.RFD_PMED as RFD_PMED,
exp_FARMPOLS.RFD_PADD_BLDGS as RFD_PADD_BLDGS,
exp_FARMPOLS.RFD_LIAB_MED_DT as RFD_LIAB_MED_DT,
exp_FARMPOLS.RFD_TOT_ACRES as RFD_TOT_ACRES,
exp_FARMPOLS.RFD_PTOT_ACRES as RFD_PTOT_ACRES,
exp_FARMPOLS.RFD_PYRL_COV as RFD_PYRL_COV,
exp_FARMPOLS.RFD_PPYRL_COV as RFD_PPYRL_COV,
exp_FARMPOLS.RFD_RECEIPTS as RFD_RECEIPTS,
exp_FARMPOLS.RFD_PRECEIPTS as RFD_PRECEIPTS,
exp_FARMPOLS.RFD_SEC_DWELL as RFD_SEC_DWELL,
exp_FARMPOLS.RFD_PSEC_DWELL as RFD_PSEC_DWELL,
exp_FARMPOLS.RFD_OFFICES as RFD_OFFICES,
exp_FARMPOLS.RFD_POFFICES as RFD_POFFICES,
exp_FARMPOLS.RFD_PONDS as RFD_PONDS,
exp_FARMPOLS.RFD_PPONDS as RFD_PPONDS,
exp_FARMPOLS.RFD_NAMED_INSD as RFD_NAMED_INSD,
exp_FARMPOLS.RFD_PNAMED_INSD as RFD_PNAMED_INSD,
exp_FARMPOLS.RFD_FO_06_NON_NAME as RFD_FO_06_NON_NAME,
exp_FARMPOLS.RFD_PNON_NAMED as RFD_PNON_NAMED,
exp_FARMPOLS.RFD_NAMED_MED as RFD_NAMED_MED,
exp_FARMPOLS.RFD_PNAMED_MED as RFD_PNAMED_MED,
exp_FARMPOLS.RFD_ADDL_RES as RFD_ADDL_RES,
exp_FARMPOLS.RFD_PADDL_RES as RFD_PADDL_RES,
exp_FARMPOLS.RFD_NAMED_MED_DT as RFD_NAMED_MED_DT,
exp_FARMPOLS.RFD_NAMED_MED_PRM as RFD_NAMED_MED_PRM,
exp_FARMPOLS.RFD_LIAB_PRM as RFD_LIAB_PRM,
exp_FARMPOLS.RFD_LVSTK_COV as RFD_LVSTK_COV,
exp_FARMPOLS.RFD_LVSTK_PRM as RFD_LVSTK_PRM,
exp_FARMPOLS.RFD_LVSTK_DED as RFD_LVSTK_DED,
exp_FARMPOLS.RFD_PLVSTK_COV as RFD_PLVSTK_COV,
exp_FARMPOLS.RFD_PLVSTK_DED as RFD_PLVSTK_DED,
exp_FARMPOLS.RFD_LVSTK_DT as RFD_LVSTK_DT,
exp_FARMPOLS.RFD_LVSTK_DED_DT as RFD_LVSTK_DED_DT,
exp_FARMPOLS.RFD_ANICOLL_COV as RFD_ANICOLL_COV,
exp_FARMPOLS.RFD_FDSD_COV as RFD_FDSD_COV,
exp_FARMPOLS.RFD_FDSD_PRM as RFD_FDSD_PRM,
exp_FARMPOLS.RFD_FDSD_DED as RFD_FDSD_DED,
exp_FARMPOLS.RFD_PFDSD_COV as RFD_PFDSD_COV,
exp_FARMPOLS.RFD_PFDSD_DED as RFD_PFDSD_DED,
exp_FARMPOLS.RFD_FDSD_DT as RFD_FDSD_DT,
exp_FARMPOLS.RFD_FDSD_DED_DT as RFD_FDSD_DED_DT,
exp_FARMPOLS.RFD_ANICOLL_PRM as RFD_ANICOLL_PRM,
exp_FARMPOLS.RFD_MACH_COV as RFD_MACH_COV,
exp_FARMPOLS.RFD_MACH_PRM as RFD_MACH_PRM,
exp_FARMPOLS.RFD_MACH_DED as RFD_MACH_DED,
exp_FARMPOLS.RFD_PMACH_COV as RFD_PMACH_COV,
exp_FARMPOLS.RFD_PMACH_DED as RFD_PMACH_DED,
exp_FARMPOLS.RFD_MACH_DT as RFD_MACH_DT,
exp_FARMPOLS.RFD_MACH_DED_DT as RFD_MACH_DED_DT,
exp_FARMPOLS.RFD_PANICOLL_COV as RFD_PANICOLL_COV,
exp_FARMPOLS.RFD_H_MACH_COV as RFD_H_MACH_COV,
exp_FARMPOLS.RFD_H_MACH_PRM as RFD_H_MACH_PRM,
exp_FARMPOLS.RFD_H_MACH_DED as RFD_H_MACH_DED,
exp_FARMPOLS.RFD_PH_MACH_COV as RFD_PH_MACH_COV,
exp_FARMPOLS.RFD_PH_MACH_DED as RFD_PH_MACH_DED,
exp_FARMPOLS.RFD_H_MACH_DT as RFD_H_MACH_DT,
exp_FARMPOLS.RFD_H_MACH_DED_DT as RFD_H_MACH_DED_DT,
exp_FARMPOLS.RFD_VC_DIS_DT as RFD_VC_DIS_DT,
exp_FARMPOLS.RFD_VC_DISCT as RFD_VC_DISCT,
exp_FARMPOLS.RFD_LOC1 as RFD_LOC1,
exp_FARMPOLS.RFD_LOC2 as RFD_LOC2,
exp_FARMPOLS.RFD_LOC3 as RFD_LOC3,
exp_FARMPOLS.RFD_1YR_TOT as RFD_1YR_TOT,
exp_FARMPOLS.RFD_1YR_DWELL as RFD_1YR_DWELL,
exp_FARMPOLS.RFD_1YR_UNSCH as RFD_1YR_UNSCH,
exp_FARMPOLS.RFD_1YR_ADDL as RFD_1YR_ADDL,
exp_FARMPOLS.RFD_1YR_LIAB as RFD_1YR_LIAB,
exp_FARMPOLS.RFD_1YR_MED as RFD_1YR_MED,
exp_FARMPOLS.RFD_1YR_OUTBLDG as RFD_1YR_OUTBLDG,
exp_FARMPOLS.RFD_1YR_PD as RFD_1YR_PD,
exp_FARMPOLS.RFD_1YR_NMED as RFD_1YR_NMED,
exp_FARMPOLS.RFD_1YR_LVSTK as RFD_1YR_LVSTK,
exp_FARMPOLS.RFD_1YR_MACH as RFD_1YR_MACH,
exp_FARMPOLS.RFD_5YR_TOT as RFD_5YR_TOT,
exp_FARMPOLS.RFD_5YR_DWELL as RFD_5YR_DWELL,
exp_FARMPOLS.RFD_5YR_UNSCH as RFD_5YR_UNSCH,
exp_FARMPOLS.RFD_5YR_ADDL as RFD_5YR_ADDL,
exp_FARMPOLS.RFD_5YR_LIAB as RFD_5YR_LIAB,
exp_FARMPOLS.RFD_5YR_MED as RFD_5YR_MED,
exp_FARMPOLS.RFD_5YR_OUTBLDG as RFD_5YR_OUTBLDG,
exp_FARMPOLS.RFD_5YR_PD as RFD_5YR_PD,
exp_FARMPOLS.RFD_5YR_NMED as RFD_5YR_NMED,
exp_FARMPOLS.RFD_5YR_LVSTK as RFD_5YR_LVSTK,
exp_FARMPOLS.RFD_5YR_MACH as RFD_5YR_MACH,
exp_FARMPOLS.RFD_5YR_AMT as RFD_5YR_AMT,
exp_FARMPOLS.RFD_INFL_PRI_COV as RFD_INFL_PRI_COV,
exp_FARMPOLS.RFD_INFL_PRI_UNSCH as RFD_INFL_PRI_UNSCH,
exp_FARMPOLS.RFD_NAMED_MED1 as RFD_NAMED_MED1,
exp_FARMPOLS.RFD_NAMED_MED2 as RFD_NAMED_MED2,
exp_FARMPOLS.RFD_NAMED_MED3 as RFD_NAMED_MED3,
exp_FARMPOLS.RFD_INFL_SEC_COV as RFD_INFL_SEC_COV,
exp_FARMPOLS.RFD_INFL_SEC_UNSCH as RFD_INFL_SEC_UNSCH,
exp_FARMPOLS.RFD_PRI_CNTY as RFD_PRI_CNTY,
exp_FARMPOLS.RFD_SEC_CNTY as RFD_SEC_CNTY,
exp_FARMPOLS.RFD_OVER9 as RFD_OVER9,
exp_FARMPOLS.RFD_EBLDG_CON_YR01 as RFD_EBLDG_CON_YR01,
exp_FARMPOLS.RFD_EBLDG_CON_YR02 as RFD_EBLDG_CON_YR02,
exp_FARMPOLS.RFD_EBLDG_CON_YR03 as RFD_EBLDG_CON_YR03,
exp_FARMPOLS.RFD_EBLDG_CON_YR04 as RFD_EBLDG_CON_YR04,
exp_FARMPOLS.RFD_EBLDG_CON_YR05 as RFD_EBLDG_CON_YR05,
exp_FARMPOLS.RFD_EBLDG_CON_YR06 as RFD_EBLDG_CON_YR06,
exp_FARMPOLS.RFD_EBLDG_CON_YR07 as RFD_EBLDG_CON_YR07,
exp_FARMPOLS.RFD_EBLDG_CON_YR08 as RFD_EBLDG_CON_YR08,
exp_FARMPOLS.RFD_EBLDG_CON_YR09 as RFD_EBLDG_CON_YR09,
exp_FARMPOLS.RFD_MB_TYPE as RFD_MB_TYPE,
exp_FARMPOLS.RFD_MB_ACCT_NUM as RFD_MB_ACCT_NUM,
exp_FARMPOLS.RFD_FO_07 as RFD_FO_07,
exp_FARMPOLS.RFD_FO_46 as RFD_FO_46,
exp_FARMPOLS.RFD_FO_85 as RFD_FO_85,
exp_FARMPOLS.RFD_ROLL_OVER_IND as RFD_ROLL_OVER_IND,
exp_FARMPOLS.FEED_IND as FEED_IND,
exp_FARMPOLS.FLAG as FLAG,
exp_FARMPOLS.ECTL_PRGM_ID as ECTL_PRGM_ID,
exp_FARMPOLS.ECTL_SRC_ID as ECTL_SRC_ID,
exp_FARMPOLS.ECTL_SRC_INST_ID as ECTL_SRC_INST_ID,
exp_FARMPOLS.ECTL_BATCH_ID as ECTL_BATCH_ID,
exp_FARMPOLS.ORIG_INS_TS as ORIG_INS_TS,
exp_FARMPOLS.ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE,
exp_FARMPOLS.LOAD_DT as LOAD_DT,
exp_FARMPOLS.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_FARMPOLS.source_record_id
FROM
exp_FARMPOLS
WHERE exp_FARMPOLS.FLAG = ''UPD'';


-- Component exp_GET_EXP_DT, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_GET_EXP_DT AS
(
SELECT
rtr_INS_UPD_UPDATE.SC_POLICY_NUM as SC_POLICY_NUM1,
TO_CHAR ( ( DATE_PART(''YYYY'', TO_TIMESTAMP(rtr_INS_UPD_UPDATE.LOAD_DT)) * 10000 ) + ( DATE_PART(''MM'', TO_TIMESTAMP(rtr_INS_UPD_UPDATE.LOAD_DT)) * 100 ) + 1 ) as var_GET_START_DATE,
 TO_DATE ( var_GET_START_DATE  )  - 1  as var_CHG_EXP_DT,
CASE WHEN rtr_INS_UPD_UPDATE.CHG_EFF_DT_lkp >= TO_DATE ( var_GET_START_DATE , ''YYYYMMDD'' ) THEN rtr_INS_UPD_UPDATE.CHG_EFF_DT_lkp ELSE var_CHG_EXP_DT END as out_CHG_EXP_DT,
rtr_INS_UPD_UPDATE.ECTL_BATCH_ID as ECTL_BATCH_ID1,
rtr_INS_UPD_UPDATE.ORIG_INS_TS as MODIFY_TS,
CURRENT_TIMESTAMP as out_ECTL_END_DATE,
''UPD'' as out_ECTL_TX_CD,
rtr_INS_UPD_UPDATE.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
rtr_INS_UPD_UPDATE.source_record_id
FROM
rtr_INS_UPD_UPDATE
);


-- Component exp_GET_EFF_DATE, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_GET_EFF_DATE AS
(
SELECT
rtr_INS_UPD_INSERT.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY1,
rtr_INS_UPD_INSERT.SC_SERVICE_CENTER as SC_SERVICE_CENTER1,
rtr_INS_UPD_INSERT.SC_POLICY_NUM as SC_POLICY_NUM1,
rtr_INS_UPD_INSERT.SC_FLT_ITEM as SC_FLT_ITEM1,
rtr_INS_UPD_INSERT.SC_FILE_TYPE as SC_FILE_TYPE1,
rtr_INS_UPD_INSERT.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE1,
rtr_INS_UPD_INSERT.SC_TRANS_DATE as SC_TRANS_DATE1,
rtr_INS_UPD_INSERT.SC_TRANS_TYPE as SC_TRANS_TYPE1,
rtr_INS_UPD_INSERT.PC_ALPHA_CODE as PC_ALPHA_CODE1,
rtr_INS_UPD_INSERT.PC_NAME_1 as PC_NAME_11,
rtr_INS_UPD_INSERT.PC_NAME_2 as PC_NAME_21,
rtr_INS_UPD_INSERT.PC_ADDRESS_1 as PC_ADDRESS_11,
rtr_INS_UPD_INSERT.PC_ADDRESS_2 as PC_ADDRESS_21,
rtr_INS_UPD_INSERT.PC_CITYST as PC_CITYST1,
rtr_INS_UPD_INSERT.PC_ZIP as PC_ZIP1,
rtr_INS_UPD_INSERT.PC_TAX_CODE as PC_TAX_CODE1,
rtr_INS_UPD_INSERT.PC_AGENT as PC_AGENT1,
rtr_INS_UPD_INSERT.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER1,
rtr_INS_UPD_INSERT.PC_RATE_CODE as PC_RATE_CODE1,
rtr_INS_UPD_INSERT.PC_ENCUMBRANCE as PC_ENCUMBRANCE1,
rtr_INS_UPD_INSERT.PC_PREM_FIN as PC_PREM_FIN1,
rtr_INS_UPD_INSERT.PC_MORT_IND as PC_MORT_IND1,
rtr_INS_UPD_INSERT.PC_COMPANY as PC_COMPANY1,
rtr_INS_UPD_INSERT.PC_INCEPT_DATE as PC_INCEPT_DATE1,
rtr_INS_UPD_INSERT.PC_EXP_DATE as PC_EXP_DATE1,
rtr_INS_UPD_INSERT.PC_EFF_DATE as PC_EFF_DATE1,
rtr_INS_UPD_INSERT.PC_STATUS as PC_STATUS1,
rtr_INS_UPD_INSERT.RFD_TOT_PREM as RFD_TOT_PREM1,
rtr_INS_UPD_INSERT.RFD_REWRITE_IND as RFD_REWRITE_IND1,
rtr_INS_UPD_INSERT.RFD_REWRITE_DT as RFD_REWRITE_DT1,
rtr_INS_UPD_INSERT.RFD_OUTSTAND_AMT as RFD_OUTSTAND_AMT1,
rtr_INS_UPD_INSERT.RFD_OUTSTAND_TYPE as RFD_OUTSTAND_TYPE1,
rtr_INS_UPD_INSERT.RFD_OUTSTAND_DT as RFD_OUTSTAND_DT1,
rtr_INS_UPD_INSERT.RFD_OUTSTAND_PD_DT as RFD_OUTSTAND_PD_DT1,
rtr_INS_UPD_INSERT.RFD_SUSPENSE_CD as RFD_SUSPENSE_CD1,
rtr_INS_UPD_INSERT.RFD_SUSPENSE_CANCL as RFD_SUSPENSE_CANCL1,
rtr_INS_UPD_INSERT.RFD_SSNO_1 as RFD_SSNO_11,
rtr_INS_UPD_INSERT.RFD_SSNO_2 as RFD_SSNO_21,
rtr_INS_UPD_INSERT.RFD_REVIEW_DT as RFD_REVIEW_DT1,
rtr_INS_UPD_INSERT.RFD_UW_INIT as RFD_UW_INIT1,
rtr_INS_UPD_INSERT.RFD_MORT_NAME_1 as RFD_MORT_NAME_11,
rtr_INS_UPD_INSERT.RFD_MORT_NAME_2 as RFD_MORT_NAME_21,
rtr_INS_UPD_INSERT.RFD_MORT_ADD_1 as RFD_MORT_ADD_11,
rtr_INS_UPD_INSERT.RFD_MORT_ADD_2 as RFD_MORT_ADD_21,
rtr_INS_UPD_INSERT.RFD_MORT_CITYST as RFD_MORT_CITYST1,
rtr_INS_UPD_INSERT.RFD_MORT_ZIP as RFD_MORT_ZIP1,
rtr_INS_UPD_INSERT.RFD_STATE as RFD_STATE1,
rtr_INS_UPD_INSERT.RFD_MORT_TYPE as RFD_MORT_TYPE1,
rtr_INS_UPD_INSERT.RFD_LOAN_NUM as RFD_LOAN_NUM1,
rtr_INS_UPD_INSERT.RFD_PRI_COV as RFD_PRI_COV1,
rtr_INS_UPD_INSERT.RFD_PRI_UNSCH as RFD_PRI_UNSCH1,
rtr_INS_UPD_INSERT.RFD_PRI_ADDL as RFD_PRI_ADDL1,
rtr_INS_UPD_INSERT.RFD_PRI_HS as RFD_PRI_HS1,
rtr_INS_UPD_INSERT.RFD_PPRI_CLASS as RFD_PPRI_CLASS1,
rtr_INS_UPD_INSERT.RFD_PRI_CONST as RFD_PRI_CONST1,
rtr_INS_UPD_INSERT.RFD_PPRI_COV as RFD_PPRI_COV1,
rtr_INS_UPD_INSERT.RFD_PPRI_UNSCH as RFD_PPRI_UNSCH1,
rtr_INS_UPD_INSERT.RFD_PRI_COV_DT as RFD_PRI_COV_DT1,
rtr_INS_UPD_INSERT.RFD_PRI_BCOV_DT as RFD_PRI_BCOV_DT1,
rtr_INS_UPD_INSERT.RFD_SEC_COV as RFD_SEC_COV1,
rtr_INS_UPD_INSERT.RFD_SEC_UNSCH as RFD_SEC_UNSCH1,
rtr_INS_UPD_INSERT.RFD_SEC_ADDL as RFD_SEC_ADDL1,
rtr_INS_UPD_INSERT.RFD_SEC_HS as RFD_SEC_HS1,
rtr_INS_UPD_INSERT.RFD_PSEC_CLASS as RFD_PSEC_CLASS1,
rtr_INS_UPD_INSERT.RFD_SEC_CONST as RFD_SEC_CONST1,
rtr_INS_UPD_INSERT.RFD_PSEC_COV as RFD_PSEC_COV1,
rtr_INS_UPD_INSERT.RFD_PSEC_BCOV as RFD_PSEC_BCOV1,
rtr_INS_UPD_INSERT.RFD_SEC_COV_DT as RFD_SEC_COV_DT1,
rtr_INS_UPD_INSERT.RFD_SEC_BCOV_DT as RFD_SEC_BCOV_DT1,
rtr_INS_UPD_INSERT.RFD_PRI_CLASS as RFD_PRI_CLASS1,
rtr_INS_UPD_INSERT.RFD_PRI_DED as RFD_PRI_DED1,
rtr_INS_UPD_INSERT.RFD_SEC_CLASS as RFD_SEC_CLASS1,
rtr_INS_UPD_INSERT.RFD_SEC_DED as RFD_SEC_DED1,
rtr_INS_UPD_INSERT.RFD_PRI_PREM as RFD_PRI_PREM1,
rtr_INS_UPD_INSERT.RFD_SEC_PREM as RFD_SEC_PREM1,
rtr_INS_UPD_INSERT.RFD_ANICOLL_DT as RFD_ANICOLL_DT1,
rtr_INS_UPD_INSERT.RFD_PPRI_DED as RFD_PPRI_DED1,
rtr_INS_UPD_INSERT.RFD_PSEC_DED as RFD_PSEC_DED1,
rtr_INS_UPD_INSERT.RFD_LIAB as RFD_LIAB1,
rtr_INS_UPD_INSERT.RFD_MED as RFD_MED1,
rtr_INS_UPD_INSERT.RFD_ADD_BLDGS as RFD_ADD_BLDGS1,
rtr_INS_UPD_INSERT.RFD_PLIAB as RFD_PLIAB1,
rtr_INS_UPD_INSERT.RFD_PMED as RFD_PMED1,
rtr_INS_UPD_INSERT.RFD_PADD_BLDGS as RFD_PADD_BLDGS1,
rtr_INS_UPD_INSERT.RFD_LIAB_MED_DT as RFD_LIAB_MED_DT1,
rtr_INS_UPD_INSERT.RFD_TOT_ACRES as RFD_TOT_ACRES1,
rtr_INS_UPD_INSERT.RFD_PTOT_ACRES as RFD_PTOT_ACRES1,
rtr_INS_UPD_INSERT.RFD_PYRL_COV as RFD_PYRL_COV1,
rtr_INS_UPD_INSERT.RFD_PPYRL_COV as RFD_PPYRL_COV1,
rtr_INS_UPD_INSERT.RFD_RECEIPTS as RFD_RECEIPTS1,
rtr_INS_UPD_INSERT.RFD_PRECEIPTS as RFD_PRECEIPTS1,
rtr_INS_UPD_INSERT.RFD_SEC_DWELL as RFD_SEC_DWELL1,
rtr_INS_UPD_INSERT.RFD_PSEC_DWELL as RFD_PSEC_DWELL1,
rtr_INS_UPD_INSERT.RFD_OFFICES as RFD_OFFICES1,
rtr_INS_UPD_INSERT.RFD_POFFICES as RFD_POFFICES1,
rtr_INS_UPD_INSERT.RFD_PONDS as RFD_PONDS1,
rtr_INS_UPD_INSERT.RFD_PPONDS as RFD_PPONDS1,
rtr_INS_UPD_INSERT.RFD_NAMED_INSD as RFD_NAMED_INSD1,
rtr_INS_UPD_INSERT.RFD_PNAMED_INSD as RFD_PNAMED_INSD1,
rtr_INS_UPD_INSERT.RFD_FO_06_NON_NAME as RFD_FO_06_NON_NAME1,
rtr_INS_UPD_INSERT.RFD_PNON_NAMED as RFD_PNON_NAMED1,
rtr_INS_UPD_INSERT.RFD_NAMED_MED as RFD_NAMED_MED4,
rtr_INS_UPD_INSERT.RFD_PNAMED_MED as RFD_PNAMED_MED1,
rtr_INS_UPD_INSERT.RFD_ADDL_RES as RFD_ADDL_RES1,
rtr_INS_UPD_INSERT.RFD_PADDL_RES as RFD_PADDL_RES1,
rtr_INS_UPD_INSERT.RFD_NAMED_MED_DT as RFD_NAMED_MED_DT1,
rtr_INS_UPD_INSERT.RFD_NAMED_MED_PRM as RFD_NAMED_MED_PRM1,
rtr_INS_UPD_INSERT.RFD_LIAB_PRM as RFD_LIAB_PRM1,
rtr_INS_UPD_INSERT.RFD_LVSTK_COV as RFD_LVSTK_COV1,
rtr_INS_UPD_INSERT.RFD_LVSTK_PRM as RFD_LVSTK_PRM1,
rtr_INS_UPD_INSERT.RFD_LVSTK_DED as RFD_LVSTK_DED1,
rtr_INS_UPD_INSERT.RFD_PLVSTK_COV as RFD_PLVSTK_COV1,
rtr_INS_UPD_INSERT.RFD_PLVSTK_DED as RFD_PLVSTK_DED1,
rtr_INS_UPD_INSERT.RFD_LVSTK_DT as RFD_LVSTK_DT1,
rtr_INS_UPD_INSERT.RFD_LVSTK_DED_DT as RFD_LVSTK_DED_DT1,
rtr_INS_UPD_INSERT.RFD_ANICOLL_COV as RFD_ANICOLL_COV1,
rtr_INS_UPD_INSERT.RFD_FDSD_COV as RFD_FDSD_COV1,
rtr_INS_UPD_INSERT.RFD_FDSD_PRM as RFD_FDSD_PRM1,
rtr_INS_UPD_INSERT.RFD_FDSD_DED as RFD_FDSD_DED1,
rtr_INS_UPD_INSERT.RFD_PFDSD_COV as RFD_PFDSD_COV1,
rtr_INS_UPD_INSERT.RFD_PFDSD_DED as RFD_PFDSD_DED1,
rtr_INS_UPD_INSERT.RFD_FDSD_DT as RFD_FDSD_DT1,
rtr_INS_UPD_INSERT.RFD_FDSD_DED_DT as RFD_FDSD_DED_DT1,
rtr_INS_UPD_INSERT.RFD_ANICOLL_PRM as RFD_ANICOLL_PRM1,
rtr_INS_UPD_INSERT.RFD_MACH_COV as RFD_MACH_COV1,
rtr_INS_UPD_INSERT.RFD_MACH_PRM as RFD_MACH_PRM1,
rtr_INS_UPD_INSERT.RFD_MACH_DED as RFD_MACH_DED1,
rtr_INS_UPD_INSERT.RFD_PMACH_COV as RFD_PMACH_COV1,
rtr_INS_UPD_INSERT.RFD_PMACH_DED as RFD_PMACH_DED1,
rtr_INS_UPD_INSERT.RFD_MACH_DT as RFD_MACH_DT1,
rtr_INS_UPD_INSERT.RFD_MACH_DED_DT as RFD_MACH_DED_DT1,
rtr_INS_UPD_INSERT.RFD_PANICOLL_COV as RFD_PANICOLL_COV1,
rtr_INS_UPD_INSERT.RFD_H_MACH_COV as RFD_H_MACH_COV1,
rtr_INS_UPD_INSERT.RFD_H_MACH_PRM as RFD_H_MACH_PRM1,
rtr_INS_UPD_INSERT.RFD_H_MACH_DED as RFD_H_MACH_DED1,
rtr_INS_UPD_INSERT.RFD_PH_MACH_COV as RFD_PH_MACH_COV1,
rtr_INS_UPD_INSERT.RFD_PH_MACH_DED as RFD_PH_MACH_DED1,
rtr_INS_UPD_INSERT.RFD_H_MACH_DT as RFD_H_MACH_DT1,
rtr_INS_UPD_INSERT.RFD_H_MACH_DED_DT as RFD_H_MACH_DED_DT1,
rtr_INS_UPD_INSERT.RFD_VC_DIS_DT as RFD_VC_DIS_DT1,
rtr_INS_UPD_INSERT.RFD_VC_DISCT as RFD_VC_DISCT1,
rtr_INS_UPD_INSERT.RFD_LOC1 as RFD_LOC11,
rtr_INS_UPD_INSERT.RFD_LOC2 as RFD_LOC21,
rtr_INS_UPD_INSERT.RFD_LOC3 as RFD_LOC31,
rtr_INS_UPD_INSERT.RFD_1YR_TOT as RFD_1YR_TOT1,
rtr_INS_UPD_INSERT.RFD_1YR_DWELL as RFD_1YR_DWELL1,
rtr_INS_UPD_INSERT.RFD_1YR_UNSCH as RFD_1YR_UNSCH1,
rtr_INS_UPD_INSERT.RFD_1YR_ADDL as RFD_1YR_ADDL1,
rtr_INS_UPD_INSERT.RFD_1YR_LIAB as RFD_1YR_LIAB1,
rtr_INS_UPD_INSERT.RFD_1YR_MED as RFD_1YR_MED1,
rtr_INS_UPD_INSERT.RFD_1YR_OUTBLDG as RFD_1YR_OUTBLDG1,
rtr_INS_UPD_INSERT.RFD_1YR_PD as RFD_1YR_PD1,
rtr_INS_UPD_INSERT.RFD_1YR_NMED as RFD_1YR_NMED1,
rtr_INS_UPD_INSERT.RFD_1YR_LVSTK as RFD_1YR_LVSTK1,
rtr_INS_UPD_INSERT.RFD_1YR_MACH as RFD_1YR_MACH1,
rtr_INS_UPD_INSERT.RFD_5YR_TOT as RFD_5YR_TOT1,
rtr_INS_UPD_INSERT.RFD_5YR_DWELL as RFD_5YR_DWELL1,
rtr_INS_UPD_INSERT.RFD_5YR_UNSCH as RFD_5YR_UNSCH1,
rtr_INS_UPD_INSERT.RFD_5YR_ADDL as RFD_5YR_ADDL1,
rtr_INS_UPD_INSERT.RFD_5YR_LIAB as RFD_5YR_LIAB1,
rtr_INS_UPD_INSERT.RFD_5YR_MED as RFD_5YR_MED1,
rtr_INS_UPD_INSERT.RFD_5YR_OUTBLDG as RFD_5YR_OUTBLDG1,
rtr_INS_UPD_INSERT.RFD_5YR_PD as RFD_5YR_PD1,
rtr_INS_UPD_INSERT.RFD_5YR_NMED as RFD_5YR_NMED1,
rtr_INS_UPD_INSERT.RFD_5YR_LVSTK as RFD_5YR_LVSTK1,
rtr_INS_UPD_INSERT.RFD_5YR_MACH as RFD_5YR_MACH1,
rtr_INS_UPD_INSERT.RFD_5YR_AMT as RFD_5YR_AMT1,
rtr_INS_UPD_INSERT.RFD_INFL_PRI_COV as RFD_INFL_PRI_COV1,
rtr_INS_UPD_INSERT.RFD_INFL_PRI_UNSCH as RFD_INFL_PRI_UNSCH1,
rtr_INS_UPD_INSERT.RFD_NAMED_MED1 as RFD_NAMED_MED11,
rtr_INS_UPD_INSERT.RFD_NAMED_MED2 as RFD_NAMED_MED21,
rtr_INS_UPD_INSERT.RFD_NAMED_MED3 as RFD_NAMED_MED31,
rtr_INS_UPD_INSERT.RFD_INFL_SEC_COV as RFD_INFL_SEC_COV1,
rtr_INS_UPD_INSERT.RFD_INFL_SEC_UNSCH as RFD_INFL_SEC_UNSCH1,
rtr_INS_UPD_INSERT.RFD_PRI_CNTY as RFD_PRI_CNTY1,
rtr_INS_UPD_INSERT.RFD_SEC_CNTY as RFD_SEC_CNTY1,
rtr_INS_UPD_INSERT.RFD_OVER9 as RFD_OVER91,
rtr_INS_UPD_INSERT.RFD_EBLDG_CON_YR01 as RFD_EBLDG_CON_YR011,
rtr_INS_UPD_INSERT.RFD_EBLDG_CON_YR02 as RFD_EBLDG_CON_YR021,
rtr_INS_UPD_INSERT.RFD_EBLDG_CON_YR03 as RFD_EBLDG_CON_YR031,
rtr_INS_UPD_INSERT.RFD_EBLDG_CON_YR04 as RFD_EBLDG_CON_YR041,
rtr_INS_UPD_INSERT.RFD_EBLDG_CON_YR05 as RFD_EBLDG_CON_YR051,
rtr_INS_UPD_INSERT.RFD_EBLDG_CON_YR06 as RFD_EBLDG_CON_YR061,
rtr_INS_UPD_INSERT.RFD_EBLDG_CON_YR07 as RFD_EBLDG_CON_YR071,
rtr_INS_UPD_INSERT.RFD_EBLDG_CON_YR08 as RFD_EBLDG_CON_YR081,
rtr_INS_UPD_INSERT.RFD_EBLDG_CON_YR09 as RFD_EBLDG_CON_YR091,
rtr_INS_UPD_INSERT.RFD_MB_TYPE as RFD_MB_TYPE1,
rtr_INS_UPD_INSERT.RFD_MB_ACCT_NUM as RFD_MB_ACCT_NUM1,
rtr_INS_UPD_INSERT.RFD_FO_07 as RFD_FO_071,
rtr_INS_UPD_INSERT.RFD_FO_46 as RFD_FO_461,
rtr_INS_UPD_INSERT.RFD_FO_85 as RFD_FO_851,
rtr_INS_UPD_INSERT.RFD_ROLL_OVER_IND as RFD_ROLL_OVER_IND1,
rtr_INS_UPD_INSERT.FEED_IND as FEED_IND1,
rtr_INS_UPD_INSERT.ECTL_PRGM_ID as ECTL_PRGM_ID1,
rtr_INS_UPD_INSERT.ECTL_SRC_ID as ECTL_SRC_ID1,
rtr_INS_UPD_INSERT.ECTL_SRC_INST_ID as ECTL_SRC_INST_ID1,
rtr_INS_UPD_INSERT.ECTL_BATCH_ID as ECTL_BATCH_ID1,
rtr_INS_UPD_INSERT.ORIG_INS_TS as ORIG_INS_TS1,
rtr_INS_UPD_INSERT.ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE1,
''NEW'' as out_ECTL_TX_CD,
TO_CHAR ( ( DATE_PART(''YYYY'', TO_TIMESTAMP(rtr_INS_UPD_INSERT.LOAD_DT)) * 10000 ) + ( DATE_PART(''MM'', TO_TIMESTAMP(rtr_INS_UPD_INSERT.LOAD_DT)) * 100 ) + 1 ) as var_GET_START_DATE,
TO_DATE ( var_GET_START_DATE , ''YYYYMMDD'' ) as var_CHG_EFF_DT,
CASE WHEN rtr_INS_UPD_INSERT.CHG_EFF_DT_lkp >= var_CHG_EFF_DT THEN  rtr_INS_UPD_INSERT.CHG_EFF_DT_lkp + 1  ELSE var_CHG_EFF_DT END as out_CHG_EFF_DT,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as CHG_EXP_DT,
TO_DATE ( ''12/31/9999'' , ''MM/DD/YYYY'' ) as out_ECTL_END_DATE,
rtr_INS_UPD_INSERT.source_record_id
FROM
rtr_INS_UPD_INSERT
);


-- Component FARMPOLS_INS, Type TARGET 
INSERT INTO DB_T_CORE_MEMBXREF_PROD.FARMPOLS
(
SC_DWNLD_PRIORITY,
SC_SERVICE_CENTER,
SC_POLICY_NUM,
CHG_EFF_DT,
CHG_EXP_DT,
SC_FLT_ITEM,
SC_FILE_TYPE,
SC_REC_TRANS_CODE,
SC_TRANS_DATE,
SC_TRANS_TYPE,
PC_ALPHA_CODE,
PC_NAME_1,
PC_NAME_2,
PC_ADDRESS_1,
PC_ADDRESS_2,
PC_CITYST,
PC_ZIP,
PC_TAX_CODE,
PC_AGENT,
PC_MEMBER_NUMBER,
PC_RATE_CODE,
PC_ENCUMBRANCE,
PC_PREM_FIN,
PC_MORT_IND,
PC_COMPANY,
PC_INCEPT_DATE,
PC_EXP_DATE,
PC_EFF_DATE,
PC_STATUS,
RFD_TOT_PREM,
RFD_REWRITE_IND,
RFD_REWRITE_DT,
RFD_OUTSTAND_AMT,
RFD_OUTSTAND_TYPE,
RFD_OUTSTAND_DT,
RFD_OUTSTAND_PD_DT,
RFD_SUSPENSE_CD,
RFD_SUSPENSE_CANCL,
RFD_SSNO_1,
RFD_SSNO_2,
RFD_REVIEW_DT,
RFD_UW_INIT,
RFD_MORT_NAME_1,
RFD_MORT_NAME_2,
RFD_MORT_ADD_1,
RFD_MORT_ADD_2,
RFD_MORT_CITYST,
RFD_MORT_ZIP,
RFD_STATE,
RFD_MORT_TYPE,
RFD_LOAN_NUM,
RFD_PRI_COV,
RFD_PRI_UNSCH,
RFD_PRI_ADDL,
RFD_PRI_HS,
RFD_PPRI_CLASS,
RFD_PRI_CONST,
RFD_PPRI_COV,
RFD_PPRI_UNSCH,
RFD_PRI_COV_DT,
RFD_PRI_BCOV_DT,
RFD_SEC_COV,
RFD_SEC_UNSCH,
RFD_SEC_ADDL,
RFD_SEC_HS,
RFD_PSEC_CLASS,
RFD_SEC_CONST,
RFD_PSEC_COV,
RFD_PSEC_BCOV,
RFD_SEC_COV_DT,
RFD_SEC_BCOV_DT,
RFD_PRI_CLASS,
RFD_PRI_DED,
RFD_SEC_CLASS,
RFD_SEC_DED,
RFD_PRI_PREM,
RFD_SEC_PREM,
RFD_ANICOLL_DT,
RFD_PPRI_DED,
RFD_PSEC_DED,
RFD_LIAB,
RFD_MED,
RFD_ADD_BLDGS,
RFD_PLIAB,
RFD_PMED,
RFD_PADD_BLDGS,
RFD_LIAB_MED_DT,
RFD_TOT_ACRES,
RFD_PTOT_ACRES,
RFD_PYRL_COV,
RFD_PPYRL_COV,
RFD_RECEIPTS,
RFD_PRECEIPTS,
RFD_SEC_DWELL,
RFD_PSEC_DWELL,
RFD_OFFICES,
RFD_POFFICES,
RFD_PONDS,
RFD_PPONDS,
RFD_NAMED_INSD,
RFD_PNAMED_INSD,
RFD_FO_06_NON_NAME,
RFD_PNON_NAMED,
RFD_NAMED_MED,
RFD_PNAMED_MED,
RFD_ADDL_RES,
RFD_PADDL_RES,
RFD_NAMED_MED_DT,
RFD_NAMED_MED_PRM,
RFD_LIAB_PRM,
RFD_LVSTK_COV,
RFD_LVSTK_PRM,
RFD_LVSTK_DED,
RFD_PLVSTK_COV,
RFD_PLVSTK_DED,
RFD_LVSTK_DT,
RFD_LVSTK_DED_DT,
RFD_ANICOLL_COV,
RFD_FDSD_COV,
RFD_FDSD_PRM,
RFD_FDSD_DED,
RFD_PFDSD_COV,
RFD_PFDSD_DED,
RFD_FDSD_DT,
RFD_FDSD_DED_DT,
RFD_ANICOLL_PRM,
RFD_MACH_COV,
RFD_MACH_PRM,
RFD_MACH_DED,
RFD_PMACH_COV,
RFD_PMACH_DED,
RFD_MACH_DT,
RFD_MACH_DED_DT,
RFD_PANICOLL_COV,
RFD_H_MACH_COV,
RFD_H_MACH_PRM,
RFD_H_MACH_DED,
RFD_PH_MACH_COV,
RFD_PH_MACH_DED,
RFD_H_MACH_DT,
RFD_H_MACH_DED_DT,
RFD_VC_DIS_DT,
RFD_VC_DISCT,
RFD_LOC1,
RFD_LOC2,
RFD_LOC3,
RFD_1YR_TOT,
RFD_1YR_DWELL,
RFD_1YR_UNSCH,
RFD_1YR_ADDL,
RFD_1YR_LIAB,
RFD_1YR_MED,
RFD_1YR_OUTBLDG,
RFD_1YR_PD,
RFD_1YR_NMED,
RFD_1YR_LVSTK,
RFD_1YR_MACH,
RFD_5YR_TOT,
RFD_5YR_DWELL,
RFD_5YR_UNSCH,
RFD_5YR_ADDL,
RFD_5YR_LIAB,
RFD_5YR_MED,
RFD_5YR_OUTBLDG,
RFD_5YR_PD,
RFD_5YR_NMED,
RFD_5YR_LVSTK,
RFD_5YR_MACH,
RFD_5YR_AMT,
RFD_INFL_PRI_COV,
RFD_INFL_PRI_UNSCH,
RFD_NAMED_MED1,
RFD_NAMED_MED2,
RFD_NAMED_MED3,
RFD_INFL_SEC_COV,
RFD_INFL_SEC_UNSCH,
RFD_PRI_CNTY,
RFD_SEC_CNTY,
RFD_OVER9,
RFD_EBLDG_CON_YR01,
RFD_EBLDG_CON_YR02,
RFD_EBLDG_CON_YR03,
RFD_EBLDG_CON_YR04,
RFD_EBLDG_CON_YR05,
RFD_EBLDG_CON_YR06,
RFD_EBLDG_CON_YR07,
RFD_EBLDG_CON_YR08,
RFD_EBLDG_CON_YR09,
RFD_MB_TYPE,
RFD_MB_ACCT_NUM,
RFD_FO_07,
RFD_FO_46,
RFD_FO_85,
RFD_ROLL_OVER_IND,
FEED_IND,
ECTL_BATCH_ID,
ECTL_ORIG_INS_TS,
ECTL_MODIFY_TS,
ECTL_SRC_ID,
ECTL_SRC_INST_ID,
ECTL_PRGM_ID,
ECTL_TX_CD,
ECTL_START_DATE,
ECTL_END_DATE
)
SELECT
exp_GET_EFF_DATE.SC_DWNLD_PRIORITY1 as SC_DWNLD_PRIORITY,
exp_GET_EFF_DATE.SC_SERVICE_CENTER1 as SC_SERVICE_CENTER,
exp_GET_EFF_DATE.SC_POLICY_NUM1 as SC_POLICY_NUM,
exp_GET_EFF_DATE.out_CHG_EFF_DT as CHG_EFF_DT,
exp_GET_EFF_DATE.CHG_EXP_DT as CHG_EXP_DT,
exp_GET_EFF_DATE.SC_FLT_ITEM1 as SC_FLT_ITEM,
exp_GET_EFF_DATE.SC_FILE_TYPE1 as SC_FILE_TYPE,
exp_GET_EFF_DATE.SC_REC_TRANS_CODE1 as SC_REC_TRANS_CODE,
exp_GET_EFF_DATE.SC_TRANS_DATE1 as SC_TRANS_DATE,
exp_GET_EFF_DATE.SC_TRANS_TYPE1 as SC_TRANS_TYPE,
exp_GET_EFF_DATE.PC_ALPHA_CODE1 as PC_ALPHA_CODE,
exp_GET_EFF_DATE.PC_NAME_11 as PC_NAME_1,
exp_GET_EFF_DATE.PC_NAME_21 as PC_NAME_2,
exp_GET_EFF_DATE.PC_ADDRESS_11 as PC_ADDRESS_1,
exp_GET_EFF_DATE.PC_ADDRESS_21 as PC_ADDRESS_2,
exp_GET_EFF_DATE.PC_CITYST1 as PC_CITYST,
exp_GET_EFF_DATE.PC_ZIP1 as PC_ZIP,
exp_GET_EFF_DATE.PC_TAX_CODE1 as PC_TAX_CODE,
exp_GET_EFF_DATE.PC_AGENT1 as PC_AGENT,
exp_GET_EFF_DATE.PC_MEMBER_NUMBER1 as PC_MEMBER_NUMBER,
exp_GET_EFF_DATE.PC_RATE_CODE1 as PC_RATE_CODE,
exp_GET_EFF_DATE.PC_ENCUMBRANCE1 as PC_ENCUMBRANCE,
exp_GET_EFF_DATE.PC_PREM_FIN1 as PC_PREM_FIN,
exp_GET_EFF_DATE.PC_MORT_IND1 as PC_MORT_IND,
exp_GET_EFF_DATE.PC_COMPANY1 as PC_COMPANY,
exp_GET_EFF_DATE.PC_INCEPT_DATE1 as PC_INCEPT_DATE,
exp_GET_EFF_DATE.PC_EXP_DATE1 as PC_EXP_DATE,
exp_GET_EFF_DATE.PC_EFF_DATE1 as PC_EFF_DATE,
exp_GET_EFF_DATE.PC_STATUS1 as PC_STATUS,
exp_GET_EFF_DATE.RFD_TOT_PREM1 as RFD_TOT_PREM,
exp_GET_EFF_DATE.RFD_REWRITE_IND1 as RFD_REWRITE_IND,
exp_GET_EFF_DATE.RFD_REWRITE_DT1 as RFD_REWRITE_DT,
exp_GET_EFF_DATE.RFD_OUTSTAND_AMT1 as RFD_OUTSTAND_AMT,
exp_GET_EFF_DATE.RFD_OUTSTAND_TYPE1 as RFD_OUTSTAND_TYPE,
exp_GET_EFF_DATE.RFD_OUTSTAND_DT1 as RFD_OUTSTAND_DT,
exp_GET_EFF_DATE.RFD_OUTSTAND_PD_DT1 as RFD_OUTSTAND_PD_DT,
exp_GET_EFF_DATE.RFD_SUSPENSE_CD1 as RFD_SUSPENSE_CD,
exp_GET_EFF_DATE.RFD_SUSPENSE_CANCL1 as RFD_SUSPENSE_CANCL,
exp_GET_EFF_DATE.RFD_SSNO_11 as RFD_SSNO_1,
exp_GET_EFF_DATE.RFD_SSNO_21 as RFD_SSNO_2,
exp_GET_EFF_DATE.RFD_REVIEW_DT1 as RFD_REVIEW_DT,
exp_GET_EFF_DATE.RFD_UW_INIT1 as RFD_UW_INIT,
exp_GET_EFF_DATE.RFD_MORT_NAME_11 as RFD_MORT_NAME_1,
exp_GET_EFF_DATE.RFD_MORT_NAME_21 as RFD_MORT_NAME_2,
exp_GET_EFF_DATE.RFD_MORT_ADD_11 as RFD_MORT_ADD_1,
exp_GET_EFF_DATE.RFD_MORT_ADD_21 as RFD_MORT_ADD_2,
exp_GET_EFF_DATE.RFD_MORT_CITYST1 as RFD_MORT_CITYST,
exp_GET_EFF_DATE.RFD_MORT_ZIP1 as RFD_MORT_ZIP,
exp_GET_EFF_DATE.RFD_STATE1 as RFD_STATE,
exp_GET_EFF_DATE.RFD_MORT_TYPE1 as RFD_MORT_TYPE,
exp_GET_EFF_DATE.RFD_LOAN_NUM1 as RFD_LOAN_NUM,
exp_GET_EFF_DATE.RFD_PRI_COV1 as RFD_PRI_COV,
exp_GET_EFF_DATE.RFD_PRI_UNSCH1 as RFD_PRI_UNSCH,
exp_GET_EFF_DATE.RFD_PRI_ADDL1 as RFD_PRI_ADDL,
exp_GET_EFF_DATE.RFD_PRI_HS1 as RFD_PRI_HS,
exp_GET_EFF_DATE.RFD_PPRI_CLASS1 as RFD_PPRI_CLASS,
exp_GET_EFF_DATE.RFD_PRI_CONST1 as RFD_PRI_CONST,
exp_GET_EFF_DATE.RFD_PPRI_COV1 as RFD_PPRI_COV,
exp_GET_EFF_DATE.RFD_PPRI_UNSCH1 as RFD_PPRI_UNSCH,
exp_GET_EFF_DATE.RFD_PRI_COV_DT1 as RFD_PRI_COV_DT,
exp_GET_EFF_DATE.RFD_PRI_BCOV_DT1 as RFD_PRI_BCOV_DT,
exp_GET_EFF_DATE.RFD_SEC_COV1 as RFD_SEC_COV,
exp_GET_EFF_DATE.RFD_SEC_UNSCH1 as RFD_SEC_UNSCH,
exp_GET_EFF_DATE.RFD_SEC_ADDL1 as RFD_SEC_ADDL,
exp_GET_EFF_DATE.RFD_SEC_HS1 as RFD_SEC_HS,
exp_GET_EFF_DATE.RFD_PSEC_CLASS1 as RFD_PSEC_CLASS,
exp_GET_EFF_DATE.RFD_SEC_CONST1 as RFD_SEC_CONST,
exp_GET_EFF_DATE.RFD_PSEC_COV1 as RFD_PSEC_COV,
exp_GET_EFF_DATE.RFD_PSEC_BCOV1 as RFD_PSEC_BCOV,
exp_GET_EFF_DATE.RFD_SEC_COV_DT1 as RFD_SEC_COV_DT,
exp_GET_EFF_DATE.RFD_SEC_BCOV_DT1 as RFD_SEC_BCOV_DT,
exp_GET_EFF_DATE.RFD_PRI_CLASS1 as RFD_PRI_CLASS,
exp_GET_EFF_DATE.RFD_PRI_DED1 as RFD_PRI_DED,
exp_GET_EFF_DATE.RFD_SEC_CLASS1 as RFD_SEC_CLASS,
exp_GET_EFF_DATE.RFD_SEC_DED1 as RFD_SEC_DED,
exp_GET_EFF_DATE.RFD_PRI_PREM1 as RFD_PRI_PREM,
exp_GET_EFF_DATE.RFD_SEC_PREM1 as RFD_SEC_PREM,
exp_GET_EFF_DATE.RFD_ANICOLL_DT1 as RFD_ANICOLL_DT,
exp_GET_EFF_DATE.RFD_PPRI_DED1 as RFD_PPRI_DED,
exp_GET_EFF_DATE.RFD_PSEC_DED1 as RFD_PSEC_DED,
exp_GET_EFF_DATE.RFD_LIAB1 as RFD_LIAB,
exp_GET_EFF_DATE.RFD_MED1 as RFD_MED,
exp_GET_EFF_DATE.RFD_ADD_BLDGS1 as RFD_ADD_BLDGS,
exp_GET_EFF_DATE.RFD_PLIAB1 as RFD_PLIAB,
exp_GET_EFF_DATE.RFD_PMED1 as RFD_PMED,
exp_GET_EFF_DATE.RFD_PADD_BLDGS1 as RFD_PADD_BLDGS,
exp_GET_EFF_DATE.RFD_LIAB_MED_DT1 as RFD_LIAB_MED_DT,
exp_GET_EFF_DATE.RFD_TOT_ACRES1 as RFD_TOT_ACRES,
exp_GET_EFF_DATE.RFD_PTOT_ACRES1 as RFD_PTOT_ACRES,
exp_GET_EFF_DATE.RFD_PYRL_COV1 as RFD_PYRL_COV,
exp_GET_EFF_DATE.RFD_PPYRL_COV1 as RFD_PPYRL_COV,
exp_GET_EFF_DATE.RFD_RECEIPTS1 as RFD_RECEIPTS,
exp_GET_EFF_DATE.RFD_PRECEIPTS1 as RFD_PRECEIPTS,
exp_GET_EFF_DATE.RFD_SEC_DWELL1 as RFD_SEC_DWELL,
exp_GET_EFF_DATE.RFD_PSEC_DWELL1 as RFD_PSEC_DWELL,
exp_GET_EFF_DATE.RFD_OFFICES1 as RFD_OFFICES,
exp_GET_EFF_DATE.RFD_POFFICES1 as RFD_POFFICES,
exp_GET_EFF_DATE.RFD_PONDS1 as RFD_PONDS,
exp_GET_EFF_DATE.RFD_PPONDS1 as RFD_PPONDS,
exp_GET_EFF_DATE.RFD_NAMED_INSD1 as RFD_NAMED_INSD,
exp_GET_EFF_DATE.RFD_PNAMED_INSD1 as RFD_PNAMED_INSD,
exp_GET_EFF_DATE.RFD_FO_06_NON_NAME1 as RFD_FO_06_NON_NAME,
exp_GET_EFF_DATE.RFD_PNON_NAMED1 as RFD_PNON_NAMED,
exp_GET_EFF_DATE.RFD_NAMED_MED4 as RFD_NAMED_MED,
exp_GET_EFF_DATE.RFD_PNAMED_MED1 as RFD_PNAMED_MED,
exp_GET_EFF_DATE.RFD_ADDL_RES1 as RFD_ADDL_RES,
exp_GET_EFF_DATE.RFD_PADDL_RES1 as RFD_PADDL_RES,
exp_GET_EFF_DATE.RFD_NAMED_MED_DT1 as RFD_NAMED_MED_DT,
exp_GET_EFF_DATE.RFD_NAMED_MED_PRM1 as RFD_NAMED_MED_PRM,
exp_GET_EFF_DATE.RFD_LIAB_PRM1 as RFD_LIAB_PRM,
exp_GET_EFF_DATE.RFD_LVSTK_COV1 as RFD_LVSTK_COV,
exp_GET_EFF_DATE.RFD_LVSTK_PRM1 as RFD_LVSTK_PRM,
exp_GET_EFF_DATE.RFD_LVSTK_DED1 as RFD_LVSTK_DED,
exp_GET_EFF_DATE.RFD_PLVSTK_COV1 as RFD_PLVSTK_COV,
exp_GET_EFF_DATE.RFD_PLVSTK_DED1 as RFD_PLVSTK_DED,
exp_GET_EFF_DATE.RFD_LVSTK_DT1 as RFD_LVSTK_DT,
exp_GET_EFF_DATE.RFD_LVSTK_DED_DT1 as RFD_LVSTK_DED_DT,
exp_GET_EFF_DATE.RFD_ANICOLL_COV1 as RFD_ANICOLL_COV,
exp_GET_EFF_DATE.RFD_FDSD_COV1 as RFD_FDSD_COV,
exp_GET_EFF_DATE.RFD_FDSD_PRM1 as RFD_FDSD_PRM,
exp_GET_EFF_DATE.RFD_FDSD_DED1 as RFD_FDSD_DED,
exp_GET_EFF_DATE.RFD_PFDSD_COV1 as RFD_PFDSD_COV,
exp_GET_EFF_DATE.RFD_PFDSD_DED1 as RFD_PFDSD_DED,
exp_GET_EFF_DATE.RFD_FDSD_DT1 as RFD_FDSD_DT,
exp_GET_EFF_DATE.RFD_FDSD_DED_DT1 as RFD_FDSD_DED_DT,
exp_GET_EFF_DATE.RFD_ANICOLL_PRM1 as RFD_ANICOLL_PRM,
exp_GET_EFF_DATE.RFD_MACH_COV1 as RFD_MACH_COV,
exp_GET_EFF_DATE.RFD_MACH_PRM1 as RFD_MACH_PRM,
exp_GET_EFF_DATE.RFD_MACH_DED1 as RFD_MACH_DED,
exp_GET_EFF_DATE.RFD_PMACH_COV1 as RFD_PMACH_COV,
exp_GET_EFF_DATE.RFD_PMACH_DED1 as RFD_PMACH_DED,
exp_GET_EFF_DATE.RFD_MACH_DT1 as RFD_MACH_DT,
exp_GET_EFF_DATE.RFD_MACH_DED_DT1 as RFD_MACH_DED_DT,
exp_GET_EFF_DATE.RFD_PANICOLL_COV1 as RFD_PANICOLL_COV,
exp_GET_EFF_DATE.RFD_H_MACH_COV1 as RFD_H_MACH_COV,
exp_GET_EFF_DATE.RFD_H_MACH_PRM1 as RFD_H_MACH_PRM,
exp_GET_EFF_DATE.RFD_H_MACH_DED1 as RFD_H_MACH_DED,
exp_GET_EFF_DATE.RFD_PH_MACH_COV1 as RFD_PH_MACH_COV,
exp_GET_EFF_DATE.RFD_PH_MACH_DED1 as RFD_PH_MACH_DED,
exp_GET_EFF_DATE.RFD_H_MACH_DT1 as RFD_H_MACH_DT,
exp_GET_EFF_DATE.RFD_H_MACH_DED_DT1 as RFD_H_MACH_DED_DT,
exp_GET_EFF_DATE.RFD_VC_DIS_DT1 as RFD_VC_DIS_DT,
exp_GET_EFF_DATE.RFD_VC_DISCT1 as RFD_VC_DISCT,
exp_GET_EFF_DATE.RFD_LOC11 as RFD_LOC1,
exp_GET_EFF_DATE.RFD_LOC21 as RFD_LOC2,
exp_GET_EFF_DATE.RFD_LOC31 as RFD_LOC3,
exp_GET_EFF_DATE.RFD_1YR_TOT1 as RFD_1YR_TOT,
exp_GET_EFF_DATE.RFD_1YR_DWELL1 as RFD_1YR_DWELL,
exp_GET_EFF_DATE.RFD_1YR_UNSCH1 as RFD_1YR_UNSCH,
exp_GET_EFF_DATE.RFD_1YR_ADDL1 as RFD_1YR_ADDL,
exp_GET_EFF_DATE.RFD_1YR_LIAB1 as RFD_1YR_LIAB,
exp_GET_EFF_DATE.RFD_1YR_MED1 as RFD_1YR_MED,
exp_GET_EFF_DATE.RFD_1YR_OUTBLDG1 as RFD_1YR_OUTBLDG,
exp_GET_EFF_DATE.RFD_1YR_PD1 as RFD_1YR_PD,
exp_GET_EFF_DATE.RFD_1YR_NMED1 as RFD_1YR_NMED,
exp_GET_EFF_DATE.RFD_1YR_LVSTK1 as RFD_1YR_LVSTK,
exp_GET_EFF_DATE.RFD_1YR_MACH1 as RFD_1YR_MACH,
exp_GET_EFF_DATE.RFD_5YR_TOT1 as RFD_5YR_TOT,
exp_GET_EFF_DATE.RFD_5YR_DWELL1 as RFD_5YR_DWELL,
exp_GET_EFF_DATE.RFD_5YR_UNSCH1 as RFD_5YR_UNSCH,
exp_GET_EFF_DATE.RFD_5YR_ADDL1 as RFD_5YR_ADDL,
exp_GET_EFF_DATE.RFD_5YR_LIAB1 as RFD_5YR_LIAB,
exp_GET_EFF_DATE.RFD_5YR_MED1 as RFD_5YR_MED,
exp_GET_EFF_DATE.RFD_5YR_OUTBLDG1 as RFD_5YR_OUTBLDG,
exp_GET_EFF_DATE.RFD_5YR_PD1 as RFD_5YR_PD,
exp_GET_EFF_DATE.RFD_5YR_NMED1 as RFD_5YR_NMED,
exp_GET_EFF_DATE.RFD_5YR_LVSTK1 as RFD_5YR_LVSTK,
exp_GET_EFF_DATE.RFD_5YR_MACH1 as RFD_5YR_MACH,
exp_GET_EFF_DATE.RFD_5YR_AMT1 as RFD_5YR_AMT,
exp_GET_EFF_DATE.RFD_INFL_PRI_COV1 as RFD_INFL_PRI_COV,
exp_GET_EFF_DATE.RFD_INFL_PRI_UNSCH1 as RFD_INFL_PRI_UNSCH,
exp_GET_EFF_DATE.RFD_NAMED_MED11 as RFD_NAMED_MED1,
exp_GET_EFF_DATE.RFD_NAMED_MED21 as RFD_NAMED_MED2,
exp_GET_EFF_DATE.RFD_NAMED_MED31 as RFD_NAMED_MED3,
exp_GET_EFF_DATE.RFD_INFL_SEC_COV1 as RFD_INFL_SEC_COV,
exp_GET_EFF_DATE.RFD_INFL_SEC_UNSCH1 as RFD_INFL_SEC_UNSCH,
exp_GET_EFF_DATE.RFD_PRI_CNTY1 as RFD_PRI_CNTY,
exp_GET_EFF_DATE.RFD_SEC_CNTY1 as RFD_SEC_CNTY,
exp_GET_EFF_DATE.RFD_OVER91 as RFD_OVER9,
exp_GET_EFF_DATE.RFD_EBLDG_CON_YR011 as RFD_EBLDG_CON_YR01,
exp_GET_EFF_DATE.RFD_EBLDG_CON_YR021 as RFD_EBLDG_CON_YR02,
exp_GET_EFF_DATE.RFD_EBLDG_CON_YR031 as RFD_EBLDG_CON_YR03,
exp_GET_EFF_DATE.RFD_EBLDG_CON_YR041 as RFD_EBLDG_CON_YR04,
exp_GET_EFF_DATE.RFD_EBLDG_CON_YR051 as RFD_EBLDG_CON_YR05,
exp_GET_EFF_DATE.RFD_EBLDG_CON_YR061 as RFD_EBLDG_CON_YR06,
exp_GET_EFF_DATE.RFD_EBLDG_CON_YR071 as RFD_EBLDG_CON_YR07,
exp_GET_EFF_DATE.RFD_EBLDG_CON_YR081 as RFD_EBLDG_CON_YR08,
exp_GET_EFF_DATE.RFD_EBLDG_CON_YR091 as RFD_EBLDG_CON_YR09,
exp_GET_EFF_DATE.RFD_MB_TYPE1 as RFD_MB_TYPE,
exp_GET_EFF_DATE.RFD_MB_ACCT_NUM1 as RFD_MB_ACCT_NUM,
exp_GET_EFF_DATE.RFD_FO_071 as RFD_FO_07,
exp_GET_EFF_DATE.RFD_FO_461 as RFD_FO_46,
exp_GET_EFF_DATE.RFD_FO_851 as RFD_FO_85,
exp_GET_EFF_DATE.RFD_ROLL_OVER_IND1 as RFD_ROLL_OVER_IND,
exp_GET_EFF_DATE.FEED_IND1 as FEED_IND,
exp_GET_EFF_DATE.ECTL_BATCH_ID1 as ECTL_BATCH_ID,
exp_GET_EFF_DATE.ORIG_INS_TS1 as ECTL_ORIG_INS_TS,
exp_GET_EFF_DATE.ORIG_INS_TS1 as ECTL_MODIFY_TS,
exp_GET_EFF_DATE.ECTL_SRC_ID1 as ECTL_SRC_ID,
exp_GET_EFF_DATE.ECTL_SRC_INST_ID1 as ECTL_SRC_INST_ID,
exp_GET_EFF_DATE.ECTL_PRGM_ID1 as ECTL_PRGM_ID,
exp_GET_EFF_DATE.out_ECTL_TX_CD as ECTL_TX_CD,
exp_GET_EFF_DATE.ECTL_BATCH_START_DATE1 as ECTL_START_DATE,
exp_GET_EFF_DATE.out_ECTL_END_DATE as ECTL_END_DATE
FROM
exp_GET_EFF_DATE;


-- Component upd_FARMPOLS, Type UPDATE 
CREATE OR REPLACE TEMPORARY TABLE upd_FARMPOLS AS
(
/* UPDATE_STRATEGY_ACTION = 0 FOR INSERT / UPDATE_STRATEGY_ACTION = 1 FOR UPDATE / UPDATE_STRATEGY_ACTION = 2 FOR DELETE / UPDATE_STRATEGY_ACTION = 3 FOR REJECT */
SELECT
exp_GET_EXP_DT.SC_POLICY_NUM1 as SC_POLICY_NUM1,
exp_GET_EXP_DT.out_CHG_EXP_DT as CHG_EXP_DT,
exp_GET_EXP_DT.ECTL_BATCH_ID1 as ECTL_BATCH_ID1,
exp_GET_EXP_DT.MODIFY_TS as ORIG_INS_TS1,
exp_GET_EXP_DT.out_ECTL_END_DATE as ECTL_END_DATE,
exp_GET_EXP_DT.out_ECTL_TX_CD as ECTL_TX_CD,
exp_GET_EXP_DT.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp3,
1 as UPDATE_STRATEGY_ACTION
FROM
exp_GET_EXP_DT
);


-- Component FARMPOLS_UPD, Type TARGET 
/* Perform Updates */
MERGE INTO DB_T_core_MEMBXREF_PROD.FARMPOLS
USING upd_FARMPOLS
ON (SC_POLICY_NUM = upd_FARMPOLS.SC_POLICY_NUM1 AND CHG_EFF_DT = upd_FARMPOLS.CHG_EFF_DT_lkp3)
WHEN MATCHED THEN UPDATE SET
ECTL_BATCH_ID = upd_FARMPOLS.ECTL_BATCH_ID1,ECTL_END_DATE =upd_FARMPOLS.ECTL_END_DATE,
--ECTL_MODIFY_TS = upd_FARMPOLS.ECTL_MODIFY_TS,
ECTL_TX_CD = upd_FARMPOLS.ECTL_TX_CD,
CHG_EXP_DT = upd_FARMPOLS.CHG_EXP_DT;



-- PIPELINE END FOR 2

END; ';