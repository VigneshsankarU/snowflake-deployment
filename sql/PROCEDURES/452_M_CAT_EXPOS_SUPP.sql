-- Object Type: PROCEDURES
CREATE OR REPLACE PROCEDURE ALFA_EDW_DEV.PUBLIC.M_CAT_EXPOS_SUPP("RUN_ID" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS ' DECLARE ACT_PROJ_ID varchar;
BATCH_ACTIVE_IND varchar;
PMMAPPINGNAME varchar;
PMCAT_EXPOS_SUPPTABLENAME varchar;
BEGIN 

PMMAPPINGNAME:=''M_CAT_EXPOS_SUPP''; 
PMCAT_EXPOS_SUPPTABLENAME:='' ''; 
BATCH_ACTIVE_IND:=(select ectl_active_ind from DB_T_CTRL_FIN_PROD.ECTL_BATCH_INFO where ECTL_BATCH_ID= :run_id); 
ACT_PROJ_ID:=(select ectl_proj_id from DB_T_CTRL_FIN_PROD.ECTL_BATCH_INFO where ECTL_BATCH_ID= :run_id); 

-- Component SQ_STG_BENFIELD_SUPP_INFO, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_STG_BENFIELD_SUPP_INFO AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as POLICY_NBR,
$2 as INCEPT_DT,
$3 as EXP_DT,
$4 as POLICY_STATUS,
$5 as CMPY_NBR,
$6 as ROOF_YR,
$7 as SQUARE_FTG,
$8 as EQUAKE_ENDRSMN,
$9 as EQUAKE_END_DESC,
$10 as HURR_ENDRSMNT,
$11 as HURR_END_DESC,
$12 as XWIND_ENDRSMNT,
$13 as XWIND_END_DESC,
$14 as LOCATION_DESC,
$15 as FEED_DT,
$16 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT
STG_BENFIELD_SUPP_INFO.POLICY_NBR,
STG_BENFIELD_SUPP_INFO.INCEPT_DT,
STG_BENFIELD_SUPP_INFO.EXP_DT,
STG_BENFIELD_SUPP_INFO.POLICY_STATUS,
STG_BENFIELD_SUPP_INFO.CMPY_NBR,
STG_BENFIELD_SUPP_INFO.ROOF_YR,
STG_BENFIELD_SUPP_INFO.SQUARE_FTG,
STG_BENFIELD_SUPP_INFO.EQUAKE_ENDRSMN,
STG_BENFIELD_SUPP_INFO.EQUAKE_END_DESC,
STG_BENFIELD_SUPP_INFO.HURR_ENDRSMNT,
STG_BENFIELD_SUPP_INFO.HURR_END_DESC,
STG_BENFIELD_SUPP_INFO.XWIND_ENDRSMNT,
STG_BENFIELD_SUPP_INFO.XWIND_END_DESC,
STG_BENFIELD_SUPP_INFO.LOCATION_DESC,
STG_BENFIELD_SUPP_INFO.FEED_DT
FROM DB_T_STAG_PROD.STG_BENFIELD_SUPP_INFO
) SRC
)
);


-- Component EXPTRANS, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE EXPTRANS AS
(
SELECT
TO_CHAR ( SQ_STG_BENFIELD_SUPP_INFO.POLICY_NBR ) as POLICY_NBR,
CASE WHEN TO_NUMBER(SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.EXP_DT , 5 , 2 )) > TO_NUMBER(SUBSTR ( TO_CHAR ( DATE_PART(''YYYY'', TO_TIMESTAMP(CURRENT_TIMESTAMP)) ) , 3 , 2 )) + 10 THEN TO_CHAR ( TO_NUMBER(SUBSTR ( TO_CHAR ( DATE_PART(''YYYY'', TO_TIMESTAMP(CURRENT_TIMESTAMP)) ) , 1 , 2 )) - 1 ) || SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.EXP_DT , 5 , 2 ) ELSE SUBSTR ( TO_CHAR ( DATE_PART(''YYYY'', TO_TIMESTAMP(CURRENT_TIMESTAMP)) ) , 1 , 2 ) || SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.EXP_DT , 5 , 2 ) END as var_EXP_YR,
SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.EXP_DT , 1 , 2 ) as var_EXP_MO,
CASE WHEN TO_NUMBER(SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.EXP_DT , 3 , 2 )) = 0 OR  try_to_DATE ( SQ_STG_BENFIELD_SUPP_INFO.EXP_DT  ) is null THEN ( CASE WHEN TO_NUMBER(var_EXP_MO) in ( TO_NUMBER(var_EXP_MO) , 1 , 3 , 5 , 7 , 8 , 10 , 12 ) THEN 31 ELSE CASE WHEN TO_NUMBER(var_EXP_MO) in ( TO_NUMBER(var_EXP_MO) , 4 , 6 , 9 , 11 ) THEN 30 ELSE CASE WHEN TO_NUMBER(var_EXP_MO) = 2 THEN CASE WHEN MOD ( TO_NUMBER(var_EXP_YR) , 4 ) = 0 THEN 29 ELSE 28 END ELSE $3 END END END ) ELSE TO_NUMBER(SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.EXP_DT , 3 , 2 )) END as var_EXP_DT,
CASE WHEN TO_NUMBER(var_EXP_MO) > 12 or TO_NUMBER(var_EXP_MO) = 0 OR TO_NUMBER(SQ_STG_BENFIELD_SUPP_INFO.EXP_DT) = 0 THEN try_TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE try_TO_DATE ( CONCAT ( var_EXP_YR , CONCAT ( var_EXP_MO , var_EXP_DT ) ) , ''YYYYMMDD'' ) END as EXP_DT,
CASE WHEN TO_NUMBER(SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.INCEPT_DT , 5 , 2 )) > TO_NUMBER(SUBSTR ( TO_CHAR ( DATE_PART(''YYYY'', TO_TIMESTAMP(CURRENT_TIMESTAMP)) ) , 3 , 2 )) THEN TO_CHAR ( TO_NUMBER(SUBSTR ( TO_CHAR ( DATE_PART(''YYYY'', TO_TIMESTAMP(CURRENT_TIMESTAMP)) ) , 1 , 2 )) - 1 ) || SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.INCEPT_DT , 5 , 2 ) ELSE SUBSTR ( TO_CHAR ( DATE_PART(''YYYY'', TO_TIMESTAMP(CURRENT_TIMESTAMP)) ) , 1 , 2 ) || SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.INCEPT_DT , 5 , 2 ) END as var_INCEPT_YR,
CASE WHEN var_INCEPT_YR > var_EXP_YR THEN TO_CHAR ( TO_NUMBER(SUBSTR ( var_INCEPT_YR , 1 , 2 )) - 1 ) || SUBSTR ( var_INCEPT_YR , 3 , 2 ) ELSE var_INCEPT_YR END as var2_INCEPT_YR,
SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.INCEPT_DT , 1 , 2 ) as var_INCEPT_MO,
CASE WHEN TO_NUMBER(SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.INCEPT_DT , 3 , 2 )) = 0 OR  try_to_DATE ( SQ_STG_BENFIELD_SUPP_INFO.INCEPT_DT  ) is null THEN ( CASE WHEN TO_NUMBER(var_INCEPT_MO) in ( TO_NUMBER(var_INCEPT_MO) , 1 , 3 , 5 , 7 , 8 , 10 , 12 ) THEN 31 ELSE CASE WHEN TO_NUMBER(var_INCEPT_MO) in ( TO_NUMBER(var_INCEPT_MO) , 4 , 6 , 9 , 11 ) THEN 30 ELSE CASE WHEN TO_NUMBER(var_INCEPT_MO) = 2 THEN CASE WHEN MOD ( TO_NUMBER(var2_INCEPT_YR) , 4 ) = 0 THEN 29 ELSE 28 END ELSE $3 END END END ) ELSE TO_NUMBER(SUBSTR ( SQ_STG_BENFIELD_SUPP_INFO.INCEPT_DT , 3 , 2 )) END as var_INCEPT_DT,
CASE WHEN TO_NUMBER(var_INCEPT_MO) > 12 or TO_NUMBER(var_INCEPT_MO) = 0 OR TO_NUMBER(SQ_STG_BENFIELD_SUPP_INFO.INCEPT_DT) = 0 THEN try_to_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE try_to_DATE ( CONCAT ( var2_INCEPT_YR , CONCAT ( var_INCEPT_MO , var_INCEPT_DT ) ) , ''YYYYMMDD'' ) END as INCEPT_DT,
TO_CHAR ( SQ_STG_BENFIELD_SUPP_INFO.POLICY_STATUS ) as POLICY_STATUS,
IFNULL(TRY_TO_DECIMAL(SQ_STG_BENFIELD_SUPP_INFO.CMPY_NBR), 0) as CMPY_NBR,
IFNULL(TRY_TO_DECIMAL(SQ_STG_BENFIELD_SUPP_INFO.ROOF_YR), 0) as ROOF_YR,
IFNULL(TRY_TO_DECIMAL(SQ_STG_BENFIELD_SUPP_INFO.SQUARE_FTG), 0) as SQUARE_FTG,
TO_CHAR ( SQ_STG_BENFIELD_SUPP_INFO.EQUAKE_ENDRSMN ) as EQUAKE_ENDRSMNT,
TO_CHAR ( SQ_STG_BENFIELD_SUPP_INFO.EQUAKE_END_DESC ) as EQUAKE_END_DESC,
TO_CHAR ( SQ_STG_BENFIELD_SUPP_INFO.HURR_ENDRSMNT ) as HURR_ENDRSMNT,
TO_CHAR ( SQ_STG_BENFIELD_SUPP_INFO.HURR_END_DESC ) as HURR_END_DESC,
TO_CHAR ( SQ_STG_BENFIELD_SUPP_INFO.XWIND_ENDRSMNT ) as XWIND_ENDRSMNT,
TO_CHAR ( SQ_STG_BENFIELD_SUPP_INFO.XWIND_END_DESC ) as XWIND_END_DESC,
TO_CHAR ( SQ_STG_BENFIELD_SUPP_INFO.LOCATION_DESC ) as LOCATION_DESC,
SQ_STG_BENFIELD_SUPP_INFO.FEED_DT as in_FEED_DT,
SQ_STG_BENFIELD_SUPP_INFO.source_record_id
FROM
SQ_STG_BENFIELD_SUPP_INFO
);


-- Component LKPTRANS, Type LOOKUP 
CREATE OR REPLACE TEMPORARY TABLE LKPTRANS AS
(
SELECT
LKP.POLICY_NBR_lkup,
EXPTRANS.source_record_id,
ROW_NUMBER() OVER(PARTITION BY EXPTRANS.source_record_id ORDER BY LKP.POLICY_NBR_lkup asc,LKP.INCEPT_DT_lkup asc,LKP.EXP_DT_lkup asc,LKP.POLICY_STATUS_lkup asc,LKP.CMPY_NBR_lkup asc,LKP.ROOF_YEAR_lkup asc,LKP.SQUARE_FTG_lkup asc,LKP.EQUAKE_ENDRSMNT_lkup asc,LKP.EQUAKE_END_DESC_lkup asc,LKP.HURR_ENDRSMNT_lkup asc,LKP.HURR_END_DESC_lkup asc,LKP.XWIND_ENDRSMNT_lkup asc,LKP.XWIND_END_DESC_lkup asc,LKP.LOCATION_DESC_lkup asc,LKP.FEED_DT_lkup asc) RNK
FROM
EXPTRANS
LEFT JOIN (
SELECT  CAT_EXPOS_SUPP.POLICY_NBR as POLICY_NBR_lkup, CAT_EXPOS_SUPP.INCEPT_DT as INCEPT_DT_lkup, CAT_EXPOS_SUPP.EXP_DT as EXP_DT_lkup, CAT_EXPOS_SUPP.POLICY_STATUS as POLICY_STATUS_lkup,
CAT_EXPOS_SUPP.CMPY_NBR as CMPY_NBR_lkup, CAT_EXPOS_SUPP.ROOF_YEAR as ROOF_YEAR_lkup, 
CAT_EXPOS_SUPP.SQUARE_FTG as SQUARE_FTG_lkup, CAT_EXPOS_SUPP.EQUAKE_ENDRSMNT as EQUAKE_ENDRSMNT_lkup, 
CAT_EXPOS_SUPP.EQUAKE_END_DESC as EQUAKE_END_DESC_lkup, CAT_EXPOS_SUPP.HURR_ENDRSMNT as HURR_ENDRSMNT_lkup, 
CAT_EXPOS_SUPP.HURR_END_DESC as HURR_END_DESC_lkup, CAT_EXPOS_SUPP.XWIND_ENDRSMNT as XWIND_ENDRSMNT_lkup, 
CAT_EXPOS_SUPP.XWIND_END_DESC as XWIND_END_DESC_lkup, CAT_EXPOS_SUPP.LOCATION_DESC as LOCATION_DESC_lkup, 
CAT_EXPOS_SUPP.FEED_DT as FEED_DT_lkup FROM DB_T_ML_PROD.CAT_EXPOS_SUPP
) LKP ON LKP.POLICY_NBR_lkup = EXPTRANS.POLICY_NBR AND LKP.INCEPT_DT_lkup = EXPTRANS.INCEPT_DT AND LKP.EXP_DT_lkup = EXPTRANS.EXP_DT AND LKP.POLICY_STATUS_lkup = EXPTRANS.POLICY_STATUS AND LKP.CMPY_NBR_lkup = EXPTRANS.CMPY_NBR AND LKP.ROOF_YEAR_lkup = EXPTRANS.ROOF_YR AND LKP.SQUARE_FTG_lkup = EXPTRANS.SQUARE_FTG AND LKP.EQUAKE_ENDRSMNT_lkup = EXPTRANS.EQUAKE_ENDRSMNT AND LKP.EQUAKE_END_DESC_lkup = EXPTRANS.EQUAKE_END_DESC AND LKP.HURR_ENDRSMNT_lkup = EXPTRANS.HURR_ENDRSMNT AND LKP.HURR_END_DESC_lkup = EXPTRANS.HURR_END_DESC AND LKP.XWIND_ENDRSMNT_lkup = EXPTRANS.XWIND_ENDRSMNT AND LKP.XWIND_END_DESC_lkup = EXPTRANS.XWIND_END_DESC AND LKP.LOCATION_DESC_lkup = EXPTRANS.LOCATION_DESC AND LKP.FEED_DT_lkup = EXPTRANS.in_FEED_DT
QUALIFY RNK = 1
);


-- Component EXPTRANS1, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE EXPTRANS1 AS
(
SELECT
EXPTRANS.POLICY_NBR as POLICY_NBR,
EXPTRANS.INCEPT_DT as INCEPT_DT,
EXPTRANS.EXP_DT as EXP_DT,
EXPTRANS.POLICY_STATUS as POLICY_STATUS,
EXPTRANS.CMPY_NBR as CMPY_NBR,
EXPTRANS.ROOF_YR as ROOF_YR,
EXPTRANS.SQUARE_FTG as SQUARE_FTG,
EXPTRANS.EQUAKE_ENDRSMNT as EQUAKE_ENDRSMNT,
EXPTRANS.EQUAKE_END_DESC as EQUAKE_END_DESC,
EXPTRANS.HURR_ENDRSMNT as HURR_ENDRSMNT,
EXPTRANS.HURR_END_DESC as HURR_END_DESC,
EXPTRANS.XWIND_ENDRSMNT as XWIND_ENDRSMNT,
EXPTRANS.XWIND_END_DESC as XWIND_END_DESC,
EXPTRANS.LOCATION_DESC as LOCATION_DESC,
EXPTRANS.in_FEED_DT as in_FEED_DT,
CASE WHEN LKPTRANS.POLICY_NBR_lkup IS NULL THEN ''NEW'' ELSE ''REJ'' END as out_CHK,
EXPTRANS.source_record_id
FROM
EXPTRANS
INNER JOIN LKPTRANS ON EXPTRANS.source_record_id = LKPTRANS.source_record_id
);


-- Component FILTRANS, Type FILTER 
CREATE OR REPLACE TEMPORARY TABLE FILTRANS AS
(
SELECT
EXPTRANS1.POLICY_NBR as POLICY_NBR,
EXPTRANS1.INCEPT_DT as INCEPT_DT,
EXPTRANS1.EXP_DT as EXP_DT,
EXPTRANS1.POLICY_STATUS as POLICY_STATUS,
EXPTRANS1.CMPY_NBR as CMPY_NBR,
EXPTRANS1.ROOF_YR as ROOF_YR,
EXPTRANS1.SQUARE_FTG as SQUARE_FTG,
EXPTRANS1.EQUAKE_ENDRSMNT as EQUAKE_ENDRSMNT,
EXPTRANS1.EQUAKE_END_DESC as EQUAKE_END_DESC,
EXPTRANS1.HURR_ENDRSMNT as HURR_ENDRSMNT,
EXPTRANS1.HURR_END_DESC as HURR_END_DESC,
EXPTRANS1.XWIND_ENDRSMNT as XWIND_ENDRSMNT,
EXPTRANS1.XWIND_END_DESC as XWIND_END_DESC,
EXPTRANS1.LOCATION_DESC as LOCATION_DESC,
EXPTRANS1.in_FEED_DT as in_FEED_DT,
EXPTRANS1.out_CHK as out_CHK,
EXPTRANS1.source_record_id
FROM
EXPTRANS1
WHERE EXPTRANS1.out_CHK = ''NEW''
);


-- Component EXPTRANS2, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE EXPTRANS2 AS
(
SELECT
FILTRANS.POLICY_NBR as POLICY_NBR,
FILTRANS.INCEPT_DT as INCEPT_DT,
FILTRANS.EXP_DT as EXP_DT,
FILTRANS.POLICY_STATUS as POLICY_STATUS,
FILTRANS.CMPY_NBR as CMPY_NBR,
FILTRANS.ROOF_YR as ROOF_YR,
FILTRANS.SQUARE_FTG as SQUARE_FTG,
FILTRANS.EQUAKE_ENDRSMNT as EQUAKE_ENDRSMNT,
FILTRANS.EQUAKE_END_DESC as EQUAKE_END_DESC,
FILTRANS.HURR_ENDRSMNT as HURR_ENDRSMNT,
FILTRANS.HURR_END_DESC as HURR_END_DESC,
FILTRANS.XWIND_ENDRSMNT as XWIND_ENDRSMNT,
FILTRANS.XWIND_END_DESC as XWIND_END_DESC,
FILTRANS.LOCATION_DESC as LOCATION_DESC,
FILTRANS.in_FEED_DT as in_FEED_DT,
:ACT_PROJ_ID as out_ACT_PROJ_ID,
:BATCH_ACTIVE_IND as out_BATCH_ACTIVE_IND,
:PMMappingName as out_PRGM_NM,
:PMCAT_EXPOS_SUPPTableName as out_TABLE_NM,
:ACT_PROJ_ID as IN_ACT_PROJ_ID,
:BATCH_ACTIVE_IND as IN_BATCH_ACTIVE_IND,
''m_STG_FIN_CLM'' IN_PRGM_NM,
null IN_TABLE_NM,
FILTRANS.source_record_id
FROM
FILTRANS
);


-- Component mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, Type MAPPLET 
--MAPPLET NOT REGISTERED: mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, mapplet instance mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE;
call mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE(''EXPTRANS2'');

-- Component EXPTRANS3, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE EXPTRANS3 AS
(
SELECT
EXPTRANS2.POLICY_NBR as POLICY_NBR,
EXPTRANS2.INCEPT_DT as INCEPT_DT,
EXPTRANS2.EXP_DT as EXP_DT,
EXPTRANS2.POLICY_STATUS as POLICY_STATUS,
EXPTRANS2.CMPY_NBR as CMPY_NBR,
EXPTRANS2.ROOF_YR as ROOF_YR,
EXPTRANS2.SQUARE_FTG as SQUARE_FTG,
EXPTRANS2.EQUAKE_ENDRSMNT as EQUAKE_ENDRSMNT,
EXPTRANS2.EQUAKE_END_DESC as EQUAKE_END_DESC,
EXPTRANS2.HURR_ENDRSMNT as HURR_ENDRSMNT,
EXPTRANS2.HURR_END_DESC as HURR_END_DESC,
EXPTRANS2.XWIND_ENDRSMNT as XWIND_ENDRSMNT,
EXPTRANS2.XWIND_END_DESC as XWIND_END_DESC,
EXPTRANS2.LOCATION_DESC as LOCATION_DESC,
EXPTRANS2.in_FEED_DT as in_FEED_DT,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_PRGM_ID as out_ECTL_PRGM_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_ID as out_ECTL_SRC_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_INST_ID as out_ECTL_SRC_INST_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_ID as out_ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ORIG_INS_TS as out_ORIG_INS_TS,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_START_DATE as out_ECTL_BATCH_START_DATE,
''NEW'' as out_ECTL_TX_CD,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as out_ECTL_END_DATE,
EXPTRANS2.source_record_id
FROM
EXPTRANS2
INNER JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE ON EXPTRANS2.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.source_record_id
);


-- Component CAT_EXPOS_SUPP, Type TARGET_EXPORT_PREPARE Stage data before exporting
CREATE OR REPLACE TEMPORARY TABLE CAT_EXPOS_SUPP AS
(
SELECT
EXPTRANS3.POLICY_NBR as POLICY_NBR,
EXPTRANS3.INCEPT_DT as INCEPT_DT,
EXPTRANS3.EXP_DT as EXP_DT,
EXPTRANS3.POLICY_STATUS as POLICY_STATUS,
EXPTRANS3.CMPY_NBR as CMPY_NBR,
EXPTRANS3.ROOF_YR as ROOF_YEAR,
EXPTRANS3.SQUARE_FTG as SQUARE_FTG,
EXPTRANS3.EQUAKE_ENDRSMNT as EQUAKE_ENDRSMNT,
EXPTRANS3.EQUAKE_END_DESC as EQUAKE_END_DESC,
EXPTRANS3.HURR_ENDRSMNT as HURR_ENDRSMNT,
EXPTRANS3.HURR_END_DESC as HURR_END_DESC,
EXPTRANS3.XWIND_ENDRSMNT as XWIND_ENDRSMNT,
EXPTRANS3.XWIND_END_DESC as XWIND_END_DESC,
EXPTRANS3.LOCATION_DESC as LOCATION_DESC,
EXPTRANS3.in_FEED_DT as FEED_DT,
EXPTRANS3.out_ECTL_BATCH_ID as ECTL_BATCH_ID,
EXPTRANS3.out_ORIG_INS_TS as ECTL_ORIG_INS_TS,
EXPTRANS3.out_ECTL_SRC_ID as ECTL_SRC_ID,
EXPTRANS3.out_ECTL_SRC_INST_ID as ECTL_SRC_INST_ID,
EXPTRANS3.out_ECTL_PRGM_ID as ECTL_PRGM_ID,
EXPTRANS3.out_ECTL_TX_CD as ECTL_TX_CD,
EXPTRANS3.out_ECTL_BATCH_START_DATE as ECTL_START_DATE,
EXPTRANS3.out_ECTL_END_DATE as ECTL_END_DATE
FROM
EXPTRANS3
);


-- Component CAT_EXPOS_SUPP, Type EXPORT_DATA Exporting data
;


END; ';