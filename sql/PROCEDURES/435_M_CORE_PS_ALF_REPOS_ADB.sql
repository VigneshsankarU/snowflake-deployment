-- Object Type: PROCEDURES
CREATE OR REPLACE PROCEDURE ALFA_EDW_DEV.PUBLIC.M_CORE_PS_ALF_REPOS_ADB("RUN_ID" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS ' 
DECLARE 
PMMAPPINGNAME varchar;
ACT_PROJ_ID integer;
ECTL_ACTIVE_IND varchar;
PMSHORTCUT_TO_PS_ALF_REPOS_ADB_STABLENAME varchar;

BEGIN 

PMMAPPINGNAME:=''''; 
ACT_PROJ_ID:=1; 
ECTL_ACTIVE_IND:=''''; 
PMSHORTCUT_TO_PS_ALF_REPOS_ADB_STABLENAME:=''''; 


-- Component SQ_Shortcut_to_PS_ALF_REPOS_ADB_S, Type Pre SQL 
DELETE FROM
 DB_T_CORE_FIN_PROD.PS_ALF_REPOS_ADB_S 
WHERE FISCAL_YEAR = (select distinct trim(ectl_param_value) YR  from DB_T_CTRL_PROD.ectl_prgm_param where ectl_param_desc=''ACCOUNTING_YEAR'')
AND ACCOUNTING_PERIOD = (select distinct trim(ectl_param_value) MO  from db_t_ctrl_prod.ectl_prgm_param where ectl_param_desc=''ACCOUNTING_MONTH'');


-- Component SQ_Shortcut_to_PS_ALF_REPOS_ADB_S, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_Shortcut_to_PS_ALF_REPOS_ADB_S AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as BUSINESS_UNIT,
$2 as TRANSACTION_ID,
$3 as DTTM_STAMP,
$4 as ALF_REC_COUNTER,
$5 as LEDGER_GROUP,
$6 as LEDGER,
$7 as JOURNAL_ID,
$8 as JOURNAL_LINE,
$9 as FISCAL_YEAR,
$10 as ACCOUNTING_PERIOD,
$11 as JOURNAL_DATE,
$12 as ACCOUNT_CD,
$13 as DEPTID,
$14 as PRODUCT,
$15 as PROJECT_ID,
$16 as CHARTFIELD1,
$17 as CHARTFIELD2,
$18 as CHARTFIELD3,
$19 as AFFILIATE,
$20 as ALF_TRANS_CODE,
$21 as ALF_POL_PREFIX,
$22 as ALF_POL_NUMBER,
$23 as ALF_AGENT_NO,
$24 as ALF_SERV_CTR_NBR,
$25 as ALF_STATE_CD,
$26 as ALF_COMPANY_CD,
$27 as ALF_BUDGET_SYM,
$28 as ALF_ACCT_NBR,
$29 as ALF_LEGACY_LINE_NO,
$30 as ALF_ACCT_DT,
$31 as APPL_JRNL_ID,
$32 as BUSINESS_UNIT_GL,
$33 as ACCOUNTING_DT,
$34 as GL_DISTRIB_STATUS,
$35 as JRNL_LN_REF,
$36 as JRNL_DESCR,
$37 as CURRENCY_CD,
$38 as STATISTICS_CODE,
$39 as MONETARY_AMOUNT,
$40 as STATISTIC_AMOUNT,
$41 as FOREIGN_AMOUNT,
$42 as FOREIGN_CURRENCY,
$43 as PROCESS_INSTANCE,
$44 as ALF_VTC_PREFIX,
$45 as ALF_VTC_NUMBER,
$46 as ALF_BANK_ID,
$47 as ALF_BANK_ACCT_CD,
$48 as ALF_TAX_ID,
$49 as ALF_REFERENCE,
$50 as ALF_ROW_INDICATOR,
$51 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT PS_ALF_REPOS_ADB_S.BUSINESS_UNIT, PS_ALF_REPOS_ADB_S.TRANSACTION_ID, PS_ALF_REPOS_ADB_S.DTTM_STAMP, PS_ALF_REPOS_ADB_S.ALF_REC_COUNTER, PS_ALF_REPOS_ADB_S.LEDGER_GROUP, PS_ALF_REPOS_ADB_S.LEDGER, PS_ALF_REPOS_ADB_S.JOURNAL_ID, PS_ALF_REPOS_ADB_S.JOURNAL_LINE, PS_ALF_REPOS_ADB_S.FISCAL_YEAR, PS_ALF_REPOS_ADB_S.ACCOUNTING_PERIOD, PS_ALF_REPOS_ADB_S.JOURNAL_DATE, PS_ALF_REPOS_ADB_S.ACCOUNT_CD, PS_ALF_REPOS_ADB_S.DEPTID, PS_ALF_REPOS_ADB_S.PRODUCT, PS_ALF_REPOS_ADB_S.PROJECT_ID, PS_ALF_REPOS_ADB_S.CHARTFIELD1, PS_ALF_REPOS_ADB_S.CHARTFIELD2, PS_ALF_REPOS_ADB_S.CHARTFIELD3, PS_ALF_REPOS_ADB_S.AFFILIATE, PS_ALF_REPOS_ADB_S.ALF_TRANS_CODE, PS_ALF_REPOS_ADB_S.ALF_POL_PREFIX, PS_ALF_REPOS_ADB_S.ALF_POL_NUMBER, PS_ALF_REPOS_ADB_S.ALF_AGENT_NO, PS_ALF_REPOS_ADB_S.ALF_SERV_CTR_NBR, PS_ALF_REPOS_ADB_S.ALF_STATE_CD, PS_ALF_REPOS_ADB_S.ALF_COMPANY_CD, PS_ALF_REPOS_ADB_S.ALF_BUDGET_SYM, PS_ALF_REPOS_ADB_S.ALF_ACCT_NBR, PS_ALF_REPOS_ADB_S.ALF_LEGACY_LINE_NO, PS_ALF_REPOS_ADB_S.ALF_ACCT_DT, PS_ALF_REPOS_ADB_S.APPL_JRNL_ID, PS_ALF_REPOS_ADB_S.BUSINESS_UNIT_GL, PS_ALF_REPOS_ADB_S.ACCOUNTING_DT, PS_ALF_REPOS_ADB_S.GL_DISTRIB_STATUS, PS_ALF_REPOS_ADB_S.JRNL_LN_REF, PS_ALF_REPOS_ADB_S.JRNL_DESCR, PS_ALF_REPOS_ADB_S.CURRENCY_CD, PS_ALF_REPOS_ADB_S.STATISTICS_CODE, PS_ALF_REPOS_ADB_S.MONETARY_AMOUNT, PS_ALF_REPOS_ADB_S.STATISTIC_AMOUNT, PS_ALF_REPOS_ADB_S.FOREIGN_AMOUNT, PS_ALF_REPOS_ADB_S.FOREIGN_CURRENCY, PS_ALF_REPOS_ADB_S.PROCESS_INSTANCE, PS_ALF_REPOS_ADB_S.ALF_VTC_PREFIX, PS_ALF_REPOS_ADB_S.ALF_VTC_NUMBER, PS_ALF_REPOS_ADB_S.ALF_BANK_ID, PS_ALF_REPOS_ADB_S.ALF_BANK_ACCT_CD, PS_ALF_REPOS_ADB_S.ALF_TAX_ID, PS_ALF_REPOS_ADB_S.ALF_REFERENCE, PS_ALF_REPOS_ADB_S.ALF_ROW_INDICATOR 
FROM
 DB_T_CORE_FIN_PROD.PS_ALF_REPOS_ADB_S 
WHERE FISCAL_YEAR = (select distinct trim(ectl_param_value) YR  from DB_T_CTRL_FIN_PROD.ectl_prgm_param where ectl_param_desc=''ACCOUNTING_YEAR'')
AND ACCOUNTING_PERIOD = (select distinct trim(ectl_param_value) MO  from DB_T_CTRL_FIN_PROD.ectl_prgm_param where ectl_param_desc=''ACCOUNTING_MONTH'')
) SRC
)
);


-- Component exp_GET_DATA, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_GET_DATA AS
(
SELECT
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.BUSINESS_UNIT as BUSINESS_UNIT,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.TRANSACTION_ID as TRANSACTION_ID,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.DTTM_STAMP as DTTM_STAMP,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_REC_COUNTER as ALF_REC_COUNTER,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.LEDGER_GROUP as LEDGER_GROUP,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.LEDGER as LEDGER,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.JOURNAL_ID as JOURNAL_ID,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.JOURNAL_LINE as JOURNAL_LINE,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.FISCAL_YEAR as FISCAL_YEAR,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ACCOUNTING_PERIOD as ACCOUNTING_PERIOD,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.JOURNAL_DATE as JOURNAL_DATE,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ACCOUNT_CD as ACCOUNT_CD,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.DEPTID as DEPTID,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.PRODUCT as PRODUCT,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.PROJECT_ID as PROJECT_ID,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.CHARTFIELD1 as CHARTFIELD1,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.CHARTFIELD2 as CHARTFIELD2,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.CHARTFIELD3 as CHARTFIELD3,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.AFFILIATE as AFFILIATE,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_TRANS_CODE as ALF_TRANS_CODE,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_POL_PREFIX as ALF_POL_PREFIX,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_POL_NUMBER as ALF_POL_NUMBER,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_AGENT_NO as ALF_AGENT_NO,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_SERV_CTR_NBR as ALF_SERV_CTR_NBR,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_STATE_CD as ALF_STATE_CD,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_COMPANY_CD as ALF_COMPANY_CD,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_BUDGET_SYM as ALF_BUDGET_SYM,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_ACCT_NBR as ALF_ACCT_NBR,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_LEGACY_LINE_NO as ALF_LEGACY_LINE_NO,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_ACCT_DT as ALF_ACCT_DT,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.APPL_JRNL_ID as APPL_JRNL_ID,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.BUSINESS_UNIT_GL as BUSINESS_UNIT_GL,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ACCOUNTING_DT as ACCOUNTING_DT,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.GL_DISTRIB_STATUS as GL_DISTRIB_STATUS,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.JRNL_LN_REF as JRNL_LN_REF,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.JRNL_DESCR as JRNL_DESCR,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.CURRENCY_CD as CURRENCY_CD,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.STATISTICS_CODE as STATISTICS_CODE,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.MONETARY_AMOUNT as MONETARY_AMOUNT,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.STATISTIC_AMOUNT as STATISTIC_AMOUNT,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.FOREIGN_AMOUNT as FOREIGN_AMOUNT,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.FOREIGN_CURRENCY as FOREIGN_CURRENCY,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.PROCESS_INSTANCE as PROCESS_INSTANCE,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_VTC_PREFIX as ALF_VTC_PREFIX,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_VTC_NUMBER as ALF_VTC_NUMBER,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_BANK_ID as ALF_BANK_ID,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_BANK_ACCT_CD as ALF_BANK_ACCT_CD,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_TAX_ID as ALF_TAX_ID,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_REFERENCE as ALF_REFERENCE,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.ALF_ROW_INDICATOR as ALF_ROW_INDICATOR,
trim(:PMMappingName) as in_PRGM_NM,
:ACT_PROJ_ID as in_ACT_PROJ_ID,
:ECTL_ACTIVE_IND as in_BATCH_ACTIVE_IND,
:PMSHORTCUT_TO_PS_ALF_REPOS_ADB_STABLENAME as in_TABLE_NM,
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S.source_record_id
FROM
SQ_Shortcut_to_PS_ALF_REPOS_ADB_S
);


-- Component mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, Type MAPPLET 
--MAPPLET NOT REGISTERED: mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, mapplet instance mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE;
call mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE(''exp_GET_DATA'');

-- Component exp_EXISTS_IN_TGT, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_EXISTS_IN_TGT AS
(
SELECT
exp_GET_DATA.BUSINESS_UNIT as BUSINESS_UNIT,
exp_GET_DATA.TRANSACTION_ID as TRANSACTION_ID,
exp_GET_DATA.DTTM_STAMP as DTTM_STAMP,
exp_GET_DATA.ALF_REC_COUNTER as ALF_REC_COUNTER,
exp_GET_DATA.LEDGER_GROUP as LEDGER_GROUP,
exp_GET_DATA.LEDGER as LEDGER,
exp_GET_DATA.JOURNAL_ID as JOURNAL_ID,
exp_GET_DATA.JOURNAL_LINE as JOURNAL_LINE,
exp_GET_DATA.FISCAL_YEAR as FISCAL_YEAR,
exp_GET_DATA.ACCOUNTING_PERIOD as ACCOUNTING_PERIOD,
exp_GET_DATA.JOURNAL_DATE as JOURNAL_DATE,
exp_GET_DATA.ACCOUNT_CD as ACCOUNT_CD,
exp_GET_DATA.DEPTID as DEPTID,
exp_GET_DATA.PRODUCT as PRODUCT,
exp_GET_DATA.PROJECT_ID as PROJECT_ID,
exp_GET_DATA.CHARTFIELD1 as CHARTFIELD1,
exp_GET_DATA.CHARTFIELD2 as CHARTFIELD2,
exp_GET_DATA.CHARTFIELD3 as CHARTFIELD3,
exp_GET_DATA.AFFILIATE as AFFILIATE,
exp_GET_DATA.ALF_TRANS_CODE as ALF_TRANS_CODE,
exp_GET_DATA.ALF_POL_PREFIX as ALF_POL_PREFIX,
exp_GET_DATA.ALF_POL_NUMBER as ALF_POL_NUMBER,
exp_GET_DATA.ALF_AGENT_NO as ALF_AGENT_NO,
exp_GET_DATA.ALF_SERV_CTR_NBR as ALF_SERV_CTR_NBR,
exp_GET_DATA.ALF_STATE_CD as ALF_STATE_CD,
exp_GET_DATA.ALF_COMPANY_CD as ALF_COMPANY_CD,
exp_GET_DATA.ALF_BUDGET_SYM as ALF_BUDGET_SYM,
exp_GET_DATA.ALF_ACCT_NBR as ALF_ACCT_NBR,
exp_GET_DATA.ALF_LEGACY_LINE_NO as ALF_LEGACY_LINE_NO,
exp_GET_DATA.ALF_ACCT_DT as ALF_ACCT_DT,
exp_GET_DATA.APPL_JRNL_ID as APPL_JRNL_ID,
exp_GET_DATA.BUSINESS_UNIT_GL as BUSINESS_UNIT_GL,
exp_GET_DATA.ACCOUNTING_DT as ACCOUNTING_DT,
exp_GET_DATA.GL_DISTRIB_STATUS as GL_DISTRIB_STATUS,
exp_GET_DATA.JRNL_LN_REF as JRNL_LN_REF,
exp_GET_DATA.JRNL_DESCR as JRNL_DESCR,
exp_GET_DATA.CURRENCY_CD as CURRENCY_CD,
exp_GET_DATA.STATISTICS_CODE as STATISTICS_CODE,
exp_GET_DATA.MONETARY_AMOUNT as MONETARY_AMOUNT,
exp_GET_DATA.STATISTIC_AMOUNT as STATISTIC_AMOUNT,
exp_GET_DATA.FOREIGN_AMOUNT as FOREIGN_AMOUNT,
exp_GET_DATA.FOREIGN_CURRENCY as FOREIGN_CURRENCY,
exp_GET_DATA.PROCESS_INSTANCE as PROCESS_INSTANCE,
exp_GET_DATA.ALF_VTC_PREFIX as ALF_VTC_PREFIX,
exp_GET_DATA.ALF_VTC_NUMBER as ALF_VTC_NUMBER,
exp_GET_DATA.ALF_BANK_ID as ALF_BANK_ID,
exp_GET_DATA.ALF_BANK_ACCT_CD as ALF_BANK_ACCT_CD,
exp_GET_DATA.ALF_TAX_ID as ALF_TAX_ID,
exp_GET_DATA.ALF_REFERENCE as ALF_REFERENCE,
exp_GET_DATA.ALF_ROW_INDICATOR as ALF_ROW_INDICATOR,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_ID as ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ORIG_INS_TS as ECTL_ORIG_INS_TS,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ORIG_INS_TS as ECTL_MODIFY_TS,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_ID as ECTL_SRC_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_INST_ID as ECTL_SRC_INST_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_PRGM_ID as ECTL_PRGM_ID,
''NEW'' as ECTL_TXN_CD,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_START_DATE as ECTL_START_DATE,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as ECTL_END_DATE,
exp_GET_DATA.source_record_id
FROM
exp_GET_DATA
INNER JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE ON exp_GET_DATA.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.source_record_id
);


-- Component Shortcut_to_CORE_PS_ALF_REPOS_ADB_S, Type TARGET 
INSERT INTO DB_T_CORE_FIN_PROD.PS_ALF_REPOS_ADB_S
(
BUSINESS_UNIT,
TRANSACTION_ID,
DTTM_STAMP,
ALF_REC_COUNTER,
LEDGER_GROUP,
LEDGER,
JOURNAL_ID,
JOURNAL_LINE,
FISCAL_YEAR,
ACCOUNTING_PERIOD,
JOURNAL_DATE,
ACCOUNT_CD,
DEPTID,
PRODUCT,
PROJECT_ID,
CHARTFIELD1,
CHARTFIELD2,
CHARTFIELD3,
AFFILIATE,
ALF_TRANS_CODE,
ALF_POL_PREFIX,
ALF_POL_NUMBER,
ALF_AGENT_NO,
ALF_SERV_CTR_NBR,
ALF_STATE_CD,
ALF_COMPANY_CD,
ALF_BUDGET_SYM,
ALF_ACCT_NBR,
ALF_LEGACY_LINE_NO,
ALF_ACCT_DT,
APPL_JRNL_ID,
BUSINESS_UNIT_GL,
ACCOUNTING_DT,
GL_DISTRIB_STATUS,
JRNL_LN_REF,
JRNL_DESCR,
CURRENCY_CD,
STATISTICS_CODE,
MONETARY_AMOUNT,
STATISTIC_AMOUNT,
FOREIGN_AMOUNT,
FOREIGN_CURRENCY,
PROCESS_INSTANCE,
ALF_VTC_PREFIX,
ALF_VTC_NUMBER,
ALF_BANK_ID,
ALF_BANK_ACCT_CD,
ALF_TAX_ID,
ALF_REFERENCE,
ALF_ROW_INDICATOR,
ECTL_BATCH_ID,
ECTL_ORIG_INS_TS,
ECTL_MODIFY_TS,
ECTL_SRC_ID,
ECTL_SRC_INST_ID,
ECTL_PRGM_ID,
ECTL_TXN_CD,
ECTL_START_DATE,
ECTL_END_DATE
)
SELECT
exp_EXISTS_IN_TGT.BUSINESS_UNIT as BUSINESS_UNIT,
exp_EXISTS_IN_TGT.TRANSACTION_ID as TRANSACTION_ID,
exp_EXISTS_IN_TGT.DTTM_STAMP as DTTM_STAMP,
exp_EXISTS_IN_TGT.ALF_REC_COUNTER as ALF_REC_COUNTER,
exp_EXISTS_IN_TGT.LEDGER_GROUP as LEDGER_GROUP,
exp_EXISTS_IN_TGT.LEDGER as LEDGER,
exp_EXISTS_IN_TGT.JOURNAL_ID as JOURNAL_ID,
exp_EXISTS_IN_TGT.JOURNAL_LINE as JOURNAL_LINE,
exp_EXISTS_IN_TGT.FISCAL_YEAR as FISCAL_YEAR,
exp_EXISTS_IN_TGT.ACCOUNTING_PERIOD as ACCOUNTING_PERIOD,
exp_EXISTS_IN_TGT.JOURNAL_DATE as JOURNAL_DATE,
exp_EXISTS_IN_TGT.ACCOUNT_CD as ACCOUNT_CD,
exp_EXISTS_IN_TGT.DEPTID as DEPTID,
exp_EXISTS_IN_TGT.PRODUCT as PRODUCT,
exp_EXISTS_IN_TGT.PROJECT_ID as PROJECT_ID,
exp_EXISTS_IN_TGT.CHARTFIELD1 as CHARTFIELD1,
exp_EXISTS_IN_TGT.CHARTFIELD2 as CHARTFIELD2,
exp_EXISTS_IN_TGT.CHARTFIELD3 as CHARTFIELD3,
exp_EXISTS_IN_TGT.AFFILIATE as AFFILIATE,
exp_EXISTS_IN_TGT.ALF_TRANS_CODE as ALF_TRANS_CODE,
exp_EXISTS_IN_TGT.ALF_POL_PREFIX as ALF_POL_PREFIX,
exp_EXISTS_IN_TGT.ALF_POL_NUMBER as ALF_POL_NUMBER,
exp_EXISTS_IN_TGT.ALF_AGENT_NO as ALF_AGENT_NO,
exp_EXISTS_IN_TGT.ALF_SERV_CTR_NBR as ALF_SERV_CTR_NBR,
exp_EXISTS_IN_TGT.ALF_STATE_CD as ALF_STATE_CD,
exp_EXISTS_IN_TGT.ALF_COMPANY_CD as ALF_COMPANY_CD,
exp_EXISTS_IN_TGT.ALF_BUDGET_SYM as ALF_BUDGET_SYM,
exp_EXISTS_IN_TGT.ALF_ACCT_NBR as ALF_ACCT_NBR,
exp_EXISTS_IN_TGT.ALF_LEGACY_LINE_NO as ALF_LEGACY_LINE_NO,
exp_EXISTS_IN_TGT.ALF_ACCT_DT as ALF_ACCT_DT,
exp_EXISTS_IN_TGT.APPL_JRNL_ID as APPL_JRNL_ID,
exp_EXISTS_IN_TGT.BUSINESS_UNIT_GL as BUSINESS_UNIT_GL,
exp_EXISTS_IN_TGT.ACCOUNTING_DT as ACCOUNTING_DT,
exp_EXISTS_IN_TGT.GL_DISTRIB_STATUS as GL_DISTRIB_STATUS,
exp_EXISTS_IN_TGT.JRNL_LN_REF as JRNL_LN_REF,
exp_EXISTS_IN_TGT.JRNL_DESCR as JRNL_DESCR,
exp_EXISTS_IN_TGT.CURRENCY_CD as CURRENCY_CD,
exp_EXISTS_IN_TGT.STATISTICS_CODE as STATISTICS_CODE,
exp_EXISTS_IN_TGT.MONETARY_AMOUNT as MONETARY_AMOUNT,
exp_EXISTS_IN_TGT.STATISTIC_AMOUNT as STATISTIC_AMOUNT,
exp_EXISTS_IN_TGT.FOREIGN_AMOUNT as FOREIGN_AMOUNT,
exp_EXISTS_IN_TGT.FOREIGN_CURRENCY as FOREIGN_CURRENCY,
exp_EXISTS_IN_TGT.PROCESS_INSTANCE as PROCESS_INSTANCE,
exp_EXISTS_IN_TGT.ALF_VTC_PREFIX as ALF_VTC_PREFIX,
exp_EXISTS_IN_TGT.ALF_VTC_NUMBER as ALF_VTC_NUMBER,
exp_EXISTS_IN_TGT.ALF_BANK_ID as ALF_BANK_ID,
exp_EXISTS_IN_TGT.ALF_BANK_ACCT_CD as ALF_BANK_ACCT_CD,
exp_EXISTS_IN_TGT.ALF_TAX_ID as ALF_TAX_ID,
exp_EXISTS_IN_TGT.ALF_REFERENCE as ALF_REFERENCE,
exp_EXISTS_IN_TGT.ALF_ROW_INDICATOR as ALF_ROW_INDICATOR,
exp_EXISTS_IN_TGT.ECTL_BATCH_ID as ECTL_BATCH_ID,
exp_EXISTS_IN_TGT.ECTL_ORIG_INS_TS as ECTL_ORIG_INS_TS,
exp_EXISTS_IN_TGT.ECTL_MODIFY_TS as ECTL_MODIFY_TS,
exp_EXISTS_IN_TGT.ECTL_SRC_ID as ECTL_SRC_ID,
exp_EXISTS_IN_TGT.ECTL_SRC_INST_ID as ECTL_SRC_INST_ID,
exp_EXISTS_IN_TGT.ECTL_PRGM_ID as ECTL_PRGM_ID,
exp_EXISTS_IN_TGT.ECTL_TXN_CD as ECTL_TXN_CD,
exp_EXISTS_IN_TGT.ECTL_START_DATE as ECTL_START_DATE,
exp_EXISTS_IN_TGT.ECTL_END_DATE as ECTL_END_DATE
FROM
exp_EXISTS_IN_TGT;


END; ';