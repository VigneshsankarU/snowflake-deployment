-- Object Type: PROCEDURES
CREATE OR REPLACE PROCEDURE ALFA_EDW_DEV.PUBLIC.M_CLMF_CLAIM_CORE_AUTO("RUN_ID" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS ' 
DECLARE 
PMMAPPINGNAME varchar;
ACT_PROJ_ID varchar;
BATCH_ACTIVE_IND varchar;
TABLE_NM varchar;
BEGIN 


-- Component LKP_ECTL_PRGM_PARAM, Type Prerequisite Lookup Object 
CREATE OR REPLACE TEMPORARY TABLE LKP_ECTL_PRGM_PARAM AS
(
SELECT
ECTL_PARAM_VALUE,
ECTL_PARAM_DESC
FROM db_t_ctrl_prod.ECTL_PRGM_PARAM
);


-- Component sq_STG_CLMF_CLM_NO_TRL_AUTO, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE sq_STG_CLMF_CLM_NO_TRL_AUTO AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as OPERATOR_ID,
$2 as COMPANY,
$3 as MRI,
$4 as TRL_COUNT,
$5 as POL_STATE,
$6 as PFX,
$7 as PNO,
$8 as DATE_O_LOSS,
$9 as DATE_O_LOSS_DT,
$10 as SEQNO,
$11 as TRANS_ID,
$12 as DIST,
$13 as ADJSYM,
$14 as FAST_TRAC,
$15 as GLASBRK,
$16 as SUSP,
$17 as SAL_SUB,
$18 as SUIT_CD,
$19 as SLC_CD,
$20 as REPT_DT,
$21 as REPT_DATE,
$22 as ACCTG_DT,
$23 as ACCTG_DATE,
$24 as CAUSE_CD,
$25 as CAUSE_DESC,
$26 as COT_PLN,
$27 as CAT_CD,
$28 as RISK_ID,
$29 as CLOSE_CD,
$30 as CLOSE_DT,
$31 as CLOSE_DATE,
$32 as NO_REO,
$33 as REIN,
$34 as ENC_CD,
$35 as AGTNO,
$36 as SCNO,
$37 as INSD_NM,
$38 as OCC_CD,
$39 as TIME_O_LOSS,
$40 as SUBROGATION_DATE,
$41 as PURG_CLM_FROM_FOLDER,
$42 as RECOVERABLE_LOSS_CD,
$43 as RECOVERABLE_LOSS_AMT,
$44 as PREM_FINANCE,
$45 as HIGH_PERFORM_CODE,
$46 as FIBER_GLASS_CODE,
$47 as INEXPER_DRVR_CODE,
$48 as FINANCIAL_RESPONBILITY_CODE,
$49 as MISC_DISCOUNT,
$50 as HO_DISCOUNT,
$51 as SM_SP_POLICY_IND,
$52 as PREV_AGENT,
$53 as CHANGE_AGT_DT,
$54 as CHANGE_AGT_DATE,
$55 as WC_EFF_YR,
$56 as POL_FOLDER_DATE,
$57 as POL_FOLDER_DT,
$58 as TRANSFERRED_POL_NBR,
$59 as CLUE_CHANGE_MMYY,
$60 as CLUE_REPT_ITEM,
$61 as MISS_FIRE_CLM_IND,
$62 as TIMES_NOT_FOUND,
$63 as TOT_RES_AMT,
$64 as TOT_PAID_AMT,
$65 as AC_VEHICLE_ID_NO,
$66 as AC_DRVERNO,
$67 as AC_DRVERNM,
$68 as AC_ARRP_CHRG_DT,
$69 as AC_ARRP_CHRG_DATE,
$70 as AC_FATAL_CD,
$71 as AC_FLEET_ITEM_NO,
$72 as AC_CARYR,
$73 as AC_MAKE,
$74 as AC_MODEL,
$75 as AC_HPTON,
$76 as AC_VEHICLE_TYPE,
$77 as TERR,
$78 as USEX,
$79 as DC,
$80 as SYM,
$81 as AC_DISC,
$82 as AC_DRLISC,
$83 as AC_DR_DOB,
$84 as AC_DR_DOB_DATE,
$85 as AC_ARRP_CODE,
$86 as AC_CAMPER_BODY,
$87 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT DISTINCT TRIM(STG_CLMF_CLM_NO_TRL_AUTO.OPERATOR_ID) AS OPERATOR_ID,
STG_CLMF_CLM_NO_TRL_AUTO.COMPANY, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.MRI) AS MRI,
STG_CLMF_CLM_NO_TRL_AUTO.TRL_COUNT, 
STG_CLMF_CLM_NO_TRL_AUTO.POL_STATE, 
STG_CLMF_CLM_NO_TRL_AUTO.PFX, 
STG_CLMF_CLM_NO_TRL_AUTO.PNO, 
STG_CLMF_CLM_NO_TRL_AUTO.DATE_O_LOSS, 
STG_CLMF_CLM_NO_TRL_AUTO.DATE_O_LOSS_DT, 
STG_CLMF_CLM_NO_TRL_AUTO.SEQNO, 
STG_CLMF_CLM_NO_TRL_AUTO.TRANS_ID, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.DIST) AS DIST,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.ADJSYM) AS ADJSYM,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.FAST_TRAC) AS FAST_TRAC,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.GLASBRK) AS GLASBRK,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.SUSP) AS SUSP,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.SAL_SUB) AS SAL_SUB,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.SUIT_CD) AS SUIT_CD,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.SLC_CD) AS SLC_CD,
STG_CLMF_CLM_NO_TRL_AUTO.REPT_DT, 
STG_CLMF_CLM_NO_TRL_AUTO.REPT_DATE, 
STG_CLMF_CLM_NO_TRL_AUTO.ACCTG_DT, 
STG_CLMF_CLM_NO_TRL_AUTO.ACCTG_DATE, 
STG_CLMF_CLM_NO_TRL_AUTO.CAUSE_CD, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.CAUSE_DESC) AS CAUSE_DESC,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.COT_PLN) AS COT_PLN,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.CAT_CD) AS CAT_CD,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.RISK_ID) AS RISK_ID,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.CLOSE_CD) AS CLOSE_CD,
STG_CLMF_CLM_NO_TRL_AUTO.CLOSE_DT, 
STG_CLMF_CLM_NO_TRL_AUTO.CLOSE_DATE, 
STG_CLMF_CLM_NO_TRL_AUTO.NO_REO, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.REIN) AS REIN,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.ENC_CD) AS ENC_CD,
STG_CLMF_CLM_NO_TRL_AUTO.AGTNO, 
STG_CLMF_CLM_NO_TRL_AUTO.SCNO, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.INSD_NM)INSD_NM,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.OCC_CD) AS OCC_CD,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.TIME_O_LOSS) AS TIME_O_LOSS,
STG_CLMF_CLM_NO_TRL_AUTO.SUBROGATION_DATE, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.PURG_CLM_FROM_FOLDER) AS PURG_CLM_FROM_FOLDER,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.RECOVERABLE_LOSS_CD) AS RECOVERABLE_LOSS_CD,
STG_CLMF_CLM_NO_TRL_AUTO.RECOVERABLE_LOSS_AMT, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.PREM_FINANCE) AS PREM_FINANCE,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.HIGH_PERFORM_CODE) AS HIGH_PERFORM_CODE,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.FIBER_GLASS_CODE) AS FIBER_GLASS_CODE,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.INEXPER_DRVR_CODE) AS INEXPER_DRVR_CODE,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.FINANCIAL_RESPONBILITY_CODE) AS FINANCIAL_RESPONBILITY_CODE,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.MISC_DISCOUNT) AS MISC_DISCOUNT,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.HO_DISCOUNT) AS HO_DISCOUNT,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.SM_SP_POLICY_IND) AS SM_SP_POLICY_IND,
STG_CLMF_CLM_NO_TRL_AUTO.PREV_AGENT, 
STG_CLMF_CLM_NO_TRL_AUTO.CHANGE_AGT_DT, 
STG_CLMF_CLM_NO_TRL_AUTO.CHANGE_AGT_DATE, 
STG_CLMF_CLM_NO_TRL_AUTO.WC_EFF_YR, 
STG_CLMF_CLM_NO_TRL_AUTO.POL_FOLDER_DATE, 
STG_CLMF_CLM_NO_TRL_AUTO.POL_FOLDER_DT, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.TRANSFERRED_POL_NBR) AS TRANSFERRED_POL_NBR,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.CLUE_CHANGE_MMYY) AS CLUE_CHANGE_MMYY,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.CLUE_REPT_ITEM) AS CLUE_REPT_ITEM,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.MISS_FIRE_CLM_IND) AS MISS_FIRE_CLM_IND,
STG_CLMF_CLM_NO_TRL_AUTO.TIMES_NOT_FOUND, 
STG_CLMF_CLM_NO_TRL_AUTO.TOT_RES_AMT, 
STG_CLMF_CLM_NO_TRL_AUTO.TOT_PAID_AMT, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.AC_VEHICLE_ID_NO) AS AC_VEHICLE_ID_NO,
STG_CLMF_CLM_NO_TRL_AUTO.AC_DRVERNO, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.AC_DRVERNM) AS AC_DRVERNM,
STG_CLMF_CLM_NO_TRL_AUTO.AC_ARRP_CHRG_DT, 
STG_CLMF_CLM_NO_TRL_AUTO.AC_ARRP_CHRG_DATE, 
STG_CLMF_CLM_NO_TRL_AUTO.AC_FATAL_CD, 
STG_CLMF_CLM_NO_TRL_AUTO.AC_FLEET_ITEM_NO, 
STG_CLMF_CLM_NO_TRL_AUTO.AC_CARYR, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.AC_MAKE) AS AC_MAKE,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.AC_MODEL) AS AC_MODEL,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.AC_HPTON) AS AC_HPTON,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.AC_VEHICLE_TYPE) AS AC_VEHICLE_TYPE,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.TERR) AS TERR,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.USEX) AS USEX,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.DC) AS DC,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.SYM) AS SYM,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.AC_DISC) AS AC_DISC,
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.AC_DRLISC) AS AC_DRLISC,
STG_CLMF_CLM_NO_TRL_AUTO.AC_DR_DOB, 
STG_CLMF_CLM_NO_TRL_AUTO.AC_DR_DOB_DATE, 
TRIM(STG_CLMF_CLM_NO_TRL_AUTO.AC_ARRP_CODE) AS AC_ARRP_CODE,
STG_CLMF_CLM_NO_TRL_AUTO.AC_CAMPER_BODY  
FROM
 DB_T_STAG_PROD.STG_CLMF_CLM_NO_TRL_AUTO 
 
 UNION 
 SELECT DISTINCT TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.OPERATOR_ID) AS OPERATOR_ID,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.COMPANY, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.MRI) AS MRI,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.TRL_COUNT, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.POL_STATE, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.PFX, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.PNO, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.DATE_O_LOSS, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.DATE_O_LOSS_DATE, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.SEQNO, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.TRANS_ID, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.DIST) AS DIST,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.ADJSYM) AS ADJSYM,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.FAST_TRAC) AS FAST_TRAC,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.GLASBRK) AS GLASBRK,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.SUSP) AS SUSP,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.SAL_SUB) AS SAL_SUB,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.SUIT_CD) AS SUIT_CD,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.SLC_CD) AS SLC_CD,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.REPT_DT, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.REPT_DATE, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.ACCTG_DT, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.ACCTG_DATE, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.CAUSE_CD, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.CAUSE_DESC) AS CAUSE_DESC,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.COT_PLN) AS COT_PLN,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.CAT_CD) AS CAT_CD,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.RISK_ID) AS RISK_ID,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.CLOSE_CD) AS CLOSE_CD,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.CLOSE_DT, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.CLOSE_DATE, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.NO_REO, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.REIN) AS REIN,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.ENC_CD) AS ENC_CD,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AGTNO, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.SCNO, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.INSD_NM)INSD_NM,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.OCC_CD) AS OCC_CD,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.TIME_O_LOSS) AS TIME_O_LOSS,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.SUBROGATION_DATE, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.PURG_CLM_FROM_FOLDER) AS PURG_CLM_FROM_FOLDER,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.RECOVERABLE_LOSS_CD) AS RECOVERABLE_LOSS_CD,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.RECOVERABLE_LOSS_AMT, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.PREM_FINANCE) AS PREM_FINANCE,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.HIGH_PERFORM_CODE) AS HIGH_PERFORM_CODE,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.FIBER_GLASS_CODE) AS FIBER_GLASS_CODE,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.INEXPER_DRVR_CODE) AS INEXPER_DRVR_CODE,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.FINANCIAL_RESPONBILITY_CODE) AS FINANCIAL_RESPONBILITY_CODE,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.MISC_DISCOUNT) AS MISC_DISCOUNT,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.HO_DISCOUNT) AS HO_DISCOUNT,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.SM_SP_POLICY_IND) AS SM_SP_POLICY_IND,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.PREV_AGENT, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.CHANGE_AGT_DT, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.CHANGE_AGT_DATE, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.WC_EFF_YR, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.POL_FOLDER_DATE, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.POL_FOLDER_DT, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.TRANSFERRED_POL_NBR) AS TRANSFERRED_POL_NBR,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.CLUE_CHANGE_MMYY) AS CLUE_CHANGE_MMYY,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.CLUE_REPT_ITEM) AS CLUE_REPT_ITEM,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.MISS_FIRE_CLM_IND) AS MISS_FIRE_CLM_IND,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.TIMES_NOT_FOUND, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.TOT_RES_AMT, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.TOT_PAID_AMT, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_VEHICLE_ID_NO) AS AC_VEHICLE_ID_NO,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_DRVERNO, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_DRVERNM) AS AC_DRVERNM,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_ARRP_CHRG_DT, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_ARRP_CHRG_DATE, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_FATAL_CD, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_FLEET_ITEM_NO, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_CARYR, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_MAKE) AS AC_MAKE,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_MODEL) AS AC_MODEL,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_HPTON) AS AC_HPTON,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_VEHICLE_TYPE) AS AC_VEHICLE_TYPE,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.TERR) AS TERR,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.USEX) AS USEX,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.DC) AS DC,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.SYM) AS SYM,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_DISC) AS AC_DISC,
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_DRLISC) AS AC_DRLISC,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_DR_DOB, 
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_DR_DOB_DATE, 
TRIM(STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_ARRP_CODE) AS AC_ARRP_CODE,
STG_CLMF_CLM_LOSS_RESERVE_AUTO.AC_CAMPER_BODY  
FROM
 DB_T_STAG_PROD.STG_CLMF_CLM_LOSS_RESERVE_AUTO
 UNION 
  SELECT DISTINCT TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.OPERATOR_ID) AS OPERATOR_ID,
STG_CLMF_CLM_SURVEY_LTR_AUTO.COMPANY, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.MRI) AS MRI,
STG_CLMF_CLM_SURVEY_LTR_AUTO.TRL_COUNT, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.POL_STATE, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.PFX, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.PNO, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.DATE_O_LOSS, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.DATE_O_LOSS_DATE, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.SEQNO, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.TRANS_ID, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.DIST)  AS DIST,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.ADJSYM) AS ADJSYM,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.FAST_TRAC) AS FAST_TRAC,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.GLASBRK) AS GLASBRK,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.SUSP) AS SUSP,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.SAL_SUB) AS SAL_SUB,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.SUIT_CD) AS SUIT_CD,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.SLC_CD) AS SLC_CD,
STG_CLMF_CLM_SURVEY_LTR_AUTO.REPT_DT, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.REPT_DATE, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.ACCTG_DT, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.ACCTG_DATE, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.CAUSE_CD, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.CAUSE_DESC) AS CAUSE_DESC,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.COT_PLN) AS COT_PLN,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.CAT_CD) AS CAT_CD,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.RISK_ID) AS RISK_ID,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.CLOSE_CD) AS CLOSE_CD,
STG_CLMF_CLM_SURVEY_LTR_AUTO.CLOSE_DT, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.CLOSE_DATE, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.NO_REO, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.REIN) AS REIN,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.ENC_CD) AS ENC_CD,
STG_CLMF_CLM_SURVEY_LTR_AUTO.AGTNO, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.SCNO, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.INSD_NM)INSD_NM,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.OCC_CD) AS OCC_CD,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.TIME_O_LOSS) AS TIME_O_LOSS,
STG_CLMF_CLM_SURVEY_LTR_AUTO.SUBROGATION_DATE, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.PURG_CLM_FROM_FOLDER) AS PURG_CLM_FROM_FOLDER,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.RECOVERABLE_LOSS_CD) AS RECOVERABLE_LOSS_CD,
STG_CLMF_CLM_SURVEY_LTR_AUTO.RECOVERABLE_LOSS_AMT, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.PREM_FINANCE) AS PREM_FINANCE,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.HIGH_PERFORM_CODE) AS HIGH_PERFORM_CODE,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.FIBER_GLASS_CODE) AS FIBER_GLASS_CODE,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.INEXPER_DRVR_CODE) AS INEXPER_DRVR_CODE,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.FINANCIAL_RESPONBILITY_CODE) AS FINANCIAL_RESPONBILITY_CODE,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.MISC_DISCOUNT) AS MISC_DISCOUNT,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.HO_DISCOUNT) AS HO_DISCOUNT,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.SM_SP_POLICY_IND) AS SM_SP_POLICY_IND,
STG_CLMF_CLM_SURVEY_LTR_AUTO.PREV_AGENT, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.CHANGE_AGT_DT, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.CHANGE_AGT_DATE, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.WC_EFF_YR, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.POL_FOLDER_DATE, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.POL_FOLDER_DT, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.TRANSFERRED_POL_NBR) AS TRANSFERRED_POL_NBR,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.CLUE_CHANGE_MMYY) AS CLUE_CHANGE_MMYY,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.CLUE_REPT_ITEM) AS CLUE_REPT_ITEM,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.MISS_FIRE_CLM_IND) AS MISS_FIRE_CLM_IND,
STG_CLMF_CLM_SURVEY_LTR_AUTO.TIMES_NOT_FOUND, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.TOT_RES_AMT, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.TOT_PAID_AMT, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_VEHICLE_ID_NO) AS AC_VEHICLE_ID_NO,
STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_DRVERNO, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_DRVERNM) AS AC_DRVERNM,
STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_ARRP_CHRG_DT, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_ARRP_CHRG_DATE, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_FATAL_CD, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_FLEET_ITEM_NO, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_CARYR, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_MAKE) AS AC_MAKE,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_MODEL) AS AC_MODEL,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_HPTON) AS AC_HPTON,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_VEHICLE_TYPE) AS AC_VEHICLE_TYPE,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.TERR) AS TERR,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.USEX) AS USEX,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.DC) AS DC,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.SYM) AS SYM,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_DISC) AS AC_DISC,
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_DRLISC) AS AC_DRLISC,
STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_DR_DOB, 
STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_DR_DOB_DATE, 
TRIM(STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_ARRP_CODE) AS AC_ARRP_CODE,
STG_CLMF_CLM_SURVEY_LTR_AUTO.AC_CAMPER_BODY  
FROM
 DB_T_STAG_PROD.STG_CLMF_CLM_SURVEY_LTR_AUTO
) SRC
)
);


-- Component exp_HOLD_DATA, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_HOLD_DATA AS
(
SELECT
sq_STG_CLMF_CLM_NO_TRL_AUTO.OPERATOR_ID as OPERATOR_ID,
sq_STG_CLMF_CLM_NO_TRL_AUTO.COMPANY as COMPANY,
sq_STG_CLMF_CLM_NO_TRL_AUTO.MRI as MRI,
sq_STG_CLMF_CLM_NO_TRL_AUTO.TRL_COUNT as TRL_COUNT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.POL_STATE as POL_STATE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.PFX as PFX,
sq_STG_CLMF_CLM_NO_TRL_AUTO.PNO as PNO,
sq_STG_CLMF_CLM_NO_TRL_AUTO.DATE_O_LOSS as DATE_O_LOSS,
sq_STG_CLMF_CLM_NO_TRL_AUTO.DATE_O_LOSS_DT as DATE_O_LOSS_DT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.SEQNO as SEQNO,
sq_STG_CLMF_CLM_NO_TRL_AUTO.TRANS_ID as TRANS_ID,
sq_STG_CLMF_CLM_NO_TRL_AUTO.DIST as DIST,
sq_STG_CLMF_CLM_NO_TRL_AUTO.ADJSYM as ADJSYM,
sq_STG_CLMF_CLM_NO_TRL_AUTO.FAST_TRAC as FAST_TRAC,
sq_STG_CLMF_CLM_NO_TRL_AUTO.GLASBRK as GLASBRK,
sq_STG_CLMF_CLM_NO_TRL_AUTO.SUSP as SUSP,
DECODE ( sq_STG_CLMF_CLM_NO_TRL_AUTO.SAL_SUB , ''1'' , ''Y'' , ''3'' , ''Y'' , ''2'' , ''N'' , ''V'' , ''N/A'' , ''N'' ) as out_SAL,
DECODE ( sq_STG_CLMF_CLM_NO_TRL_AUTO.SAL_SUB , ''1'' , ''N'' , ''3'' , ''N'' , ''2'' , ''Y'' , ''V'' , ''N/A'' , ''N'' ) as out_SUB,
sq_STG_CLMF_CLM_NO_TRL_AUTO.SUIT_CD as SUIT_CD,
sq_STG_CLMF_CLM_NO_TRL_AUTO.SLC_CD as SLC_CD,
sq_STG_CLMF_CLM_NO_TRL_AUTO.REPT_DT as REPT_DT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.REPT_DATE as REPT_DATE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.ACCTG_DT as ACCTG_DT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.ACCTG_DATE as ACCTG_DATE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CAUSE_CD as CAUSE_CD,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CAUSE_DESC as CAUSE_DESC,
sq_STG_CLMF_CLM_NO_TRL_AUTO.COT_PLN as COT_PLN,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CAT_CD as CAT_CD,
sq_STG_CLMF_CLM_NO_TRL_AUTO.RISK_ID as RISK_ID,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CLOSE_CD as CLOSE_CD,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CLOSE_DT as CLOSE_DT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CLOSE_DATE as CLOSE_DATE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.NO_REO as NO_REO,
sq_STG_CLMF_CLM_NO_TRL_AUTO.REIN as REIN,
sq_STG_CLMF_CLM_NO_TRL_AUTO.ENC_CD as ENC_CD,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AGTNO as AGTNO,
sq_STG_CLMF_CLM_NO_TRL_AUTO.SCNO as SCNO,
sq_STG_CLMF_CLM_NO_TRL_AUTO.INSD_NM as INSD_NM,
sq_STG_CLMF_CLM_NO_TRL_AUTO.OCC_CD as OCC_CD,
sq_STG_CLMF_CLM_NO_TRL_AUTO.TIME_O_LOSS as TIME_O_LOSS,
sq_STG_CLMF_CLM_NO_TRL_AUTO.SUBROGATION_DATE as SUBROGATION_DATE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.PURG_CLM_FROM_FOLDER as PURG_CLM_FROM_FOLDER,
sq_STG_CLMF_CLM_NO_TRL_AUTO.RECOVERABLE_LOSS_CD as RECOVERABLE_LOSS_CD,
sq_STG_CLMF_CLM_NO_TRL_AUTO.RECOVERABLE_LOSS_AMT as RECOVERABLE_LOSS_AMT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.PREM_FINANCE as PREM_FINANCE,
DECODE ( sq_STG_CLMF_CLM_NO_TRL_AUTO.PREM_FINANCE , ''M'' , ''Y'' , ''N'' ) as MONTHLY_BILLING,
sq_STG_CLMF_CLM_NO_TRL_AUTO.HIGH_PERFORM_CODE as HIGH_PERFORM_CODE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.FIBER_GLASS_CODE as FIBER_GLASS_CODE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.INEXPER_DRVR_CODE as INEXPER_DRVR_CODE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.FINANCIAL_RESPONBILITY_CODE as FINANCIAL_RESPONBILITY_CODE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.MISC_DISCOUNT as MISC_DISCOUNT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.HO_DISCOUNT as HO_DISCOUNT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.SM_SP_POLICY_IND as SM_SP_POLICY_IND,
sq_STG_CLMF_CLM_NO_TRL_AUTO.PREV_AGENT as PREV_AGENT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CHANGE_AGT_DT as CHANGE_AGT_DT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CHANGE_AGT_DATE as CHANGE_AGT_DATE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.WC_EFF_YR as WC_EFF_YR,
sq_STG_CLMF_CLM_NO_TRL_AUTO.POL_FOLDER_DATE as POL_FOLDER_DATE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.POL_FOLDER_DT as POL_FOLDER_DT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.TRANSFERRED_POL_NBR as TRANSFERRED_POL_NBR,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CLUE_CHANGE_MMYY as CLUE_CHANGE_MMYY,
sq_STG_CLMF_CLM_NO_TRL_AUTO.CLUE_REPT_ITEM as CLUE_REPT_ITEM,
sq_STG_CLMF_CLM_NO_TRL_AUTO.MISS_FIRE_CLM_IND as MISS_FIRE_CLM_IND,
sq_STG_CLMF_CLM_NO_TRL_AUTO.TIMES_NOT_FOUND as TIMES_NOT_FOUND,
sq_STG_CLMF_CLM_NO_TRL_AUTO.TOT_RES_AMT as TOT_RES_AMT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.TOT_PAID_AMT as TOT_PAID_AMT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_VEHICLE_ID_NO as AC_VEHICLE_ID_NO,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_DRVERNO as AC_DRVERNO,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_DRVERNM as AC_DRVERNM,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_ARRP_CHRG_DT as AC_ARRP_CHRG_DT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_ARRP_CHRG_DATE as AC_ARRP_CHRG_DATE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_FATAL_CD as AC_FATAL_CD,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_FLEET_ITEM_NO as AC_FLEET_ITEM_NO,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_CARYR as AC_CARYR,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_MAKE as AC_MAKE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_MODEL as AC_MODEL,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_HPTON as AC_HPTON,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_VEHICLE_TYPE as AC_VEHICLE_TYPE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.TERR as TERR,
sq_STG_CLMF_CLM_NO_TRL_AUTO.USEX as USEX,
sq_STG_CLMF_CLM_NO_TRL_AUTO.DC as DC,
sq_STG_CLMF_CLM_NO_TRL_AUTO.SYM as SYM,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_DISC as AC_DISC,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_DRLISC as AC_DRLISC,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_DR_DOB as AC_DR_DOB,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_DR_DOB_DATE as AC_DR_DOB_DATE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_ARRP_CODE as AC_ARRP_CODE,
sq_STG_CLMF_CLM_NO_TRL_AUTO.AC_CAMPER_BODY as AC_CAMPER_BODY,
LKP_1.ECTL_PARAM_VALUE /* replaced lookup LKP_ECTL_PRGM_PARAM */ as var_CHG_EFF_DT,
TO_DATE ( var_CHG_EFF_DT , ''YYYY-MM-DD'' ) as out_CHG_EFF_DT,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as out_CHG_EXP_DT,
sq_STG_CLMF_CLM_NO_TRL_AUTO.source_record_id,
row_number() over (partition by sq_STG_CLMF_CLM_NO_TRL_AUTO.source_record_id order by sq_STG_CLMF_CLM_NO_TRL_AUTO.source_record_id) as RNK
FROM
sq_STG_CLMF_CLM_NO_TRL_AUTO
LEFT JOIN LKP_ECTL_PRGM_PARAM LKP_1 ON LKP_1.ECTL_PARAM_DESC = ''CLAIM MASTER FEED DATE''
QUALIFY RNK = 1
);


-- Component LKP_CLMF_CLAIM_CORE, Type LOOKUP 
CREATE OR REPLACE TEMPORARY TABLE LKP_CLMF_CLAIM_CORE AS
(
SELECT
LKP.CLAIM_SKEY,
LKP.OPERATOR_ID,
LKP.CMPY_CD,
LKP.REC_TYPE,
LKP.TRL_CNT,
LKP.CHG_EFF_DT,
LKP.TRANS_ID,
LKP.DIST_CD,
LKP.ADJ_SYM,
LKP.FAST_TRAC_IND,
LKP.GLASSBREAK_IND,
LKP.SUSP_IND,
LKP.SAL_IND,
LKP.SUBR_IND,
LKP.SUIT_CD,
LKP.SURVY_LTR_CD,
LKP.REPORTED_DT,
LKP.REPORTED_DATE,
LKP.ACCTG_DT,
LKP.ACCTG_DATE,
LKP.CAUSE_CD,
LKP.CAUSE_DESC,
LKP.COT_PLN,
LKP.CAT_CD,
LKP.RISK_ID,
LKP.CLOSE_CD,
LKP.CLOSE_DT,
LKP.CLOSE_DATE,
LKP.REOPEN_CNT,
LKP.REINSURANCE_CD,
LKP.ENCUMBRANCE_CD,
LKP.AGNT_NBR,
LKP.SVC_NBR,
LKP.INSD_NM,
LKP.OCP_CD,
LKP.TIME_OF_LOSS,
LKP.SUBROGATION_DATE,
LKP.PURG_CLM_FROM_FOLDER,
LKP.RECOV_LOSS_CD,
LKP.RECOV_LOSS_AMT,
LKP.PREM_FINANCE_IND,
LKP.MONTHLY_BILLING_IND,
LKP.HIGH_PERFORM_CD,
LKP.FIBER_GLASS_CD,
LKP.INEXPER_DRVR_CD,
LKP.FIN_RES_CD,
LKP.MISC_DISC,
LKP.HO_DISC,
LKP.SM_SP_PLCY_IND,
LKP.PREV_AGNT,
LKP.CHANGE_AGT_DT,
LKP.CHANGE_AGT_DATE,
LKP.WC_EFF_YR,
LKP.PLCY_FOLDER_DT,
LKP.PLCY_FOLDER_DATE,
LKP.TRANSFERRED_PLCY_NBR,
LKP.CLUE_CHANGE_MMYY,
LKP.CLUE_REPT_ITEM,
LKP.MISS_FIRE_CLM_IND,
LKP.TIMES_NOT_FOUND,
LKP.TOT_RES_AMT,
LKP.TOT_PAID_AMT,
LKP.VEH_ID_NBR,
LKP.DRV_NBR,
LKP.DRV_NM,
LKP.ARRP_CHRG_DT,
LKP.ARRP_CHRG_DATE,
LKP.FATAL_CD,
LKP.FLEET_ITEM_NBR,
LKP.CAR_YR,
LKP.MAKE,
LKP.MODEL,
LKP.HPTON,
LKP.VEH_TYPE,
LKP.TERRITORY,
LKP.USER_CLASS_CD,
LKP.DRV_CLASS_CD,
LKP.COST_SYM_CD,
LKP.AUTO_DISC,
LKP.DRV_LIC_NBR,
LKP.DRV_DOB_DT,
LKP.DRV_DOB_DATE,
LKP.ARRP_CD,
LKP.CAMPER_BODY_CD,
exp_HOLD_DATA.source_record_id,
ROW_NUMBER() OVER(PARTITION BY exp_HOLD_DATA.source_record_id ORDER BY LKP.CLAIM_SKEY asc,LKP.OPERATOR_ID asc,LKP.CMPY_CD asc,LKP.REC_TYPE asc,LKP.TRL_CNT asc,LKP.PLCY_ST asc,LKP.PLCY_PREFIX asc,LKP.PLCY_NBR asc,LKP.LOSS_DT asc,LKP.LOSS_DATE asc,LKP.SEQ_NBR asc,LKP.CHG_EFF_DT asc,
/*LKP.CHG_EXP_DT asc,*/
LKP.TRANS_ID asc,LKP.DIST_CD asc,LKP.ADJ_SYM asc,LKP.FAST_TRAC_IND asc,LKP.GLASSBREAK_IND asc,LKP.SUSP_IND asc,LKP.SAL_IND asc,
LKP.SUBR_IND asc,LKP.SUIT_CD asc,LKP.SURVY_LTR_CD asc,LKP.REPORTED_DT asc,LKP.REPORTED_DATE asc,LKP.ACCTG_DT asc,LKP.ACCTG_DATE asc,
LKP.CAUSE_CD asc,LKP.CAUSE_DESC asc,LKP.COT_PLN asc,LKP.CAT_CD asc,LKP.RISK_ID asc,LKP.CLOSE_CD asc,LKP.CLOSE_DT asc,LKP.CLOSE_DATE asc,
LKP.REOPEN_CNT asc,LKP.REINSURANCE_CD asc,LKP.ENCUMBRANCE_CD asc,LKP.AGNT_NBR asc,LKP.SVC_NBR asc,LKP.INSD_NM asc,LKP.OCP_CD asc,
LKP.TIME_OF_LOSS asc,LKP.SUBROGATION_DATE asc,LKP.PURG_CLM_FROM_FOLDER asc,LKP.RECOV_LOSS_CD asc,LKP.RECOV_LOSS_AMT asc,
LKP.PREM_FINANCE_IND asc,LKP.MONTHLY_BILLING_IND asc,LKP.HIGH_PERFORM_CD asc,LKP.FIBER_GLASS_CD asc,LKP.INEXPER_DRVR_CD asc,
LKP.FIN_RES_CD asc,LKP.MISC_DISC asc,LKP.HO_DISC asc,LKP.SM_SP_PLCY_IND asc,LKP.PREV_AGNT asc,LKP.CHANGE_AGT_DT asc,
LKP.CHANGE_AGT_DATE asc,LKP.WC_EFF_YR asc,LKP.PLCY_FOLDER_DT asc,LKP.PLCY_FOLDER_DATE asc,LKP.TRANSFERRED_PLCY_NBR asc,
LKP.CLUE_CHANGE_MMYY asc,LKP.CLUE_REPT_ITEM asc,LKP.MISS_FIRE_CLM_IND asc,LKP.TIMES_NOT_FOUND asc,LKP.TOT_RES_AMT asc,
LKP.TOT_PAID_AMT asc,LKP.VEH_ID_NBR asc,LKP.DRV_NBR asc,LKP.DRV_NM asc,LKP.ARRP_CHRG_DT asc,LKP.ARRP_CHRG_DATE asc,
LKP.FATAL_CD asc,LKP.FLEET_ITEM_NBR asc,LKP.CAR_YR asc,LKP.MAKE asc,LKP.MODEL asc,LKP.HPTON asc,LKP.VEH_TYPE asc,
LKP.TERRITORY asc,LKP.USER_CLASS_CD asc,LKP.DRV_CLASS_CD asc,LKP.COST_SYM_CD asc,LKP.AUTO_DISC asc,LKP.DRV_LIC_NBR asc,
LKP.DRV_DOB_DT asc,LKP.DRV_DOB_DATE asc,LKP.ARRP_CD asc,LKP.CAMPER_BODY_CD asc) RNK
FROM
exp_HOLD_DATA
LEFT JOIN (
SELECT DISTINCT CLMF_CLAIM_CORE.CLAIM_SKEY as CLAIM_SKEY, CLMF_CLAIM_CORE.OPERATOR_ID as OPERATOR_ID, CLMF_CLAIM_CORE.CMPY_CD as CMPY_CD, CLMF_CLAIM_CORE.REC_TYPE as REC_TYPE, 
CLMF_CLAIM_CORE.TRL_CNT as TRL_CNT, CLMF_CLAIM_CORE.LOSS_DATE as LOSS_DATE, CLMF_CLAIM_CORE.CHG_EFF_DT as CHG_EFF_DT, 
CLMF_CLAIM_CORE.TRANS_ID as TRANS_ID, CLMF_CLAIM_CORE.DIST_CD as DIST_CD, CLMF_CLAIM_CORE.ADJ_SYM as ADJ_SYM,
 CLMF_CLAIM_CORE.FAST_TRAC_IND as FAST_TRAC_IND, CLMF_CLAIM_CORE.GLASSBREAK_IND as GLASSBREAK_IND, 
 CLMF_CLAIM_CORE.SUSP_IND as SUSP_IND, CLMF_CLAIM_CORE.SAL_IND as SAL_IND, CLMF_CLAIM_CORE.SUBR_IND as SUBR_IND, 
 CLMF_CLAIM_CORE.SUIT_CD as SUIT_CD, CLMF_CLAIM_CORE.SURVY_LTR_CD as SURVY_LTR_CD, CLMF_CLAIM_CORE.REPORTED_DT as REPORTED_DT, CLMF_CLAIM_CORE.REPORTED_DATE as REPORTED_DATE, CLMF_CLAIM_CORE.ACCTG_DT as ACCTG_DT, CLMF_CLAIM_CORE.ACCTG_DATE as ACCTG_DATE, CLMF_CLAIM_CORE.CAUSE_CD as CAUSE_CD, CLMF_CLAIM_CORE.CAUSE_DESC as CAUSE_DESC, CLMF_CLAIM_CORE.COT_PLN as COT_PLN, CLMF_CLAIM_CORE.CAT_CD as CAT_CD, CLMF_CLAIM_CORE.RISK_ID as RISK_ID, CLMF_CLAIM_CORE.CLOSE_CD as CLOSE_CD, CLMF_CLAIM_CORE.CLOSE_DT as CLOSE_DT, CLMF_CLAIM_CORE.CLOSE_DATE as CLOSE_DATE, CLMF_CLAIM_CORE.REOPEN_CNT as REOPEN_CNT, CLMF_CLAIM_CORE.REINSURANCE_CD as REINSURANCE_CD, CLMF_CLAIM_CORE.ENCUMBRANCE_CD as ENCUMBRANCE_CD, CLMF_CLAIM_CORE.AGNT_NBR as AGNT_NBR, CLMF_CLAIM_CORE.SVC_NBR as SVC_NBR, CLMF_CLAIM_CORE.INSD_NM as INSD_NM, CLMF_CLAIM_CORE.OCP_CD as OCP_CD, CLMF_CLAIM_CORE.TIME_OF_LOSS as TIME_OF_LOSS, CLMF_CLAIM_CORE.SUBROGATION_DATE as SUBROGATION_DATE, CLMF_CLAIM_CORE.PURG_CLM_FROM_FOLDER as PURG_CLM_FROM_FOLDER, CLMF_CLAIM_CORE.RECOV_LOSS_CD as RECOV_LOSS_CD, CLMF_CLAIM_CORE.RECOV_LOSS_AMT as RECOV_LOSS_AMT, CLMF_CLAIM_CORE.PREM_FINANCE_IND as PREM_FINANCE_IND, CLMF_CLAIM_CORE.MONTHLY_BILLING_IND as MONTHLY_BILLING_IND, CLMF_CLAIM_CORE.HIGH_PERFORM_CD as HIGH_PERFORM_CD, CLMF_CLAIM_CORE.FIBER_GLASS_CD as FIBER_GLASS_CD, CLMF_CLAIM_CORE.INEXPER_DRVR_CD as INEXPER_DRVR_CD, CLMF_CLAIM_CORE.FIN_RES_CD as FIN_RES_CD, CLMF_CLAIM_CORE.MISC_DISC as MISC_DISC, CLMF_CLAIM_CORE.HO_DISC as HO_DISC, CLMF_CLAIM_CORE.SM_SP_PLCY_IND as SM_SP_PLCY_IND, CLMF_CLAIM_CORE.PREV_AGNT as PREV_AGNT, CLMF_CLAIM_CORE.CHANGE_AGT_DT as CHANGE_AGT_DT, CLMF_CLAIM_CORE.CHANGE_AGT_DATE as CHANGE_AGT_DATE, CLMF_CLAIM_CORE.WC_EFF_YR as WC_EFF_YR, CLMF_CLAIM_CORE.PLCY_FOLDER_DT as PLCY_FOLDER_DT, CLMF_CLAIM_CORE.PLCY_FOLDER_DATE as PLCY_FOLDER_DATE, CLMF_CLAIM_CORE.TRANSFERRED_PLCY_NBR as TRANSFERRED_PLCY_NBR, CLMF_CLAIM_CORE.CLUE_CHANGE_MMYY as CLUE_CHANGE_MMYY, CLMF_CLAIM_CORE.CLUE_REPT_ITEM as CLUE_REPT_ITEM, CLMF_CLAIM_CORE.MISS_FIRE_CLM_IND as MISS_FIRE_CLM_IND, CLMF_CLAIM_CORE.TIMES_NOT_FOUND as TIMES_NOT_FOUND, CLMF_CLAIM_CORE.TOT_RES_AMT as TOT_RES_AMT, CLMF_CLAIM_CORE.TOT_PAID_AMT as TOT_PAID_AMT, CLMF_CLAIM_CORE.VEH_ID_NBR as VEH_ID_NBR, CLMF_CLAIM_CORE.DRV_NBR as DRV_NBR, CLMF_CLAIM_CORE.DRV_NM as DRV_NM, CLMF_CLAIM_CORE.ARRP_CHRG_DT as ARRP_CHRG_DT, CLMF_CLAIM_CORE.ARRP_CHRG_DATE as ARRP_CHRG_DATE, CLMF_CLAIM_CORE.FATAL_CD as FATAL_CD, CLMF_CLAIM_CORE.FLEET_ITEM_NBR as FLEET_ITEM_NBR, CLMF_CLAIM_CORE.CAR_YR as CAR_YR, CLMF_CLAIM_CORE.MAKE as MAKE, CLMF_CLAIM_CORE.MODEL as MODEL, CLMF_CLAIM_CORE.HPTON as HPTON, CLMF_CLAIM_CORE.VEH_TYPE as VEH_TYPE, CLMF_CLAIM_CORE.TERRITORY as TERRITORY, CLMF_CLAIM_CORE.USER_CLASS_CD as USER_CLASS_CD, CLMF_CLAIM_CORE.DRV_CLASS_CD as DRV_CLASS_CD, CLMF_CLAIM_CORE.COST_SYM_CD as COST_SYM_CD, CLMF_CLAIM_CORE.AUTO_DISC as AUTO_DISC, CLMF_CLAIM_CORE.DRV_LIC_NBR as DRV_LIC_NBR, CLMF_CLAIM_CORE.DRV_DOB_DT as DRV_DOB_DT, CLMF_CLAIM_CORE.DRV_DOB_DATE as DRV_DOB_DATE, CLMF_CLAIM_CORE.ARRP_CD as ARRP_CD, CLMF_CLAIM_CORE.CAMPER_BODY_CD as CAMPER_BODY_CD, CLMF_CLAIM_CORE.PLCY_ST as PLCY_ST, CLMF_CLAIM_CORE.PLCY_PREFIX as PLCY_PREFIX, CLMF_CLAIM_CORE.PLCY_NBR as PLCY_NBR, CLMF_CLAIM_CORE.LOSS_DT as LOSS_DT, CLMF_CLAIM_CORE.SEQ_NBR as SEQ_NBR
FROM  db_t_core_prod.CLMF_CLAIM_CORE WHERE CLMF_CLAIM_CORE.ECTL_TX_CD = ''NEW''
) LKP ON LKP.PLCY_ST = exp_HOLD_DATA.POL_STATE AND LKP.PLCY_PREFIX = exp_HOLD_DATA.PFX AND LKP.PLCY_NBR = exp_HOLD_DATA.PNO AND LKP.LOSS_DT = exp_HOLD_DATA.DATE_O_LOSS AND LKP.SEQ_NBR = exp_HOLD_DATA.SEQNO
QUALIFY RNK = 1
);


-- Component exp_CHECK, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_CHECK AS
(
SELECT
LKP_CLMF_CLAIM_CORE.CLAIM_SKEY as CLAIM_SKEY_lkp,
exp_HOLD_DATA.PFX as PFX,
exp_HOLD_DATA.PNO as PNO,
exp_HOLD_DATA.DATE_O_LOSS as DATE_O_LOSS,
exp_HOLD_DATA.DATE_O_LOSS_DT as DATE_O_LOSS_DT,
exp_HOLD_DATA.SEQNO as SEQNO,
exp_HOLD_DATA.TRANS_ID as TRANS_ID1,
exp_HOLD_DATA.DIST as DIST,
exp_HOLD_DATA.ADJSYM as ADJSYM,
exp_HOLD_DATA.FAST_TRAC as FAST_TRAC,
exp_HOLD_DATA.GLASBRK as GLASBRK,
exp_HOLD_DATA.SUSP as SUSP,
exp_HOLD_DATA.out_SAL as out_SAL,
exp_HOLD_DATA.out_SUB as out_SUB,
exp_HOLD_DATA.SLC_CD as SLC_CD,
exp_HOLD_DATA.REPT_DT as REPT_DT,
exp_HOLD_DATA.REPT_DATE as REPT_DATE,
exp_HOLD_DATA.ACCTG_DT as ACCTG_DT1,
exp_HOLD_DATA.ACCTG_DATE as ACCTG_DATE1,
exp_HOLD_DATA.CAUSE_CD as CAUSE_CD1,
exp_HOLD_DATA.CAUSE_DESC as CAUSE_DESC1,
exp_HOLD_DATA.COT_PLN as COT_PLN1,
exp_HOLD_DATA.CAT_CD as CAT_CD1,
exp_HOLD_DATA.RISK_ID as RISK_ID1,
exp_HOLD_DATA.CLOSE_CD as CLOSE_CD1,
exp_HOLD_DATA.CLOSE_DT as CLOSE_DT1,
exp_HOLD_DATA.CLOSE_DATE as CLOSE_DATE1,
exp_HOLD_DATA.NO_REO as NO_REO,
exp_HOLD_DATA.REIN as REIN,
exp_HOLD_DATA.ENC_CD as ENC_CD,
exp_HOLD_DATA.AGTNO as AGTNO,
exp_HOLD_DATA.SCNO as SCNO,
exp_HOLD_DATA.INSD_NM as INSD_NM1,
exp_HOLD_DATA.OCC_CD as OCC_CD,
exp_HOLD_DATA.TIME_O_LOSS as TIME_O_LOSS,
exp_HOLD_DATA.SUBROGATION_DATE as SUBROGATION_DATE,
exp_HOLD_DATA.PURG_CLM_FROM_FOLDER as PURG_CLM_FROM_FOLDER1,
exp_HOLD_DATA.RECOVERABLE_LOSS_CD as RECOVERABLE_LOSS_CD,
exp_HOLD_DATA.RECOVERABLE_LOSS_AMT as RECOVERABLE_LOSS_AMT,
exp_HOLD_DATA.PREM_FINANCE as PREM_FINANCE,
exp_HOLD_DATA.MONTHLY_BILLING as MONTHLY_BILLING,
exp_HOLD_DATA.HIGH_PERFORM_CODE as HIGH_PERFORM_CODE,
exp_HOLD_DATA.FIBER_GLASS_CODE as FIBER_GLASS_CODE,
exp_HOLD_DATA.INEXPER_DRVR_CODE as INEXPER_DRVR_CODE,
exp_HOLD_DATA.FINANCIAL_RESPONBILITY_CODE as FINANCIAL_RESPONBILITY_CODE,
exp_HOLD_DATA.MISC_DISCOUNT as MISC_DISCOUNT,
exp_HOLD_DATA.HO_DISCOUNT as HO_DISCOUNT,
exp_HOLD_DATA.SM_SP_POLICY_IND as SM_SP_POLICY_IND,
exp_HOLD_DATA.PREV_AGENT as PREV_AGENT,
exp_HOLD_DATA.CHANGE_AGT_DT as CHANGE_AGT_DT1,
exp_HOLD_DATA.CHANGE_AGT_DATE as CHANGE_AGT_DATE1,
exp_HOLD_DATA.WC_EFF_YR as WC_EFF_YR1,
exp_HOLD_DATA.POL_FOLDER_DATE as POL_FOLDER_DATE,
exp_HOLD_DATA.POL_FOLDER_DT as POL_FOLDER_DT,
exp_HOLD_DATA.TRANSFERRED_POL_NBR as TRANSFERRED_POL_NBR,
exp_HOLD_DATA.CLUE_CHANGE_MMYY as CLUE_CHANGE_MMYY1,
exp_HOLD_DATA.CLUE_REPT_ITEM as CLUE_REPT_ITEM1,
exp_HOLD_DATA.MISS_FIRE_CLM_IND as MISS_FIRE_CLM_IND1,
exp_HOLD_DATA.TIMES_NOT_FOUND as TIMES_NOT_FOUND1,
exp_HOLD_DATA.TOT_RES_AMT as TOT_RES_AMT1,
exp_HOLD_DATA.TOT_PAID_AMT as TOT_PAID_AMT1,
exp_HOLD_DATA.AC_VEHICLE_ID_NO as AC_VEHICLE_ID_NO,
exp_HOLD_DATA.AC_DRVERNO as AC_DRVERNO,
exp_HOLD_DATA.AC_DRVERNM as AC_DRVERNM,
exp_HOLD_DATA.AC_ARRP_CHRG_DT as AC_ARRP_CHRG_DT,
exp_HOLD_DATA.AC_ARRP_CHRG_DATE as AC_ARRP_CHRG_DATE,
exp_HOLD_DATA.AC_FATAL_CD as AC_FATAL_CD,
exp_HOLD_DATA.AC_FLEET_ITEM_NO as AC_FLEET_ITEM_NO,
exp_HOLD_DATA.AC_CARYR as AC_CARYR,
exp_HOLD_DATA.AC_MAKE as AC_MAKE,
exp_HOLD_DATA.AC_MODEL as AC_MODEL,
exp_HOLD_DATA.AC_HPTON as AC_HPTON,
exp_HOLD_DATA.AC_VEHICLE_TYPE as AC_VEHICLE_TYPE,
exp_HOLD_DATA.TERR as TERR,
exp_HOLD_DATA.USEX as USEX,
exp_HOLD_DATA.DC as DC,
exp_HOLD_DATA.SYM as SYM,
exp_HOLD_DATA.AC_DISC as AC_DISC,
exp_HOLD_DATA.AC_DRLISC as AC_DRLISC,
exp_HOLD_DATA.AC_DR_DOB as AC_DR_DOB,
exp_HOLD_DATA.AC_ARRP_CODE as AC_ARRP_CODE,
exp_HOLD_DATA.AC_CAMPER_BODY as AC_CAMPER_BODY,
exp_HOLD_DATA.OPERATOR_ID as OPERATOR_ID,
exp_HOLD_DATA.COMPANY as COMPANY,
exp_HOLD_DATA.MRI as MRI,
exp_HOLD_DATA.TRL_COUNT as TRL_COUNT,
exp_HOLD_DATA.POL_STATE as POL_STATE,
exp_HOLD_DATA.SUIT_CD as SUIT_CD1,
CASE WHEN LKP_CLMF_CLAIM_CORE.CLAIM_SKEY IS NULL THEN ''INS'' ELSE CASE WHEN CASE WHEN LKP_CLMF_CLAIM_CORE.OPERATOR_ID IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.OPERATOR_ID END <> CASE WHEN exp_HOLD_DATA.OPERATOR_ID IS NULL THEN ''~'' ELSE exp_HOLD_DATA.OPERATOR_ID END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CMPY_CD IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.CMPY_CD END <> CASE WHEN exp_HOLD_DATA.COMPANY IS NULL THEN 0 ELSE exp_HOLD_DATA.COMPANY END OR CASE WHEN LKP_CLMF_CLAIM_CORE.REC_TYPE IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.REC_TYPE END <> CASE WHEN exp_HOLD_DATA.MRI IS NULL THEN ''~'' ELSE exp_HOLD_DATA.MRI END OR CASE WHEN LKP_CLMF_CLAIM_CORE.TRL_CNT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.TRL_CNT END <> CASE WHEN exp_HOLD_DATA.TRL_COUNT IS NULL THEN 0 ELSE exp_HOLD_DATA.TRL_COUNT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.TRANS_ID IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.TRANS_ID END <> CASE WHEN exp_HOLD_DATA.TRANS_ID IS NULL THEN 0 ELSE exp_HOLD_DATA.TRANS_ID END OR CASE WHEN LKP_CLMF_CLAIM_CORE.DIST_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.DIST_CD END <> CASE WHEN exp_HOLD_DATA.DIST IS NULL THEN ''~'' ELSE exp_HOLD_DATA.DIST END OR CASE WHEN LKP_CLMF_CLAIM_CORE.ADJ_SYM IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.ADJ_SYM END <> CASE WHEN exp_HOLD_DATA.ADJSYM IS NULL THEN ''~'' ELSE exp_HOLD_DATA.ADJSYM END OR CASE WHEN LKP_CLMF_CLAIM_CORE.FAST_TRAC_IND IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.FAST_TRAC_IND END <> CASE WHEN exp_HOLD_DATA.FAST_TRAC IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FAST_TRAC END OR CASE WHEN LKP_CLMF_CLAIM_CORE.GLASSBREAK_IND IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.GLASSBREAK_IND END <> CASE WHEN exp_HOLD_DATA.GLASBRK IS NULL THEN ''~'' ELSE exp_HOLD_DATA.GLASBRK END OR CASE WHEN LKP_CLMF_CLAIM_CORE.SUSP_IND IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.SUSP_IND END <> CASE WHEN exp_HOLD_DATA.SUSP IS NULL THEN ''~'' ELSE exp_HOLD_DATA.SUSP END OR CASE WHEN LKP_CLMF_CLAIM_CORE.SAL_IND IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.SAL_IND END <> CASE WHEN exp_HOLD_DATA.out_SAL IS NULL THEN ''~'' ELSE exp_HOLD_DATA.out_SAL END OR CASE WHEN LKP_CLMF_CLAIM_CORE.SUBR_IND IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.SUBR_IND END <> CASE WHEN exp_HOLD_DATA.out_SUB IS NULL THEN ''~'' ELSE exp_HOLD_DATA.out_SUB END OR CASE WHEN LKP_CLMF_CLAIM_CORE.SUIT_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.SUIT_CD END <> CASE WHEN exp_HOLD_DATA.SUIT_CD IS NULL THEN ''~'' ELSE exp_HOLD_DATA.SUIT_CD END OR CASE WHEN LKP_CLMF_CLAIM_CORE.SURVY_LTR_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.SURVY_LTR_CD END <> CASE WHEN exp_HOLD_DATA.SLC_CD IS NULL THEN ''~'' ELSE exp_HOLD_DATA.SLC_CD END OR CASE WHEN LKP_CLMF_CLAIM_CORE.REPORTED_DT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.REPORTED_DT END <> CASE WHEN exp_HOLD_DATA.REPT_DT IS NULL THEN 0 ELSE exp_HOLD_DATA.REPT_DT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.REPORTED_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_CLMF_CLAIM_CORE.REPORTED_DATE END <> CASE WHEN exp_HOLD_DATA.REPT_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.REPT_DATE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.ACCTG_DT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.ACCTG_DT END <> CASE WHEN exp_HOLD_DATA.ACCTG_DT IS NULL THEN 0 ELSE exp_HOLD_DATA.ACCTG_DT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.ACCTG_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_CLMF_CLAIM_CORE.ACCTG_DATE END <> CASE WHEN exp_HOLD_DATA.ACCTG_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.ACCTG_DATE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CAUSE_CD IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.CAUSE_CD END <> CASE WHEN exp_HOLD_DATA.CAUSE_CD IS NULL THEN 0 ELSE exp_HOLD_DATA.CAUSE_CD END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CAUSE_DESC IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.CAUSE_DESC END <> CASE WHEN exp_HOLD_DATA.CAUSE_DESC IS NULL THEN ''~'' ELSE exp_HOLD_DATA.CAUSE_DESC END OR CASE WHEN LKP_CLMF_CLAIM_CORE.COT_PLN IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.COT_PLN END <> CASE WHEN exp_HOLD_DATA.COT_PLN IS NULL THEN ''~'' ELSE exp_HOLD_DATA.COT_PLN END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CAT_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.CAT_CD END <> CASE WHEN exp_HOLD_DATA.CAT_CD IS NULL THEN ''~'' ELSE exp_HOLD_DATA.CAT_CD END OR CASE WHEN LKP_CLMF_CLAIM_CORE.RISK_ID IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.RISK_ID END <> CASE WHEN exp_HOLD_DATA.RISK_ID IS NULL THEN ''~'' ELSE exp_HOLD_DATA.RISK_ID END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CLOSE_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.CLOSE_CD END <> CASE WHEN exp_HOLD_DATA.CLOSE_CD IS NULL THEN ''~'' ELSE exp_HOLD_DATA.CLOSE_CD END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CLOSE_DT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.CLOSE_DT END <> CASE WHEN exp_HOLD_DATA.CLOSE_DT IS NULL THEN 0 ELSE exp_HOLD_DATA.CLOSE_DT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CLOSE_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_CLMF_CLAIM_CORE.CLOSE_DATE END <> CASE WHEN exp_HOLD_DATA.CLOSE_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.CLOSE_DATE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.REOPEN_CNT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.REOPEN_CNT END <> CASE WHEN exp_HOLD_DATA.NO_REO IS NULL THEN 0 ELSE exp_HOLD_DATA.NO_REO END OR CASE WHEN LKP_CLMF_CLAIM_CORE.REINSURANCE_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.REINSURANCE_CD END <> CASE WHEN exp_HOLD_DATA.REIN IS NULL THEN ''~'' ELSE exp_HOLD_DATA.REIN END OR CASE WHEN LKP_CLMF_CLAIM_CORE.ENCUMBRANCE_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.ENCUMBRANCE_CD END <> CASE WHEN exp_HOLD_DATA.ENC_CD IS NULL THEN ''~'' ELSE exp_HOLD_DATA.ENC_CD END OR CASE WHEN LKP_CLMF_CLAIM_CORE.AGNT_NBR IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.AGNT_NBR END <> CASE WHEN exp_HOLD_DATA.AGTNO IS NULL THEN 0 ELSE exp_HOLD_DATA.AGTNO END OR CASE WHEN LKP_CLMF_CLAIM_CORE.SVC_NBR IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.SVC_NBR END <> CASE WHEN exp_HOLD_DATA.SCNO IS NULL THEN 0 ELSE exp_HOLD_DATA.SCNO END OR CASE WHEN LKP_CLMF_CLAIM_CORE.INSD_NM IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.INSD_NM END <> CASE WHEN exp_HOLD_DATA.INSD_NM IS NULL THEN ''~'' ELSE exp_HOLD_DATA.INSD_NM END OR CASE WHEN LKP_CLMF_CLAIM_CORE.OCP_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.OCP_CD END <> CASE WHEN exp_HOLD_DATA.OCC_CD IS NULL THEN ''~'' ELSE exp_HOLD_DATA.OCC_CD END OR CASE WHEN LKP_CLMF_CLAIM_CORE.TIME_OF_LOSS IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.TIME_OF_LOSS END <> CASE WHEN exp_HOLD_DATA.TIME_O_LOSS IS NULL THEN ''~'' ELSE exp_HOLD_DATA.TIME_O_LOSS END OR CASE WHEN LKP_CLMF_CLAIM_CORE.SUBROGATION_DATE IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.SUBROGATION_DATE END <> CASE WHEN exp_HOLD_DATA.SUBROGATION_DATE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.SUBROGATION_DATE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.PURG_CLM_FROM_FOLDER IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.PURG_CLM_FROM_FOLDER END <> CASE WHEN exp_HOLD_DATA.PURG_CLM_FROM_FOLDER IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PURG_CLM_FROM_FOLDER END OR CASE WHEN LKP_CLMF_CLAIM_CORE.RECOV_LOSS_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.RECOV_LOSS_CD END <> CASE WHEN exp_HOLD_DATA.RECOVERABLE_LOSS_CD IS NULL THEN ''~'' ELSE exp_HOLD_DATA.RECOVERABLE_LOSS_CD END OR CASE WHEN LKP_CLMF_CLAIM_CORE.RECOV_LOSS_AMT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.RECOV_LOSS_AMT END <> CASE WHEN exp_HOLD_DATA.RECOVERABLE_LOSS_AMT IS NULL THEN 0 ELSE exp_HOLD_DATA.RECOVERABLE_LOSS_AMT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.PREM_FINANCE_IND IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.PREM_FINANCE_IND END <> CASE WHEN exp_HOLD_DATA.PREM_FINANCE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PREM_FINANCE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.MONTHLY_BILLING_IND IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.MONTHLY_BILLING_IND END <> CASE WHEN exp_HOLD_DATA.MONTHLY_BILLING IS NULL THEN ''~'' ELSE exp_HOLD_DATA.MONTHLY_BILLING END OR CASE WHEN LKP_CLMF_CLAIM_CORE.HIGH_PERFORM_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.HIGH_PERFORM_CD END <> CASE WHEN exp_HOLD_DATA.HIGH_PERFORM_CODE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.HIGH_PERFORM_CODE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.FIBER_GLASS_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.FIBER_GLASS_CD END <> CASE WHEN exp_HOLD_DATA.FIBER_GLASS_CODE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FIBER_GLASS_CODE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.INEXPER_DRVR_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.INEXPER_DRVR_CD END <> CASE WHEN exp_HOLD_DATA.INEXPER_DRVR_CODE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.INEXPER_DRVR_CODE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.FIN_RES_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.FIN_RES_CD END <> CASE WHEN exp_HOLD_DATA.FINANCIAL_RESPONBILITY_CODE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FINANCIAL_RESPONBILITY_CODE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.MISC_DISC IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.MISC_DISC END <> CASE WHEN exp_HOLD_DATA.MISC_DISCOUNT IS NULL THEN ''~'' ELSE exp_HOLD_DATA.MISC_DISCOUNT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.HO_DISC IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.HO_DISC END <> CASE WHEN exp_HOLD_DATA.HO_DISCOUNT IS NULL THEN ''~'' ELSE exp_HOLD_DATA.HO_DISCOUNT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.SM_SP_PLCY_IND IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.SM_SP_PLCY_IND END <> CASE WHEN exp_HOLD_DATA.SM_SP_POLICY_IND IS NULL THEN ''~'' ELSE exp_HOLD_DATA.SM_SP_POLICY_IND END OR CASE WHEN LKP_CLMF_CLAIM_CORE.PREV_AGNT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.PREV_AGNT END <> CASE WHEN exp_HOLD_DATA.PREV_AGENT IS NULL THEN 0 ELSE exp_HOLD_DATA.PREV_AGENT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CHANGE_AGT_DT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.CHANGE_AGT_DT END <> CASE WHEN exp_HOLD_DATA.CHANGE_AGT_DT IS NULL THEN 0 ELSE exp_HOLD_DATA.CHANGE_AGT_DT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CHANGE_AGT_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_CLMF_CLAIM_CORE.CHANGE_AGT_DATE END <> CASE WHEN exp_HOLD_DATA.CHANGE_AGT_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.CHANGE_AGT_DATE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.WC_EFF_YR IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.WC_EFF_YR END <> CASE WHEN exp_HOLD_DATA.WC_EFF_YR IS NULL THEN 0 ELSE exp_HOLD_DATA.WC_EFF_YR END OR CASE WHEN LKP_CLMF_CLAIM_CORE.PLCY_FOLDER_DT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.PLCY_FOLDER_DT END <> CASE WHEN exp_HOLD_DATA.POL_FOLDER_DATE IS NULL THEN 0 ELSE exp_HOLD_DATA.POL_FOLDER_DATE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.PLCY_FOLDER_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_CLMF_CLAIM_CORE.PLCY_FOLDER_DATE END <> CASE WHEN exp_HOLD_DATA.POL_FOLDER_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.POL_FOLDER_DT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.TRANSFERRED_PLCY_NBR IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.TRANSFERRED_PLCY_NBR END <> CASE WHEN exp_HOLD_DATA.TRANSFERRED_POL_NBR IS NULL THEN ''~'' ELSE exp_HOLD_DATA.TRANSFERRED_POL_NBR END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CLUE_CHANGE_MMYY IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.CLUE_CHANGE_MMYY END <> CASE WHEN exp_HOLD_DATA.CLUE_CHANGE_MMYY IS NULL THEN ''~'' ELSE exp_HOLD_DATA.CLUE_CHANGE_MMYY END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CLUE_REPT_ITEM IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.CLUE_REPT_ITEM END <> CASE WHEN exp_HOLD_DATA.CLUE_REPT_ITEM IS NULL THEN ''~'' ELSE exp_HOLD_DATA.CLUE_REPT_ITEM END OR CASE WHEN LKP_CLMF_CLAIM_CORE.MISS_FIRE_CLM_IND IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.MISS_FIRE_CLM_IND END <> CASE WHEN exp_HOLD_DATA.MISS_FIRE_CLM_IND IS NULL THEN ''~'' ELSE exp_HOLD_DATA.MISS_FIRE_CLM_IND END OR CASE WHEN LKP_CLMF_CLAIM_CORE.TIMES_NOT_FOUND IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.TIMES_NOT_FOUND END <> CASE WHEN exp_HOLD_DATA.TIMES_NOT_FOUND IS NULL THEN 0 ELSE exp_HOLD_DATA.TIMES_NOT_FOUND END OR CASE WHEN LKP_CLMF_CLAIM_CORE.TOT_RES_AMT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.TOT_RES_AMT END <> CASE WHEN exp_HOLD_DATA.TOT_RES_AMT IS NULL THEN 0 ELSE exp_HOLD_DATA.TOT_RES_AMT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.TOT_PAID_AMT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.TOT_PAID_AMT END <> CASE WHEN exp_HOLD_DATA.TOT_PAID_AMT IS NULL THEN 0 ELSE exp_HOLD_DATA.TOT_PAID_AMT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.VEH_ID_NBR IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.VEH_ID_NBR END <> CASE WHEN exp_HOLD_DATA.AC_VEHICLE_ID_NO IS NULL THEN ''~'' ELSE exp_HOLD_DATA.AC_VEHICLE_ID_NO END OR CASE WHEN LKP_CLMF_CLAIM_CORE.DRV_NBR IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.DRV_NBR END <> CASE WHEN exp_HOLD_DATA.AC_DRVERNO IS NULL THEN 0 ELSE exp_HOLD_DATA.AC_DRVERNO END OR CASE WHEN LKP_CLMF_CLAIM_CORE.DRV_NM IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.DRV_NM END <> CASE WHEN exp_HOLD_DATA.AC_DRVERNM IS NULL THEN ''~'' ELSE exp_HOLD_DATA.AC_DRVERNM END OR CASE WHEN LKP_CLMF_CLAIM_CORE.ARRP_CHRG_DT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.ARRP_CHRG_DT END <> CASE WHEN exp_HOLD_DATA.AC_ARRP_CHRG_DT IS NULL THEN 0 ELSE exp_HOLD_DATA.AC_ARRP_CHRG_DT END OR CASE WHEN LKP_CLMF_CLAIM_CORE.ARRP_CHRG_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_CLMF_CLAIM_CORE.ARRP_CHRG_DATE END <> CASE WHEN exp_HOLD_DATA.AC_ARRP_CHRG_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.AC_ARRP_CHRG_DATE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.FATAL_CD IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.FATAL_CD END <> CASE WHEN exp_HOLD_DATA.AC_FATAL_CD IS NULL THEN 0 ELSE exp_HOLD_DATA.AC_FATAL_CD END OR CASE WHEN LKP_CLMF_CLAIM_CORE.FLEET_ITEM_NBR IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.FLEET_ITEM_NBR END <> CASE WHEN exp_HOLD_DATA.AC_FLEET_ITEM_NO IS NULL THEN 0 ELSE exp_HOLD_DATA.AC_FLEET_ITEM_NO END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CAR_YR IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.CAR_YR END <> CASE WHEN exp_HOLD_DATA.AC_CARYR IS NULL THEN 0 ELSE exp_HOLD_DATA.AC_CARYR END OR CASE WHEN LKP_CLMF_CLAIM_CORE.MAKE IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.MAKE END <> CASE WHEN exp_HOLD_DATA.AC_MAKE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.AC_MAKE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.MODEL IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.MODEL END <> CASE WHEN exp_HOLD_DATA.AC_MODEL IS NULL THEN ''~'' ELSE exp_HOLD_DATA.AC_MODEL END OR CASE WHEN LKP_CLMF_CLAIM_CORE.HPTON IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.HPTON END <> CASE WHEN exp_HOLD_DATA.AC_HPTON IS NULL THEN ''~'' ELSE exp_HOLD_DATA.AC_HPTON END OR CASE WHEN LKP_CLMF_CLAIM_CORE.VEH_TYPE IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.VEH_TYPE END <> CASE WHEN exp_HOLD_DATA.AC_VEHICLE_TYPE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.AC_VEHICLE_TYPE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.TERRITORY IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.TERRITORY END <> CASE WHEN exp_HOLD_DATA.TERR IS NULL THEN ''~'' ELSE exp_HOLD_DATA.TERR END OR CASE WHEN LKP_CLMF_CLAIM_CORE.USER_CLASS_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.USER_CLASS_CD END <> CASE WHEN exp_HOLD_DATA.USEX IS NULL THEN ''~'' ELSE exp_HOLD_DATA.USEX END OR CASE WHEN LKP_CLMF_CLAIM_CORE.DRV_CLASS_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.DRV_CLASS_CD END <> CASE WHEN exp_HOLD_DATA.DC IS NULL THEN ''~'' ELSE exp_HOLD_DATA.DC END OR CASE WHEN LKP_CLMF_CLAIM_CORE.COST_SYM_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.COST_SYM_CD END <> CASE WHEN exp_HOLD_DATA.SYM IS NULL THEN ''~'' ELSE exp_HOLD_DATA.SYM END OR CASE WHEN LKP_CLMF_CLAIM_CORE.AUTO_DISC IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.AUTO_DISC END <> CASE WHEN exp_HOLD_DATA.AC_DISC IS NULL THEN ''~'' ELSE exp_HOLD_DATA.AC_DISC END OR CASE WHEN LKP_CLMF_CLAIM_CORE.DRV_LIC_NBR IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.DRV_LIC_NBR END <> CASE WHEN exp_HOLD_DATA.AC_DRLISC IS NULL THEN ''~'' ELSE exp_HOLD_DATA.AC_DRLISC END OR CASE WHEN LKP_CLMF_CLAIM_CORE.DRV_DOB_DT IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.DRV_DOB_DT END <> CASE WHEN exp_HOLD_DATA.AC_DR_DOB IS NULL THEN 0 ELSE exp_HOLD_DATA.AC_DR_DOB END OR CASE WHEN LKP_CLMF_CLAIM_CORE.ARRP_CD IS NULL THEN ''~'' ELSE LKP_CLMF_CLAIM_CORE.ARRP_CD END <> CASE WHEN exp_HOLD_DATA.AC_ARRP_CODE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.AC_ARRP_CODE END OR CASE WHEN LKP_CLMF_CLAIM_CORE.CAMPER_BODY_CD IS NULL THEN 0 ELSE LKP_CLMF_CLAIM_CORE.CAMPER_BODY_CD END <> CASE WHEN exp_HOLD_DATA.AC_CAMPER_BODY IS NULL THEN 0 ELSE exp_HOLD_DATA.AC_CAMPER_BODY END OR CASE WHEN LKP_CLMF_CLAIM_CORE.DRV_DOB_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_CLMF_CLAIM_CORE.DRV_DOB_DATE END <> CASE WHEN exp_HOLD_DATA.AC_DR_DOB_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.AC_DR_DOB_DATE END THEN ''UPD'' ELSE ''REJ'' END END as out_CHECK,
LTRIM ( RTRIM ( :PMMappingName ) ) as in_PRGM_NM,
:ACT_PROJ_ID as in_ACT_PROJ_ID,
:BATCH_ACTIVE_IND as in_BATCH_ACTIVE_IND,
:TABLE_NM as in_TABLE_NM,
exp_HOLD_DATA.out_CHG_EFF_DT as out_CHG_EFF_DT,
exp_HOLD_DATA.out_CHG_EXP_DT as out_CHG_EXP_DT,
LKP_CLMF_CLAIM_CORE.CHG_EFF_DT as CHG_EFF_DT_lkp,
exp_HOLD_DATA.AC_DR_DOB_DATE as AC_DR_DOB_DATE,
exp_HOLD_DATA.source_record_id
FROM
exp_HOLD_DATA
INNER JOIN LKP_CLMF_CLAIM_CORE ON exp_HOLD_DATA.source_record_id = LKP_CLMF_CLAIM_CORE.source_record_id
);


-- Component mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, Type MAPPLET 
--MAPPLET NOT REGISTERED: mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, mapplet instance mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE;
call mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE(''exp_CHECK'');

-- Component rtr_INS_UPD_INS, Type ROUTER Output Group INS
create or replace temp table rtr_INS_UPD_INS as 
SELECT
exp_CHECK.OPERATOR_ID as OPERATOR_ID,
exp_CHECK.COMPANY as COMPANY,
exp_CHECK.MRI as MRI,
exp_CHECK.TRL_COUNT as TRL_COUNT,
exp_CHECK.POL_STATE as POL_STATE,
exp_CHECK.PFX as PFX,
exp_CHECK.PNO as PNO,
exp_CHECK.DATE_O_LOSS as DATE_O_LOSS,
exp_CHECK.DATE_O_LOSS_DT as DATE_O_LOSS_DT,
exp_CHECK.SEQNO as SEQNO,
exp_CHECK.TRANS_ID1 as TRANS_ID1,
exp_CHECK.DIST as DIST,
exp_CHECK.ADJSYM as ADJSYM,
exp_CHECK.FAST_TRAC as FAST_TRAC,
exp_CHECK.GLASBRK as GLASBRK,
exp_CHECK.SUSP as SUSP,
exp_CHECK.out_SAL as SAL,
exp_CHECK.out_SUB as SUB,
exp_CHECK.SUIT_CD1 as SUIT_CD1,
exp_CHECK.SLC_CD as SLC_CD,
exp_CHECK.REPT_DT as REPT_DT,
exp_CHECK.REPT_DATE as REPT_DATE,
exp_CHECK.ACCTG_DT1 as ACCTG_DT1,
exp_CHECK.ACCTG_DATE1 as ACCTG_DATE1,
exp_CHECK.CAUSE_CD1 as CAUSE_CD1,
exp_CHECK.CAUSE_DESC1 as CAUSE_DESC1,
exp_CHECK.COT_PLN1 as COT_PLN1,
exp_CHECK.CAT_CD1 as CAT_CD1,
exp_CHECK.RISK_ID1 as RISK_ID1,
exp_CHECK.CLOSE_CD1 as CLOSE_CD1,
exp_CHECK.CLOSE_DT1 as CLOSE_DT1,
exp_CHECK.CLOSE_DATE1 as CLOSE_DATE1,
exp_CHECK.NO_REO as NO_REO,
exp_CHECK.REIN as REIN,
exp_CHECK.ENC_CD as ENC_CD,
exp_CHECK.AGTNO as AGTNO,
exp_CHECK.SCNO as SCNO,
exp_CHECK.INSD_NM1 as INSD_NM1,
exp_CHECK.OCC_CD as OCC_CD,
exp_CHECK.TIME_O_LOSS as TIME_O_LOSS,
exp_CHECK.SUBROGATION_DATE as SUBROGATION_DATE,
exp_CHECK.PURG_CLM_FROM_FOLDER1 as PURG_CLM_FROM_FOLDER1,
exp_CHECK.RECOVERABLE_LOSS_CD as RECOVERABLE_LOSS_CD,
exp_CHECK.RECOVERABLE_LOSS_AMT as RECOVERABLE_LOSS_AMT,
exp_CHECK.PREM_FINANCE as PREM_FINANCE,
exp_CHECK.MONTHLY_BILLING as MONTHLY_BILLING,
exp_CHECK.HIGH_PERFORM_CODE as HIGH_PERFORM_CODE,
exp_CHECK.FIBER_GLASS_CODE as FIBER_GLASS_CODE,
exp_CHECK.INEXPER_DRVR_CODE as INEXPER_DRVR_CODE,
exp_CHECK.FINANCIAL_RESPONBILITY_CODE as FINANCIAL_RESPONBILITY_CODE,
exp_CHECK.MISC_DISCOUNT as MISC_DISCOUNT,
exp_CHECK.HO_DISCOUNT as HO_DISCOUNT,
exp_CHECK.SM_SP_POLICY_IND as SM_SP_POLICY_IND,
exp_CHECK.PREV_AGENT as PREV_AGENT,
exp_CHECK.CHANGE_AGT_DT1 as CHANGE_AGT_DT1,
exp_CHECK.CHANGE_AGT_DATE1 as CHANGE_AGT_DATE1,
exp_CHECK.WC_EFF_YR1 as WC_EFF_YR1,
exp_CHECK.POL_FOLDER_DATE as POL_FOLDER_DATE,
exp_CHECK.POL_FOLDER_DT as POL_FOLDER_DT,
exp_CHECK.TRANSFERRED_POL_NBR as TRANSFERRED_POL_NBR,
exp_CHECK.CLUE_CHANGE_MMYY1 as CLUE_CHANGE_MMYY1,
exp_CHECK.CLUE_REPT_ITEM1 as CLUE_REPT_ITEM1,
exp_CHECK.MISS_FIRE_CLM_IND1 as MISS_FIRE_CLM_IND1,
exp_CHECK.TIMES_NOT_FOUND1 as TIMES_NOT_FOUND1,
exp_CHECK.TOT_RES_AMT1 as TOT_RES_AMT1,
exp_CHECK.TOT_PAID_AMT1 as TOT_PAID_AMT1,
exp_CHECK.AC_VEHICLE_ID_NO as AC_VEHICLE_ID_NO,
exp_CHECK.AC_DRVERNO as AC_DRVERNO,
exp_CHECK.AC_DRVERNM as AC_DRVERNM,
exp_CHECK.AC_ARRP_CHRG_DT as AC_ARRP_CHRG_DT,
exp_CHECK.AC_ARRP_CHRG_DATE as AC_ARRP_CHRG_DATE,
exp_CHECK.AC_FATAL_CD as AC_FATAL_CD,
exp_CHECK.AC_FLEET_ITEM_NO as AC_FLEET_ITEM_NO,
exp_CHECK.AC_CARYR as AC_CARYR,
exp_CHECK.AC_MAKE as AC_MAKE,
exp_CHECK.AC_MODEL as AC_MODEL,
exp_CHECK.AC_HPTON as AC_HPTON,
exp_CHECK.AC_VEHICLE_TYPE as AC_VEHICLE_TYPE,
exp_CHECK.TERR as TERR,
exp_CHECK.USEX as USEX,
exp_CHECK.DC as DC,
exp_CHECK.SYM as SYM,
exp_CHECK.AC_DISC as AC_DISC,
exp_CHECK.AC_DRLISC as AC_DRLISC,
exp_CHECK.AC_DR_DOB as AC_DR_DOB,
exp_CHECK.AC_ARRP_CODE as AC_ARRP_CODE,
exp_CHECK.AC_CAMPER_BODY as AC_CAMPER_BODY,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_PRGM_ID as out_ECTL_PRGM_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_ID as out_ECTL_SRC_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_INST_ID as out_ECTL_SRC_INST_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_ID as out_ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ORIG_INS_TS as out_ORIG_INS_TS,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_START_DATE as out_ECTL_BATCH_START_DATE,
exp_CHECK.out_CHECK as out_CHECK,
exp_CHECK.CLAIM_SKEY_lkp as CLAIM_SKEY_lkp,
exp_CHECK.out_CHG_EFF_DT as out_CHG_EFF_DT,
exp_CHECK.out_CHG_EXP_DT as out_CHG_EXP_DT,
exp_CHECK.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_CHECK.AC_DR_DOB_DATE as AC_DR_DOB_DATE,
exp_CHECK.source_record_id
FROM
exp_CHECK
LEFT JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE ON exp_CHECK.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.source_record_id
WHERE exp_CHECK.out_CHECK = ''INS'';


-- Component rtr_INS_UPD_UPD, Type ROUTER Output Group UPD
create or replace temp table rtr_INS_UPD_UPD as
SELECT
exp_CHECK.OPERATOR_ID as OPERATOR_ID,
exp_CHECK.COMPANY as COMPANY,
exp_CHECK.MRI as MRI,
exp_CHECK.TRL_COUNT as TRL_COUNT,
exp_CHECK.POL_STATE as POL_STATE,
exp_CHECK.PFX as PFX,
exp_CHECK.PNO as PNO,
exp_CHECK.DATE_O_LOSS as DATE_O_LOSS,
exp_CHECK.DATE_O_LOSS_DT as DATE_O_LOSS_DT,
exp_CHECK.SEQNO as SEQNO,
exp_CHECK.TRANS_ID1 as TRANS_ID1,
exp_CHECK.DIST as DIST,
exp_CHECK.ADJSYM as ADJSYM,
exp_CHECK.FAST_TRAC as FAST_TRAC,
exp_CHECK.GLASBRK as GLASBRK,
exp_CHECK.SUSP as SUSP,
exp_CHECK.out_SAL as SAL,
exp_CHECK.out_SUB as SUB,
exp_CHECK.SUIT_CD1 as SUIT_CD1,
exp_CHECK.SLC_CD as SLC_CD,
exp_CHECK.REPT_DT as REPT_DT,
exp_CHECK.REPT_DATE as REPT_DATE,
exp_CHECK.ACCTG_DT1 as ACCTG_DT1,
exp_CHECK.ACCTG_DATE1 as ACCTG_DATE1,
exp_CHECK.CAUSE_CD1 as CAUSE_CD1,
exp_CHECK.CAUSE_DESC1 as CAUSE_DESC1,
exp_CHECK.COT_PLN1 as COT_PLN1,
exp_CHECK.CAT_CD1 as CAT_CD1,
exp_CHECK.RISK_ID1 as RISK_ID1,
exp_CHECK.CLOSE_CD1 as CLOSE_CD1,
exp_CHECK.CLOSE_DT1 as CLOSE_DT1,
exp_CHECK.CLOSE_DATE1 as CLOSE_DATE1,
exp_CHECK.NO_REO as NO_REO,
exp_CHECK.REIN as REIN,
exp_CHECK.ENC_CD as ENC_CD,
exp_CHECK.AGTNO as AGTNO,
exp_CHECK.SCNO as SCNO,
exp_CHECK.INSD_NM1 as INSD_NM1,
exp_CHECK.OCC_CD as OCC_CD,
exp_CHECK.TIME_O_LOSS as TIME_O_LOSS,
exp_CHECK.SUBROGATION_DATE as SUBROGATION_DATE,
exp_CHECK.PURG_CLM_FROM_FOLDER1 as PURG_CLM_FROM_FOLDER1,
exp_CHECK.RECOVERABLE_LOSS_CD as RECOVERABLE_LOSS_CD,
exp_CHECK.RECOVERABLE_LOSS_AMT as RECOVERABLE_LOSS_AMT,
exp_CHECK.PREM_FINANCE as PREM_FINANCE,
exp_CHECK.MONTHLY_BILLING as MONTHLY_BILLING,
exp_CHECK.HIGH_PERFORM_CODE as HIGH_PERFORM_CODE,
exp_CHECK.FIBER_GLASS_CODE as FIBER_GLASS_CODE,
exp_CHECK.INEXPER_DRVR_CODE as INEXPER_DRVR_CODE,
exp_CHECK.FINANCIAL_RESPONBILITY_CODE as FINANCIAL_RESPONBILITY_CODE,
exp_CHECK.MISC_DISCOUNT as MISC_DISCOUNT,
exp_CHECK.HO_DISCOUNT as HO_DISCOUNT,
exp_CHECK.SM_SP_POLICY_IND as SM_SP_POLICY_IND,
exp_CHECK.PREV_AGENT as PREV_AGENT,
exp_CHECK.CHANGE_AGT_DT1 as CHANGE_AGT_DT1,
exp_CHECK.CHANGE_AGT_DATE1 as CHANGE_AGT_DATE1,
exp_CHECK.WC_EFF_YR1 as WC_EFF_YR1,
exp_CHECK.POL_FOLDER_DATE as POL_FOLDER_DATE,
exp_CHECK.POL_FOLDER_DT as POL_FOLDER_DT,
exp_CHECK.TRANSFERRED_POL_NBR as TRANSFERRED_POL_NBR,
exp_CHECK.CLUE_CHANGE_MMYY1 as CLUE_CHANGE_MMYY1,
exp_CHECK.CLUE_REPT_ITEM1 as CLUE_REPT_ITEM1,
exp_CHECK.MISS_FIRE_CLM_IND1 as MISS_FIRE_CLM_IND1,
exp_CHECK.TIMES_NOT_FOUND1 as TIMES_NOT_FOUND1,
exp_CHECK.TOT_RES_AMT1 as TOT_RES_AMT1,
exp_CHECK.TOT_PAID_AMT1 as TOT_PAID_AMT1,
exp_CHECK.AC_VEHICLE_ID_NO as AC_VEHICLE_ID_NO,
exp_CHECK.AC_DRVERNO as AC_DRVERNO,
exp_CHECK.AC_DRVERNM as AC_DRVERNM,
exp_CHECK.AC_ARRP_CHRG_DT as AC_ARRP_CHRG_DT,
exp_CHECK.AC_ARRP_CHRG_DATE as AC_ARRP_CHRG_DATE,
exp_CHECK.AC_FATAL_CD as AC_FATAL_CD,
exp_CHECK.AC_FLEET_ITEM_NO as AC_FLEET_ITEM_NO,
exp_CHECK.AC_CARYR as AC_CARYR,
exp_CHECK.AC_MAKE as AC_MAKE,
exp_CHECK.AC_MODEL as AC_MODEL,
exp_CHECK.AC_HPTON as AC_HPTON,
exp_CHECK.AC_VEHICLE_TYPE as AC_VEHICLE_TYPE,
exp_CHECK.TERR as TERR,
exp_CHECK.USEX as USEX,
exp_CHECK.DC as DC,
exp_CHECK.SYM as SYM,
exp_CHECK.AC_DISC as AC_DISC,
exp_CHECK.AC_DRLISC as AC_DRLISC,
exp_CHECK.AC_DR_DOB as AC_DR_DOB,
exp_CHECK.AC_ARRP_CODE as AC_ARRP_CODE,
exp_CHECK.AC_CAMPER_BODY as AC_CAMPER_BODY,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_PRGM_ID as out_ECTL_PRGM_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_ID as out_ECTL_SRC_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_INST_ID as out_ECTL_SRC_INST_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_ID as out_ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ORIG_INS_TS as out_ORIG_INS_TS,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_START_DATE as out_ECTL_BATCH_START_DATE,
exp_CHECK.out_CHECK as out_CHECK,
exp_CHECK.CLAIM_SKEY_lkp as CLAIM_SKEY_lkp,
exp_CHECK.out_CHG_EFF_DT as out_CHG_EFF_DT,
exp_CHECK.out_CHG_EXP_DT as out_CHG_EXP_DT,
exp_CHECK.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_CHECK.AC_DR_DOB_DATE as AC_DR_DOB_DATE,
exp_CHECK.source_record_id
FROM
exp_CHECK
LEFT JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE ON exp_CHECK.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.source_record_id
WHERE exp_CHECK.out_CHECK = ''UPD'';


-- Component exp_UPD, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_UPD AS
(
SELECT
rtr_INS_UPD_UPD.CLAIM_SKEY_lkp as CLAIM_SKEY_lkp3,
rtr_INS_UPD_UPD.out_CHECK as out_CHECK3,
rtr_INS_UPD_UPD.out_ECTL_BATCH_ID as out_ECTL_BATCH_ID3,
rtr_INS_UPD_UPD.out_ORIG_INS_TS as out_ORIG_INS_TS3,
dateadd ( day,-1,rtr_INS_UPD_UPD.out_CHG_EFF_DT  ) as CHG_EXP_DT,
CURRENT_TIMESTAMP as out_ECTL_END_DT,
rtr_INS_UPD_UPD.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp3,
rtr_INS_UPD_UPD.source_record_id
FROM
rtr_INS_UPD_UPD
);


-- Component upd_CLMF_CLAIM_CORE, Type UPDATE 
CREATE OR REPLACE TEMPORARY TABLE upd_CLMF_CLAIM_CORE AS
(
/* UPDATE_STRATEGY_ACTION = 0 FOR INSERT / UPDATE_STRATEGY_ACTION = 1 FOR UPDATE / UPDATE_STRATEGY_ACTION = 2 FOR DELETE / UPDATE_STRATEGY_ACTION = 3 FOR REJECT */
SELECT
exp_UPD.CLAIM_SKEY_lkp3 as CLAIM_SKEY_lkp3,
exp_UPD.out_ECTL_BATCH_ID3 as out_ECTL_BATCH_ID3,
exp_UPD.out_ORIG_INS_TS3 as out_ORIG_INS_TS3,
exp_UPD.out_CHECK3 as out_CHECK3,
exp_UPD.CHG_EXP_DT as CHG_EXP_DT,
exp_UPD.out_ECTL_END_DT as out_ECTL_END_DT,
exp_UPD.CHG_EFF_DT_lkp3 as CHG_EFF_DT,
1 as UPDATE_STRATEGY_ACTION,
exp_UPD.source_record_id
FROM
exp_UPD
);


-- Component exp_INS, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_INS AS
(
SELECT
rtr_INS_UPD_INS.OPERATOR_ID as OPERATOR_ID1,
rtr_INS_UPD_INS.COMPANY as COMPANY1,
rtr_INS_UPD_INS.MRI as MRI1,
rtr_INS_UPD_INS.TRL_COUNT as TRL_COUNT1,
rtr_INS_UPD_INS.POL_STATE as POL_STATE1,
rtr_INS_UPD_INS.PFX as PFX1,
rtr_INS_UPD_INS.PNO as PNO1,
rtr_INS_UPD_INS.DATE_O_LOSS as DATE_O_LOSS1,
rtr_INS_UPD_INS.DATE_O_LOSS_DT as DATE_O_LOSS_DT1,
rtr_INS_UPD_INS.SEQNO as SEQNO1,
rtr_INS_UPD_INS.TRANS_ID1 as TRANS_ID11,
rtr_INS_UPD_INS.DIST as DIST1,
rtr_INS_UPD_INS.ADJSYM as ADJSYM1,
rtr_INS_UPD_INS.FAST_TRAC as FAST_TRAC1,
rtr_INS_UPD_INS.GLASBRK as GLASBRK1,
rtr_INS_UPD_INS.SUSP as SUSP1,
rtr_INS_UPD_INS.SAL as SAL1,
rtr_INS_UPD_INS.SUB as SUB1,
rtr_INS_UPD_INS.SUIT_CD1 as SUIT_CD11,
rtr_INS_UPD_INS.SLC_CD as SLC_CD1,
rtr_INS_UPD_INS.REPT_DT as REPT_DT1,
rtr_INS_UPD_INS.REPT_DATE as REPT_DATE1,
rtr_INS_UPD_INS.ACCTG_DT1 as ACCTG_DT11,
rtr_INS_UPD_INS.ACCTG_DATE1 as ACCTG_DATE11,
rtr_INS_UPD_INS.CAUSE_CD1 as CAUSE_CD11,
rtr_INS_UPD_INS.CAUSE_DESC1 as CAUSE_DESC11,
rtr_INS_UPD_INS.COT_PLN1 as COT_PLN11,
rtr_INS_UPD_INS.CAT_CD1 as CAT_CD11,
rtr_INS_UPD_INS.RISK_ID1 as RISK_ID11,
rtr_INS_UPD_INS.CLOSE_CD1 as CLOSE_CD11,
rtr_INS_UPD_INS.CLOSE_DT1 as CLOSE_DT11,
rtr_INS_UPD_INS.CLOSE_DATE1 as CLOSE_DATE11,
rtr_INS_UPD_INS.NO_REO as NO_REO1,
rtr_INS_UPD_INS.REIN as REIN1,
rtr_INS_UPD_INS.ENC_CD as ENC_CD1,
rtr_INS_UPD_INS.AGTNO as AGTNO1,
rtr_INS_UPD_INS.SCNO as SCNO1,
rtr_INS_UPD_INS.INSD_NM1 as INSD_NM11,
rtr_INS_UPD_INS.OCC_CD as OCC_CD1,
rtr_INS_UPD_INS.TIME_O_LOSS as TIME_O_LOSS1,
rtr_INS_UPD_INS.SUBROGATION_DATE as SUBROGATION_DATE1,
rtr_INS_UPD_INS.PURG_CLM_FROM_FOLDER1 as PURG_CLM_FROM_FOLDER11,
rtr_INS_UPD_INS.RECOVERABLE_LOSS_CD as RECOVERABLE_LOSS_CD1,
rtr_INS_UPD_INS.RECOVERABLE_LOSS_AMT as RECOVERABLE_LOSS_AMT1,
rtr_INS_UPD_INS.PREM_FINANCE as PREM_FINANCE1,
rtr_INS_UPD_INS.MONTHLY_BILLING as MONTHLY_BILLING1,
rtr_INS_UPD_INS.HIGH_PERFORM_CODE as HIGH_PERFORM_CODE1,
rtr_INS_UPD_INS.FIBER_GLASS_CODE as FIBER_GLASS_CODE1,
rtr_INS_UPD_INS.INEXPER_DRVR_CODE as INEXPER_DRVR_CODE1,
rtr_INS_UPD_INS.FINANCIAL_RESPONBILITY_CODE as FINANCIAL_RESPONBILITY_CODE1,
rtr_INS_UPD_INS.MISC_DISCOUNT as MISC_DISCOUNT1,
rtr_INS_UPD_INS.HO_DISCOUNT as HO_DISCOUNT1,
rtr_INS_UPD_INS.SM_SP_POLICY_IND as SM_SP_POLICY_IND1,
rtr_INS_UPD_INS.PREV_AGENT as PREV_AGENT1,
rtr_INS_UPD_INS.CHANGE_AGT_DT1 as CHANGE_AGT_DT11,
rtr_INS_UPD_INS.CHANGE_AGT_DATE1 as CHANGE_AGT_DATE11,
rtr_INS_UPD_INS.WC_EFF_YR1 as WC_EFF_YR11,
rtr_INS_UPD_INS.POL_FOLDER_DATE as POL_FOLDER_DATE1,
rtr_INS_UPD_INS.POL_FOLDER_DT as POL_FOLDER_DT1,
rtr_INS_UPD_INS.TRANSFERRED_POL_NBR as TRANSFERRED_POL_NBR1,
rtr_INS_UPD_INS.CLUE_CHANGE_MMYY1 as CLUE_CHANGE_MMYY11,
rtr_INS_UPD_INS.CLUE_REPT_ITEM1 as CLUE_REPT_ITEM11,
rtr_INS_UPD_INS.MISS_FIRE_CLM_IND1 as MISS_FIRE_CLM_IND11,
rtr_INS_UPD_INS.TIMES_NOT_FOUND1 as TIMES_NOT_FOUND11,
rtr_INS_UPD_INS.TOT_RES_AMT1 as TOT_RES_AMT11,
rtr_INS_UPD_INS.TOT_PAID_AMT1 as TOT_PAID_AMT11,
rtr_INS_UPD_INS.AC_VEHICLE_ID_NO as AC_VEHICLE_ID_NO1,
rtr_INS_UPD_INS.AC_DRVERNO as AC_DRVERNO1,
rtr_INS_UPD_INS.AC_DRVERNM as AC_DRVERNM1,
rtr_INS_UPD_INS.AC_ARRP_CHRG_DT as AC_ARRP_CHRG_DT1,
rtr_INS_UPD_INS.AC_ARRP_CHRG_DATE as AC_ARRP_CHRG_DATE1,
rtr_INS_UPD_INS.AC_FATAL_CD as AC_FATAL_CD1,
rtr_INS_UPD_INS.AC_FLEET_ITEM_NO as AC_FLEET_ITEM_NO1,
rtr_INS_UPD_INS.AC_CARYR as AC_CARYR1,
rtr_INS_UPD_INS.AC_MAKE as AC_MAKE1,
rtr_INS_UPD_INS.AC_MODEL as AC_MODEL1,
rtr_INS_UPD_INS.AC_HPTON as AC_HPTON1,
rtr_INS_UPD_INS.AC_VEHICLE_TYPE as AC_VEHICLE_TYPE1,
rtr_INS_UPD_INS.TERR as TERR1,
rtr_INS_UPD_INS.USEX as USEX1,
rtr_INS_UPD_INS.DC as DC1,
rtr_INS_UPD_INS.SYM as SYM1,
rtr_INS_UPD_INS.AC_DISC as AC_DISC1,
rtr_INS_UPD_INS.AC_DRLISC as AC_DRLISC1,
rtr_INS_UPD_INS.AC_DR_DOB as AC_DR_DOB1,
rtr_INS_UPD_INS.AC_DR_DOB_DATE as AC_DR_DOB_DATE11,
rtr_INS_UPD_INS.AC_ARRP_CODE as AC_ARRP_CODE1,
rtr_INS_UPD_INS.AC_CAMPER_BODY as AC_CAMPER_BODY1,
rtr_INS_UPD_INS.out_ECTL_PRGM_ID as out_ECTL_PRGM_ID1,
rtr_INS_UPD_INS.out_ECTL_SRC_ID as out_ECTL_SRC_ID1,
rtr_INS_UPD_INS.out_ECTL_SRC_INST_ID as out_ECTL_SRC_INST_ID1,
rtr_INS_UPD_INS.out_ECTL_BATCH_ID as out_ECTL_BATCH_ID1,
rtr_INS_UPD_INS.out_ORIG_INS_TS as out_ORIG_INS_TS1,
rtr_INS_UPD_INS.out_ECTL_BATCH_START_DATE as out_ECTL_BATCH_START_DATE1,
rtr_INS_UPD_INS.out_CHG_EFF_DT as out_CHG_EFF_DT1,
rtr_INS_UPD_INS.out_CHG_EXP_DT as out_CHG_EXP_DT1,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as out_ECTL_END_DATE,
''NEW'' as out_CHECK1,
rtr_INS_UPD_INS.source_record_id
FROM
rtr_INS_UPD_INS
);


-- Component exp_UPD_INS, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_UPD_INS AS
(
SELECT
rtr_INS_UPD_UPD.CLAIM_SKEY_lkp as CLAIM_SKEY_lkp3,
rtr_INS_UPD_UPD.OPERATOR_ID as OPERATOR_ID3,
rtr_INS_UPD_UPD.COMPANY as COMPANY3,
rtr_INS_UPD_UPD.MRI as MRI3,
rtr_INS_UPD_UPD.TRL_COUNT as TRL_COUNT3,
rtr_INS_UPD_UPD.POL_STATE as POL_STATE3,
rtr_INS_UPD_UPD.PFX as PFX3,
rtr_INS_UPD_UPD.PNO as PNO3,
rtr_INS_UPD_UPD.DATE_O_LOSS as DATE_O_LOSS3,
rtr_INS_UPD_UPD.DATE_O_LOSS_DT as DATE_O_LOSS_DT3,
rtr_INS_UPD_UPD.SEQNO as SEQNO3,
rtr_INS_UPD_UPD.TRANS_ID1 as TRANS_ID13,
rtr_INS_UPD_UPD.DIST as DIST3,
rtr_INS_UPD_UPD.ADJSYM as ADJSYM3,
rtr_INS_UPD_UPD.FAST_TRAC as FAST_TRAC3,
rtr_INS_UPD_UPD.GLASBRK as GLASBRK3,
rtr_INS_UPD_UPD.SUSP as SUSP3,
rtr_INS_UPD_UPD.SAL as SAL3,
rtr_INS_UPD_UPD.SUB as SUB3,
rtr_INS_UPD_UPD.SUIT_CD1 as SUIT_CD13,
rtr_INS_UPD_UPD.SLC_CD as SLC_CD3,
rtr_INS_UPD_UPD.REPT_DT as REPT_DT3,
rtr_INS_UPD_UPD.REPT_DATE as REPT_DATE3,
rtr_INS_UPD_UPD.ACCTG_DT1 as ACCTG_DT13,
rtr_INS_UPD_UPD.ACCTG_DATE1 as ACCTG_DATE13,
rtr_INS_UPD_UPD.CAUSE_CD1 as CAUSE_CD13,
rtr_INS_UPD_UPD.CAUSE_DESC1 as CAUSE_DESC13,
rtr_INS_UPD_UPD.COT_PLN1 as COT_PLN13,
rtr_INS_UPD_UPD.CAT_CD1 as CAT_CD13,
rtr_INS_UPD_UPD.RISK_ID1 as RISK_ID13,
rtr_INS_UPD_UPD.CLOSE_CD1 as CLOSE_CD13,
rtr_INS_UPD_UPD.CLOSE_DT1 as CLOSE_DT13,
rtr_INS_UPD_UPD.CLOSE_DATE1 as CLOSE_DATE13,
rtr_INS_UPD_UPD.NO_REO as NO_REO3,
rtr_INS_UPD_UPD.REIN as REIN3,
rtr_INS_UPD_UPD.ENC_CD as ENC_CD3,
rtr_INS_UPD_UPD.AGTNO as AGTNO3,
rtr_INS_UPD_UPD.SCNO as SCNO3,
rtr_INS_UPD_UPD.INSD_NM1 as INSD_NM13,
rtr_INS_UPD_UPD.OCC_CD as OCC_CD3,
rtr_INS_UPD_UPD.TIME_O_LOSS as TIME_O_LOSS3,
rtr_INS_UPD_UPD.SUBROGATION_DATE as SUBROGATION_DATE3,
rtr_INS_UPD_UPD.PURG_CLM_FROM_FOLDER1 as PURG_CLM_FROM_FOLDER13,
rtr_INS_UPD_UPD.RECOVERABLE_LOSS_CD as RECOVERABLE_LOSS_CD3,
rtr_INS_UPD_UPD.RECOVERABLE_LOSS_AMT as RECOVERABLE_LOSS_AMT3,
rtr_INS_UPD_UPD.PREM_FINANCE as PREM_FINANCE3,
rtr_INS_UPD_UPD.MONTHLY_BILLING as MONTHLY_BILLING3,
rtr_INS_UPD_UPD.HIGH_PERFORM_CODE as HIGH_PERFORM_CODE3,
rtr_INS_UPD_UPD.FIBER_GLASS_CODE as FIBER_GLASS_CODE3,
rtr_INS_UPD_UPD.INEXPER_DRVR_CODE as INEXPER_DRVR_CODE3,
rtr_INS_UPD_UPD.FINANCIAL_RESPONBILITY_CODE as FINANCIAL_RESPONBILITY_CODE3,
rtr_INS_UPD_UPD.MISC_DISCOUNT as MISC_DISCOUNT3,
rtr_INS_UPD_UPD.HO_DISCOUNT as HO_DISCOUNT3,
rtr_INS_UPD_UPD.SM_SP_POLICY_IND as SM_SP_POLICY_IND3,
rtr_INS_UPD_UPD.PREV_AGENT as PREV_AGENT3,
rtr_INS_UPD_UPD.CHANGE_AGT_DT1 as CHANGE_AGT_DT13,
rtr_INS_UPD_UPD.CHANGE_AGT_DATE1 as CHANGE_AGT_DATE13,
rtr_INS_UPD_UPD.WC_EFF_YR1 as WC_EFF_YR13,
rtr_INS_UPD_UPD.POL_FOLDER_DATE as POL_FOLDER_DATE3,
rtr_INS_UPD_UPD.POL_FOLDER_DT as POL_FOLDER_DT3,
rtr_INS_UPD_UPD.TRANSFERRED_POL_NBR as TRANSFERRED_POL_NBR3,
rtr_INS_UPD_UPD.CLUE_CHANGE_MMYY1 as CLUE_CHANGE_MMYY13,
rtr_INS_UPD_UPD.CLUE_REPT_ITEM1 as CLUE_REPT_ITEM13,
rtr_INS_UPD_UPD.MISS_FIRE_CLM_IND1 as MISS_FIRE_CLM_IND13,
rtr_INS_UPD_UPD.TIMES_NOT_FOUND1 as TIMES_NOT_FOUND13,
rtr_INS_UPD_UPD.TOT_RES_AMT1 as TOT_RES_AMT13,
rtr_INS_UPD_UPD.TOT_PAID_AMT1 as TOT_PAID_AMT13,
rtr_INS_UPD_UPD.AC_VEHICLE_ID_NO as AC_VEHICLE_ID_NO3,
rtr_INS_UPD_UPD.AC_DRVERNO as AC_DRVERNO3,
rtr_INS_UPD_UPD.AC_DRVERNM as AC_DRVERNM3,
rtr_INS_UPD_UPD.AC_ARRP_CHRG_DT as AC_ARRP_CHRG_DT3,
rtr_INS_UPD_UPD.AC_ARRP_CHRG_DATE as AC_ARRP_CHRG_DATE3,
rtr_INS_UPD_UPD.AC_FATAL_CD as AC_FATAL_CD3,
rtr_INS_UPD_UPD.AC_FLEET_ITEM_NO as AC_FLEET_ITEM_NO3,
rtr_INS_UPD_UPD.AC_CARYR as AC_CARYR3,
rtr_INS_UPD_UPD.AC_MAKE as AC_MAKE3,
rtr_INS_UPD_UPD.AC_MODEL as AC_MODEL3,
rtr_INS_UPD_UPD.AC_HPTON as AC_HPTON3,
rtr_INS_UPD_UPD.AC_VEHICLE_TYPE as AC_VEHICLE_TYPE3,
rtr_INS_UPD_UPD.TERR as TERR3,
rtr_INS_UPD_UPD.USEX as USEX3,
rtr_INS_UPD_UPD.DC as DC3,
rtr_INS_UPD_UPD.SYM as SYM3,
rtr_INS_UPD_UPD.AC_DISC as AC_DISC3,
rtr_INS_UPD_UPD.AC_DRLISC as AC_DRLISC3,
rtr_INS_UPD_UPD.AC_DR_DOB as AC_DR_DOB3,
rtr_INS_UPD_UPD.AC_ARRP_CODE as AC_ARRP_CODE3,
rtr_INS_UPD_UPD.AC_CAMPER_BODY as AC_CAMPER_BODY3,
rtr_INS_UPD_UPD.out_ECTL_PRGM_ID as out_ECTL_PRGM_ID3,
rtr_INS_UPD_UPD.out_ECTL_SRC_ID as out_ECTL_SRC_ID3,
rtr_INS_UPD_UPD.out_ECTL_SRC_INST_ID as out_ECTL_SRC_INST_ID3,
rtr_INS_UPD_UPD.out_ECTL_BATCH_ID as out_ECTL_BATCH_ID3,
rtr_INS_UPD_UPD.out_ORIG_INS_TS as out_ORIG_INS_TS3,
rtr_INS_UPD_UPD.out_ECTL_BATCH_START_DATE as out_ECTL_BATCH_START_DATE3,
''NEW'' as out_CHECK3,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as out_ECTL_END_DATE,
rtr_INS_UPD_UPD.out_CHG_EFF_DT as out_CHG_EFF_DT3,
rtr_INS_UPD_UPD.out_CHG_EXP_DT as out_CHG_EXP_DT3,
rtr_INS_UPD_UPD.AC_DR_DOB_DATE as AC_DR_DOB_DATE3,
rtr_INS_UPD_UPD.source_record_id
FROM
rtr_INS_UPD_UPD
);


-- Component CLMF_CLAIM_CORE_AUTO_INS, Type TARGET_EXPORT_PREPARE Stage data before exporting
CREATE OR REPLACE TEMPORARY TABLE CLMF_CLAIM_CORE_AUTO_INS AS
(
SELECT
seq_SKEY_GEN.NEXTVAL as CLAIM_SKEY,
exp_INS.OPERATOR_ID1 as OPERATOR_ID,
exp_INS.COMPANY1 as CMPY_CD,
exp_INS.MRI1 as REC_TYPE,
exp_INS.TRL_COUNT1 as TRL_CNT,
exp_INS.POL_STATE1 as PLCY_ST,
exp_INS.PFX1 as PLCY_PREFIX,
exp_INS.PNO1 as PLCY_NBR,
exp_INS.DATE_O_LOSS1 as LOSS_DT,
exp_INS.DATE_O_LOSS_DT1 as LOSS_DATE,
exp_INS.SEQNO1 as SEQ_NBR,
exp_INS.out_CHG_EFF_DT1 as CHG_EFF_DT,
exp_INS.out_CHG_EXP_DT1 as CHG_EXP_DT,
exp_INS.TRANS_ID11 as TRANS_ID,
exp_INS.DIST1 as DIST_CD,
exp_INS.ADJSYM1 as ADJ_SYM,
exp_INS.FAST_TRAC1 as FAST_TRAC_IND,
exp_INS.GLASBRK1 as GLASSBREAK_IND,
exp_INS.SUSP1 as SUSP_IND,
exp_INS.SAL1 as SAL_IND,
exp_INS.SUB1 as SUBR_IND,
exp_INS.SUIT_CD11 as SUIT_CD,
exp_INS.SLC_CD1 as SURVY_LTR_CD,
exp_INS.REPT_DT1 as REPORTED_DT,
exp_INS.REPT_DATE1 as REPORTED_DATE,
exp_INS.ACCTG_DT11 as ACCTG_DT,
exp_INS.ACCTG_DATE11 as ACCTG_DATE,
exp_INS.CAUSE_CD11 as CAUSE_CD,
exp_INS.CAUSE_DESC11 as CAUSE_DESC,
exp_INS.COT_PLN11 as COT_PLN,
exp_INS.CAT_CD11 as CAT_CD,
exp_INS.RISK_ID11 as RISK_ID,
exp_INS.CLOSE_CD11 as CLOSE_CD,
exp_INS.CLOSE_DT11 as CLOSE_DT,
exp_INS.CLOSE_DATE11 as CLOSE_DATE,
exp_INS.NO_REO1 as REOPEN_CNT,
exp_INS.REIN1 as REINSURANCE_CD,
exp_INS.ENC_CD1 as ENCUMBRANCE_CD,
exp_INS.AGTNO1 as AGNT_NBR,
exp_INS.SCNO1 as SVC_NBR,
exp_INS.INSD_NM11 as INSD_NM,
exp_INS.OCC_CD1 as OCP_CD,
exp_INS.TIME_O_LOSS1 as TIME_OF_LOSS,
exp_INS.SUBROGATION_DATE1 as SUBROGATION_DATE,
exp_INS.PURG_CLM_FROM_FOLDER11 as PURG_CLM_FROM_FOLDER,
exp_INS.RECOVERABLE_LOSS_CD1 as RECOV_LOSS_CD,
exp_INS.RECOVERABLE_LOSS_AMT1 as RECOV_LOSS_AMT,
exp_INS.PREM_FINANCE1 as PREM_FINANCE_IND,
exp_INS.MONTHLY_BILLING1 as MONTHLY_BILLING_IND,
exp_INS.HIGH_PERFORM_CODE1 as HIGH_PERFORM_CD,
exp_INS.FIBER_GLASS_CODE1 as FIBER_GLASS_CD,
exp_INS.INEXPER_DRVR_CODE1 as INEXPER_DRVR_CD,
exp_INS.FINANCIAL_RESPONBILITY_CODE1 as FIN_RES_CD,
exp_INS.MISC_DISCOUNT1 as MISC_DISC,
exp_INS.HO_DISCOUNT1 as HO_DISC,
exp_INS.SM_SP_POLICY_IND1 as SM_SP_PLCY_IND,
exp_INS.PREV_AGENT1 as PREV_AGNT,
exp_INS.CHANGE_AGT_DT11 as CHANGE_AGT_DT,
exp_INS.CHANGE_AGT_DATE11 as CHANGE_AGT_DATE,
exp_INS.WC_EFF_YR11 as WC_EFF_YR,
exp_INS.POL_FOLDER_DATE1 as PLCY_FOLDER_DT,
exp_INS.POL_FOLDER_DT1 as PLCY_FOLDER_DATE,
exp_INS.TRANSFERRED_POL_NBR1 as TRANSFERRED_PLCY_NBR,
exp_INS.CLUE_CHANGE_MMYY11 as CLUE_CHANGE_MMYY,
exp_INS.CLUE_REPT_ITEM11 as CLUE_REPT_ITEM,
exp_INS.MISS_FIRE_CLM_IND11 as MISS_FIRE_CLM_IND,
exp_INS.TIMES_NOT_FOUND11 as TIMES_NOT_FOUND,
exp_INS.TOT_RES_AMT11 as TOT_RES_AMT,
exp_INS.TOT_PAID_AMT11 as TOT_PAID_AMT,
exp_INS.AC_VEHICLE_ID_NO1 as VEH_ID_NBR,
exp_INS.AC_DRVERNO1 as DRV_NBR,
exp_INS.AC_DRVERNM1 as DRV_NM,
exp_INS.AC_ARRP_CHRG_DT1 as ARRP_CHRG_DT,
exp_INS.AC_ARRP_CHRG_DATE1 as ARRP_CHRG_DATE,
exp_INS.AC_FATAL_CD1 as FATAL_CD,
exp_INS.AC_FLEET_ITEM_NO1 as FLEET_ITEM_NBR,
exp_INS.AC_CARYR1 as CAR_YR,
exp_INS.AC_MAKE1 as MAKE,
exp_INS.AC_MODEL1 as MODEL,
exp_INS.AC_HPTON1 as HPTON,
exp_INS.AC_VEHICLE_TYPE1 as VEH_TYPE,
exp_INS.TERR1 as TERRITORY,
exp_INS.USEX1 as USER_CLASS_CD,
exp_INS.DC1 as DRV_CLASS_CD,
exp_INS.SYM1 as COST_SYM_CD,
exp_INS.AC_DISC1 as AUTO_DISC,
exp_INS.AC_DRLISC1 as DRV_LIC_NBR,
exp_INS.AC_DR_DOB1 as DRV_DOB_DT,
exp_INS.AC_DR_DOB_DATE11 as DRV_DOB_DATE,
exp_INS.AC_ARRP_CODE1 as ARRP_CD,
exp_INS.AC_CAMPER_BODY1 as CAMPER_BODY_CD,
exp_INS.out_ECTL_BATCH_ID1 as ECTL_BATCH_ID,
exp_INS.out_ORIG_INS_TS1 as ECTL_ORIG_INS_TS,
exp_INS.out_ORIG_INS_TS1 as ECTL_MODIFY_TS,
exp_INS.out_ECTL_SRC_ID1 as ECTL_SRC_ID,
exp_INS.out_ECTL_SRC_INST_ID1 as ECTL_SRC_INST_ID,
exp_INS.out_ECTL_PRGM_ID1 as ECTL_PRGM_ID,
exp_INS.out_CHECK1 as ECTL_TX_CD,
exp_INS.out_ECTL_BATCH_START_DATE1 as ECTL_START_DATE,
exp_INS.out_ECTL_END_DATE as ECTL_END_DATE
FROM
exp_INS
);


-- Component CLMF_CLAIM_CORE_AUTO_INS, Type EXPORT_DATA Exporting data
;


-- Component CLMF_CLAIM_CORE_AUTO_INS_NK, Type TARGET 
INSERT INTO DB_T_CORE_PROD.CLMF_CLAIM_CORE
(
CLAIM_SKEY,
OPERATOR_ID,
CMPY_CD,
REC_TYPE,
TRL_CNT,
PLCY_ST,
PLCY_PREFIX,
PLCY_NBR,
LOSS_DT,
LOSS_DATE,
SEQ_NBR,
CHG_EFF_DT,
CHG_EXP_DT,
TRANS_ID,
DIST_CD,
ADJ_SYM,
FAST_TRAC_IND,
GLASSBREAK_IND,
SUSP_IND,
SAL_IND,
SUBR_IND,
SUIT_CD,
SURVY_LTR_CD,
REPORTED_DT,
REPORTED_DATE,
ACCTG_DT,
ACCTG_DATE,
CAUSE_CD,
CAUSE_DESC,
COT_PLN,
CAT_CD,
RISK_ID,
CLOSE_CD,
CLOSE_DT,
CLOSE_DATE,
REOPEN_CNT,
REINSURANCE_CD,
ENCUMBRANCE_CD,
AGNT_NBR,
SVC_NBR,
INSD_NM,
OCP_CD,
TIME_OF_LOSS,
SUBROGATION_DATE,
PURG_CLM_FROM_FOLDER,
RECOV_LOSS_CD,
RECOV_LOSS_AMT,
PREM_FINANCE_IND,
MONTHLY_BILLING_IND,
HIGH_PERFORM_CD,
FIBER_GLASS_CD,
INEXPER_DRVR_CD,
FIN_RES_CD,
MISC_DISC,
HO_DISC,
SM_SP_PLCY_IND,
PREV_AGNT,
CHANGE_AGT_DT,
CHANGE_AGT_DATE,
WC_EFF_YR,
PLCY_FOLDER_DT,
PLCY_FOLDER_DATE,
TRANSFERRED_PLCY_NBR,
CLUE_CHANGE_MMYY,
CLUE_REPT_ITEM,
MISS_FIRE_CLM_IND,
TIMES_NOT_FOUND,
TOT_RES_AMT,
TOT_PAID_AMT,
VEH_ID_NBR,
DRV_NBR,
DRV_NM,
ARRP_CHRG_DT,
ARRP_CHRG_DATE,
FATAL_CD,
FLEET_ITEM_NBR,
CAR_YR,
MAKE,
MODEL,
HPTON,
VEH_TYPE,
TERRITORY,
USER_CLASS_CD,
DRV_CLASS_CD,
COST_SYM_CD,
AUTO_DISC,
DRV_LIC_NBR,
DRV_DOB_DT,
DRV_DOB_DATE,
ARRP_CD,
CAMPER_BODY_CD,
ECTL_BATCH_ID,
ECTL_ORIG_INS_TS,
ECTL_MODIFY_TS,
ECTL_SRC_ID,
ECTL_SRC_INST_ID,
ECTL_PRGM_ID,
ECTL_TX_CD,
ECTL_START_DATE,
ECTL_END_DATE
)
SELECT
exp_UPD_INS.CLAIM_SKEY_lkp3 as CLAIM_SKEY,
exp_UPD_INS.OPERATOR_ID3 as OPERATOR_ID,
exp_UPD_INS.COMPANY3 as CMPY_CD,
exp_UPD_INS.MRI3 as REC_TYPE,
exp_UPD_INS.TRL_COUNT3 as TRL_CNT,
exp_UPD_INS.POL_STATE3 as PLCY_ST,
exp_UPD_INS.PFX3 as PLCY_PREFIX,
exp_UPD_INS.PNO3 as PLCY_NBR,
exp_UPD_INS.DATE_O_LOSS3 as LOSS_DT,
exp_UPD_INS.DATE_O_LOSS_DT3 as LOSS_DATE,
exp_UPD_INS.SEQNO3 as SEQ_NBR,
exp_UPD_INS.out_CHG_EFF_DT3 as CHG_EFF_DT,
exp_UPD_INS.out_CHG_EXP_DT3 as CHG_EXP_DT,
exp_UPD_INS.TRANS_ID13 as TRANS_ID,
exp_UPD_INS.DIST3 as DIST_CD,
exp_UPD_INS.ADJSYM3 as ADJ_SYM,
exp_UPD_INS.FAST_TRAC3 as FAST_TRAC_IND,
exp_UPD_INS.GLASBRK3 as GLASSBREAK_IND,
exp_UPD_INS.SUSP3 as SUSP_IND,
exp_UPD_INS.SAL3 as SAL_IND,
exp_UPD_INS.SUB3 as SUBR_IND,
exp_UPD_INS.SUIT_CD13 as SUIT_CD,
exp_UPD_INS.SLC_CD3 as SURVY_LTR_CD,
exp_UPD_INS.REPT_DT3 as REPORTED_DT,
exp_UPD_INS.REPT_DATE3 as REPORTED_DATE,
exp_UPD_INS.ACCTG_DT13 as ACCTG_DT,
exp_UPD_INS.ACCTG_DATE13 as ACCTG_DATE,
exp_UPD_INS.CAUSE_CD13 as CAUSE_CD,
exp_UPD_INS.CAUSE_DESC13 as CAUSE_DESC,
exp_UPD_INS.COT_PLN13 as COT_PLN,
exp_UPD_INS.CAT_CD13 as CAT_CD,
exp_UPD_INS.RISK_ID13 as RISK_ID,
exp_UPD_INS.CLOSE_CD13 as CLOSE_CD,
exp_UPD_INS.CLOSE_DT13 as CLOSE_DT,
exp_UPD_INS.CLOSE_DATE13 as CLOSE_DATE,
exp_UPD_INS.NO_REO3 as REOPEN_CNT,
exp_UPD_INS.REIN3 as REINSURANCE_CD,
exp_UPD_INS.ENC_CD3 as ENCUMBRANCE_CD,
exp_UPD_INS.AGTNO3 as AGNT_NBR,
exp_UPD_INS.SCNO3 as SVC_NBR,
exp_UPD_INS.INSD_NM13 as INSD_NM,
exp_UPD_INS.OCC_CD3 as OCP_CD,
exp_UPD_INS.TIME_O_LOSS3 as TIME_OF_LOSS,
exp_UPD_INS.SUBROGATION_DATE3 as SUBROGATION_DATE,
exp_UPD_INS.PURG_CLM_FROM_FOLDER13 as PURG_CLM_FROM_FOLDER,
exp_UPD_INS.RECOVERABLE_LOSS_CD3 as RECOV_LOSS_CD,
exp_UPD_INS.RECOVERABLE_LOSS_AMT3 as RECOV_LOSS_AMT,
exp_UPD_INS.PREM_FINANCE3 as PREM_FINANCE_IND,
exp_UPD_INS.MONTHLY_BILLING3 as MONTHLY_BILLING_IND,
exp_UPD_INS.HIGH_PERFORM_CODE3 as HIGH_PERFORM_CD,
exp_UPD_INS.FIBER_GLASS_CODE3 as FIBER_GLASS_CD,
exp_UPD_INS.INEXPER_DRVR_CODE3 as INEXPER_DRVR_CD,
exp_UPD_INS.FINANCIAL_RESPONBILITY_CODE3 as FIN_RES_CD,
exp_UPD_INS.MISC_DISCOUNT3 as MISC_DISC,
exp_UPD_INS.HO_DISCOUNT3 as HO_DISC,
exp_UPD_INS.SM_SP_POLICY_IND3 as SM_SP_PLCY_IND,
exp_UPD_INS.PREV_AGENT3 as PREV_AGNT,
exp_UPD_INS.CHANGE_AGT_DT13 as CHANGE_AGT_DT,
exp_UPD_INS.CHANGE_AGT_DATE13 as CHANGE_AGT_DATE,
exp_UPD_INS.WC_EFF_YR13 as WC_EFF_YR,
exp_UPD_INS.POL_FOLDER_DATE3 as PLCY_FOLDER_DT,
exp_UPD_INS.POL_FOLDER_DT3 as PLCY_FOLDER_DATE,
exp_UPD_INS.TRANSFERRED_POL_NBR3 as TRANSFERRED_PLCY_NBR,
exp_UPD_INS.CLUE_CHANGE_MMYY13 as CLUE_CHANGE_MMYY,
exp_UPD_INS.CLUE_REPT_ITEM13 as CLUE_REPT_ITEM,
exp_UPD_INS.MISS_FIRE_CLM_IND13 as MISS_FIRE_CLM_IND,
exp_UPD_INS.TIMES_NOT_FOUND13 as TIMES_NOT_FOUND,
exp_UPD_INS.TOT_RES_AMT13 as TOT_RES_AMT,
exp_UPD_INS.TOT_PAID_AMT13 as TOT_PAID_AMT,
exp_UPD_INS.AC_VEHICLE_ID_NO3 as VEH_ID_NBR,
exp_UPD_INS.AC_DRVERNO3 as DRV_NBR,
exp_UPD_INS.AC_DRVERNM3 as DRV_NM,
exp_UPD_INS.AC_ARRP_CHRG_DT3 as ARRP_CHRG_DT,
exp_UPD_INS.AC_ARRP_CHRG_DATE3 as ARRP_CHRG_DATE,
exp_UPD_INS.AC_FATAL_CD3 as FATAL_CD,
exp_UPD_INS.AC_FLEET_ITEM_NO3 as FLEET_ITEM_NBR,
exp_UPD_INS.AC_CARYR3 as CAR_YR,
exp_UPD_INS.AC_MAKE3 as MAKE,
exp_UPD_INS.AC_MODEL3 as MODEL,
exp_UPD_INS.AC_HPTON3 as HPTON,
exp_UPD_INS.AC_VEHICLE_TYPE3 as VEH_TYPE,
exp_UPD_INS.TERR3 as TERRITORY,
exp_UPD_INS.USEX3 as USER_CLASS_CD,
exp_UPD_INS.DC3 as DRV_CLASS_CD,
exp_UPD_INS.SYM3 as COST_SYM_CD,
exp_UPD_INS.AC_DISC3 as AUTO_DISC,
exp_UPD_INS.AC_DRLISC3 as DRV_LIC_NBR,
exp_UPD_INS.AC_DR_DOB3 as DRV_DOB_DT,
exp_UPD_INS.AC_DR_DOB_DATE3 as DRV_DOB_DATE,
exp_UPD_INS.AC_ARRP_CODE3 as ARRP_CD,
exp_UPD_INS.AC_CAMPER_BODY3 as CAMPER_BODY_CD,
exp_UPD_INS.out_ECTL_BATCH_ID3 as ECTL_BATCH_ID,
exp_UPD_INS.out_ORIG_INS_TS3 as ECTL_ORIG_INS_TS,
exp_UPD_INS.out_ORIG_INS_TS3 as ECTL_MODIFY_TS,
exp_UPD_INS.out_ECTL_SRC_ID3 as ECTL_SRC_ID,
exp_UPD_INS.out_ECTL_SRC_INST_ID3 as ECTL_SRC_INST_ID,
exp_UPD_INS.out_ECTL_PRGM_ID3 as ECTL_PRGM_ID,
exp_UPD_INS.out_CHECK3 as ECTL_TX_CD,
exp_UPD_INS.out_ECTL_BATCH_START_DATE3 as ECTL_START_DATE,
exp_UPD_INS.out_ECTL_END_DATE as ECTL_END_DATE
FROM
exp_UPD_INS;


-- Component CLMF_CLAIM_CORE_AUTO_UPD, Type TARGET 
/* Perform Updates */
MERGE INTO DB_T_CORE_PROD.CLMF_CLAIM_CORE
USING upd_CLMF_CLAIM_CORE
ON (CLAIM_SKEY = upd_CLMF_CLAIM_CORE.CLAIM_SKEY_lkp3 and DB_T_CORE_PROD.CLMF_CLAIM_CORe.CHG_EFF_DT = upd_CLMF_CLAIM_CORE.CHG_EFF_DT)
WHEN MATCHED THEN UPDATE SET
CHG_EXP_DT = upd_CLMF_CLAIM_CORE.CHG_EXP_DT, ECTL_BATCH_ID = upd_CLMF_CLAIM_CORE.out_ECTL_BATCH_ID3, ECTL_MODIFY_TS = upd_CLMF_CLAIM_CORE.out_ORIG_INS_TS3, 
--ECTL_TX_CD = upd_CLMF_CLAIM_CORE.ECTL_TX_CD, 
ECTL_END_DATE = upd_CLMF_CLAIM_CORE.out_ECTL_END_DT;


END; ';