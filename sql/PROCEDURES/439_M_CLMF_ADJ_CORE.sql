-- Object Type: PROCEDURES
CREATE OR REPLACE PROCEDURE ALFA_EDW_DEV.PUBLIC.M_CLMF_ADJ_CORE("RUN_ID" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS ' DECLARE PROG_NM varchar;
ACT_PROJ_ID varchar;
BATCH_ACTIVE_IND varchar;
TABLE_NM varchar;
BEGIN 

PROG_NM:='' ''; 
TABLE_NM:='' ''; 
BATCH_ACTIVE_IND:=(select ectl_active_ind from DB_T_CTRL_FIN_PROD.ECTL_BATCH_INFO where ECTL_BATCH_ID= :run_id); 
ACT_PROJ_ID:=(select ectl_proj_id from DB_T_CTRL_FIN_PROD.ECTL_BATCH_INFO where ECTL_BATCH_ID= :run_id); 

-- Component LKP_ECTL_PRGM_PARAM, Type Prerequisite Lookup Object 
CREATE OR REPLACE TEMPORARY TABLE LKP_ECTL_PRGM_PARAM AS
(
SELECT
ECTL_PARAM_VALUE,
ECTL_PARAM_DESC
FROM DB_T_CTRL_FIN_PROD.ECTL_PRGM_PARAM
);


-- Component SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1 AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as OPERATOR_ID,
$2 as COMPANY,
$3 as MRI,
$4 as TRL_COUNT,
$5 as POL_STATE,
$6 as PFX,
$7 as PNO,
$8 as DATE_O_LOSS,
$9 as DATE_O_LOSS_DATE,
$10 as SEQNO,
$11 as TRANS_ID,
$12 as DIST,
$13 as ADJSYM,
$14 as AE_PAIDCD,
$15 as AE_PAID_DT,
$16 as AE_PAID_DATE,
$17 as AE_ACCTG_DT,
$18 as AE_ACCTG_DATE,
$19 as AE_TOTAMT,
$20 as AE_NOMEALS,
$21 as AE_MEALAMT,
$22 as AE_NONIGHTS,
$23 as AE_HOTELAMT,
$24 as AE_TELE,
$25 as AE_POSTAGE,
$26 as AE_FILMDEV,
$27 as AE_PATLREP,
$28 as AE_PARK,
$29 as AE_CARNO,
$30 as AE_CARREPR,
$31 as AE_OTCAREX,
$32 as AE_OTEXP,
$33 as FILLER_2,
$34 as CDN_PFX,
$35 as CDN_DNO,
$36 as AC_VEHICLE_ID_NO,
$37 as AC_DRVERNO,
$38 as AC_DRVERNM,
$39 as AC_ARRP_CHRG_DT,
$40 as AC_ARRP_CHRG_DATE,
$41 as AC_FATAL_CD,
$42 as AC_FLEET_ITEM_NO,
$43 as AC_CARYR,
$44 as AC_MAKE,
$45 as AC_MODEL,
$46 as AC_HPTON,
$47 as AC_VEHICLE_TYPE,
$48 as TERR,
$49 as USEX,
$50 as DC,
$51 as SYM,
$52 as FILLER_3,
$53 as AC_DISC,
$54 as AC_DRLISC,
$55 as AC_DR_DOB,
$56 as AC_DR_DOB_DATE,
$57 as AC_ARRP_CODE,
$58 as AC_CAMPER_BODY,
$59 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT
STG_CLMF_ADJ_NO_TRL.OPERATOR_ID,
STG_CLMF_ADJ_NO_TRL.COMPANY,
STG_CLMF_ADJ_NO_TRL.MRI,
STG_CLMF_ADJ_NO_TRL.TRL_COUNT,
STG_CLMF_ADJ_NO_TRL.POL_STATE,
STG_CLMF_ADJ_NO_TRL.PFX,
STG_CLMF_ADJ_NO_TRL.PNO,
STG_CLMF_ADJ_NO_TRL.DATE_O_LOSS,
STG_CLMF_ADJ_NO_TRL.DATE_O_LOSS_DATE,
STG_CLMF_ADJ_NO_TRL.SEQNO,
STG_CLMF_ADJ_NO_TRL.TRANS_ID,
STG_CLMF_ADJ_NO_TRL.DIST,
STG_CLMF_ADJ_NO_TRL.ADJSYM,
STG_CLMF_ADJ_NO_TRL.AE_PAIDCD,
STG_CLMF_ADJ_NO_TRL.AE_PAID_DT,
STG_CLMF_ADJ_NO_TRL.AE_PAID_DATE,
STG_CLMF_ADJ_NO_TRL.AE_ACCTG_DT,
STG_CLMF_ADJ_NO_TRL.AE_ACCTG_DATE,
STG_CLMF_ADJ_NO_TRL.AE_TOTAMT,
STG_CLMF_ADJ_NO_TRL.AE_NOMEALS,
STG_CLMF_ADJ_NO_TRL.AE_MEALAMT,
STG_CLMF_ADJ_NO_TRL.AE_NONIGHTS,
STG_CLMF_ADJ_NO_TRL.AE_HOTELAMT,
STG_CLMF_ADJ_NO_TRL.AE_TELE,
STG_CLMF_ADJ_NO_TRL.AE_POSTAGE,
STG_CLMF_ADJ_NO_TRL.AE_FILMDEV,
STG_CLMF_ADJ_NO_TRL.AE_PATLREP,
STG_CLMF_ADJ_NO_TRL.AE_PARK,
STG_CLMF_ADJ_NO_TRL.AE_CARNO,
STG_CLMF_ADJ_NO_TRL.AE_CARREPR,
STG_CLMF_ADJ_NO_TRL.AE_OTCAREX,
STG_CLMF_ADJ_NO_TRL.AE_OTEXP,
STG_CLMF_ADJ_NO_TRL.FILLER_2,
STG_CLMF_ADJ_NO_TRL.CDN_PFX,
STG_CLMF_ADJ_NO_TRL.CDN_DNO,
STG_CLMF_ADJ_NO_TRL.AC_VEHICLE_ID_NO,
STG_CLMF_ADJ_NO_TRL.AC_DRVERNO,
STG_CLMF_ADJ_NO_TRL.AC_DRVERNM,
STG_CLMF_ADJ_NO_TRL.AC_ARRP_CHRG_DT,
STG_CLMF_ADJ_NO_TRL.AC_ARRP_CHRG_DATE,
STG_CLMF_ADJ_NO_TRL.AC_FATAL_CD,
STG_CLMF_ADJ_NO_TRL.AC_FLEET_ITEM_NO,
STG_CLMF_ADJ_NO_TRL.AC_CARYR,
STG_CLMF_ADJ_NO_TRL.AC_MAKE,
STG_CLMF_ADJ_NO_TRL.AC_MODEL,
STG_CLMF_ADJ_NO_TRL.AC_HPTON,
STG_CLMF_ADJ_NO_TRL.AC_VEHICLE_TYPE,
STG_CLMF_ADJ_NO_TRL.TERR,
STG_CLMF_ADJ_NO_TRL.USEX,
STG_CLMF_ADJ_NO_TRL.DC,
STG_CLMF_ADJ_NO_TRL.SYM,
STG_CLMF_ADJ_NO_TRL.FILLER_3,
STG_CLMF_ADJ_NO_TRL.AC_DISC,
STG_CLMF_ADJ_NO_TRL.AC_DRLISC,
STG_CLMF_ADJ_NO_TRL.AC_DR_DOB,
STG_CLMF_ADJ_NO_TRL.AC_DR_DOB_DATE,
STG_CLMF_ADJ_NO_TRL.AC_ARRP_CODE,
STG_CLMF_ADJ_NO_TRL.AC_CAMPER_BODY
FROM DB_T_STAG_PROD.STG_CLMF_ADJ_NO_TRL
) SRC
)
);


-- Component exp_HOLD_STAG_DATA1, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_HOLD_STAG_DATA1 AS
(
SELECT
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.OPERATOR_ID as OPERATOR_ID,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.COMPANY as COMPANY,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.MRI as MRI,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.TRL_COUNT as TRL_COUNT,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.POL_STATE as POL_STATE,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.PFX as PFX,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.PNO as PNO,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.DATE_O_LOSS as DATE_O_LOSS,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.DATE_O_LOSS_DATE as DATE_O_LOSS_DATE,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.SEQNO as SEQNO,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.TRANS_ID as TRANS_ID,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.DIST as DIST,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.ADJSYM as ADJSYM,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_PAIDCD as AE_PAIDCD,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_PAID_DT as AE_PAID_DT,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_PAID_DATE as AE_PAID_DATE,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_ACCTG_DT as AE_ACCTG_DT,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_ACCTG_DATE as AE_ACCTG_DATE,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_TOTAMT as AE_TOTAMT,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_NOMEALS as AE_NOMEALS,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_MEALAMT as AE_MEALAMT,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_NONIGHTS as AE_NONIGHTS,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_HOTELAMT as AE_HOTELAMT,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_TELE as AE_TELE,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_POSTAGE as AE_POSTAGE,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_FILMDEV as AE_FILMDEV,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_PATLREP as AE_PATLREP,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_PARK as AE_PARK,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_CARNO as AE_CARNO,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_CARREPR as AE_CARREPR,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_OTCAREX as AE_OTCAREX,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.AE_OTEXP as AE_OTEXP,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.FILLER_2 as FILLER_2,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.CDN_PFX as CDN_PFX,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.CDN_DNO as CDN_DNO,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as EXP_DATE,
LKP_1.ECTL_PARAM_VALUE /* replaced lookup LKP_ECTL_PRGM_PARAM */ as var_CHG_EFF_DATE,
TO_DATE ( var_CHG_EFF_DATE , ''YYYY-MM-DD'' ) as out_CHG_EFF_DATE,
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.source_record_id,
row_number() over (partition by SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.source_record_id order by SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1.source_record_id) as RNK
FROM
SQ_Shortcut_to_STG_CLMF_ADJ_NO_TRL1
LEFT JOIN LKP_ECTL_PRGM_PARAM LKP_1 ON LKP_1.ECTL_PARAM_DESC = ''CLAIM MASTER FEED DATE''
QUALIFY RNK = 1
);


-- Component LKP_ADJ_CORE, Type LOOKUP 
CREATE OR REPLACE TEMPORARY TABLE LKP_ADJ_CORE AS
(
SELECT
LKP.ADJ_SKEY,
LKP.OPERATOR_ID,
LKP.CMPY_CD,
LKP.REC_TYPE,
LKP.TRL_CNT,
LKP.PLCY_ST,
LKP.PLCY_PREFIX,
LKP.DRFT_NBR,
LKP.LOSS_DT,
LKP.LOSS_DATE,
LKP.DRFT_NBR_PFX,
LKP.CHG_EFF_DT,
LKP.CHG_EXP_DT,
LKP.TRANS_ID,
LKP.DIST_CD,
LKP.ADJ_SYM,
LKP.PAID_CD,
LKP.PAID_DT,
LKP.PAID_DATE,
LKP.ACCTG_DT,
LKP.ACCTG_DATE,
LKP.TOT_AMT,
LKP.NBR_OF_MEALS,
LKP.MEAL_AMT,
LKP.NBR_OF_NIGHTS,
LKP.HOTEL_AMT,
LKP.TELEPHONE_COST,
LKP.POSTAGE_COST,
LKP.FILM_DEV,
LKP.PATROL_EXP,
LKP.PARKING_EXP,
LKP.CAR_NBR,
LKP.CAR_REPR,
LKP.OTH_CAR_EXP,
LKP.OTH_EXP,
LKP.CHARG_DRFT_NBR_PFX,
LKP.CHARG_DRFT_NBR,
exp_HOLD_STAG_DATA1.source_record_id,
ROW_NUMBER() OVER(PARTITION BY exp_HOLD_STAG_DATA1.source_record_id ORDER BY LKP.ADJ_SKEY asc,LKP.OPERATOR_ID asc,LKP.CMPY_CD asc,LKP.REC_TYPE asc,LKP.TRL_CNT asc,LKP.PLCY_ST asc,LKP.PLCY_PREFIX asc,LKP.DRFT_NBR asc,LKP.LOSS_DT asc,LKP.LOSS_DATE asc,LKP.DRFT_NBR_PFX asc,LKP.CHG_EFF_DT asc,LKP.CHG_EXP_DT asc,LKP.TRANS_ID asc,LKP.DIST_CD asc,LKP.ADJ_SYM asc,LKP.PAID_CD asc,LKP.PAID_DT asc,LKP.PAID_DATE asc,LKP.ACCTG_DT asc,LKP.ACCTG_DATE asc,LKP.TOT_AMT asc,LKP.NBR_OF_MEALS asc,LKP.MEAL_AMT asc,LKP.NBR_OF_NIGHTS asc,LKP.HOTEL_AMT asc,LKP.TELEPHONE_COST asc,LKP.POSTAGE_COST asc,LKP.FILM_DEV asc,LKP.PATROL_EXP asc,LKP.PARKING_EXP asc,LKP.CAR_NBR asc,LKP.CAR_REPR asc,LKP.OTH_CAR_EXP asc,LKP.OTH_EXP asc,LKP.CHARG_DRFT_NBR_PFX asc,LKP.CHARG_DRFT_NBR asc) RNK
FROM
exp_HOLD_STAG_DATA1
LEFT JOIN (
SELECT
ADJ_SKEY,
OPERATOR_ID,
CMPY_CD,
REC_TYPE,
TRL_CNT,
PLCY_ST,
PLCY_PREFIX,
DRFT_NBR,
LOSS_DT,
LOSS_DATE,
DRFT_NBR_PFX,
CHG_EFF_DT,
CHG_EXP_DT,
TRANS_ID,
DIST_CD,
ADJ_SYM,
PAID_CD,
PAID_DT,
PAID_DATE,
ACCTG_DT,
ACCTG_DATE,
TOT_AMT,
NBR_OF_MEALS,
MEAL_AMT,
NBR_OF_NIGHTS,
HOTEL_AMT,
TELEPHONE_COST,
POSTAGE_COST,
FILM_DEV,
PATROL_EXP,
PARKING_EXP,
CAR_NBR,
CAR_REPR,
OTH_CAR_EXP,
OTH_EXP,
CHARG_DRFT_NBR_PFX,
CHARG_DRFT_NBR
FROM DB_T_CORE_PROD.CLMF_ADJ_CORE
) LKP ON LKP.DRFT_NBR = exp_HOLD_STAG_DATA1.PNO AND LKP.CHG_EXP_DT = exp_HOLD_STAG_DATA1.EXP_DATE
QUALIFY RNK = 1
);


-- Component exp_CHECK, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_CHECK AS
(
SELECT
LKP_ADJ_CORE.ADJ_SKEY as ADJ_SKEY_lkp,
LKP_ADJ_CORE.OPERATOR_ID as OPERATOR_ID_lkp,
LKP_ADJ_CORE.CMPY_CD as CMPY_CD_lkp,
LKP_ADJ_CORE.REC_TYPE as REC_TYPE_lkp,
LKP_ADJ_CORE.TRL_CNT as TRL_CNT_lkp,
LKP_ADJ_CORE.PLCY_PREFIX as PLCY_PREFIX_lkp,
LKP_ADJ_CORE.DRFT_NBR as DRFT_NBR_lkp,
LKP_ADJ_CORE.LOSS_DT as LOSS_DT_lkp,
LKP_ADJ_CORE.PLCY_ST as PLCY_ST_lkp,
LKP_ADJ_CORE.DRFT_NBR_PFX as DRFT_NBR_PFX_lkp,
LKP_ADJ_CORE.TRANS_ID as TRANS_ID_lkp,
LKP_ADJ_CORE.DIST_CD as DIST_CD_lkp,
LKP_ADJ_CORE.ADJ_SYM as ADJ_SYM_lkp,
LKP_ADJ_CORE.PAID_CD as PAID_CD_lkp,
LKP_ADJ_CORE.PAID_DT as PAID_DT_lkp,
LKP_ADJ_CORE.ACCTG_DT as ACCTG_DT_lkp,
LKP_ADJ_CORE.TOT_AMT as TOT_AMT_lkp,
LKP_ADJ_CORE.NBR_OF_MEALS as NBR_OF_MEALS_lkp,
LKP_ADJ_CORE.MEAL_AMT as MEAL_AMT_lkp,
LKP_ADJ_CORE.NBR_OF_NIGHTS as NBR_OF_NIGHTS_lkp,
LKP_ADJ_CORE.HOTEL_AMT as HOTEL_AMT_lkp,
LKP_ADJ_CORE.TELEPHONE_COST as TELEPHONE_COST_lkp,
LKP_ADJ_CORE.POSTAGE_COST as POSTAGE_COST_lkp,
LKP_ADJ_CORE.FILM_DEV as FILM_DEV_lkp,
LKP_ADJ_CORE.PATROL_EXP as PATROL_EXP_lkp,
LKP_ADJ_CORE.PARKING_EXP as PARKING_EXP_lkp,
LKP_ADJ_CORE.CAR_NBR as CAR_NBR_lkp,
LKP_ADJ_CORE.CAR_REPR as CAR_REPR_lkp,
LKP_ADJ_CORE.OTH_CAR_EXP as OTH_CAR_EXP_lkp,
LKP_ADJ_CORE.OTH_EXP as OTH_EXP_lkp,
LKP_ADJ_CORE.CHARG_DRFT_NBR_PFX as CHARG_DRFT_NBR_PFX_lkp,
LKP_ADJ_CORE.CHARG_DRFT_NBR as CHARG_DRFT_NBR_lkp,
LKP_ADJ_CORE.CHG_EFF_DT as CHG_EFF_DT_lkp,
LKP_ADJ_CORE.CHG_EXP_DT as CHG_EXP_DT_lkp,
LKP_ADJ_CORE.LOSS_DATE as LOSS_DATE_lkp,
LKP_ADJ_CORE.PAID_DATE as PAID_DATE_lkp,
LKP_ADJ_CORE.ACCTG_DATE as ACCTG_DATE_lkp,
exp_HOLD_STAG_DATA1.OPERATOR_ID as OPERATOR_ID,
exp_HOLD_STAG_DATA1.COMPANY as COMPANY,
exp_HOLD_STAG_DATA1.MRI as MRI,
exp_HOLD_STAG_DATA1.TRL_COUNT as TRL_COUNT,
exp_HOLD_STAG_DATA1.POL_STATE as POL_STATE,
exp_HOLD_STAG_DATA1.PFX as PFX,
exp_HOLD_STAG_DATA1.PNO as PNO,
exp_HOLD_STAG_DATA1.DATE_O_LOSS as DATE_O_LOSS,
exp_HOLD_STAG_DATA1.DATE_O_LOSS_DATE as DATE_O_LOSS_DATE,
exp_HOLD_STAG_DATA1.SEQNO as SEQNO,
exp_HOLD_STAG_DATA1.TRANS_ID as TRANS_ID,
exp_HOLD_STAG_DATA1.DIST as DIST,
exp_HOLD_STAG_DATA1.ADJSYM as ADJSYM,
exp_HOLD_STAG_DATA1.AE_PAIDCD as AE_PAIDCD,
exp_HOLD_STAG_DATA1.AE_PAID_DT as AE_PAID_DT,
exp_HOLD_STAG_DATA1.AE_PAID_DATE as AE_PAID_DATE,
exp_HOLD_STAG_DATA1.AE_ACCTG_DT as AE_ACCTG_DT,
exp_HOLD_STAG_DATA1.AE_ACCTG_DATE as AE_ACCTG_DATE,
exp_HOLD_STAG_DATA1.AE_TOTAMT as AE_TOTAMT,
exp_HOLD_STAG_DATA1.AE_NOMEALS as AE_NOMEALS,
exp_HOLD_STAG_DATA1.AE_MEALAMT as AE_MEALAMT,
exp_HOLD_STAG_DATA1.AE_NONIGHTS as AE_NONIGHTS,
exp_HOLD_STAG_DATA1.AE_HOTELAMT as AE_HOTELAMT,
exp_HOLD_STAG_DATA1.AE_TELE as AE_TELE,
exp_HOLD_STAG_DATA1.AE_POSTAGE as AE_POSTAGE,
exp_HOLD_STAG_DATA1.AE_FILMDEV as AE_FILMDEV,
exp_HOLD_STAG_DATA1.AE_PATLREP as AE_PATLREP,
exp_HOLD_STAG_DATA1.AE_PARK as AE_PARK,
exp_HOLD_STAG_DATA1.AE_CARNO as AE_CARNO,
exp_HOLD_STAG_DATA1.AE_CARREPR as AE_CARREPR,
exp_HOLD_STAG_DATA1.AE_OTCAREX as AE_OTCAREX,
exp_HOLD_STAG_DATA1.AE_OTEXP as AE_OTEXP,
exp_HOLD_STAG_DATA1.FILLER_2 as FILLER_2,
exp_HOLD_STAG_DATA1.CDN_PFX as CDN_PFX,
exp_HOLD_STAG_DATA1.CDN_DNO as CDN_DNO,
:PROG_NM as out_PRGM_NM,
:ACT_PROJ_ID as out_ACT_PROJ_ID,
:BATCH_ACTIVE_IND as out_BATCH_ACTIVE_IND,
:TABLE_NM as out_TABLE_NAME,
:ACT_PROJ_ID as IN_ACT_PROJ_ID,
:BATCH_ACTIVE_IND as IN_BATCH_ACTIVE_IND,
''m_STG_FIN_CLM'' IN_PRGM_NM,
:TABLE_NM IN_TABLE_NM,
CASE WHEN LKP_ADJ_CORE.ADJ_SKEY IS NULL THEN ''INS'' ELSE CASE WHEN CASE WHEN LKP_ADJ_CORE.PAID_DT IS NULL THEN 0 ELSE LKP_ADJ_CORE.PAID_DT END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_PAID_DT IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_PAID_DT END OR CASE WHEN LKP_ADJ_CORE.ACCTG_DT IS NULL THEN 0 ELSE LKP_ADJ_CORE.ACCTG_DT END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_ACCTG_DT IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_ACCTG_DT END OR CASE WHEN LKP_ADJ_CORE.LOSS_DT IS NULL THEN 0 ELSE LKP_ADJ_CORE.LOSS_DT END <> CASE WHEN exp_HOLD_STAG_DATA1.DATE_O_LOSS IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.DATE_O_LOSS END OR CASE WHEN LKP_ADJ_CORE.CMPY_CD IS NULL THEN 0 ELSE LKP_ADJ_CORE.CMPY_CD END <> CASE WHEN exp_HOLD_STAG_DATA1.COMPANY IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.COMPANY END OR CASE WHEN LKP_ADJ_CORE.TRL_CNT IS NULL THEN 0 ELSE LKP_ADJ_CORE.TRL_CNT END <> CASE WHEN exp_HOLD_STAG_DATA1.TRL_COUNT IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.TRL_COUNT END OR CASE WHEN LKP_ADJ_CORE.PLCY_ST IS NULL THEN 0 ELSE LKP_ADJ_CORE.PLCY_ST END <> CASE WHEN exp_HOLD_STAG_DATA1.POL_STATE IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.POL_STATE END OR CASE WHEN LKP_ADJ_CORE.PLCY_PREFIX IS NULL THEN 0 ELSE LKP_ADJ_CORE.PLCY_PREFIX END <> CASE WHEN exp_HOLD_STAG_DATA1.PFX IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.PFX END OR CASE WHEN LKP_ADJ_CORE.DRFT_NBR IS NULL THEN 0 ELSE LKP_ADJ_CORE.DRFT_NBR END <> CASE WHEN exp_HOLD_STAG_DATA1.PNO IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.PNO END OR CASE WHEN LKP_ADJ_CORE.DRFT_NBR_PFX IS NULL THEN 0 ELSE LKP_ADJ_CORE.DRFT_NBR_PFX END <> CASE WHEN exp_HOLD_STAG_DATA1.SEQNO IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.SEQNO END OR CASE WHEN LKP_ADJ_CORE.TRANS_ID IS NULL THEN 0 ELSE LKP_ADJ_CORE.TRANS_ID END <> CASE WHEN exp_HOLD_STAG_DATA1.TRANS_ID IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.TRANS_ID END OR CASE WHEN LKP_ADJ_CORE.TOT_AMT IS NULL THEN 0 ELSE LKP_ADJ_CORE.TOT_AMT END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_TOTAMT IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_TOTAMT END OR CASE WHEN LKP_ADJ_CORE.NBR_OF_MEALS IS NULL THEN 0 ELSE LKP_ADJ_CORE.NBR_OF_MEALS END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_NOMEALS IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_NOMEALS END OR CASE WHEN LKP_ADJ_CORE.MEAL_AMT IS NULL THEN 0 ELSE LKP_ADJ_CORE.MEAL_AMT END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_MEALAMT IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_MEALAMT END OR CASE WHEN LKP_ADJ_CORE.NBR_OF_NIGHTS IS NULL THEN 0 ELSE LKP_ADJ_CORE.NBR_OF_NIGHTS END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_NONIGHTS IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_NONIGHTS END OR CASE WHEN LKP_ADJ_CORE.HOTEL_AMT IS NULL THEN 0 ELSE LKP_ADJ_CORE.HOTEL_AMT END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_HOTELAMT IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_HOTELAMT END OR CASE WHEN LKP_ADJ_CORE.TELEPHONE_COST IS NULL THEN 0 ELSE LKP_ADJ_CORE.TELEPHONE_COST END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_TELE IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_TELE END OR CASE WHEN LKP_ADJ_CORE.POSTAGE_COST IS NULL THEN 0 ELSE LKP_ADJ_CORE.POSTAGE_COST END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_POSTAGE IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_POSTAGE END OR CASE WHEN LKP_ADJ_CORE.FILM_DEV IS NULL THEN 0 ELSE LKP_ADJ_CORE.FILM_DEV END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_FILMDEV IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_FILMDEV END OR CASE WHEN LKP_ADJ_CORE.PATROL_EXP IS NULL THEN 0 ELSE LKP_ADJ_CORE.PATROL_EXP END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_PATLREP IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_PATLREP END OR CASE WHEN LKP_ADJ_CORE.PARKING_EXP IS NULL THEN 0 ELSE LKP_ADJ_CORE.PARKING_EXP END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_PARK IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_PARK END OR CASE WHEN LKP_ADJ_CORE.CAR_NBR IS NULL THEN 0 ELSE LKP_ADJ_CORE.CAR_NBR END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_CARNO IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_CARNO END OR CASE WHEN LKP_ADJ_CORE.CAR_REPR IS NULL THEN 0 ELSE LKP_ADJ_CORE.CAR_REPR END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_CARREPR IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_CARREPR END OR CASE WHEN LKP_ADJ_CORE.OTH_CAR_EXP IS NULL THEN 0 ELSE LKP_ADJ_CORE.OTH_CAR_EXP END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_OTCAREX IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_OTCAREX END OR CASE WHEN LKP_ADJ_CORE.OTH_EXP IS NULL THEN 0 ELSE LKP_ADJ_CORE.OTH_EXP END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_OTEXP IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.AE_OTEXP END OR CASE WHEN LKP_ADJ_CORE.CHARG_DRFT_NBR IS NULL THEN 0 ELSE LKP_ADJ_CORE.CHARG_DRFT_NBR END <> CASE WHEN exp_HOLD_STAG_DATA1.CDN_DNO IS NULL THEN 0 ELSE exp_HOLD_STAG_DATA1.CDN_DNO END OR CASE WHEN LKP_ADJ_CORE.OPERATOR_ID IS NULL THEN ''~'' ELSE LKP_ADJ_CORE.OPERATOR_ID END <> CASE WHEN exp_HOLD_STAG_DATA1.OPERATOR_ID IS NULL THEN ''~'' ELSE exp_HOLD_STAG_DATA1.OPERATOR_ID END OR CASE WHEN LKP_ADJ_CORE.REC_TYPE IS NULL THEN ''~'' ELSE LKP_ADJ_CORE.REC_TYPE END <> CASE WHEN exp_HOLD_STAG_DATA1.MRI IS NULL THEN ''~'' ELSE exp_HOLD_STAG_DATA1.MRI END OR CASE WHEN LKP_ADJ_CORE.DIST_CD IS NULL THEN ''~'' ELSE LKP_ADJ_CORE.DIST_CD END <> CASE WHEN exp_HOLD_STAG_DATA1.DIST IS NULL THEN ''~'' ELSE exp_HOLD_STAG_DATA1.DIST END OR CASE WHEN LKP_ADJ_CORE.ADJ_SYM IS NULL THEN ''~'' ELSE LKP_ADJ_CORE.ADJ_SYM END <> CASE WHEN exp_HOLD_STAG_DATA1.ADJSYM IS NULL THEN ''~'' ELSE exp_HOLD_STAG_DATA1.ADJSYM END OR CASE WHEN LKP_ADJ_CORE.PAID_CD IS NULL THEN ''~'' ELSE LKP_ADJ_CORE.PAID_CD END <> CASE WHEN exp_HOLD_STAG_DATA1.AE_PAIDCD IS NULL THEN ''~'' ELSE exp_HOLD_STAG_DATA1.AE_PAIDCD END OR CASE WHEN LKP_ADJ_CORE.CHARG_DRFT_NBR_PFX IS NULL THEN ''~'' ELSE LKP_ADJ_CORE.CHARG_DRFT_NBR_PFX END <> CASE WHEN exp_HOLD_STAG_DATA1.CDN_PFX IS NULL THEN ''~'' ELSE exp_HOLD_STAG_DATA1.CDN_PFX END THEN ''UPD'' ELSE ''REJ'' END END as out_FLAG,
exp_HOLD_STAG_DATA1.out_CHG_EFF_DATE as out_CHG_EFF_DATE,
exp_HOLD_STAG_DATA1.EXP_DATE as EXP_DATE,
exp_HOLD_STAG_DATA1.source_record_id
FROM
exp_HOLD_STAG_DATA1
INNER JOIN LKP_ADJ_CORE ON exp_HOLD_STAG_DATA1.source_record_id = LKP_ADJ_CORE.source_record_id
);


-- Component mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, Type MAPPLET 
--MAPPLET NOT REGISTERED: mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, mapplet instance mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE;
call mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE(''exp_CHECK'');


-- Component rtr_UPDATE_INSERT_INSERT, Type ROUTER Output Group INSERT
create or replace temp table RTR_UPDATE_INSERT_INSERT as
SELECT
exp_CHECK.out_FLAG as in_FLAG,
exp_CHECK.ADJ_SKEY_lkp as ADJ_SKEY_lkp,
exp_CHECK.PLCY_PREFIX_lkp as PLCY_PREFIX_lkp,
exp_CHECK.DRFT_NBR_lkp as DRFT_NBR_lkp,
exp_CHECK.LOSS_DT_lkp as LOSS_DT_lkp,
exp_CHECK.DRFT_NBR_PFX_lkp as SEQ_NBR_lkp,
exp_CHECK.ACCTG_DT_lkp as ACCTG_DATE_lkp,
exp_CHECK.CMPY_CD_lkp as CMPY_CD_lkp,
exp_CHECK.REC_TYPE_lkp as REC_TYPE_lkp,
exp_CHECK.TRL_CNT_lkp as TRL_CNT_lkp,
exp_CHECK.PLCY_ST_lkp as PLCY_ST_lkp,
exp_CHECK.TRANS_ID_lkp as TRANS_ID_lkp,
exp_CHECK.DIST_CD_lkp as DIST_CD_lkp,
exp_CHECK.ADJ_SYM_lkp as ADJ_SYM_lkp,
exp_CHECK.PAID_CD_lkp as PAID_CD_lkp,
exp_CHECK.TOT_AMT_lkp as TOT_AMT_lkp,
exp_CHECK.NBR_OF_MEALS_lkp as NBR_OF_MEALS_lkp,
exp_CHECK.MEAL_AMT_lkp as MEAL_AMT_lkp,
exp_CHECK.NBR_OF_NIGHTS_lkp as NBR_OF_NIGHTS_lkp,
exp_CHECK.HOTEL_AMT_lkp as HOTEL_AMT_lkp,
exp_CHECK.TELEPHONE_COST_lkp as TELEPHONE_COST_lkp,
exp_CHECK.POSTAGE_COST_lkp as POSTAGE_COST_lkp,
exp_CHECK.FILM_DEV_lkp as FILM_DEV_lkp,
exp_CHECK.PATROL_EXP_lkp as PATROL_EXP_lkp,
exp_CHECK.PARKING_EXP_lkp as PARKING_EXP_lkp,
exp_CHECK.CAR_NBR_lkp as CAR_NBR_lkp,
exp_CHECK.CAR_REPR_lkp as CAR_REPR_lkp,
exp_CHECK.OTH_CAR_EXP_lkp as OTH_CAR_EXP_lkp,
exp_CHECK.OTH_EXP_lkp as OTH_EXP_lkp,
exp_CHECK.PAID_DT_lkp as PAID_DT_lkp,
exp_CHECK.CHARG_DRFT_NBR_PFX_lkp as CHARG_DRFT_NBR_PFX_lkp,
exp_CHECK.CHARG_DRFT_NBR_lkp as CHARG_DRFT_NBR_lkp,
exp_CHECK.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_CHECK.CHG_EXP_DT_lkp as CHG_EXP_DT_lkp,
exp_CHECK.OPERATOR_ID as OPERATOR_ID,
exp_CHECK.COMPANY as COMPANY,
exp_CHECK.MRI as MRI,
exp_CHECK.TRL_COUNT as TRL_COUNT,
exp_CHECK.POL_STATE as POL_STATE,
exp_CHECK.PFX as PFX,
exp_CHECK.PNO as PNO,
exp_CHECK.DATE_O_LOSS as DATE_O_LOSS,
exp_CHECK.DATE_O_LOSS_DATE as DATE_O_LOSS_DATE,
exp_CHECK.SEQNO as SEQNO,
exp_CHECK.TRANS_ID as TRANS_ID,
exp_CHECK.DIST as DIST,
exp_CHECK.ADJSYM as ADJSYM,
exp_CHECK.AE_PAIDCD as AE_PAIDCD,
exp_CHECK.AE_PAID_DT as AE_PAID_DT,
exp_CHECK.AE_PAID_DATE as AE_PAID_DATE,
exp_CHECK.AE_ACCTG_DT as AE_ACCTG_DT,
exp_CHECK.AE_ACCTG_DATE as AE_ACCTG_DATE,
exp_CHECK.AE_TOTAMT as AE_TOTAMT,
exp_CHECK.AE_NOMEALS as AE_NOMEALS,
exp_CHECK.AE_MEALAMT as AE_MEALAMT,
exp_CHECK.AE_NONIGHTS as AE_NONIGHTS,
exp_CHECK.AE_HOTELAMT as AE_HOTELAMT,
exp_CHECK.AE_TELE as AE_TELE,
exp_CHECK.AE_POSTAGE as AE_POSTAGE,
exp_CHECK.AE_FILMDEV as AE_FILMDEV,
exp_CHECK.AE_PATLREP as AE_PATLREP,
exp_CHECK.AE_PARK as AE_PARK,
exp_CHECK.AE_CARNO as AE_CARNO,
exp_CHECK.AE_CARREPR as AE_CARREPR,
exp_CHECK.AE_OTCAREX as AE_OTCAREX,
exp_CHECK.AE_OTEXP as AE_OTEXP,
exp_CHECK.FILLER_2 as FILLER_2,
exp_CHECK.CDN_PFX as CDN_PFX,
exp_CHECK.CDN_DNO as CDN_DNO,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_PRGM_ID as out_ECTL_PRGM_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_ID as out_ECTL_SRC_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_INST_ID as out_ECTL_SRC_INST_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_ID as out_ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ORIG_INS_TS as out_ORIG_INS_TS,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_START_DATE as out_ECTL_BATCH_START_DATE,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_TABLE_ID as out_ECTL_TABLE_ID,
exp_CHECK.OPERATOR_ID_lkp as OPERATOR_ID_lkp,
exp_CHECK.out_CHG_EFF_DATE as out_CHG_EFF_DATE,
exp_CHECK.EXP_DATE as EXP_DATE,
exp_CHECK.LOSS_DATE_lkp as LOSS_DATE_lkp,
exp_CHECK.PAID_DATE_lkp as PAID_DATE_lkp,
exp_CHECK.ACCTG_DATE_lkp as ACCTG_DATE_lkp4,
exp_CHECK.source_record_id
FROM
exp_CHECK
LEFT JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE ON exp_CHECK.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.source_record_id
WHERE exp_CHECK.out_FLAG = ''INS'';


-- Component rtr_UPDATE_INSERT_UPDATE, Type ROUTER Output Group UPDATE
create or replace temp table RTR_UPDATE_INSERT_UPDATE as
SELECT
exp_CHECK.out_FLAG as in_FLAG,
exp_CHECK.ADJ_SKEY_lkp as ADJ_SKEY_lkp,
exp_CHECK.PLCY_PREFIX_lkp as PLCY_PREFIX_lkp,
exp_CHECK.DRFT_NBR_lkp as DRFT_NBR_lkp,
exp_CHECK.LOSS_DT_lkp as LOSS_DT_lkp,
exp_CHECK.DRFT_NBR_PFX_lkp as SEQ_NBR_lkp,
exp_CHECK.ACCTG_DT_lkp as ACCTG_DATE_lkp,
exp_CHECK.CMPY_CD_lkp as CMPY_CD_lkp,
exp_CHECK.REC_TYPE_lkp as REC_TYPE_lkp,
exp_CHECK.TRL_CNT_lkp as TRL_CNT_lkp,
exp_CHECK.PLCY_ST_lkp as PLCY_ST_lkp,
exp_CHECK.TRANS_ID_lkp as TRANS_ID_lkp,
exp_CHECK.DIST_CD_lkp as DIST_CD_lkp,
exp_CHECK.ADJ_SYM_lkp as ADJ_SYM_lkp,
exp_CHECK.PAID_CD_lkp as PAID_CD_lkp,
exp_CHECK.TOT_AMT_lkp as TOT_AMT_lkp,
exp_CHECK.NBR_OF_MEALS_lkp as NBR_OF_MEALS_lkp,
exp_CHECK.MEAL_AMT_lkp as MEAL_AMT_lkp,
exp_CHECK.NBR_OF_NIGHTS_lkp as NBR_OF_NIGHTS_lkp,
exp_CHECK.HOTEL_AMT_lkp as HOTEL_AMT_lkp,
exp_CHECK.TELEPHONE_COST_lkp as TELEPHONE_COST_lkp,
exp_CHECK.POSTAGE_COST_lkp as POSTAGE_COST_lkp,
exp_CHECK.FILM_DEV_lkp as FILM_DEV_lkp,
exp_CHECK.PATROL_EXP_lkp as PATROL_EXP_lkp,
exp_CHECK.PARKING_EXP_lkp as PARKING_EXP_lkp,
exp_CHECK.CAR_NBR_lkp as CAR_NBR_lkp,
exp_CHECK.CAR_REPR_lkp as CAR_REPR_lkp,
exp_CHECK.OTH_CAR_EXP_lkp as OTH_CAR_EXP_lkp,
exp_CHECK.OTH_EXP_lkp as OTH_EXP_lkp,
exp_CHECK.PAID_DT_lkp as PAID_DT_lkp,
exp_CHECK.CHARG_DRFT_NBR_PFX_lkp as CHARG_DRFT_NBR_PFX_lkp,
exp_CHECK.CHARG_DRFT_NBR_lkp as CHARG_DRFT_NBR_lkp,
exp_CHECK.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_CHECK.CHG_EXP_DT_lkp as CHG_EXP_DT_lkp,
exp_CHECK.OPERATOR_ID as OPERATOR_ID,
exp_CHECK.COMPANY as COMPANY,
exp_CHECK.MRI as MRI,
exp_CHECK.TRL_COUNT as TRL_COUNT,
exp_CHECK.POL_STATE as POL_STATE,
exp_CHECK.PFX as PFX,
exp_CHECK.PNO as PNO,
exp_CHECK.DATE_O_LOSS as DATE_O_LOSS,
exp_CHECK.DATE_O_LOSS_DATE as DATE_O_LOSS_DATE,
exp_CHECK.SEQNO as SEQNO,
exp_CHECK.TRANS_ID as TRANS_ID,
exp_CHECK.DIST as DIST,
exp_CHECK.ADJSYM as ADJSYM,
exp_CHECK.AE_PAIDCD as AE_PAIDCD,
exp_CHECK.AE_PAID_DT as AE_PAID_DT,
exp_CHECK.AE_PAID_DATE as AE_PAID_DATE,
exp_CHECK.AE_ACCTG_DT as AE_ACCTG_DT,
exp_CHECK.AE_ACCTG_DATE as AE_ACCTG_DATE,
exp_CHECK.AE_TOTAMT as AE_TOTAMT,
exp_CHECK.AE_NOMEALS as AE_NOMEALS,
exp_CHECK.AE_MEALAMT as AE_MEALAMT,
exp_CHECK.AE_NONIGHTS as AE_NONIGHTS,
exp_CHECK.AE_HOTELAMT as AE_HOTELAMT,
exp_CHECK.AE_TELE as AE_TELE,
exp_CHECK.AE_POSTAGE as AE_POSTAGE,
exp_CHECK.AE_FILMDEV as AE_FILMDEV,
exp_CHECK.AE_PATLREP as AE_PATLREP,
exp_CHECK.AE_PARK as AE_PARK,
exp_CHECK.AE_CARNO as AE_CARNO,
exp_CHECK.AE_CARREPR as AE_CARREPR,
exp_CHECK.AE_OTCAREX as AE_OTCAREX,
exp_CHECK.AE_OTEXP as AE_OTEXP,
exp_CHECK.FILLER_2 as FILLER_2,
exp_CHECK.CDN_PFX as CDN_PFX,
exp_CHECK.CDN_DNO as CDN_DNO,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_PRGM_ID as out_ECTL_PRGM_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_ID as out_ECTL_SRC_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_INST_ID as out_ECTL_SRC_INST_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_ID as out_ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ORIG_INS_TS as out_ORIG_INS_TS,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_START_DATE as out_ECTL_BATCH_START_DATE,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_TABLE_ID as out_ECTL_TABLE_ID,
exp_CHECK.OPERATOR_ID_lkp as OPERATOR_ID_lkp,
exp_CHECK.out_CHG_EFF_DATE as out_CHG_EFF_DATE,
exp_CHECK.EXP_DATE as EXP_DATE,
exp_CHECK.LOSS_DATE_lkp as LOSS_DATE_lkp,
exp_CHECK.PAID_DATE_lkp as PAID_DATE_lkp,
exp_CHECK.ACCTG_DATE_lkp as ACCTG_DATE_lkp4,
exp_CHECK.source_record_id
FROM
exp_CHECK
LEFT JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE ON exp_CHECK.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.source_record_id
WHERE exp_CHECK.out_FLAG = ''UPD'';


-- Component exp_UPD_UPD, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_UPD_UPD AS
(
SELECT
rtr_UPDATE_INSERT_UPDATE.ADJ_SKEY_lkp as ADJ_SKEY_lkp,
rtr_UPDATE_INSERT_UPDATE.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
 rtr_UPDATE_INSERT_UPDATE.out_CHG_EFF_DATE  - 1  as out_CHG_EXP_DT,
CURRENT_TIMESTAMP as out_ECTL_BATCH_END_DATE,
rtr_UPDATE_INSERT_UPDATE.out_ORIG_INS_TS as ORIG_INS_TS3,
rtr_UPDATE_INSERT_UPDATE.out_ECTL_BATCH_ID as ECTL_BATCH_ID3,
''UPD'' as out_ETL_TX_CD,
rtr_UPDATE_INSERT_UPDATE.source_record_id
FROM
rtr_UPDATE_INSERT_UPDATE
);


-- Component exp_INS_UPD, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_INS_UPD AS
(
SELECT
rtr_UPDATE_INSERT_UPDATE.ADJ_SKEY_lkp as ADJ_SKEY_lkp,
rtr_UPDATE_INSERT_UPDATE.OPERATOR_ID as OPERATOR_ID3,
rtr_UPDATE_INSERT_UPDATE.COMPANY as COMPANY3,
rtr_UPDATE_INSERT_UPDATE.MRI as MRI3,
rtr_UPDATE_INSERT_UPDATE.TRL_COUNT as TRL_COUNT3,
rtr_UPDATE_INSERT_UPDATE.POL_STATE as POL_STATE3,
rtr_UPDATE_INSERT_UPDATE.PFX as PFX3,
rtr_UPDATE_INSERT_UPDATE.PNO as PNO3,
rtr_UPDATE_INSERT_UPDATE.DATE_O_LOSS as DATE_O_LOSS3,
rtr_UPDATE_INSERT_UPDATE.DATE_O_LOSS_DATE as DATE_O_LOSS_DATE3,
rtr_UPDATE_INSERT_UPDATE.SEQNO as SEQNO3,
rtr_UPDATE_INSERT_UPDATE.TRANS_ID as TRANS_ID3,
rtr_UPDATE_INSERT_UPDATE.DIST as DIST3,
rtr_UPDATE_INSERT_UPDATE.ADJSYM as ADJSYM3,
rtr_UPDATE_INSERT_UPDATE.AE_PAIDCD as AE_PAIDCD3,
rtr_UPDATE_INSERT_UPDATE.AE_PAID_DT as AE_PAID_DT3,
rtr_UPDATE_INSERT_UPDATE.AE_PAID_DATE as AE_PAID_DATE3,
rtr_UPDATE_INSERT_UPDATE.AE_ACCTG_DT as AE_ACCTG_DT3,
rtr_UPDATE_INSERT_UPDATE.AE_ACCTG_DATE as AE_ACCTG_DATE3,
rtr_UPDATE_INSERT_UPDATE.AE_TOTAMT as AE_TOTAMT3,
rtr_UPDATE_INSERT_UPDATE.AE_NOMEALS as AE_NOMEALS3,
rtr_UPDATE_INSERT_UPDATE.AE_MEALAMT as AE_MEALAMT3,
rtr_UPDATE_INSERT_UPDATE.AE_NONIGHTS as AE_NONIGHTS3,
rtr_UPDATE_INSERT_UPDATE.AE_HOTELAMT as AE_HOTELAMT3,
rtr_UPDATE_INSERT_UPDATE.AE_TELE as AE_TELE3,
rtr_UPDATE_INSERT_UPDATE.AE_POSTAGE as AE_POSTAGE3,
rtr_UPDATE_INSERT_UPDATE.AE_FILMDEV as AE_FILMDEV3,
rtr_UPDATE_INSERT_UPDATE.AE_PATLREP as AE_PATLREP3,
rtr_UPDATE_INSERT_UPDATE.AE_PARK as AE_PARK3,
rtr_UPDATE_INSERT_UPDATE.AE_CARNO as AE_CARNO3,
rtr_UPDATE_INSERT_UPDATE.AE_CARREPR as AE_CARREPR3,
rtr_UPDATE_INSERT_UPDATE.AE_OTCAREX as AE_OTCAREX3,
rtr_UPDATE_INSERT_UPDATE.AE_OTEXP as AE_OTEXP3,
rtr_UPDATE_INSERT_UPDATE.CDN_PFX as CDN_PFX3,
rtr_UPDATE_INSERT_UPDATE.CDN_DNO as CDN_DNO3,
rtr_UPDATE_INSERT_UPDATE.out_ECTL_PRGM_ID as ECTL_PRGM_ID3,
rtr_UPDATE_INSERT_UPDATE.out_ECTL_SRC_ID as ECTL_SRC_ID3,
rtr_UPDATE_INSERT_UPDATE.out_ECTL_SRC_INST_ID as ECTL_SRC_INST_ID3,
rtr_UPDATE_INSERT_UPDATE.out_ECTL_BATCH_ID as ECTL_BATCH_ID3,
rtr_UPDATE_INSERT_UPDATE.out_ORIG_INS_TS as ORIG_INS_TS3,
rtr_UPDATE_INSERT_UPDATE.out_ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE3,
''NEW'' as out_TRANS_CODE,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as out_ECTL_END_DATE,
rtr_UPDATE_INSERT_UPDATE.out_CHG_EFF_DATE as CHG_EFF_DATE1,
rtr_UPDATE_INSERT_UPDATE.EXP_DATE as EXP_DATE3,
rtr_UPDATE_INSERT_UPDATE.source_record_id
FROM
rtr_UPDATE_INSERT_UPDATE
);


-- Component exp_INSERT, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_INSERT AS
(
SELECT
rtr_UPDATE_INSERT_INSERT.OPERATOR_ID as OPERATOR_ID1,
rtr_UPDATE_INSERT_INSERT.COMPANY as COMPANY1,
rtr_UPDATE_INSERT_INSERT.MRI as MRI1,
rtr_UPDATE_INSERT_INSERT.TRL_COUNT as TRL_COUNT1,
rtr_UPDATE_INSERT_INSERT.POL_STATE as POL_STATE1,
rtr_UPDATE_INSERT_INSERT.PFX as PFX1,
rtr_UPDATE_INSERT_INSERT.PNO as PNO1,
rtr_UPDATE_INSERT_INSERT.DATE_O_LOSS as DATE_O_LOSS1,
rtr_UPDATE_INSERT_INSERT.DATE_O_LOSS_DATE as DATE_O_LOSS_DATE1,
rtr_UPDATE_INSERT_INSERT.SEQNO as SEQNO1,
rtr_UPDATE_INSERT_INSERT.TRANS_ID as TRANS_ID1,
rtr_UPDATE_INSERT_INSERT.DIST as DIST1,
rtr_UPDATE_INSERT_INSERT.ADJSYM as ADJSYM1,
rtr_UPDATE_INSERT_INSERT.AE_PAIDCD as AE_PAIDCD1,
rtr_UPDATE_INSERT_INSERT.AE_PAID_DT as AE_PAID_DT1,
rtr_UPDATE_INSERT_INSERT.AE_PAID_DATE as AE_PAID_DATE1,
rtr_UPDATE_INSERT_INSERT.AE_ACCTG_DT as AE_ACCTG_DT1,
rtr_UPDATE_INSERT_INSERT.AE_ACCTG_DATE as AE_ACCTG_DATE1,
rtr_UPDATE_INSERT_INSERT.AE_TOTAMT as AE_TOTAMT1,
rtr_UPDATE_INSERT_INSERT.AE_NOMEALS as AE_NOMEALS1,
rtr_UPDATE_INSERT_INSERT.AE_MEALAMT as AE_MEALAMT1,
rtr_UPDATE_INSERT_INSERT.AE_NONIGHTS as AE_NONIGHTS1,
rtr_UPDATE_INSERT_INSERT.AE_HOTELAMT as AE_HOTELAMT1,
rtr_UPDATE_INSERT_INSERT.AE_TELE as AE_TELE1,
rtr_UPDATE_INSERT_INSERT.AE_POSTAGE as AE_POSTAGE1,
rtr_UPDATE_INSERT_INSERT.AE_FILMDEV as AE_FILMDEV1,
rtr_UPDATE_INSERT_INSERT.AE_PATLREP as AE_PATLREP1,
rtr_UPDATE_INSERT_INSERT.AE_PARK as AE_PARK1,
rtr_UPDATE_INSERT_INSERT.AE_CARNO as AE_CARNO1,
rtr_UPDATE_INSERT_INSERT.AE_CARREPR as AE_CARREPR1,
rtr_UPDATE_INSERT_INSERT.AE_OTCAREX as AE_OTCAREX1,
rtr_UPDATE_INSERT_INSERT.AE_OTEXP as AE_OTEXP1,
rtr_UPDATE_INSERT_INSERT.CDN_PFX as CDN_PFX1,
rtr_UPDATE_INSERT_INSERT.CDN_DNO as CDN_DNO1,
rtr_UPDATE_INSERT_INSERT.out_ECTL_PRGM_ID as ECTL_PRGM_ID1,
rtr_UPDATE_INSERT_INSERT.out_ECTL_SRC_ID as ECTL_SRC_ID1,
rtr_UPDATE_INSERT_INSERT.out_ECTL_SRC_INST_ID as ECTL_SRC_INST_ID1,
rtr_UPDATE_INSERT_INSERT.out_ECTL_BATCH_ID as ECTL_BATCH_ID1,
rtr_UPDATE_INSERT_INSERT.out_ORIG_INS_TS as ORIG_INS_TS1,
rtr_UPDATE_INSERT_INSERT.out_ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE,
''NEW'' as out_CHECK,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as out_ECTL_END_DATE,
rtr_UPDATE_INSERT_INSERT.out_CHG_EFF_DATE as CHG_EFF_DATE1,
rtr_UPDATE_INSERT_INSERT.EXP_DATE as EXP_DATE2,
rtr_UPDATE_INSERT_INSERT.source_record_id
FROM
rtr_UPDATE_INSERT_INSERT
);


-- Component CLMF_ADJ_CORE_INS_UPD, Type TARGET 
INSERT INTO DB_T_CORE_PROD.CLMF_ADJ_CORE
(
ADJ_SKEY,
OPERATOR_ID,
CMPY_CD,
REC_TYPE,
TRL_CNT,
PLCY_ST,
PLCY_PREFIX,
DRFT_NBR,
LOSS_DT,
LOSS_DATE,
DRFT_NBR_PFX,
CHG_EFF_DT,
CHG_EXP_DT,
TRANS_ID,
DIST_CD,
ADJ_SYM,
PAID_CD,
PAID_DT,
PAID_DATE,
ACCTG_DT,
ACCTG_DATE,
TOT_AMT,
NBR_OF_MEALS,
MEAL_AMT,
NBR_OF_NIGHTS,
HOTEL_AMT,
TELEPHONE_COST,
POSTAGE_COST,
FILM_DEV,
PATROL_EXP,
PARKING_EXP,
CAR_NBR,
CAR_REPR,
OTH_CAR_EXP,
OTH_EXP,
CHARG_DRFT_NBR_PFX,
CHARG_DRFT_NBR,
ECTL_BATCH_ID,
ECTL_ORIG_INS_TS,
ECTL_MODIFY_TS,
ECTL_SRC_ID,
ECTL_SRC_INST_ID,
ECTL_PRGM_ID,
ECTL_TX_CD,
ECTL_START_DATE,
ECTL_END_DATE
)
SELECT
exp_INS_UPD.ADJ_SKEY_lkp as ADJ_SKEY,
exp_INS_UPD.OPERATOR_ID3 as OPERATOR_ID,
exp_INS_UPD.COMPANY3 as CMPY_CD,
exp_INS_UPD.MRI3 as REC_TYPE,
exp_INS_UPD.TRL_COUNT3 as TRL_CNT,
exp_INS_UPD.POL_STATE3 as PLCY_ST,
exp_INS_UPD.PFX3 as PLCY_PREFIX,
exp_INS_UPD.PNO3 as DRFT_NBR,
exp_INS_UPD.DATE_O_LOSS3 as LOSS_DT,
exp_INS_UPD.DATE_O_LOSS_DATE3 as LOSS_DATE,
exp_INS_UPD.SEQNO3 as DRFT_NBR_PFX,
exp_INS_UPD.CHG_EFF_DATE1 as CHG_EFF_DT,
exp_INS_UPD.EXP_DATE3 as CHG_EXP_DT,
exp_INS_UPD.TRANS_ID3 as TRANS_ID,
exp_INS_UPD.DIST3 as DIST_CD,
exp_INS_UPD.ADJSYM3 as ADJ_SYM,
exp_INS_UPD.AE_PAIDCD3 as PAID_CD,
exp_INS_UPD.AE_PAID_DT3 as PAID_DT,
exp_INS_UPD.AE_PAID_DATE3 as PAID_DATE,
exp_INS_UPD.AE_ACCTG_DT3 as ACCTG_DT,
exp_INS_UPD.AE_ACCTG_DATE3 as ACCTG_DATE,
exp_INS_UPD.AE_TOTAMT3 as TOT_AMT,
exp_INS_UPD.AE_NOMEALS3 as NBR_OF_MEALS,
exp_INS_UPD.AE_MEALAMT3 as MEAL_AMT,
exp_INS_UPD.AE_NONIGHTS3 as NBR_OF_NIGHTS,
exp_INS_UPD.AE_HOTELAMT3 as HOTEL_AMT,
exp_INS_UPD.AE_TELE3 as TELEPHONE_COST,
exp_INS_UPD.AE_POSTAGE3 as POSTAGE_COST,
exp_INS_UPD.AE_FILMDEV3 as FILM_DEV,
exp_INS_UPD.AE_PATLREP3 as PATROL_EXP,
exp_INS_UPD.AE_PARK3 as PARKING_EXP,
exp_INS_UPD.AE_CARNO3 as CAR_NBR,
exp_INS_UPD.AE_CARREPR3 as CAR_REPR,
exp_INS_UPD.AE_OTCAREX3 as OTH_CAR_EXP,
exp_INS_UPD.AE_OTEXP3 as OTH_EXP,
exp_INS_UPD.CDN_PFX3 as CHARG_DRFT_NBR_PFX,
exp_INS_UPD.CDN_DNO3 as CHARG_DRFT_NBR,
exp_INS_UPD.ECTL_BATCH_ID3 as ECTL_BATCH_ID,
exp_INS_UPD.ORIG_INS_TS3 as ECTL_ORIG_INS_TS,
exp_INS_UPD.ORIG_INS_TS3 as ECTL_MODIFY_TS,
exp_INS_UPD.ECTL_SRC_ID3 as ECTL_SRC_ID,
exp_INS_UPD.ECTL_SRC_INST_ID3 as ECTL_SRC_INST_ID,
exp_INS_UPD.ECTL_PRGM_ID3 as ECTL_PRGM_ID,
exp_INS_UPD.out_TRANS_CODE as ECTL_TX_CD,
exp_INS_UPD.ECTL_BATCH_START_DATE3 as ECTL_START_DATE,
exp_INS_UPD.out_ECTL_END_DATE as ECTL_END_DATE
FROM
exp_INS_UPD;


-- Component upd_CLMF_ADJ_CORE, Type UPDATE 
CREATE OR REPLACE TEMPORARY TABLE upd_CLMF_ADJ_CORE AS
(
/* UPDATE_STRATEGY_ACTION = 0 FOR INSERT / UPDATE_STRATEGY_ACTION = 1 FOR UPDATE / UPDATE_STRATEGY_ACTION = 2 FOR DELETE / UPDATE_STRATEGY_ACTION = 3 FOR REJECT */
SELECT
exp_UPD_UPD.ADJ_SKEY_lkp as ADJ_SKEY_lkp,
exp_UPD_UPD.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_UPD_UPD.out_CHG_EXP_DT as CHG_EXP_DT,
exp_UPD_UPD.out_ECTL_BATCH_END_DATE as ECTL_BATCH_END_DATE,
exp_UPD_UPD.ORIG_INS_TS3 as ORIG_INS_TS3,
exp_UPD_UPD.ECTL_BATCH_ID3 as ECTL_BATCH_ID3,
exp_UPD_UPD.out_ETL_TX_CD as ETL_TX_CD,
1 as UPDATE_STRATEGY_ACTION
FROM
exp_UPD_UPD
);


-- Component CLMF_ADJ_CORE_INS, Type TARGET 
INSERT INTO DB_T_CORE_PROD.CLMF_ADJ_CORE
(
ADJ_SKEY,
OPERATOR_ID,
CMPY_CD,
REC_TYPE,
TRL_CNT,
PLCY_ST,
PLCY_PREFIX,
DRFT_NBR,
LOSS_DT,
LOSS_DATE,
DRFT_NBR_PFX,
CHG_EFF_DT,
CHG_EXP_DT,
TRANS_ID,
DIST_CD,
ADJ_SYM,
PAID_CD,
PAID_DT,
PAID_DATE,
ACCTG_DT,
ACCTG_DATE,
TOT_AMT,
NBR_OF_MEALS,
MEAL_AMT,
NBR_OF_NIGHTS,
HOTEL_AMT,
TELEPHONE_COST,
POSTAGE_COST,
FILM_DEV,
PATROL_EXP,
PARKING_EXP,
CAR_NBR,
CAR_REPR,
OTH_CAR_EXP,
OTH_EXP,
CHARG_DRFT_NBR_PFX,
CHARG_DRFT_NBR,
ECTL_BATCH_ID,
ECTL_ORIG_INS_TS,
ECTL_MODIFY_TS,
ECTL_SRC_ID,
ECTL_SRC_INST_ID,
ECTL_PRGM_ID,
ECTL_TX_CD,
ECTL_START_DATE,
ECTL_END_DATE
)
SELECT
row_number() over (order by 1) as ADJ_SKEY,
exp_INSERT.OPERATOR_ID1 as OPERATOR_ID,
exp_INSERT.COMPANY1 as CMPY_CD,
exp_INSERT.MRI1 as REC_TYPE,
exp_INSERT.TRL_COUNT1 as TRL_CNT,
exp_INSERT.POL_STATE1 as PLCY_ST,
exp_INSERT.PFX1 as PLCY_PREFIX,
exp_INSERT.PNO1 as DRFT_NBR,
exp_INSERT.DATE_O_LOSS1 as LOSS_DT,
exp_INSERT.DATE_O_LOSS_DATE1 as LOSS_DATE,
exp_INSERT.SEQNO1 as DRFT_NBR_PFX,
exp_INSERT.CHG_EFF_DATE1 as CHG_EFF_DT,
exp_INSERT.EXP_DATE2 as CHG_EXP_DT,
exp_INSERT.TRANS_ID1 as TRANS_ID,
exp_INSERT.DIST1 as DIST_CD,
exp_INSERT.ADJSYM1 as ADJ_SYM,
exp_INSERT.AE_PAIDCD1 as PAID_CD,
exp_INSERT.AE_PAID_DT1 as PAID_DT,
exp_INSERT.AE_PAID_DATE1 as PAID_DATE,
exp_INSERT.AE_ACCTG_DT1 as ACCTG_DT,
exp_INSERT.AE_ACCTG_DATE1 as ACCTG_DATE,
exp_INSERT.AE_TOTAMT1 as TOT_AMT,
exp_INSERT.AE_NOMEALS1 as NBR_OF_MEALS,
exp_INSERT.AE_MEALAMT1 as MEAL_AMT,
exp_INSERT.AE_NONIGHTS1 as NBR_OF_NIGHTS,
exp_INSERT.AE_HOTELAMT1 as HOTEL_AMT,
exp_INSERT.AE_TELE1 as TELEPHONE_COST,
exp_INSERT.AE_POSTAGE1 as POSTAGE_COST,
exp_INSERT.AE_FILMDEV1 as FILM_DEV,
exp_INSERT.AE_PATLREP1 as PATROL_EXP,
exp_INSERT.AE_PARK1 as PARKING_EXP,
exp_INSERT.AE_CARNO1 as CAR_NBR,
exp_INSERT.AE_CARREPR1 as CAR_REPR,
exp_INSERT.AE_OTCAREX1 as OTH_CAR_EXP,
exp_INSERT.AE_OTEXP1 as OTH_EXP,
exp_INSERT.CDN_PFX1 as CHARG_DRFT_NBR_PFX,
exp_INSERT.CDN_DNO1 as CHARG_DRFT_NBR,
exp_INSERT.ECTL_BATCH_ID1 as ECTL_BATCH_ID,
exp_INSERT.ORIG_INS_TS1 as ECTL_ORIG_INS_TS,
exp_INSERT.ORIG_INS_TS1 as ECTL_MODIFY_TS,
exp_INSERT.ECTL_SRC_ID1 as ECTL_SRC_ID,
exp_INSERT.ECTL_SRC_INST_ID1 as ECTL_SRC_INST_ID,
exp_INSERT.ECTL_PRGM_ID1 as ECTL_PRGM_ID,
exp_INSERT.out_CHECK as ECTL_TX_CD,
exp_INSERT.ECTL_BATCH_START_DATE as ECTL_START_DATE,
exp_INSERT.out_ECTL_END_DATE as ECTL_END_DATE
FROM
exp_INSERT;


-- Component CLMF_ADJ_CORE_UPD, Type TARGET 
/* Perform Updates */
MERGE INTO DB_T_CORE_PROD.CLMF_ADJ_CORE
USING upd_CLMF_ADJ_CORE
ON (ADJ_SKEY = upd_CLMF_ADJ_CORE.ADJ_SKEY_lkp and CHG_EFF_DT = upd_CLMF_ADJ_CORE.CHG_EFF_DT_lkp)
WHEN MATCHED THEN UPDATE SET
CHG_EXP_DT = upd_CLMF_ADJ_CORE.CHG_EXP_DT, ECTL_BATCH_ID = upd_CLMF_ADJ_CORE.ECTL_BATCH_ID3, ECTL_MODIFY_TS = upd_CLMF_ADJ_CORE.ORIG_INS_TS3, ECTL_TX_CD = upd_CLMF_ADJ_CORE.ETL_TX_CD, ECTL_END_DATE = upd_CLMF_ADJ_CORE.ECTL_BATCH_END_DATE;



END; ';