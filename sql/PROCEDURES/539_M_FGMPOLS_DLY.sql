-- Object Type: PROCEDURES
CREATE OR REPLACE PROCEDURE ALFA_EDW_DEV.PUBLIC.M_FGMPOLS_DLY("RUN_ID" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS ' DECLARE PMMAPPINGNAME varchar;
PROJ_ID varchar;
BATCH_ACTIVE_IND varchar;
BEGIN 

-- Component LKP_STG_MEMBXEF_TRIGGER_DLY, Type Prerequisite Lookup Object 
CREATE OR REPLACE TEMPORARY TABLE LKP_STG_MEMBXEF_TRIGGER_DLY AS
(
SELECT
FEED_DT,
TABLENAME
FROM DB_T_STAG_MEMBXREF_PROD.STG_MEMBXREF_TRIGGER_DLY
);


-- PIPELINE START FOR 1

-- Component sq_STG_FGMPOLS_DLY, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE sq_STG_FGMPOLS_DLY AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as SC_DWNLD_PRIORITY,
$2 as SC_SERVICE_CENTER,
$3 as SC_POLICY_NUM,
$4 as SC_FLT_ITEM,
$5 as SC_FILE_TYPE,
$6 as SC_REC_TRANS_CODE,
$7 as SC_TRANS_DATE,
$8 as SC_TRANS_TYPE,
$9 as PC_ALPHA_CODE,
$10 as PC_NAME_1,
$11 as PC_NAME_2,
$12 as PC_ADDRESS_1,
$13 as PC_ADDRESS_2,
$14 as PC_CITYST,
$15 as PC_ZIP,
$16 as PC_TAX_CODE,
$17 as PC_AGENT,
$18 as PC_MEMBER_NUMBER,
$19 as PC_RATE_CODE,
$20 as PC_ENCUMBRANCE,
$21 as PC_PREM_FIN,
$22 as PC_MORT_IND,
$23 as PC_COMPANY,
$24 as PC_INCEPT_DATE,
$25 as PC_EXP_DATE,
$26 as PC_EFF_DATE,
$27 as PC_STATUS,
$28 as FGM_TOT_PREM,
$29 as FGM_REWRITE_IND,
$30 as FGM_REWRITE_DT,
$31 as FGM_OUTST_AMT,
$32 as FGM_OUTST_TYPE,
$33 as FGM_OUTST_DATE,
$34 as FGM_OUTST_PD_DATE,
$35 as FGM_SUSPENSE_CD,
$36 as FGM_SUSPENSE_CAN,
$37 as FGM_SSN_1,
$38 as FGM_SSN_2,
$39 as FGM_UW_REVIEW_DT,
$40 as FGM_UW_INITIALS,
$41 as FGM_MORT_NAME_1,
$42 as FGM_MORT_NAME_2,
$43 as FGM_MORT_ADD_1,
$44 as FGM_MORT_ADD_2,
$45 as FGM_MORT_CTYST,
$46 as FGM_MORT_ZIP,
$47 as FGM_STATE,
$48 as FGM_MORT_TYPE,
$49 as FGM_CANC_CODE,
$50 as FGM_LOAN_NUM,
$51 as FGM_SLOAN_NUM,
$52 as FGM_SMORT_NAME_1,
$53 as FGM_SMORT_NAME_2,
$54 as FGM_SMORT_ADD_1,
$55 as FGM_SMORT_ADD_2,
$56 as FGM_SMORT_CTYST,
$57 as FGM_SMORT_ZIP,
$58 as FGM_SMORT_TYPE,
$59 as FGM_PREMIUM_1,
$60 as FGM_PREMIUM_2,
$61 as FGM_PREMIUM_3,
$62 as FGM_PREMIUM_4,
$63 as FGM_PREMIUM_5,
$64 as FGM_PREMIUM_6,
$65 as FGM_COVERAGE_1,
$66 as FGM_COVERAGE_2,
$67 as FGM_COVERAGE_3,
$68 as FGM_COVERAGE_4,
$69 as FGM_COVERAGE_5,
$70 as FGM_COVERAGE_6,
$71 as FGM_COVERAGE_7,
$72 as FGM_COVERAGE_8,
$73 as FGM_T_PUR_PRICE,
$74 as FGM_T_PUR_DATE,
$75 as FGM_T_AMT_OWED,
$76 as FGM_T_MODEL_YEAR,
$77 as FGM_T_LENGTH,
$78 as FGM_T_WIDTH,
$79 as FGM_T_TIE_DOWN,
$80 as FGM_T_FOUNDATION,
$81 as FGM_T_IN_PARK,
$82 as FGM_T_OCCUPANCY,
$83 as FGM_T_OCC_FT,
$84 as FGM_T_RATE_CLASS,
$85 as FGM_T_ENDORSEMENT,
$86 as FGM_T_VC_PERCENT,
$87 as FGM_T_VC_DATE,
$88 as FGM_SP_BT_CLASS,
$89 as FGM_FC_NUM_ACRES,
$90 as FGM_FC_ADD_PREM,
$91 as FGM_FC_ADD_RENT,
$92 as FGM_FC_SEC_RES,
$93 as FGM_FC_NUM_RENTED,
$94 as FGM_FC_ADD_INSRD,
$95 as FGM_FC_AN_COLL_CD,
$96 as FGM_FC_NUM_EMP,
$97 as FGM_FC_PAYROLL,
$98 as FGM_FC_CUST_FRM_CD,
$99 as FGM_DEDUCTIBLE,
$100 as FGM_LOCATION,
$101 as FGM_SM_POLICY_IND,
$102 as FGM_CM_HALF_TERM,
$103 as FGM_CM_FULL_TERM,
$104 as FGM_SP5_ENDR_IND,
$105 as FGM_SP_BOAT_IND,
$106 as FGM_MB_TYPE,
$107 as FGM_MB_ACCT_NUM,
$108 as FGM_GL_COV_TYPE,
$109 as LOAD_DT,
$110 as FEED_IND,
$111 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT STG_FGMPOLS_DLY.SC_DWNLD_PRIORITY SC_DWNLD_PRIORITY,
STG_FGMPOLS_DLY.SC_SERVICE_CENTER SC_SERVICE_CENTER,
LTRIM(RTRIM(STG_FGMPOLS_DLY.SC_POLICY_NUM)) SC_POLICY_NUM,
LTRIM(RTRIM(STG_FGMPOLS_DLY.SC_FLT_ITEM)) SC_FLT_ITEM,
STG_FGMPOLS_DLY.SC_FILE_TYPE SC_FILE_TYPE,
STG_FGMPOLS_DLY.SC_REC_TRANS_CODE SC_REC_TRANS_CODE,
STG_FGMPOLS_DLY.SC_TRANS_DATE SC_TRANS_DATE,
STG_FGMPOLS_DLY.SC_TRANS_TYPE SC_TRANS_TYPE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_ALPHA_CODE)) PC_ALPHA_CODE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_NAME_1)) PC_NAME_1,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_NAME_2)) PC_NAME_2,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_ADDRESS_1)) PC_ADDRESS_1,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_ADDRESS_2)) PC_ADDRESS_2,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_CITYST)) PC_CITYST,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_ZIP)) PC_ZIP,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_TAX_CODE)) PC_TAX_CODE,
STG_FGMPOLS_DLY.PC_AGENT PC_AGENT,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_MEMBER_NUMBER)) PC_MEMBER_NUMBER,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_RATE_CODE)) PC_RATE_CODE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_ENCUMBRANCE)) PC_ENCUMBRANCE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_PREM_FIN)) PC_PREM_FIN,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_MORT_IND)) PC_MORT_IND,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_COMPANY)) PC_COMPANY,
STG_FGMPOLS_DLY.PC_INCEPT_DATE PC_INCEPT_DATE,
STG_FGMPOLS_DLY.PC_EXP_DATE PC_EXP_DATE,
STG_FGMPOLS_DLY.PC_EFF_DATE PC_EFF_DATE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.PC_STATUS)) PC_STATUS,
STG_FGMPOLS_DLY.FGM_TOT_PREM FGM_TOT_PREM,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_REWRITE_IND)) FGM_REWRITE_IND,
STG_FGMPOLS_DLY.FGM_REWRITE_DT FGM_REWRITE_DT,
STG_FGMPOLS_DLY.FGM_OUTST_AMT FGM_OUTST_AMT,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_OUTST_TYPE)) FGM_OUTST_TYPE,
STG_FGMPOLS_DLY.FGM_OUTST_DATE FGM_OUTST_DATE,
STG_FGMPOLS_DLY.FGM_OUTST_PD_DATE FGM_OUTST_PD_DATE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SUSPENSE_CD)) FGM_SUSPENSE_CD,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SUSPENSE_CAN)) FGM_SUSPENSE_CAN,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SSN_1)) FGM_SSN_1,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SSN_2)) FGM_SSN_2,
STG_FGMPOLS_DLY.FGM_UW_REVIEW_DT FGM_UW_REVIEW_DT,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_UW_INITIALS)) FGM_UW_INITIALS,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_MORT_NAME_1)) FGM_MORT_NAME_1,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_MORT_NAME_2)) FGM_MORT_NAME_2,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_MORT_ADD_1)) FGM_MORT_ADD_1,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_MORT_ADD_2)) FGM_MORT_ADD_2,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_MORT_CTYST)) FGM_MORT_CTYST,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_MORT_ZIP)) FGM_MORT_ZIP,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_STATE)) FGM_STATE,
STG_FGMPOLS_DLY.FGM_MORT_TYPE FGM_MORT_TYPE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_CANC_CODE)) FGM_CANC_CODE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_LOAN_NUM)) FGM_LOAN_NUM,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SLOAN_NUM)) FGM_SLOAN_NUM,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SMORT_NAME_1)) FGM_SMORT_NAME_1,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SMORT_NAME_2)) FGM_SMORT_NAME_2,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SMORT_ADD_1)) FGM_SMORT_ADD_1,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SMORT_ADD_2)) FGM_SMORT_ADD_2,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SMORT_CTYST)) FGM_SMORT_CTYST,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SMORT_ZIP)) FGM_SMORT_ZIP,
STG_FGMPOLS_DLY.FGM_SMORT_TYPE FGM_SMORT_TYPE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_PREMIUM_1)) FGM_PREMIUM_1,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_PREMIUM_2)) FGM_PREMIUM_2,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_PREMIUM_3)) FGM_PREMIUM_3,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_PREMIUM_4)) FGM_PREMIUM_4,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_PREMIUM_5)) FGM_PREMIUM_5,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_PREMIUM_6)) FGM_PREMIUM_6,
STG_FGMPOLS_DLY.FGM_COVERAGE_1 FGM_COVERAGE_1,
STG_FGMPOLS_DLY.FGM_COVERAGE_2 FGM_COVERAGE_2,
STG_FGMPOLS_DLY.FGM_COVERAGE_3 FGM_COVERAGE_3,
STG_FGMPOLS_DLY.FGM_COVERAGE_4 FGM_COVERAGE_4,
STG_FGMPOLS_DLY.FGM_COVERAGE_5 FGM_COVERAGE_5,
STG_FGMPOLS_DLY.FGM_COVERAGE_6 FGM_COVERAGE_6,
STG_FGMPOLS_DLY.FGM_COVERAGE_7 FGM_COVERAGE_7,
STG_FGMPOLS_DLY.FGM_COVERAGE_8 FGM_COVERAGE_8,
STG_FGMPOLS_DLY.FGM_T_PUR_PRICE FGM_T_PUR_PRICE,
STG_FGMPOLS_DLY.FGM_T_PUR_DATE FGM_T_PUR_DATE,
STG_FGMPOLS_DLY.FGM_T_AMT_OWED FGM_T_AMT_OWED,
STG_FGMPOLS_DLY.FGM_T_MODEL_YEAR FGM_T_MODEL_YEAR,
STG_FGMPOLS_DLY.FGM_T_LENGTH FGM_T_LENGTH,
STG_FGMPOLS_DLY.FGM_T_WIDTH FGM_T_WIDTH,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_T_TIE_DOWN)) FGM_T_TIE_DOWN,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_T_FOUNDATION)) FGM_T_FOUNDATION,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_T_IN_PARK)) FGM_T_IN_PARK,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_T_OCCUPANCY)) FGM_T_OCCUPANCY,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_T_OCC_FT)) FGM_T_OCC_FT,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_T_RATE_CLASS)) FGM_T_RATE_CLASS,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_T_ENDORSEMENT)) FGM_T_ENDORSEMENT,
STG_FGMPOLS_DLY.FGM_T_VC_PERCENT FGM_T_VC_PERCENT,
STG_FGMPOLS_DLY.FGM_T_VC_DATE FGM_T_VC_DATE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SP_BT_CLASS)) FGM_SP_BT_CLASS,
STG_FGMPOLS_DLY.FGM_FC_NUM_ACRES FGM_FC_NUM_ACRES,
STG_FGMPOLS_DLY.FGM_FC_ADD_PREM FGM_FC_ADD_PREM,
STG_FGMPOLS_DLY.FGM_FC_ADD_RENT FGM_FC_ADD_RENT,
STG_FGMPOLS_DLY.FGM_FC_SEC_RES FGM_FC_SEC_RES,
STG_FGMPOLS_DLY.FGM_FC_NUM_RENTED FGM_FC_NUM_RENTED,
STG_FGMPOLS_DLY.FGM_FC_ADD_INSRD FGM_FC_ADD_INSRD,
STG_FGMPOLS_DLY.FGM_FC_AN_COLL_CD FGM_FC_AN_COLL_CD,
STG_FGMPOLS_DLY.FGM_FC_NUM_EMP FGM_FC_NUM_EMP,
STG_FGMPOLS_DLY.FGM_FC_PAYROLL FGM_FC_PAYROLL,
STG_FGMPOLS_DLY.FGM_FC_CUST_FRM_CD FGM_FC_CUST_FRM_CD,
STG_FGMPOLS_DLY.FGM_DEDUCTIBLE FGM_DEDUCTIBLE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_LOCATION)) FGM_LOCATION,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SM_POLICY_IND)) FGM_SM_POLICY_IND,
STG_FGMPOLS_DLY.FGM_CM_HALF_TERM FGM_CM_HALF_TERM,
STG_FGMPOLS_DLY.FGM_CM_FULL_TERM FGM_CM_FULL_TERM,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SP5_ENDR_IND)) FGM_SP5_ENDR_IND,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_SP_BOAT_IND)) FGM_SP_BOAT_IND,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_MB_TYPE)) FGM_MB_TYPE,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_MB_ACCT_NUM)) FGM_MB_ACCT_NUM,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FGM_GL_COV_TYPE)) FGM_GL_COV_TYPE,
STG_FGMPOLS_DLY.LOAD_DT LOAD_DT,
LTRIM(RTRIM(STG_FGMPOLS_DLY.FEED_IND)) FEED_IND FROM DB_T_STAG_MEMBXREF_PROD.STG_FGMPOLS_DLY STG_FGMPOLS_DLY 
) SRC
)
);


-- Component exp_HOLD_DATA, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_HOLD_DATA AS
(
SELECT
sq_STG_FGMPOLS_DLY.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY,
sq_STG_FGMPOLS_DLY.SC_SERVICE_CENTER as SC_SERVICE_CENTER,
sq_STG_FGMPOLS_DLY.SC_POLICY_NUM as SC_POLICY_NUM,
sq_STG_FGMPOLS_DLY.SC_FLT_ITEM as SC_FLT_ITEM,
sq_STG_FGMPOLS_DLY.SC_FILE_TYPE as SC_FILE_TYPE,
sq_STG_FGMPOLS_DLY.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE,
sq_STG_FGMPOLS_DLY.SC_TRANS_DATE as SC_TRANS_DATE,
sq_STG_FGMPOLS_DLY.SC_TRANS_TYPE as SC_TRANS_TYPE,
sq_STG_FGMPOLS_DLY.PC_ALPHA_CODE as PC_ALPHA_CODE,
sq_STG_FGMPOLS_DLY.PC_NAME_1 as PC_NAME_1,
sq_STG_FGMPOLS_DLY.PC_NAME_2 as PC_NAME_2,
sq_STG_FGMPOLS_DLY.PC_ADDRESS_1 as PC_ADDRESS_1,
sq_STG_FGMPOLS_DLY.PC_ADDRESS_2 as PC_ADDRESS_2,
sq_STG_FGMPOLS_DLY.PC_CITYST as PC_CITYST,
sq_STG_FGMPOLS_DLY.PC_ZIP as PC_ZIP,
sq_STG_FGMPOLS_DLY.PC_TAX_CODE as PC_TAX_CODE,
sq_STG_FGMPOLS_DLY.PC_AGENT as PC_AGENT,
sq_STG_FGMPOLS_DLY.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER,
sq_STG_FGMPOLS_DLY.PC_RATE_CODE as PC_RATE_CODE,
sq_STG_FGMPOLS_DLY.PC_ENCUMBRANCE as PC_ENCUMBRANCE,
sq_STG_FGMPOLS_DLY.PC_PREM_FIN as PC_PREM_FIN,
sq_STG_FGMPOLS_DLY.PC_MORT_IND as PC_MORT_IND,
sq_STG_FGMPOLS_DLY.PC_COMPANY as PC_COMPANY,
sq_STG_FGMPOLS_DLY.PC_INCEPT_DATE as PC_INCEPT_DATE,
sq_STG_FGMPOLS_DLY.PC_EXP_DATE as PC_EXP_DATE,
sq_STG_FGMPOLS_DLY.PC_EFF_DATE as PC_EFF_DATE,
sq_STG_FGMPOLS_DLY.PC_STATUS as PC_STATUS,
sq_STG_FGMPOLS_DLY.FGM_TOT_PREM as FGM_TOT_PREM,
sq_STG_FGMPOLS_DLY.FGM_REWRITE_IND as FGM_REWRITE_IND,
sq_STG_FGMPOLS_DLY.FGM_REWRITE_DT as FGM_REWRITE_DT,
sq_STG_FGMPOLS_DLY.FGM_OUTST_AMT as FGM_OUTST_AMT,
sq_STG_FGMPOLS_DLY.FGM_OUTST_TYPE as FGM_OUTST_TYPE,
sq_STG_FGMPOLS_DLY.FGM_OUTST_DATE as FGM_OUTST_DATE,
sq_STG_FGMPOLS_DLY.FGM_OUTST_PD_DATE as FGM_OUTST_PD_DATE,
sq_STG_FGMPOLS_DLY.FGM_SUSPENSE_CD as FGM_SUSPENSE_CD,
sq_STG_FGMPOLS_DLY.FGM_SUSPENSE_CAN as FGM_SUSPENSE_CAN,
sq_STG_FGMPOLS_DLY.FGM_SSN_1 as FGM_SSN_1,
sq_STG_FGMPOLS_DLY.FGM_SSN_2 as FGM_SSN_2,
sq_STG_FGMPOLS_DLY.FGM_UW_REVIEW_DT as FGM_UW_REVIEW_DT,
sq_STG_FGMPOLS_DLY.FGM_UW_INITIALS as FGM_UW_INITIALS,
sq_STG_FGMPOLS_DLY.FGM_MORT_NAME_1 as FGM_MORT_NAME_1,
sq_STG_FGMPOLS_DLY.FGM_MORT_NAME_2 as FGM_MORT_NAME_2,
sq_STG_FGMPOLS_DLY.FGM_MORT_ADD_1 as FGM_MORT_ADD_1,
sq_STG_FGMPOLS_DLY.FGM_MORT_ADD_2 as FGM_MORT_ADD_2,
sq_STG_FGMPOLS_DLY.FGM_MORT_CTYST as FGM_MORT_CTYST,
sq_STG_FGMPOLS_DLY.FGM_MORT_ZIP as FGM_MORT_ZIP,
sq_STG_FGMPOLS_DLY.FGM_STATE as FGM_STATE,
sq_STG_FGMPOLS_DLY.FGM_MORT_TYPE as FGM_MORT_TYPE,
sq_STG_FGMPOLS_DLY.FGM_CANC_CODE as FGM_CANC_CODE,
sq_STG_FGMPOLS_DLY.FGM_LOAN_NUM as FGM_LOAN_NUM,
sq_STG_FGMPOLS_DLY.FGM_SLOAN_NUM as FGM_SLOAN_NUM,
sq_STG_FGMPOLS_DLY.FGM_SMORT_NAME_1 as FGM_SMORT_NAME_1,
sq_STG_FGMPOLS_DLY.FGM_SMORT_NAME_2 as FGM_SMORT_NAME_2,
sq_STG_FGMPOLS_DLY.FGM_SMORT_ADD_1 as FGM_SMORT_ADD_1,
sq_STG_FGMPOLS_DLY.FGM_SMORT_ADD_2 as FGM_SMORT_ADD_2,
sq_STG_FGMPOLS_DLY.FGM_SMORT_CTYST as FGM_SMORT_CTYST,
sq_STG_FGMPOLS_DLY.FGM_SMORT_ZIP as FGM_SMORT_ZIP,
sq_STG_FGMPOLS_DLY.FGM_SMORT_TYPE as FGM_SMORT_TYPE,
sq_STG_FGMPOLS_DLY.FGM_PREMIUM_1 as FGM_PREMIUM_1,
sq_STG_FGMPOLS_DLY.FGM_PREMIUM_2 as FGM_PREMIUM_2,
sq_STG_FGMPOLS_DLY.FGM_PREMIUM_3 as FGM_PREMIUM_3,
sq_STG_FGMPOLS_DLY.FGM_PREMIUM_4 as FGM_PREMIUM_4,
sq_STG_FGMPOLS_DLY.FGM_PREMIUM_5 as FGM_PREMIUM_5,
sq_STG_FGMPOLS_DLY.FGM_PREMIUM_6 as FGM_PREMIUM_6,
sq_STG_FGMPOLS_DLY.FGM_COVERAGE_1 as FGM_COVERAGE_1,
sq_STG_FGMPOLS_DLY.FGM_COVERAGE_2 as FGM_COVERAGE_2,
sq_STG_FGMPOLS_DLY.FGM_COVERAGE_3 as FGM_COVERAGE_3,
sq_STG_FGMPOLS_DLY.FGM_COVERAGE_4 as FGM_COVERAGE_4,
sq_STG_FGMPOLS_DLY.FGM_COVERAGE_5 as FGM_COVERAGE_5,
sq_STG_FGMPOLS_DLY.FGM_COVERAGE_6 as FGM_COVERAGE_6,
sq_STG_FGMPOLS_DLY.FGM_COVERAGE_7 as FGM_COVERAGE_7,
sq_STG_FGMPOLS_DLY.FGM_COVERAGE_8 as FGM_COVERAGE_8,
sq_STG_FGMPOLS_DLY.FGM_T_PUR_PRICE as FGM_T_PUR_PRICE,
sq_STG_FGMPOLS_DLY.FGM_T_PUR_DATE as FGM_T_PUR_DATE,
sq_STG_FGMPOLS_DLY.FGM_T_AMT_OWED as FGM_T_AMT_OWED,
sq_STG_FGMPOLS_DLY.FGM_T_MODEL_YEAR as FGM_T_MODEL_YEAR,
sq_STG_FGMPOLS_DLY.FGM_T_LENGTH as FGM_T_LENGTH,
sq_STG_FGMPOLS_DLY.FGM_T_WIDTH as FGM_T_WIDTH,
sq_STG_FGMPOLS_DLY.FGM_T_TIE_DOWN as FGM_T_TIE_DOWN,
sq_STG_FGMPOLS_DLY.FGM_T_FOUNDATION as FGM_T_FOUNDATION,
sq_STG_FGMPOLS_DLY.FGM_T_IN_PARK as FGM_T_IN_PARK,
sq_STG_FGMPOLS_DLY.FGM_T_OCCUPANCY as FGM_T_OCCUPANCY,
sq_STG_FGMPOLS_DLY.FGM_T_OCC_FT as FGM_T_OCC_FT,
sq_STG_FGMPOLS_DLY.FGM_T_RATE_CLASS as FGM_T_RATE_CLASS,
sq_STG_FGMPOLS_DLY.FGM_T_ENDORSEMENT as FGM_T_ENDORSEMENT,
sq_STG_FGMPOLS_DLY.FGM_T_VC_PERCENT as FGM_T_VC_PERCENT,
sq_STG_FGMPOLS_DLY.FGM_T_VC_DATE as FGM_T_VC_DATE,
sq_STG_FGMPOLS_DLY.FGM_SP_BT_CLASS as FGM_SP_BT_CLASS,
sq_STG_FGMPOLS_DLY.FGM_FC_NUM_ACRES as FGM_FC_NUM_ACRES,
sq_STG_FGMPOLS_DLY.FGM_FC_ADD_PREM as FGM_FC_ADD_PREM,
sq_STG_FGMPOLS_DLY.FGM_FC_ADD_RENT as FGM_FC_ADD_RENT,
sq_STG_FGMPOLS_DLY.FGM_FC_SEC_RES as FGM_FC_SEC_RES,
sq_STG_FGMPOLS_DLY.FGM_FC_NUM_RENTED as FGM_FC_NUM_RENTED,
sq_STG_FGMPOLS_DLY.FGM_FC_ADD_INSRD as FGM_FC_ADD_INSRD,
sq_STG_FGMPOLS_DLY.FGM_FC_AN_COLL_CD as FGM_FC_AN_COLL_CD,
sq_STG_FGMPOLS_DLY.FGM_FC_NUM_EMP as FGM_FC_NUM_EMP,
sq_STG_FGMPOLS_DLY.FGM_FC_PAYROLL as FGM_FC_PAYROLL,
sq_STG_FGMPOLS_DLY.FGM_FC_CUST_FRM_CD as FGM_FC_CUST_FRM_CD,
sq_STG_FGMPOLS_DLY.FGM_DEDUCTIBLE as FGM_DEDUCTIBLE,
sq_STG_FGMPOLS_DLY.FGM_LOCATION as FGM_LOCATION,
sq_STG_FGMPOLS_DLY.FGM_SM_POLICY_IND as FGM_SM_POLICY_IND,
sq_STG_FGMPOLS_DLY.FGM_CM_HALF_TERM as FGM_CM_HALF_TERM,
sq_STG_FGMPOLS_DLY.FGM_CM_FULL_TERM as FGM_CM_FULL_TERM,
sq_STG_FGMPOLS_DLY.FGM_SP5_ENDR_IND as FGM_SP5_ENDR_IND,
sq_STG_FGMPOLS_DLY.FGM_SP_BOAT_IND as FGM_SP_BOAT_IND,
sq_STG_FGMPOLS_DLY.FGM_MB_TYPE as FGM_MB_TYPE,
sq_STG_FGMPOLS_DLY.FGM_MB_ACCT_NUM as FGM_MB_ACCT_NUM,
sq_STG_FGMPOLS_DLY.FGM_GL_COV_TYPE as FGM_GL_COV_TYPE,
sq_STG_FGMPOLS_DLY.LOAD_DT as LOAD_DT,
sq_STG_FGMPOLS_DLY.FEED_IND as FEED_IND,
sq_STG_FGMPOLS_DLY.source_record_id
FROM
sq_STG_FGMPOLS_DLY
);


-- Component LKP_FGMPOLS_DLY, Type LOOKUP 
CREATE OR REPLACE TEMPORARY TABLE LKP_FGMPOLS_DLY AS
(
SELECT
LKP.SC_DWNLD_PRIORITY,
LKP.SC_SERVICE_CENTER,
LKP.SC_POLICY_NUM,
LKP.CHG_EFF_DT,
LKP.CHG_EXP_DT,
LKP.SC_FLT_ITEM,
LKP.SC_FILE_TYPE,
LKP.SC_REC_TRANS_CODE,
LKP.SC_TRANS_DATE,
LKP.SC_TRANS_TYPE,
LKP.PC_ALPHA_CODE,
LKP.PC_NAME_1,
LKP.PC_NAME_2,
LKP.PC_ADDRESS_1,
LKP.PC_ADDRESS_2,
LKP.PC_CITYST,
LKP.PC_ZIP,
LKP.PC_TAX_CODE,
LKP.PC_AGENT,
LKP.PC_MEMBER_NUMBER,
LKP.PC_RATE_CODE,
LKP.PC_ENCUMBRANCE,
LKP.PC_PREM_FIN,
LKP.PC_MORT_IND,
LKP.PC_COMPANY,
LKP.PC_INCEPT_DATE,
LKP.PC_EXP_DATE,
LKP.PC_EFF_DATE,
LKP.PC_STATUS,
LKP.FGM_TOT_PREM,
LKP.FGM_REWRITE_IND,
LKP.FGM_REWRITE_DT,
LKP.FGM_OUTST_AMT,
LKP.FGM_OUTST_TYPE,
LKP.FGM_OUTST_DATE,
LKP.FGM_OUTST_PD_DATE,
LKP.FGM_SUSPENSE_CD,
LKP.FGM_SUSPENSE_CAN,
LKP.FGM_SSN_1,
LKP.FGM_SSN_2,
LKP.FGM_UW_REVIEW_DT,
LKP.FGM_UW_INITIALS,
LKP.FGM_MORT_NAME_1,
LKP.FGM_MORT_NAME_2,
LKP.FGM_MORT_ADD_1,
LKP.FGM_MORT_ADD_2,
LKP.FGM_MORT_CTYST,
LKP.FGM_MORT_ZIP,
LKP.FGM_STATE,
LKP.FGM_MORT_TYPE,
LKP.FGM_CANC_CODE,
LKP.FGM_LOAN_NUM,
LKP.FGM_SLOAN_NUM,
LKP.FGM_SMORT_NAME_1,
LKP.FGM_SMORT_NAME_2,
LKP.FGM_SMORT_ADD_1,
LKP.FGM_SMORT_ADD_2,
LKP.FGM_SMORT_CTYST,
LKP.FGM_SMORT_ZIP,
LKP.FGM_SMORT_TYPE,
LKP.FGM_PREMIUM_1,
LKP.FGM_PREMIUM_2,
LKP.FGM_PREMIUM_3,
LKP.FGM_PREMIUM_4,
LKP.FGM_PREMIUM_5,
LKP.FGM_PREMIUM_6,
LKP.FGM_COVERAGE_1,
LKP.FGM_COVERAGE_2,
LKP.FGM_COVERAGE_3,
LKP.FGM_COVERAGE_4,
LKP.FGM_COVERAGE_5,
LKP.FGM_COVERAGE_6,
LKP.FGM_COVERAGE_7,
LKP.FGM_COVERAGE_8,
LKP.FGM_T_PUR_PRICE,
LKP.FGM_T_PUR_DATE,
LKP.FGM_T_AMT_OWED,
LKP.FGM_T_MODEL_YEAR,
LKP.FGM_T_LENGTH,
LKP.FGM_T_WIDTH,
LKP.FGM_T_TIE_DOWN,
LKP.FGM_T_FOUNDATION,
LKP.FGM_T_IN_PARK,
LKP.FGM_T_OCCUPANCY,
LKP.FGM_T_OCC_FT,
LKP.FGM_T_RATE_CLASS,
LKP.FGM_T_ENDORSEMENT,
LKP.FGM_T_VC_PERCENT,
LKP.FGM_T_VC_DATE,
LKP.FGM_SP_BT_CLASS,
LKP.FGM_FC_NUM_ACRES,
LKP.FGM_FC_ADD_PREM,
LKP.FGM_FC_ADD_RENT,
LKP.FGM_FC_SEC_RES,
LKP.FGM_FC_NUM_RENTED,
LKP.FGM_FC_ADD_INSRD,
LKP.FGM_FC_AN_COLL_CD,
LKP.FGM_FC_NUM_EMP,
LKP.FGM_FC_PAYROLL,
LKP.FGM_FC_CUST_FRM_CD,
LKP.FGM_DEDUCTIBLE,
LKP.FGM_LOCATION,
LKP.FGM_SM_POLICY_IND,
LKP.FGM_CM_HALF_TERM,
LKP.FGM_CM_FULL_TERM,
LKP.FGM_SP5_ENDR_IND,
LKP.FGM_SP_BOAT_IND,
LKP.FGM_MB_TYPE,
LKP.FGM_MB_ACCT_NUM,
LKP.FGM_GL_COV_TYPE,
LKP.FEED_IND,
exp_HOLD_DATA.source_record_id,
ROW_NUMBER() OVER(PARTITION BY exp_HOLD_DATA.source_record_id ORDER BY LKP.SC_DWNLD_PRIORITY asc,LKP.SC_SERVICE_CENTER asc,LKP.SC_POLICY_NUM asc,LKP.CHG_EFF_DT asc,LKP.CHG_EXP_DT asc,LKP.SC_FLT_ITEM asc,LKP.SC_FILE_TYPE asc,LKP.SC_REC_TRANS_CODE asc,LKP.SC_TRANS_DATE asc,LKP.SC_TRANS_TYPE asc,LKP.PC_ALPHA_CODE asc,LKP.PC_NAME_1 asc,LKP.PC_NAME_2 asc,LKP.PC_ADDRESS_1 asc,LKP.PC_ADDRESS_2 asc,LKP.PC_CITYST asc,LKP.PC_ZIP asc,LKP.PC_TAX_CODE asc,LKP.PC_AGENT asc,LKP.PC_MEMBER_NUMBER asc,LKP.PC_RATE_CODE asc,LKP.PC_ENCUMBRANCE asc,LKP.PC_PREM_FIN asc,LKP.PC_MORT_IND asc,LKP.PC_COMPANY asc,LKP.PC_INCEPT_DATE asc,LKP.PC_EXP_DATE asc,LKP.PC_EFF_DATE asc,LKP.PC_STATUS asc,LKP.FGM_TOT_PREM asc,LKP.FGM_REWRITE_IND asc,LKP.FGM_REWRITE_DT asc,LKP.FGM_OUTST_AMT asc,LKP.FGM_OUTST_TYPE asc,LKP.FGM_OUTST_DATE asc,LKP.FGM_OUTST_PD_DATE asc,LKP.FGM_SUSPENSE_CD asc,LKP.FGM_SUSPENSE_CAN asc,LKP.FGM_SSN_1 asc,LKP.FGM_SSN_2 asc,LKP.FGM_UW_REVIEW_DT asc,LKP.FGM_UW_INITIALS asc,LKP.FGM_MORT_NAME_1 asc,LKP.FGM_MORT_NAME_2 asc,LKP.FGM_MORT_ADD_1 asc,LKP.FGM_MORT_ADD_2 asc,LKP.FGM_MORT_CTYST asc,LKP.FGM_MORT_ZIP asc,LKP.FGM_STATE asc,LKP.FGM_MORT_TYPE asc,LKP.FGM_CANC_CODE asc,LKP.FGM_LOAN_NUM asc,LKP.FGM_SLOAN_NUM asc,LKP.FGM_SMORT_NAME_1 asc,LKP.FGM_SMORT_NAME_2 asc,LKP.FGM_SMORT_ADD_1 asc,LKP.FGM_SMORT_ADD_2 asc,LKP.FGM_SMORT_CTYST asc,LKP.FGM_SMORT_ZIP asc,LKP.FGM_SMORT_TYPE asc,LKP.FGM_PREMIUM_1 asc,LKP.FGM_PREMIUM_2 asc,LKP.FGM_PREMIUM_3 asc,LKP.FGM_PREMIUM_4 asc,LKP.FGM_PREMIUM_5 asc,LKP.FGM_PREMIUM_6 asc,LKP.FGM_COVERAGE_1 asc,LKP.FGM_COVERAGE_2 asc,LKP.FGM_COVERAGE_3 asc,LKP.FGM_COVERAGE_4 asc,LKP.FGM_COVERAGE_5 asc,LKP.FGM_COVERAGE_6 asc,LKP.FGM_COVERAGE_7 asc,LKP.FGM_COVERAGE_8 asc,LKP.FGM_T_PUR_PRICE asc,LKP.FGM_T_PUR_DATE asc,LKP.FGM_T_AMT_OWED asc,LKP.FGM_T_MODEL_YEAR asc,LKP.FGM_T_LENGTH asc,LKP.FGM_T_WIDTH asc,LKP.FGM_T_TIE_DOWN asc,LKP.FGM_T_FOUNDATION asc,LKP.FGM_T_IN_PARK asc,LKP.FGM_T_OCCUPANCY asc,LKP.FGM_T_OCC_FT asc,LKP.FGM_T_RATE_CLASS asc,LKP.FGM_T_ENDORSEMENT asc,LKP.FGM_T_VC_PERCENT asc,LKP.FGM_T_VC_DATE asc,LKP.FGM_SP_BT_CLASS asc,LKP.FGM_FC_NUM_ACRES asc,LKP.FGM_FC_ADD_PREM asc,LKP.FGM_FC_ADD_RENT asc,LKP.FGM_FC_SEC_RES asc,LKP.FGM_FC_NUM_RENTED asc,LKP.FGM_FC_ADD_INSRD asc,LKP.FGM_FC_AN_COLL_CD asc,LKP.FGM_FC_NUM_EMP asc,LKP.FGM_FC_PAYROLL asc,LKP.FGM_FC_CUST_FRM_CD asc,LKP.FGM_DEDUCTIBLE asc,LKP.FGM_LOCATION asc,LKP.FGM_SM_POLICY_IND asc,LKP.FGM_CM_HALF_TERM asc,LKP.FGM_CM_FULL_TERM asc,LKP.FGM_SP5_ENDR_IND asc,LKP.FGM_SP_BOAT_IND asc,LKP.FGM_MB_TYPE asc,LKP.FGM_MB_ACCT_NUM asc,LKP.FGM_GL_COV_TYPE asc,LKP.FEED_IND 
--asc,LKP.ECTL_BATCH_ID 
--asc,LKP.ECTL_ORIG_INS_TS 
--asc,LKP.ECTL_MODIFY_TS 
--asc,LKP.ECTL_SRC_ID 
--asc,LKP.ECTL_SRC_INST_ID 
--asc,LKP.ECTL_PRGM_ID 
--asc,LKP.ECTL_TX_CD 
--asc,LKP.ECTL_START_DATE 
--asc,LKP.ECTL_END_DATE asc
) RNK
FROM
exp_HOLD_DATA
LEFT JOIN (
SELECT FGMPOLS_DLY.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY, 
FGMPOLS_DLY.SC_SERVICE_CENTER as SC_SERVICE_CENTER, 
FGMPOLS_DLY.SC_POLICY_NUM as SC_POLICY_NUM, 
FGMPOLS_DLY.CHG_EFF_DT as CHG_EFF_DT, 
FGMPOLS_DLY.CHG_EXP_DT as CHG_EXP_DT, 
FGMPOLS_DLY.SC_FLT_ITEM as SC_FLT_ITEM,
FGMPOLS_DLY.SC_FILE_TYPE as SC_FILE_TYPE, 
FGMPOLS_DLY.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE, 
FGMPOLS_DLY.SC_TRANS_DATE as SC_TRANS_DATE, 
FGMPOLS_DLY.SC_TRANS_TYPE as SC_TRANS_TYPE, 
FGMPOLS_DLY.PC_ALPHA_CODE as PC_ALPHA_CODE, 
FGMPOLS_DLY.PC_NAME_1 as PC_NAME_1, 
FGMPOLS_DLY.PC_NAME_2 as PC_NAME_2, 
FGMPOLS_DLY.PC_ADDRESS_1 as PC_ADDRESS_1, 
FGMPOLS_DLY.PC_ADDRESS_2 as PC_ADDRESS_2, 
FGMPOLS_DLY.PC_CITYST as PC_CITYST, 
FGMPOLS_DLY.PC_ZIP as PC_ZIP, 
FGMPOLS_DLY.PC_TAX_CODE as PC_TAX_CODE, 
FGMPOLS_DLY.PC_AGENT as PC_AGENT, 
FGMPOLS_DLY.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER, 
FGMPOLS_DLY.PC_RATE_CODE as PC_RATE_CODE, 
FGMPOLS_DLY.PC_ENCUMBRANCE as PC_ENCUMBRANCE, 
FGMPOLS_DLY.PC_PREM_FIN as PC_PREM_FIN, 
FGMPOLS_DLY.PC_MORT_IND as PC_MORT_IND, 
FGMPOLS_DLY.PC_COMPANY as PC_COMPANY, 
FGMPOLS_DLY.PC_INCEPT_DATE as PC_INCEPT_DATE, 
FGMPOLS_DLY.PC_EXP_DATE as PC_EXP_DATE, 
FGMPOLS_DLY.PC_EFF_DATE as PC_EFF_DATE, 
FGMPOLS_DLY.PC_STATUS as PC_STATUS, 
FGMPOLS_DLY.FGM_TOT_PREM as FGM_TOT_PREM, 
FGMPOLS_DLY.FGM_REWRITE_IND as FGM_REWRITE_IND, 
FGMPOLS_DLY.FGM_REWRITE_DT as FGM_REWRITE_DT, 
FGMPOLS_DLY.FGM_OUTST_AMT as FGM_OUTST_AMT, 
FGMPOLS_DLY.FGM_OUTST_TYPE as FGM_OUTST_TYPE, 
FGMPOLS_DLY.FGM_OUTST_DATE as FGM_OUTST_DATE, 
FGMPOLS_DLY.FGM_OUTST_PD_DATE as FGM_OUTST_PD_DATE, 
FGMPOLS_DLY.FGM_SUSPENSE_CD as FGM_SUSPENSE_CD, 
FGMPOLS_DLY.FGM_SUSPENSE_CAN as FGM_SUSPENSE_CAN, 
FGMPOLS_DLY.FGM_SSN_1 as FGM_SSN_1, 
FGMPOLS_DLY.FGM_SSN_2 as FGM_SSN_2, 
FGMPOLS_DLY.FGM_UW_REVIEW_DT as FGM_UW_REVIEW_DT, 
FGMPOLS_DLY.FGM_UW_INITIALS as FGM_UW_INITIALS, 
FGMPOLS_DLY.FGM_MORT_NAME_1 as FGM_MORT_NAME_1, 
FGMPOLS_DLY.FGM_MORT_NAME_2 as FGM_MORT_NAME_2, 
FGMPOLS_DLY.FGM_MORT_ADD_1 as FGM_MORT_ADD_1, 
FGMPOLS_DLY.FGM_MORT_ADD_2 as FGM_MORT_ADD_2, 
FGMPOLS_DLY.FGM_MORT_CTYST as FGM_MORT_CTYST, 
FGMPOLS_DLY.FGM_MORT_ZIP as FGM_MORT_ZIP, 
FGMPOLS_DLY.FGM_STATE as FGM_STATE, 
FGMPOLS_DLY.FGM_MORT_TYPE as FGM_MORT_TYPE, 
FGMPOLS_DLY.FGM_CANC_CODE as FGM_CANC_CODE, 
FGMPOLS_DLY.FGM_LOAN_NUM as FGM_LOAN_NUM, 
FGMPOLS_DLY.FGM_SLOAN_NUM as FGM_SLOAN_NUM, 
FGMPOLS_DLY.FGM_SMORT_NAME_1 as FGM_SMORT_NAME_1, 
FGMPOLS_DLY.FGM_SMORT_NAME_2 as FGM_SMORT_NAME_2, 
FGMPOLS_DLY.FGM_SMORT_ADD_1 as FGM_SMORT_ADD_1, 
FGMPOLS_DLY.FGM_SMORT_ADD_2 as FGM_SMORT_ADD_2, 
FGMPOLS_DLY.FGM_SMORT_CTYST as FGM_SMORT_CTYST, 
FGMPOLS_DLY.FGM_SMORT_ZIP as FGM_SMORT_ZIP, 
FGMPOLS_DLY.FGM_SMORT_TYPE as FGM_SMORT_TYPE, 
FGMPOLS_DLY.FGM_PREMIUM_1 as FGM_PREMIUM_1, 
FGMPOLS_DLY.FGM_PREMIUM_2 as FGM_PREMIUM_2, 
FGMPOLS_DLY.FGM_PREMIUM_3 as FGM_PREMIUM_3, 
FGMPOLS_DLY.FGM_PREMIUM_4 as FGM_PREMIUM_4, 
FGMPOLS_DLY.FGM_PREMIUM_5 as FGM_PREMIUM_5, 
FGMPOLS_DLY.FGM_PREMIUM_6 as FGM_PREMIUM_6, 
FGMPOLS_DLY.FGM_COVERAGE_1 as FGM_COVERAGE_1, 
FGMPOLS_DLY.FGM_COVERAGE_2 as FGM_COVERAGE_2, 
FGMPOLS_DLY.FGM_COVERAGE_3 as FGM_COVERAGE_3, 
FGMPOLS_DLY.FGM_COVERAGE_4 as FGM_COVERAGE_4, 
FGMPOLS_DLY.FGM_COVERAGE_5 as FGM_COVERAGE_5, 
FGMPOLS_DLY.FGM_COVERAGE_6 as FGM_COVERAGE_6, 
FGMPOLS_DLY.FGM_COVERAGE_7 as FGM_COVERAGE_7, 
FGMPOLS_DLY.FGM_COVERAGE_8 as FGM_COVERAGE_8, 
FGMPOLS_DLY.FGM_T_PUR_PRICE as FGM_T_PUR_PRICE, 
FGMPOLS_DLY.FGM_T_PUR_DATE as FGM_T_PUR_DATE, 
FGMPOLS_DLY.FGM_T_AMT_OWED as FGM_T_AMT_OWED, 
FGMPOLS_DLY.FGM_T_MODEL_YEAR as FGM_T_MODEL_YEAR, 
FGMPOLS_DLY.FGM_T_LENGTH as FGM_T_LENGTH, 
FGMPOLS_DLY.FGM_T_WIDTH as FGM_T_WIDTH, 
FGMPOLS_DLY.FGM_T_TIE_DOWN as FGM_T_TIE_DOWN, 
FGMPOLS_DLY.FGM_T_FOUNDATION as FGM_T_FOUNDATION, 
FGMPOLS_DLY.FGM_T_IN_PARK as FGM_T_IN_PARK, 
FGMPOLS_DLY.FGM_T_OCCUPANCY as FGM_T_OCCUPANCY, 
FGMPOLS_DLY.FGM_T_OCC_FT as FGM_T_OCC_FT, 
FGMPOLS_DLY.FGM_T_RATE_CLASS as FGM_T_RATE_CLASS, 
FGMPOLS_DLY.FGM_T_ENDORSEMENT as FGM_T_ENDORSEMENT, 
FGMPOLS_DLY.FGM_T_VC_PERCENT as FGM_T_VC_PERCENT, 
FGMPOLS_DLY.FGM_T_VC_DATE as FGM_T_VC_DATE, 
FGMPOLS_DLY.FGM_SP_BT_CLASS as FGM_SP_BT_CLASS, 
FGMPOLS_DLY.FGM_FC_NUM_ACRES as FGM_FC_NUM_ACRES, 
FGMPOLS_DLY.FGM_FC_ADD_PREM as FGM_FC_ADD_PREM, 
FGMPOLS_DLY.FGM_FC_ADD_RENT as FGM_FC_ADD_RENT, 
FGMPOLS_DLY.FGM_FC_SEC_RES as FGM_FC_SEC_RES, 
FGMPOLS_DLY.FGM_FC_NUM_RENTED as FGM_FC_NUM_RENTED, 
FGMPOLS_DLY.FGM_FC_ADD_INSRD as FGM_FC_ADD_INSRD, 
FGMPOLS_DLY.FGM_FC_AN_COLL_CD as FGM_FC_AN_COLL_CD, 
FGMPOLS_DLY.FGM_FC_NUM_EMP as FGM_FC_NUM_EMP, 
FGMPOLS_DLY.FGM_FC_PAYROLL as FGM_FC_PAYROLL, 
FGMPOLS_DLY.FGM_FC_CUST_FRM_CD as FGM_FC_CUST_FRM_CD, 
FGMPOLS_DLY.FGM_DEDUCTIBLE as FGM_DEDUCTIBLE, 
FGMPOLS_DLY.FGM_LOCATION as FGM_LOCATION, 
FGMPOLS_DLY.FGM_SM_POLICY_IND as FGM_SM_POLICY_IND, 
FGMPOLS_DLY.FGM_CM_HALF_TERM as FGM_CM_HALF_TERM, 
FGMPOLS_DLY.FGM_CM_FULL_TERM as FGM_CM_FULL_TERM, 
FGMPOLS_DLY.FGM_SP5_ENDR_IND as FGM_SP5_ENDR_IND, 
FGMPOLS_DLY.FGM_SP_BOAT_IND as FGM_SP_BOAT_IND, 
FGMPOLS_DLY.FGM_MB_TYPE as FGM_MB_TYPE, 
FGMPOLS_DLY.FGM_MB_ACCT_NUM as FGM_MB_ACCT_NUM, 
FGMPOLS_DLY.FGM_GL_COV_TYPE as FGM_GL_COV_TYPE, 
FGMPOLS_DLY.FEED_IND as FEED_IND 
 FROM DB_T_CORE_MEMBXREF_PROD.FGMPOLS_DLY 
WHERE FGMPOLS_DLY.ECTL_TX_CD = ''NEW''
) LKP ON LKP.SC_POLICY_NUM = exp_HOLD_DATA.SC_POLICY_NUM
QUALIFY RNK = 1
);


-- Component exp_DERIVE_FLAG, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_DERIVE_FLAG AS
(
SELECT
LKP_FGMPOLS_DLY.SC_POLICY_NUM as SC_POLICY_NUM_lkp,
LKP_FGMPOLS_DLY.CHG_EFF_DT as CHG_EFF_DT_lkp,
LKP_FGMPOLS_DLY.SC_FLT_ITEM as SC_FLT_ITEM_lkp,
exp_HOLD_DATA.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY,
exp_HOLD_DATA.SC_SERVICE_CENTER as SC_SERVICE_CENTER,
exp_HOLD_DATA.SC_POLICY_NUM as SC_POLICY_NUM,
exp_HOLD_DATA.SC_FLT_ITEM as SC_FLT_ITEM,
exp_HOLD_DATA.SC_FILE_TYPE as SC_FILE_TYPE,
exp_HOLD_DATA.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE,
exp_HOLD_DATA.SC_TRANS_DATE as SC_TRANS_DATE,
exp_HOLD_DATA.SC_TRANS_TYPE as SC_TRANS_TYPE,
exp_HOLD_DATA.PC_ALPHA_CODE as PC_ALPHA_CODE,
exp_HOLD_DATA.PC_NAME_1 as PC_NAME_1,
exp_HOLD_DATA.PC_NAME_2 as PC_NAME_2,
exp_HOLD_DATA.PC_ADDRESS_1 as PC_ADDRESS_1,
exp_HOLD_DATA.PC_ADDRESS_2 as PC_ADDRESS_2,
exp_HOLD_DATA.PC_CITYST as PC_CITYST,
exp_HOLD_DATA.PC_ZIP as PC_ZIP,
exp_HOLD_DATA.PC_TAX_CODE as PC_TAX_CODE,
exp_HOLD_DATA.PC_AGENT as PC_AGENT,
exp_HOLD_DATA.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER,
exp_HOLD_DATA.PC_RATE_CODE as PC_RATE_CODE,
exp_HOLD_DATA.PC_ENCUMBRANCE as PC_ENCUMBRANCE,
exp_HOLD_DATA.PC_PREM_FIN as PC_PREM_FIN,
exp_HOLD_DATA.PC_MORT_IND as PC_MORT_IND,
exp_HOLD_DATA.PC_COMPANY as PC_COMPANY,
exp_HOLD_DATA.PC_INCEPT_DATE as PC_INCEPT_DATE,
exp_HOLD_DATA.PC_EXP_DATE as PC_EXP_DATE,
exp_HOLD_DATA.PC_EFF_DATE as PC_EFF_DATE,
exp_HOLD_DATA.PC_STATUS as PC_STATUS,
exp_HOLD_DATA.FGM_TOT_PREM as FGM_TOT_PREM,
exp_HOLD_DATA.FGM_REWRITE_IND as FGM_REWRITE_IND,
exp_HOLD_DATA.FGM_REWRITE_DT as FGM_REWRITE_DT,
exp_HOLD_DATA.FGM_OUTST_AMT as FGM_OUTST_AMT,
exp_HOLD_DATA.FGM_OUTST_TYPE as FGM_OUTST_TYPE,
exp_HOLD_DATA.FGM_OUTST_DATE as FGM_OUTST_DATE,
exp_HOLD_DATA.FGM_OUTST_PD_DATE as FGM_OUTST_PD_DATE,
exp_HOLD_DATA.FGM_SUSPENSE_CD as FGM_SUSPENSE_CD,
exp_HOLD_DATA.FGM_SUSPENSE_CAN as FGM_SUSPENSE_CAN,
exp_HOLD_DATA.FGM_SSN_1 as FGM_SSN_1,
exp_HOLD_DATA.FGM_SSN_2 as FGM_SSN_2,
exp_HOLD_DATA.FGM_UW_REVIEW_DT as FGM_UW_REVIEW_DT,
exp_HOLD_DATA.FGM_UW_INITIALS as FGM_UW_INITIALS,
exp_HOLD_DATA.FGM_MORT_NAME_1 as FGM_MORT_NAME_1,
exp_HOLD_DATA.FGM_MORT_NAME_2 as FGM_MORT_NAME_2,
exp_HOLD_DATA.FGM_MORT_ADD_1 as FGM_MORT_ADD_1,
exp_HOLD_DATA.FGM_MORT_ADD_2 as FGM_MORT_ADD_2,
exp_HOLD_DATA.FGM_MORT_CTYST as FGM_MORT_CTYST,
exp_HOLD_DATA.FGM_MORT_ZIP as FGM_MORT_ZIP,
exp_HOLD_DATA.FGM_STATE as FGM_STATE,
exp_HOLD_DATA.FGM_MORT_TYPE as FGM_MORT_TYPE,
exp_HOLD_DATA.FGM_CANC_CODE as FGM_CANC_CODE,
exp_HOLD_DATA.FGM_LOAN_NUM as FGM_LOAN_NUM,
exp_HOLD_DATA.FGM_SLOAN_NUM as FGM_SLOAN_NUM,
exp_HOLD_DATA.FGM_SMORT_NAME_1 as FGM_SMORT_NAME_1,
exp_HOLD_DATA.FGM_SMORT_NAME_2 as FGM_SMORT_NAME_2,
exp_HOLD_DATA.FGM_SMORT_ADD_1 as FGM_SMORT_ADD_1,
exp_HOLD_DATA.FGM_SMORT_ADD_2 as FGM_SMORT_ADD_2,
exp_HOLD_DATA.FGM_SMORT_CTYST as FGM_SMORT_CTYST,
exp_HOLD_DATA.FGM_SMORT_ZIP as FGM_SMORT_ZIP,
exp_HOLD_DATA.FGM_SMORT_TYPE as FGM_SMORT_TYPE,
exp_HOLD_DATA.FGM_PREMIUM_1 as FGM_PREMIUM_1,
exp_HOLD_DATA.FGM_PREMIUM_2 as FGM_PREMIUM_2,
exp_HOLD_DATA.FGM_PREMIUM_3 as FGM_PREMIUM_3,
exp_HOLD_DATA.FGM_PREMIUM_4 as FGM_PREMIUM_4,
exp_HOLD_DATA.FGM_PREMIUM_5 as FGM_PREMIUM_5,
exp_HOLD_DATA.FGM_PREMIUM_6 as FGM_PREMIUM_6,
exp_HOLD_DATA.FGM_COVERAGE_1 as FGM_COVERAGE_1,
exp_HOLD_DATA.FGM_COVERAGE_2 as FGM_COVERAGE_2,
exp_HOLD_DATA.FGM_COVERAGE_3 as FGM_COVERAGE_3,
exp_HOLD_DATA.FGM_COVERAGE_4 as FGM_COVERAGE_4,
exp_HOLD_DATA.FGM_COVERAGE_5 as FGM_COVERAGE_5,
exp_HOLD_DATA.FGM_COVERAGE_6 as FGM_COVERAGE_6,
exp_HOLD_DATA.FGM_COVERAGE_7 as FGM_COVERAGE_7,
exp_HOLD_DATA.FGM_COVERAGE_8 as FGM_COVERAGE_8,
exp_HOLD_DATA.FGM_T_PUR_PRICE as FGM_T_PUR_PRICE,
exp_HOLD_DATA.FGM_T_PUR_DATE as FGM_T_PUR_DATE,
exp_HOLD_DATA.FGM_T_AMT_OWED as FGM_T_AMT_OWED,
exp_HOLD_DATA.FGM_T_MODEL_YEAR as FGM_T_MODEL_YEAR,
exp_HOLD_DATA.FGM_T_LENGTH as FGM_T_LENGTH,
exp_HOLD_DATA.FGM_T_WIDTH as FGM_T_WIDTH,
exp_HOLD_DATA.FGM_T_TIE_DOWN as FGM_T_TIE_DOWN,
exp_HOLD_DATA.FGM_T_FOUNDATION as FGM_T_FOUNDATION,
exp_HOLD_DATA.FGM_T_IN_PARK as FGM_T_IN_PARK,
exp_HOLD_DATA.FGM_T_OCCUPANCY as FGM_T_OCCUPANCY,
exp_HOLD_DATA.FGM_T_OCC_FT as FGM_T_OCC_FT,
exp_HOLD_DATA.FGM_T_RATE_CLASS as FGM_T_RATE_CLASS,
exp_HOLD_DATA.FGM_T_ENDORSEMENT as FGM_T_ENDORSEMENT,
exp_HOLD_DATA.FGM_T_VC_PERCENT as FGM_T_VC_PERCENT,
exp_HOLD_DATA.FGM_T_VC_DATE as FGM_T_VC_DATE,
exp_HOLD_DATA.FGM_SP_BT_CLASS as FGM_SP_BT_CLASS,
exp_HOLD_DATA.FGM_FC_NUM_ACRES as FGM_FC_NUM_ACRES,
exp_HOLD_DATA.FGM_FC_ADD_PREM as FGM_FC_ADD_PREM,
exp_HOLD_DATA.FGM_FC_ADD_RENT as FGM_FC_ADD_RENT,
exp_HOLD_DATA.FGM_FC_SEC_RES as FGM_FC_SEC_RES,
exp_HOLD_DATA.FGM_FC_NUM_RENTED as FGM_FC_NUM_RENTED,
exp_HOLD_DATA.FGM_FC_ADD_INSRD as FGM_FC_ADD_INSRD,
exp_HOLD_DATA.FGM_FC_AN_COLL_CD as FGM_FC_AN_COLL_CD,
exp_HOLD_DATA.FGM_FC_NUM_EMP as FGM_FC_NUM_EMP,
exp_HOLD_DATA.FGM_FC_PAYROLL as FGM_FC_PAYROLL,
exp_HOLD_DATA.FGM_FC_CUST_FRM_CD as FGM_FC_CUST_FRM_CD,
exp_HOLD_DATA.FGM_DEDUCTIBLE as FGM_DEDUCTIBLE,
exp_HOLD_DATA.FGM_LOCATION as FGM_LOCATION,
exp_HOLD_DATA.FGM_SM_POLICY_IND as FGM_SM_POLICY_IND,
exp_HOLD_DATA.FGM_CM_HALF_TERM as FGM_CM_HALF_TERM,
exp_HOLD_DATA.FGM_CM_FULL_TERM as FGM_CM_FULL_TERM,
exp_HOLD_DATA.FGM_SP5_ENDR_IND as FGM_SP5_ENDR_IND,
exp_HOLD_DATA.FGM_SP_BOAT_IND as FGM_SP_BOAT_IND,
exp_HOLD_DATA.FGM_MB_TYPE as FGM_MB_TYPE,
exp_HOLD_DATA.FGM_MB_ACCT_NUM as FGM_MB_ACCT_NUM,
exp_HOLD_DATA.FGM_GL_COV_TYPE as FGM_GL_COV_TYPE,
exp_HOLD_DATA.LOAD_DT as LOAD_DT,
exp_HOLD_DATA.FEED_IND as FEED_IND,
CASE WHEN LKP_FGMPOLS_DLY.SC_POLICY_NUM IS NULL THEN ''NEW'' ELSE CASE WHEN CASE WHEN LKP_FGMPOLS_DLY.SC_DWNLD_PRIORITY IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.SC_DWNLD_PRIORITY END <> CASE WHEN exp_HOLD_DATA.SC_DWNLD_PRIORITY IS NULL THEN 0 ELSE exp_HOLD_DATA.SC_DWNLD_PRIORITY END OR CASE WHEN LKP_FGMPOLS_DLY.SC_SERVICE_CENTER IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.SC_SERVICE_CENTER END <> CASE WHEN exp_HOLD_DATA.SC_SERVICE_CENTER IS NULL THEN 0 ELSE exp_HOLD_DATA.SC_SERVICE_CENTER END OR CASE WHEN LKP_FGMPOLS_DLY.SC_FLT_ITEM IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.SC_FLT_ITEM END <> CASE WHEN exp_HOLD_DATA.SC_FLT_ITEM IS NULL THEN ''~'' ELSE exp_HOLD_DATA.SC_FLT_ITEM END OR CASE WHEN LKP_FGMPOLS_DLY.SC_FILE_TYPE IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.SC_FILE_TYPE END <> CASE WHEN exp_HOLD_DATA.SC_FILE_TYPE IS NULL THEN 0 ELSE exp_HOLD_DATA.SC_FILE_TYPE END OR CASE WHEN LKP_FGMPOLS_DLY.SC_REC_TRANS_CODE IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.SC_REC_TRANS_CODE END <> CASE WHEN exp_HOLD_DATA.SC_REC_TRANS_CODE IS NULL THEN 0 ELSE exp_HOLD_DATA.SC_REC_TRANS_CODE END OR CASE WHEN LKP_FGMPOLS_DLY.SC_TRANS_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.SC_TRANS_DATE END <> CASE WHEN exp_HOLD_DATA.SC_TRANS_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.SC_TRANS_DATE END OR CASE WHEN LKP_FGMPOLS_DLY.SC_TRANS_TYPE IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.SC_TRANS_TYPE END <> CASE WHEN exp_HOLD_DATA.SC_TRANS_TYPE IS NULL THEN 0 ELSE exp_HOLD_DATA.SC_TRANS_TYPE END OR CASE WHEN LKP_FGMPOLS_DLY.PC_ALPHA_CODE IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_ALPHA_CODE END <> CASE WHEN exp_HOLD_DATA.PC_ALPHA_CODE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_ALPHA_CODE END OR CASE WHEN LKP_FGMPOLS_DLY.PC_NAME_1 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_NAME_1 END <> CASE WHEN exp_HOLD_DATA.PC_NAME_1 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_NAME_1 END OR CASE WHEN LKP_FGMPOLS_DLY.PC_NAME_2 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_NAME_2 END <> CASE WHEN exp_HOLD_DATA.PC_NAME_2 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_NAME_2 END OR CASE WHEN LKP_FGMPOLS_DLY.PC_ADDRESS_1 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_ADDRESS_1 END <> CASE WHEN exp_HOLD_DATA.PC_ADDRESS_1 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_ADDRESS_1 END OR CASE WHEN LKP_FGMPOLS_DLY.PC_ADDRESS_2 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_ADDRESS_2 END <> CASE WHEN exp_HOLD_DATA.PC_ADDRESS_2 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_ADDRESS_2 END OR CASE WHEN LKP_FGMPOLS_DLY.PC_CITYST IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_CITYST END <> CASE WHEN exp_HOLD_DATA.PC_CITYST IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_CITYST END OR CASE WHEN LKP_FGMPOLS_DLY.PC_ZIP IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_ZIP END <> CASE WHEN exp_HOLD_DATA.PC_ZIP IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_ZIP END OR CASE WHEN LKP_FGMPOLS_DLY.PC_TAX_CODE IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_TAX_CODE END <> CASE WHEN exp_HOLD_DATA.PC_TAX_CODE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_TAX_CODE END OR CASE WHEN LKP_FGMPOLS_DLY.PC_AGENT IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.PC_AGENT END <> CASE WHEN exp_HOLD_DATA.PC_AGENT IS NULL THEN 0 ELSE exp_HOLD_DATA.PC_AGENT END OR CASE WHEN LKP_FGMPOLS_DLY.PC_MEMBER_NUMBER IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_MEMBER_NUMBER END <> CASE WHEN exp_HOLD_DATA.PC_MEMBER_NUMBER IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_MEMBER_NUMBER END OR CASE WHEN LKP_FGMPOLS_DLY.PC_RATE_CODE IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_RATE_CODE END <> CASE WHEN exp_HOLD_DATA.PC_RATE_CODE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_RATE_CODE END OR CASE WHEN LKP_FGMPOLS_DLY.PC_ENCUMBRANCE IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_ENCUMBRANCE END <> CASE WHEN exp_HOLD_DATA.PC_ENCUMBRANCE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_ENCUMBRANCE END OR CASE WHEN LKP_FGMPOLS_DLY.PC_PREM_FIN IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_PREM_FIN END <> CASE WHEN exp_HOLD_DATA.PC_PREM_FIN IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_PREM_FIN END OR CASE WHEN LKP_FGMPOLS_DLY.PC_MORT_IND IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_MORT_IND END <> CASE WHEN exp_HOLD_DATA.PC_MORT_IND IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_MORT_IND END OR CASE WHEN LKP_FGMPOLS_DLY.PC_COMPANY IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_COMPANY END <> CASE WHEN exp_HOLD_DATA.PC_COMPANY IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_COMPANY END OR CASE WHEN LKP_FGMPOLS_DLY.PC_INCEPT_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.PC_INCEPT_DATE END <> CASE WHEN exp_HOLD_DATA.PC_INCEPT_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.PC_INCEPT_DATE END OR CASE WHEN LKP_FGMPOLS_DLY.PC_EXP_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.PC_EXP_DATE END <> CASE WHEN exp_HOLD_DATA.PC_EXP_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.PC_EXP_DATE END OR CASE WHEN LKP_FGMPOLS_DLY.PC_EFF_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.PC_EFF_DATE END <> CASE WHEN exp_HOLD_DATA.PC_EFF_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.PC_EFF_DATE END OR CASE WHEN LKP_FGMPOLS_DLY.PC_STATUS IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.PC_STATUS END <> CASE WHEN exp_HOLD_DATA.PC_STATUS IS NULL THEN ''~'' ELSE exp_HOLD_DATA.PC_STATUS END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_TOT_PREM IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_TOT_PREM END <> CASE WHEN exp_HOLD_DATA.FGM_TOT_PREM IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_TOT_PREM END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_REWRITE_IND IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_REWRITE_IND END <> CASE WHEN exp_HOLD_DATA.FGM_REWRITE_IND IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_REWRITE_IND END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_REWRITE_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.FGM_REWRITE_DT END <> CASE WHEN exp_HOLD_DATA.FGM_REWRITE_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.FGM_REWRITE_DT END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_OUTST_AMT IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_OUTST_AMT END <> CASE WHEN exp_HOLD_DATA.FGM_OUTST_AMT IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_OUTST_AMT END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_OUTST_TYPE IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_OUTST_TYPE END <> CASE WHEN exp_HOLD_DATA.FGM_OUTST_TYPE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_OUTST_TYPE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_OUTST_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.FGM_OUTST_DATE END <> CASE WHEN exp_HOLD_DATA.FGM_OUTST_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.FGM_OUTST_DATE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_OUTST_PD_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.FGM_OUTST_PD_DATE END <> CASE WHEN exp_HOLD_DATA.FGM_OUTST_PD_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.FGM_OUTST_PD_DATE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SUSPENSE_CD IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SUSPENSE_CD END <> CASE WHEN exp_HOLD_DATA.FGM_SUSPENSE_CD IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SUSPENSE_CD END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SUSPENSE_CAN IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SUSPENSE_CAN END <> CASE WHEN exp_HOLD_DATA.FGM_SUSPENSE_CAN IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SUSPENSE_CAN END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SSN_1 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SSN_1 END <> CASE WHEN exp_HOLD_DATA.FGM_SSN_1 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SSN_1 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SSN_2 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SSN_2 END <> CASE WHEN exp_HOLD_DATA.FGM_SSN_2 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SSN_2 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_UW_REVIEW_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.FGM_UW_REVIEW_DT END <> CASE WHEN exp_HOLD_DATA.FGM_UW_REVIEW_DT IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.FGM_UW_REVIEW_DT END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_UW_INITIALS IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_UW_INITIALS END <> CASE WHEN exp_HOLD_DATA.FGM_UW_INITIALS IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_UW_INITIALS END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_MORT_NAME_1 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_MORT_NAME_1 END <> CASE WHEN exp_HOLD_DATA.FGM_MORT_NAME_1 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_MORT_NAME_1 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_MORT_NAME_2 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_MORT_NAME_2 END <> CASE WHEN exp_HOLD_DATA.FGM_MORT_NAME_2 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_MORT_NAME_2 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_MORT_ADD_1 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_MORT_ADD_1 END <> CASE WHEN exp_HOLD_DATA.FGM_MORT_ADD_1 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_MORT_ADD_1 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_MORT_ADD_2 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_MORT_ADD_2 END <> CASE WHEN exp_HOLD_DATA.FGM_MORT_ADD_2 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_MORT_ADD_2 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_MORT_CTYST IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_MORT_CTYST END <> CASE WHEN exp_HOLD_DATA.FGM_MORT_CTYST IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_MORT_CTYST END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_MORT_ZIP IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_MORT_ZIP END <> CASE WHEN exp_HOLD_DATA.FGM_MORT_ZIP IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_MORT_ZIP END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_STATE IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_STATE END <> CASE WHEN exp_HOLD_DATA.FGM_STATE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_STATE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_MORT_TYPE IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_MORT_TYPE END <> CASE WHEN exp_HOLD_DATA.FGM_MORT_TYPE IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_MORT_TYPE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_CANC_CODE IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_CANC_CODE END <> CASE WHEN exp_HOLD_DATA.FGM_CANC_CODE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_CANC_CODE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_LOAN_NUM IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_LOAN_NUM END <> CASE WHEN exp_HOLD_DATA.FGM_LOAN_NUM IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_LOAN_NUM END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SLOAN_NUM IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SLOAN_NUM END <> CASE WHEN exp_HOLD_DATA.FGM_SLOAN_NUM IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SLOAN_NUM END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SMORT_NAME_1 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SMORT_NAME_1 END <> CASE WHEN exp_HOLD_DATA.FGM_SMORT_NAME_1 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SMORT_NAME_1 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SMORT_NAME_2 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SMORT_NAME_2 END <> CASE WHEN exp_HOLD_DATA.FGM_SMORT_NAME_2 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SMORT_NAME_2 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SMORT_ADD_1 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SMORT_ADD_1 END <> CASE WHEN exp_HOLD_DATA.FGM_SMORT_ADD_1 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SMORT_ADD_1 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SMORT_ADD_2 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SMORT_ADD_2 END <> CASE WHEN exp_HOLD_DATA.FGM_SMORT_ADD_2 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SMORT_ADD_2 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SMORT_CTYST IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SMORT_CTYST END <> CASE WHEN exp_HOLD_DATA.FGM_SMORT_CTYST IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SMORT_CTYST END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SMORT_ZIP IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SMORT_ZIP END <> CASE WHEN exp_HOLD_DATA.FGM_SMORT_ZIP IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SMORT_ZIP END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SMORT_TYPE IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_SMORT_TYPE END <> CASE WHEN exp_HOLD_DATA.FGM_SMORT_TYPE IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_SMORT_TYPE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_PREMIUM_1 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_PREMIUM_1 END <> CASE WHEN exp_HOLD_DATA.FGM_PREMIUM_1 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_PREMIUM_1 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_PREMIUM_2 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_PREMIUM_2 END <> CASE WHEN exp_HOLD_DATA.FGM_PREMIUM_2 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_PREMIUM_2 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_PREMIUM_3 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_PREMIUM_3 END <> CASE WHEN exp_HOLD_DATA.FGM_PREMIUM_3 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_PREMIUM_3 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_PREMIUM_4 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_PREMIUM_4 END <> CASE WHEN exp_HOLD_DATA.FGM_PREMIUM_4 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_PREMIUM_4 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_PREMIUM_5 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_PREMIUM_5 END <> CASE WHEN exp_HOLD_DATA.FGM_PREMIUM_5 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_PREMIUM_5 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_PREMIUM_6 IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_PREMIUM_6 END <> CASE WHEN exp_HOLD_DATA.FGM_PREMIUM_6 IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_PREMIUM_6 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_COVERAGE_1 IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_COVERAGE_1 END <> CASE WHEN exp_HOLD_DATA.FGM_COVERAGE_1 IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_COVERAGE_1 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_COVERAGE_2 IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_COVERAGE_2 END <> CASE WHEN exp_HOLD_DATA.FGM_COVERAGE_2 IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_COVERAGE_2 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_COVERAGE_3 IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_COVERAGE_3 END <> CASE WHEN exp_HOLD_DATA.FGM_COVERAGE_3 IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_COVERAGE_3 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_COVERAGE_4 IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_COVERAGE_4 END <> CASE WHEN exp_HOLD_DATA.FGM_COVERAGE_4 IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_COVERAGE_4 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_COVERAGE_5 IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_COVERAGE_5 END <> CASE WHEN exp_HOLD_DATA.FGM_COVERAGE_5 IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_COVERAGE_5 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_COVERAGE_6 IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_COVERAGE_6 END <> CASE WHEN exp_HOLD_DATA.FGM_COVERAGE_6 IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_COVERAGE_6 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_COVERAGE_7 IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_COVERAGE_7 END <> CASE WHEN exp_HOLD_DATA.FGM_COVERAGE_7 IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_COVERAGE_7 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_COVERAGE_8 IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_COVERAGE_8 END <> CASE WHEN exp_HOLD_DATA.FGM_COVERAGE_8 IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_COVERAGE_8 END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_PUR_PRICE IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_T_PUR_PRICE END <> CASE WHEN exp_HOLD_DATA.FGM_T_PUR_PRICE IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_T_PUR_PRICE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_PUR_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.FGM_T_PUR_DATE END <> CASE WHEN exp_HOLD_DATA.FGM_T_PUR_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.FGM_T_PUR_DATE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_AMT_OWED IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_T_AMT_OWED END <> CASE WHEN exp_HOLD_DATA.FGM_T_AMT_OWED IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_T_AMT_OWED END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_MODEL_YEAR IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_T_MODEL_YEAR END <> CASE WHEN exp_HOLD_DATA.FGM_T_MODEL_YEAR IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_T_MODEL_YEAR END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_LENGTH IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_T_LENGTH END <> CASE WHEN exp_HOLD_DATA.FGM_T_LENGTH IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_T_LENGTH END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_WIDTH IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_T_WIDTH END <> CASE WHEN exp_HOLD_DATA.FGM_T_WIDTH IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_T_WIDTH END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_TIE_DOWN IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_T_TIE_DOWN END <> CASE WHEN exp_HOLD_DATA.FGM_T_TIE_DOWN IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_T_TIE_DOWN END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_FOUNDATION IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_T_FOUNDATION END <> CASE WHEN exp_HOLD_DATA.FGM_T_FOUNDATION IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_T_FOUNDATION END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_IN_PARK IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_T_IN_PARK END <> CASE WHEN exp_HOLD_DATA.FGM_T_IN_PARK IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_T_IN_PARK END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_OCCUPANCY IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_T_OCCUPANCY END <> CASE WHEN exp_HOLD_DATA.FGM_T_OCCUPANCY IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_T_OCCUPANCY END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_OCC_FT IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_T_OCC_FT END <> CASE WHEN exp_HOLD_DATA.FGM_T_OCC_FT IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_T_OCC_FT END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_RATE_CLASS IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_T_RATE_CLASS END <> CASE WHEN exp_HOLD_DATA.FGM_T_RATE_CLASS IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_T_RATE_CLASS END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_ENDORSEMENT IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_T_ENDORSEMENT END <> CASE WHEN exp_HOLD_DATA.FGM_T_ENDORSEMENT IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_T_ENDORSEMENT END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_VC_PERCENT IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_T_VC_PERCENT END <> CASE WHEN exp_HOLD_DATA.FGM_T_VC_PERCENT IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_T_VC_PERCENT END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_T_VC_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE LKP_FGMPOLS_DLY.FGM_T_VC_DATE END <> CASE WHEN exp_HOLD_DATA.FGM_T_VC_DATE IS NULL THEN TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) ELSE exp_HOLD_DATA.FGM_T_VC_DATE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SP_BT_CLASS IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SP_BT_CLASS END <> CASE WHEN exp_HOLD_DATA.FGM_SP_BT_CLASS IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SP_BT_CLASS END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_NUM_ACRES IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_NUM_ACRES END <> CASE WHEN exp_HOLD_DATA.FGM_FC_NUM_ACRES IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_NUM_ACRES END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_ADD_PREM IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_ADD_PREM END <> CASE WHEN exp_HOLD_DATA.FGM_FC_ADD_PREM IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_ADD_PREM END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_ADD_RENT IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_ADD_RENT END <> CASE WHEN exp_HOLD_DATA.FGM_FC_ADD_RENT IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_ADD_RENT END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_SEC_RES IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_SEC_RES END <> CASE WHEN exp_HOLD_DATA.FGM_FC_SEC_RES IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_SEC_RES END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_NUM_RENTED IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_NUM_RENTED END <> CASE WHEN exp_HOLD_DATA.FGM_FC_NUM_RENTED IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_NUM_RENTED END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_ADD_INSRD IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_ADD_INSRD END <> CASE WHEN exp_HOLD_DATA.FGM_FC_ADD_INSRD IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_ADD_INSRD END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_AN_COLL_CD IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_AN_COLL_CD END <> CASE WHEN exp_HOLD_DATA.FGM_FC_AN_COLL_CD IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_AN_COLL_CD END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_NUM_EMP IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_NUM_EMP END <> CASE WHEN exp_HOLD_DATA.FGM_FC_NUM_EMP IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_NUM_EMP END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_PAYROLL IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_PAYROLL END <> CASE WHEN exp_HOLD_DATA.FGM_FC_PAYROLL IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_PAYROLL END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_FC_CUST_FRM_CD IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_FC_CUST_FRM_CD END <> CASE WHEN exp_HOLD_DATA.FGM_FC_CUST_FRM_CD IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_FC_CUST_FRM_CD END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_DEDUCTIBLE IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_DEDUCTIBLE END <> CASE WHEN exp_HOLD_DATA.FGM_DEDUCTIBLE IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_DEDUCTIBLE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_LOCATION IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_LOCATION END <> CASE WHEN exp_HOLD_DATA.FGM_LOCATION IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_LOCATION END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SM_POLICY_IND IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SM_POLICY_IND END <> CASE WHEN exp_HOLD_DATA.FGM_SM_POLICY_IND IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SM_POLICY_IND END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_CM_HALF_TERM IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_CM_HALF_TERM END <> CASE WHEN exp_HOLD_DATA.FGM_CM_HALF_TERM IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_CM_HALF_TERM END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_CM_FULL_TERM IS NULL THEN 0 ELSE LKP_FGMPOLS_DLY.FGM_CM_FULL_TERM END <> CASE WHEN exp_HOLD_DATA.FGM_CM_FULL_TERM IS NULL THEN 0 ELSE exp_HOLD_DATA.FGM_CM_FULL_TERM END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SP5_ENDR_IND IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SP5_ENDR_IND END <> CASE WHEN exp_HOLD_DATA.FGM_SP5_ENDR_IND IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SP5_ENDR_IND END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_SP_BOAT_IND IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_SP_BOAT_IND END <> CASE WHEN exp_HOLD_DATA.FGM_SP_BOAT_IND IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_SP_BOAT_IND END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_MB_TYPE IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_MB_TYPE END <> CASE WHEN exp_HOLD_DATA.FGM_MB_TYPE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_MB_TYPE END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_MB_ACCT_NUM IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_MB_ACCT_NUM END <> CASE WHEN exp_HOLD_DATA.FGM_MB_ACCT_NUM IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_MB_ACCT_NUM END OR CASE WHEN LKP_FGMPOLS_DLY.FGM_GL_COV_TYPE IS NULL THEN ''~'' ELSE LKP_FGMPOLS_DLY.FGM_GL_COV_TYPE END <> CASE WHEN exp_HOLD_DATA.FGM_GL_COV_TYPE IS NULL THEN ''~'' ELSE exp_HOLD_DATA.FGM_GL_COV_TYPE END THEN ''UPD'' ELSE ''REJ'' END END as out_FLG,
LTRIM ( RTRIM ( :PMMappingName ) ) as out_PRGM_NM,
:PROJ_ID as out_PROJ_ID,
:BATCH_ACTIVE_IND as out_BATCH_ACTIVE_IND,
:PROJ_ID as IN_ACT_PROJ_ID,
:BATCH_ACTIVE_IND as IN_BATCH_ACTIVE_IND,
''m_STG_FIN_CLM'' IN_PRGM_NM,
null IN_TABLE_NM,
exp_HOLD_DATA.source_record_id
FROM
exp_HOLD_DATA
INNER JOIN LKP_FGMPOLS_DLY ON exp_HOLD_DATA.source_record_id = LKP_FGMPOLS_DLY.source_record_id
);


-- Component mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, Type MAPPLET 
--MAPPLET NOT REGISTERED: mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, mapplet instance mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE;
call mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE(''exp_DERIVE_FLAG'');

-- Component exp_FGMPOLS_DLY, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_FGMPOLS_DLY AS
(
SELECT
exp_DERIVE_FLAG.SC_POLICY_NUM_lkp as SC_POLICY_NUM_lkp,
exp_DERIVE_FLAG.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_DERIVE_FLAG.SC_FLT_ITEM_lkp as SC_FLT_ITEM_lkp,
exp_DERIVE_FLAG.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY,
exp_DERIVE_FLAG.SC_SERVICE_CENTER as SC_SERVICE_CENTER,
exp_DERIVE_FLAG.SC_POLICY_NUM as SC_POLICY_NUM,
exp_DERIVE_FLAG.SC_FLT_ITEM as SC_FLT_ITEM,
exp_DERIVE_FLAG.SC_FILE_TYPE as SC_FILE_TYPE,
exp_DERIVE_FLAG.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE,
exp_DERIVE_FLAG.SC_TRANS_DATE as SC_TRANS_DATE,
exp_DERIVE_FLAG.SC_TRANS_TYPE as SC_TRANS_TYPE,
exp_DERIVE_FLAG.PC_ALPHA_CODE as PC_ALPHA_CODE,
exp_DERIVE_FLAG.PC_NAME_1 as PC_NAME_1,
exp_DERIVE_FLAG.PC_NAME_2 as PC_NAME_2,
exp_DERIVE_FLAG.PC_ADDRESS_1 as PC_ADDRESS_1,
exp_DERIVE_FLAG.PC_ADDRESS_2 as PC_ADDRESS_2,
exp_DERIVE_FLAG.PC_CITYST as PC_CITYST,
exp_DERIVE_FLAG.PC_ZIP as PC_ZIP,
exp_DERIVE_FLAG.PC_TAX_CODE as PC_TAX_CODE,
exp_DERIVE_FLAG.PC_AGENT as PC_AGENT,
exp_DERIVE_FLAG.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER,
exp_DERIVE_FLAG.PC_RATE_CODE as PC_RATE_CODE,
exp_DERIVE_FLAG.PC_ENCUMBRANCE as PC_ENCUMBRANCE,
exp_DERIVE_FLAG.PC_PREM_FIN as PC_PREM_FIN,
exp_DERIVE_FLAG.PC_MORT_IND as PC_MORT_IND,
exp_DERIVE_FLAG.PC_COMPANY as PC_COMPANY,
exp_DERIVE_FLAG.PC_INCEPT_DATE as PC_INCEPT_DATE,
exp_DERIVE_FLAG.PC_EXP_DATE as PC_EXP_DATE,
exp_DERIVE_FLAG.PC_EFF_DATE as PC_EFF_DATE,
exp_DERIVE_FLAG.PC_STATUS as PC_STATUS,
exp_DERIVE_FLAG.FGM_TOT_PREM as FGM_TOT_PREM,
exp_DERIVE_FLAG.FGM_REWRITE_IND as FGM_REWRITE_IND,
exp_DERIVE_FLAG.FGM_REWRITE_DT as FGM_REWRITE_DT,
exp_DERIVE_FLAG.FGM_OUTST_AMT as FGM_OUTST_AMT,
exp_DERIVE_FLAG.FGM_OUTST_TYPE as FGM_OUTST_TYPE,
exp_DERIVE_FLAG.FGM_OUTST_DATE as FGM_OUTST_DATE,
exp_DERIVE_FLAG.FGM_OUTST_PD_DATE as FGM_OUTST_PD_DATE,
exp_DERIVE_FLAG.FGM_SUSPENSE_CD as FGM_SUSPENSE_CD,
exp_DERIVE_FLAG.FGM_SUSPENSE_CAN as FGM_SUSPENSE_CAN,
exp_DERIVE_FLAG.FGM_SSN_1 as FGM_SSN_1,
exp_DERIVE_FLAG.FGM_SSN_2 as FGM_SSN_2,
exp_DERIVE_FLAG.FGM_UW_REVIEW_DT as FGM_UW_REVIEW_DT,
exp_DERIVE_FLAG.FGM_UW_INITIALS as FGM_UW_INITIALS,
exp_DERIVE_FLAG.FGM_MORT_NAME_1 as FGM_MORT_NAME_1,
exp_DERIVE_FLAG.FGM_MORT_NAME_2 as FGM_MORT_NAME_2,
exp_DERIVE_FLAG.FGM_MORT_ADD_1 as FGM_MORT_ADD_1,
exp_DERIVE_FLAG.FGM_MORT_ADD_2 as FGM_MORT_ADD_2,
exp_DERIVE_FLAG.FGM_MORT_CTYST as FGM_MORT_CTYST,
exp_DERIVE_FLAG.FGM_MORT_ZIP as FGM_MORT_ZIP,
exp_DERIVE_FLAG.FGM_STATE as FGM_STATE,
exp_DERIVE_FLAG.FGM_MORT_TYPE as FGM_MORT_TYPE,
exp_DERIVE_FLAG.FGM_CANC_CODE as FGM_CANC_CODE,
exp_DERIVE_FLAG.FGM_LOAN_NUM as FGM_LOAN_NUM,
exp_DERIVE_FLAG.FGM_SLOAN_NUM as FGM_SLOAN_NUM,
exp_DERIVE_FLAG.FGM_SMORT_NAME_1 as FGM_SMORT_NAME_1,
exp_DERIVE_FLAG.FGM_SMORT_NAME_2 as FGM_SMORT_NAME_2,
exp_DERIVE_FLAG.FGM_SMORT_ADD_1 as FGM_SMORT_ADD_1,
exp_DERIVE_FLAG.FGM_SMORT_ADD_2 as FGM_SMORT_ADD_2,
exp_DERIVE_FLAG.FGM_SMORT_CTYST as FGM_SMORT_CTYST,
exp_DERIVE_FLAG.FGM_SMORT_ZIP as FGM_SMORT_ZIP,
exp_DERIVE_FLAG.FGM_SMORT_TYPE as FGM_SMORT_TYPE,
exp_DERIVE_FLAG.FGM_PREMIUM_1 as FGM_PREMIUM_1,
exp_DERIVE_FLAG.FGM_PREMIUM_2 as FGM_PREMIUM_2,
exp_DERIVE_FLAG.FGM_PREMIUM_3 as FGM_PREMIUM_3,
exp_DERIVE_FLAG.FGM_PREMIUM_4 as FGM_PREMIUM_4,
exp_DERIVE_FLAG.FGM_PREMIUM_5 as FGM_PREMIUM_5,
exp_DERIVE_FLAG.FGM_PREMIUM_6 as FGM_PREMIUM_6,
exp_DERIVE_FLAG.FGM_COVERAGE_1 as FGM_COVERAGE_1,
exp_DERIVE_FLAG.FGM_COVERAGE_2 as FGM_COVERAGE_2,
exp_DERIVE_FLAG.FGM_COVERAGE_3 as FGM_COVERAGE_3,
exp_DERIVE_FLAG.FGM_COVERAGE_4 as FGM_COVERAGE_4,
exp_DERIVE_FLAG.FGM_COVERAGE_5 as FGM_COVERAGE_5,
exp_DERIVE_FLAG.FGM_COVERAGE_6 as FGM_COVERAGE_6,
exp_DERIVE_FLAG.FGM_COVERAGE_7 as FGM_COVERAGE_7,
exp_DERIVE_FLAG.FGM_COVERAGE_8 as FGM_COVERAGE_8,
exp_DERIVE_FLAG.FGM_T_PUR_PRICE as FGM_T_PUR_PRICE,
exp_DERIVE_FLAG.FGM_T_PUR_DATE as FGM_T_PUR_DATE,
exp_DERIVE_FLAG.FGM_T_AMT_OWED as FGM_T_AMT_OWED,
exp_DERIVE_FLAG.FGM_T_MODEL_YEAR as FGM_T_MODEL_YEAR,
exp_DERIVE_FLAG.FGM_T_LENGTH as FGM_T_LENGTH,
exp_DERIVE_FLAG.FGM_T_WIDTH as FGM_T_WIDTH,
exp_DERIVE_FLAG.FGM_T_TIE_DOWN as FGM_T_TIE_DOWN,
exp_DERIVE_FLAG.FGM_T_FOUNDATION as FGM_T_FOUNDATION,
exp_DERIVE_FLAG.FGM_T_IN_PARK as FGM_T_IN_PARK,
exp_DERIVE_FLAG.FGM_T_OCCUPANCY as FGM_T_OCCUPANCY,
exp_DERIVE_FLAG.FGM_T_OCC_FT as FGM_T_OCC_FT,
exp_DERIVE_FLAG.FGM_T_RATE_CLASS as FGM_T_RATE_CLASS,
exp_DERIVE_FLAG.FGM_T_ENDORSEMENT as FGM_T_ENDORSEMENT,
exp_DERIVE_FLAG.FGM_T_VC_PERCENT as FGM_T_VC_PERCENT,
exp_DERIVE_FLAG.FGM_T_VC_DATE as FGM_T_VC_DATE,
exp_DERIVE_FLAG.FGM_SP_BT_CLASS as FGM_SP_BT_CLASS,
exp_DERIVE_FLAG.FGM_FC_NUM_ACRES as FGM_FC_NUM_ACRES,
exp_DERIVE_FLAG.FGM_FC_ADD_PREM as FGM_FC_ADD_PREM,
exp_DERIVE_FLAG.FGM_FC_ADD_RENT as FGM_FC_ADD_RENT,
exp_DERIVE_FLAG.FGM_FC_SEC_RES as FGM_FC_SEC_RES,
exp_DERIVE_FLAG.FGM_FC_NUM_RENTED as FGM_FC_NUM_RENTED,
exp_DERIVE_FLAG.FGM_FC_ADD_INSRD as FGM_FC_ADD_INSRD,
exp_DERIVE_FLAG.FGM_FC_AN_COLL_CD as FGM_FC_AN_COLL_CD,
exp_DERIVE_FLAG.FGM_FC_NUM_EMP as FGM_FC_NUM_EMP,
exp_DERIVE_FLAG.FGM_FC_PAYROLL as FGM_FC_PAYROLL,
exp_DERIVE_FLAG.FGM_FC_CUST_FRM_CD as FGM_FC_CUST_FRM_CD,
exp_DERIVE_FLAG.FGM_DEDUCTIBLE as FGM_DEDUCTIBLE,
exp_DERIVE_FLAG.FGM_LOCATION as FGM_LOCATION,
exp_DERIVE_FLAG.FGM_SM_POLICY_IND as FGM_SM_POLICY_IND,
exp_DERIVE_FLAG.FGM_CM_HALF_TERM as FGM_CM_HALF_TERM,
exp_DERIVE_FLAG.FGM_CM_FULL_TERM as FGM_CM_FULL_TERM,
exp_DERIVE_FLAG.FGM_SP5_ENDR_IND as FGM_SP5_ENDR_IND,
exp_DERIVE_FLAG.FGM_SP_BOAT_IND as FGM_SP_BOAT_IND,
exp_DERIVE_FLAG.FGM_MB_TYPE as FGM_MB_TYPE,
exp_DERIVE_FLAG.FGM_MB_ACCT_NUM as FGM_MB_ACCT_NUM,
exp_DERIVE_FLAG.FGM_GL_COV_TYPE as FGM_GL_COV_TYPE,
exp_DERIVE_FLAG.LOAD_DT as LOAD_DT,
exp_DERIVE_FLAG.FEED_IND as FEED_IND,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_PRGM_ID as ECTL_PRGM_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_ID as ECTL_SRC_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_SRC_INST_ID as ECTL_SRC_INST_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_ID as ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ORIG_INS_TS as ORIG_INS_TS,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.out_ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE,
--null as ECTL_PRGM_ID,
--null as ECTL_SRC_ID,
--n--ull as ECTL_SRC_INST_ID,
--null as ECTL_BATCH_ID,
--null as ORIG_INS_TS,
--null as ECTL_BATCH_START_DATE,
exp_DERIVE_FLAG.out_FLG as FLG,
exp_DERIVE_FLAG.source_record_id
FROM
exp_DERIVE_FLAG
INNER JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE ON exp_DERIVE_FLAG.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE.source_record_id
);


-- Component rtr_INS_UPD_INSERT, Type ROUTER Output Group INSERT
create or replace temp table RTR_INS_UPD_INSERT as
SELECT
exp_FGMPOLS_DLY.SC_POLICY_NUM_lkp as SC_POLICY_NUM_lkp,
exp_FGMPOLS_DLY.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_FGMPOLS_DLY.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY,
exp_FGMPOLS_DLY.SC_SERVICE_CENTER as SC_SERVICE_CENTER,
exp_FGMPOLS_DLY.SC_POLICY_NUM as SC_POLICY_NUM,
exp_FGMPOLS_DLY.SC_FLT_ITEM as SC_FLT_ITEM,
exp_FGMPOLS_DLY.SC_FILE_TYPE as SC_FILE_TYPE,
exp_FGMPOLS_DLY.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE,
exp_FGMPOLS_DLY.SC_TRANS_DATE as SC_TRANS_DATE,
exp_FGMPOLS_DLY.SC_TRANS_TYPE as SC_TRANS_TYPE,
exp_FGMPOLS_DLY.PC_ALPHA_CODE as PC_ALPHA_CODE,
exp_FGMPOLS_DLY.PC_NAME_1 as PC_NAME_1,
exp_FGMPOLS_DLY.PC_NAME_2 as PC_NAME_2,
exp_FGMPOLS_DLY.PC_ADDRESS_1 as PC_ADDRESS_1,
exp_FGMPOLS_DLY.PC_ADDRESS_2 as PC_ADDRESS_2,
exp_FGMPOLS_DLY.PC_CITYST as PC_CITYST,
exp_FGMPOLS_DLY.PC_ZIP as PC_ZIP,
exp_FGMPOLS_DLY.PC_TAX_CODE as PC_TAX_CODE,
exp_FGMPOLS_DLY.PC_AGENT as PC_AGENT,
exp_FGMPOLS_DLY.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER,
exp_FGMPOLS_DLY.PC_RATE_CODE as PC_RATE_CODE,
exp_FGMPOLS_DLY.PC_ENCUMBRANCE as PC_ENCUMBRANCE,
exp_FGMPOLS_DLY.PC_PREM_FIN as PC_PREM_FIN,
exp_FGMPOLS_DLY.PC_MORT_IND as PC_MORT_IND,
exp_FGMPOLS_DLY.PC_COMPANY as PC_COMPANY,
exp_FGMPOLS_DLY.PC_INCEPT_DATE as PC_INCEPT_DATE,
exp_FGMPOLS_DLY.PC_EXP_DATE as PC_EXP_DATE,
exp_FGMPOLS_DLY.PC_EFF_DATE as PC_EFF_DATE,
exp_FGMPOLS_DLY.PC_STATUS as PC_STATUS,
exp_FGMPOLS_DLY.FGM_TOT_PREM as FGM_TOT_PREM,
exp_FGMPOLS_DLY.FGM_REWRITE_IND as FGM_REWRITE_IND,
exp_FGMPOLS_DLY.FGM_REWRITE_DT as FGM_REWRITE_DT,
exp_FGMPOLS_DLY.FGM_OUTST_AMT as FGM_OUTST_AMT,
exp_FGMPOLS_DLY.FGM_OUTST_TYPE as FGM_OUTST_TYPE,
exp_FGMPOLS_DLY.FGM_OUTST_DATE as FGM_OUTST_DATE,
exp_FGMPOLS_DLY.FGM_OUTST_PD_DATE as FGM_OUTST_PD_DATE,
exp_FGMPOLS_DLY.FGM_SUSPENSE_CD as FGM_SUSPENSE_CD,
exp_FGMPOLS_DLY.FGM_SUSPENSE_CAN as FGM_SUSPENSE_CAN,
exp_FGMPOLS_DLY.FGM_SSN_1 as FGM_SSN_1,
exp_FGMPOLS_DLY.FGM_SSN_2 as FGM_SSN_2,
exp_FGMPOLS_DLY.FGM_UW_REVIEW_DT as FGM_UW_REVIEW_DT,
exp_FGMPOLS_DLY.FGM_UW_INITIALS as FGM_UW_INITIALS,
exp_FGMPOLS_DLY.FGM_MORT_NAME_1 as FGM_MORT_NAME_1,
exp_FGMPOLS_DLY.FGM_MORT_NAME_2 as FGM_MORT_NAME_2,
exp_FGMPOLS_DLY.FGM_MORT_ADD_1 as FGM_MORT_ADD_1,
exp_FGMPOLS_DLY.FGM_MORT_ADD_2 as FGM_MORT_ADD_2,
exp_FGMPOLS_DLY.FGM_MORT_CTYST as FGM_MORT_CTYST,
exp_FGMPOLS_DLY.FGM_MORT_ZIP as FGM_MORT_ZIP,
exp_FGMPOLS_DLY.FGM_STATE as FGM_STATE,
exp_FGMPOLS_DLY.FGM_MORT_TYPE as FGM_MORT_TYPE,
exp_FGMPOLS_DLY.FGM_CANC_CODE as FGM_CANC_CODE,
exp_FGMPOLS_DLY.FGM_LOAN_NUM as FGM_LOAN_NUM,
exp_FGMPOLS_DLY.FGM_SLOAN_NUM as FGM_SLOAN_NUM,
exp_FGMPOLS_DLY.FGM_SMORT_NAME_1 as FGM_SMORT_NAME_1,
exp_FGMPOLS_DLY.FGM_SMORT_NAME_2 as FGM_SMORT_NAME_2,
exp_FGMPOLS_DLY.FGM_SMORT_ADD_1 as FGM_SMORT_ADD_1,
exp_FGMPOLS_DLY.FGM_SMORT_ADD_2 as FGM_SMORT_ADD_2,
exp_FGMPOLS_DLY.FGM_SMORT_CTYST as FGM_SMORT_CTYST,
exp_FGMPOLS_DLY.FGM_SMORT_ZIP as FGM_SMORT_ZIP,
exp_FGMPOLS_DLY.FGM_SMORT_TYPE as FGM_SMORT_TYPE,
exp_FGMPOLS_DLY.FGM_PREMIUM_1 as FGM_PREMIUM_1,
exp_FGMPOLS_DLY.FGM_PREMIUM_2 as FGM_PREMIUM_2,
exp_FGMPOLS_DLY.FGM_PREMIUM_3 as FGM_PREMIUM_3,
exp_FGMPOLS_DLY.FGM_PREMIUM_4 as FGM_PREMIUM_4,
exp_FGMPOLS_DLY.FGM_PREMIUM_5 as FGM_PREMIUM_5,
exp_FGMPOLS_DLY.FGM_PREMIUM_6 as FGM_PREMIUM_6,
exp_FGMPOLS_DLY.FGM_COVERAGE_1 as FGM_COVERAGE_1,
exp_FGMPOLS_DLY.FGM_COVERAGE_2 as FGM_COVERAGE_2,
exp_FGMPOLS_DLY.FGM_COVERAGE_3 as FGM_COVERAGE_3,
exp_FGMPOLS_DLY.FGM_COVERAGE_4 as FGM_COVERAGE_4,
exp_FGMPOLS_DLY.FGM_COVERAGE_5 as FGM_COVERAGE_5,
exp_FGMPOLS_DLY.FGM_COVERAGE_6 as FGM_COVERAGE_6,
exp_FGMPOLS_DLY.FGM_COVERAGE_7 as FGM_COVERAGE_7,
exp_FGMPOLS_DLY.FGM_COVERAGE_8 as FGM_COVERAGE_8,
exp_FGMPOLS_DLY.FGM_T_PUR_PRICE as FGM_T_PUR_PRICE,
exp_FGMPOLS_DLY.FGM_T_PUR_DATE as FGM_T_PUR_DATE,
exp_FGMPOLS_DLY.FGM_T_AMT_OWED as FGM_T_AMT_OWED,
exp_FGMPOLS_DLY.FGM_T_MODEL_YEAR as FGM_T_MODEL_YEAR,
exp_FGMPOLS_DLY.FGM_T_LENGTH as FGM_T_LENGTH,
exp_FGMPOLS_DLY.FGM_T_WIDTH as FGM_T_WIDTH,
exp_FGMPOLS_DLY.FGM_T_TIE_DOWN as FGM_T_TIE_DOWN,
exp_FGMPOLS_DLY.FGM_T_FOUNDATION as FGM_T_FOUNDATION,
exp_FGMPOLS_DLY.FGM_T_IN_PARK as FGM_T_IN_PARK,
exp_FGMPOLS_DLY.FGM_T_OCCUPANCY as FGM_T_OCCUPANCY,
exp_FGMPOLS_DLY.FGM_T_OCC_FT as FGM_T_OCC_FT,
exp_FGMPOLS_DLY.FGM_T_RATE_CLASS as FGM_T_RATE_CLASS,
exp_FGMPOLS_DLY.FGM_T_ENDORSEMENT as FGM_T_ENDORSEMENT,
exp_FGMPOLS_DLY.FGM_T_VC_PERCENT as FGM_T_VC_PERCENT,
exp_FGMPOLS_DLY.FGM_T_VC_DATE as FGM_T_VC_DATE,
exp_FGMPOLS_DLY.FGM_SP_BT_CLASS as FGM_SP_BT_CLASS,
exp_FGMPOLS_DLY.FGM_FC_NUM_ACRES as FGM_FC_NUM_ACRES,
exp_FGMPOLS_DLY.FGM_FC_ADD_PREM as FGM_FC_ADD_PREM,
exp_FGMPOLS_DLY.FGM_FC_ADD_RENT as FGM_FC_ADD_RENT,
exp_FGMPOLS_DLY.FGM_FC_SEC_RES as FGM_FC_SEC_RES,
exp_FGMPOLS_DLY.FGM_FC_NUM_RENTED as FGM_FC_NUM_RENTED,
exp_FGMPOLS_DLY.FGM_FC_ADD_INSRD as FGM_FC_ADD_INSRD,
exp_FGMPOLS_DLY.FGM_FC_AN_COLL_CD as FGM_FC_AN_COLL_CD,
exp_FGMPOLS_DLY.FGM_FC_NUM_EMP as FGM_FC_NUM_EMP,
exp_FGMPOLS_DLY.FGM_FC_PAYROLL as FGM_FC_PAYROLL,
exp_FGMPOLS_DLY.FGM_FC_CUST_FRM_CD as FGM_FC_CUST_FRM_CD,
exp_FGMPOLS_DLY.FGM_DEDUCTIBLE as FGM_DEDUCTIBLE,
exp_FGMPOLS_DLY.FGM_LOCATION as FGM_LOCATION,
exp_FGMPOLS_DLY.FGM_SM_POLICY_IND as FGM_SM_POLICY_IND,
exp_FGMPOLS_DLY.FGM_CM_HALF_TERM as FGM_CM_HALF_TERM,
exp_FGMPOLS_DLY.FGM_CM_FULL_TERM as FGM_CM_FULL_TERM,
exp_FGMPOLS_DLY.FGM_SP5_ENDR_IND as FGM_SP5_ENDR_IND,
exp_FGMPOLS_DLY.FGM_SP_BOAT_IND as FGM_SP_BOAT_IND,
exp_FGMPOLS_DLY.FGM_MB_TYPE as FGM_MB_TYPE,
exp_FGMPOLS_DLY.FGM_MB_ACCT_NUM as FGM_MB_ACCT_NUM,
exp_FGMPOLS_DLY.FGM_GL_COV_TYPE as FGM_GL_COV_TYPE,
exp_FGMPOLS_DLY.LOAD_DT as LOAD_DT,
exp_FGMPOLS_DLY.FEED_IND as FEED_IND,
exp_FGMPOLS_DLY.ECTL_PRGM_ID as ECTL_PRGM_ID,
exp_FGMPOLS_DLY.ECTL_SRC_ID as ECTL_SRC_ID,
exp_FGMPOLS_DLY.ECTL_SRC_INST_ID as ECTL_SRC_INST_ID,
exp_FGMPOLS_DLY.ECTL_BATCH_ID as ECTL_BATCH_ID,
exp_FGMPOLS_DLY.ORIG_INS_TS as ORIG_INS_TS,
exp_FGMPOLS_DLY.ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE,
exp_FGMPOLS_DLY.FLG as FLG,
exp_FGMPOLS_DLY.source_record_id
FROM
exp_FGMPOLS_DLY
WHERE ( exp_FGMPOLS_DLY.FLG = ''NEW'' ) OR ( exp_FGMPOLS_DLY.FLG = ''UPD'' );


-- Component rtr_INS_UPD_UPDATE, Type ROUTER Output Group UPDATE
create or replace temp table RTR_INS_UPD_UPDATE as
SELECT
exp_FGMPOLS_DLY.SC_POLICY_NUM_lkp as SC_POLICY_NUM_lkp,
exp_FGMPOLS_DLY.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp,
exp_FGMPOLS_DLY.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY,
exp_FGMPOLS_DLY.SC_SERVICE_CENTER as SC_SERVICE_CENTER,
exp_FGMPOLS_DLY.SC_POLICY_NUM as SC_POLICY_NUM,
exp_FGMPOLS_DLY.SC_FLT_ITEM as SC_FLT_ITEM,
exp_FGMPOLS_DLY.SC_FILE_TYPE as SC_FILE_TYPE,
exp_FGMPOLS_DLY.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE,
exp_FGMPOLS_DLY.SC_TRANS_DATE as SC_TRANS_DATE,
exp_FGMPOLS_DLY.SC_TRANS_TYPE as SC_TRANS_TYPE,
exp_FGMPOLS_DLY.PC_ALPHA_CODE as PC_ALPHA_CODE,
exp_FGMPOLS_DLY.PC_NAME_1 as PC_NAME_1,
exp_FGMPOLS_DLY.PC_NAME_2 as PC_NAME_2,
exp_FGMPOLS_DLY.PC_ADDRESS_1 as PC_ADDRESS_1,
exp_FGMPOLS_DLY.PC_ADDRESS_2 as PC_ADDRESS_2,
exp_FGMPOLS_DLY.PC_CITYST as PC_CITYST,
exp_FGMPOLS_DLY.PC_ZIP as PC_ZIP,
exp_FGMPOLS_DLY.PC_TAX_CODE as PC_TAX_CODE,
exp_FGMPOLS_DLY.PC_AGENT as PC_AGENT,
exp_FGMPOLS_DLY.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER,
exp_FGMPOLS_DLY.PC_RATE_CODE as PC_RATE_CODE,
exp_FGMPOLS_DLY.PC_ENCUMBRANCE as PC_ENCUMBRANCE,
exp_FGMPOLS_DLY.PC_PREM_FIN as PC_PREM_FIN,
exp_FGMPOLS_DLY.PC_MORT_IND as PC_MORT_IND,
exp_FGMPOLS_DLY.PC_COMPANY as PC_COMPANY,
exp_FGMPOLS_DLY.PC_INCEPT_DATE as PC_INCEPT_DATE,
exp_FGMPOLS_DLY.PC_EXP_DATE as PC_EXP_DATE,
exp_FGMPOLS_DLY.PC_EFF_DATE as PC_EFF_DATE,
exp_FGMPOLS_DLY.PC_STATUS as PC_STATUS,
exp_FGMPOLS_DLY.FGM_TOT_PREM as FGM_TOT_PREM,
exp_FGMPOLS_DLY.FGM_REWRITE_IND as FGM_REWRITE_IND,
exp_FGMPOLS_DLY.FGM_REWRITE_DT as FGM_REWRITE_DT,
exp_FGMPOLS_DLY.FGM_OUTST_AMT as FGM_OUTST_AMT,
exp_FGMPOLS_DLY.FGM_OUTST_TYPE as FGM_OUTST_TYPE,
exp_FGMPOLS_DLY.FGM_OUTST_DATE as FGM_OUTST_DATE,
exp_FGMPOLS_DLY.FGM_OUTST_PD_DATE as FGM_OUTST_PD_DATE,
exp_FGMPOLS_DLY.FGM_SUSPENSE_CD as FGM_SUSPENSE_CD,
exp_FGMPOLS_DLY.FGM_SUSPENSE_CAN as FGM_SUSPENSE_CAN,
exp_FGMPOLS_DLY.FGM_SSN_1 as FGM_SSN_1,
exp_FGMPOLS_DLY.FGM_SSN_2 as FGM_SSN_2,
exp_FGMPOLS_DLY.FGM_UW_REVIEW_DT as FGM_UW_REVIEW_DT,
exp_FGMPOLS_DLY.FGM_UW_INITIALS as FGM_UW_INITIALS,
exp_FGMPOLS_DLY.FGM_MORT_NAME_1 as FGM_MORT_NAME_1,
exp_FGMPOLS_DLY.FGM_MORT_NAME_2 as FGM_MORT_NAME_2,
exp_FGMPOLS_DLY.FGM_MORT_ADD_1 as FGM_MORT_ADD_1,
exp_FGMPOLS_DLY.FGM_MORT_ADD_2 as FGM_MORT_ADD_2,
exp_FGMPOLS_DLY.FGM_MORT_CTYST as FGM_MORT_CTYST,
exp_FGMPOLS_DLY.FGM_MORT_ZIP as FGM_MORT_ZIP,
exp_FGMPOLS_DLY.FGM_STATE as FGM_STATE,
exp_FGMPOLS_DLY.FGM_MORT_TYPE as FGM_MORT_TYPE,
exp_FGMPOLS_DLY.FGM_CANC_CODE as FGM_CANC_CODE,
exp_FGMPOLS_DLY.FGM_LOAN_NUM as FGM_LOAN_NUM,
exp_FGMPOLS_DLY.FGM_SLOAN_NUM as FGM_SLOAN_NUM,
exp_FGMPOLS_DLY.FGM_SMORT_NAME_1 as FGM_SMORT_NAME_1,
exp_FGMPOLS_DLY.FGM_SMORT_NAME_2 as FGM_SMORT_NAME_2,
exp_FGMPOLS_DLY.FGM_SMORT_ADD_1 as FGM_SMORT_ADD_1,
exp_FGMPOLS_DLY.FGM_SMORT_ADD_2 as FGM_SMORT_ADD_2,
exp_FGMPOLS_DLY.FGM_SMORT_CTYST as FGM_SMORT_CTYST,
exp_FGMPOLS_DLY.FGM_SMORT_ZIP as FGM_SMORT_ZIP,
exp_FGMPOLS_DLY.FGM_SMORT_TYPE as FGM_SMORT_TYPE,
exp_FGMPOLS_DLY.FGM_PREMIUM_1 as FGM_PREMIUM_1,
exp_FGMPOLS_DLY.FGM_PREMIUM_2 as FGM_PREMIUM_2,
exp_FGMPOLS_DLY.FGM_PREMIUM_3 as FGM_PREMIUM_3,
exp_FGMPOLS_DLY.FGM_PREMIUM_4 as FGM_PREMIUM_4,
exp_FGMPOLS_DLY.FGM_PREMIUM_5 as FGM_PREMIUM_5,
exp_FGMPOLS_DLY.FGM_PREMIUM_6 as FGM_PREMIUM_6,
exp_FGMPOLS_DLY.FGM_COVERAGE_1 as FGM_COVERAGE_1,
exp_FGMPOLS_DLY.FGM_COVERAGE_2 as FGM_COVERAGE_2,
exp_FGMPOLS_DLY.FGM_COVERAGE_3 as FGM_COVERAGE_3,
exp_FGMPOLS_DLY.FGM_COVERAGE_4 as FGM_COVERAGE_4,
exp_FGMPOLS_DLY.FGM_COVERAGE_5 as FGM_COVERAGE_5,
exp_FGMPOLS_DLY.FGM_COVERAGE_6 as FGM_COVERAGE_6,
exp_FGMPOLS_DLY.FGM_COVERAGE_7 as FGM_COVERAGE_7,
exp_FGMPOLS_DLY.FGM_COVERAGE_8 as FGM_COVERAGE_8,
exp_FGMPOLS_DLY.FGM_T_PUR_PRICE as FGM_T_PUR_PRICE,
exp_FGMPOLS_DLY.FGM_T_PUR_DATE as FGM_T_PUR_DATE,
exp_FGMPOLS_DLY.FGM_T_AMT_OWED as FGM_T_AMT_OWED,
exp_FGMPOLS_DLY.FGM_T_MODEL_YEAR as FGM_T_MODEL_YEAR,
exp_FGMPOLS_DLY.FGM_T_LENGTH as FGM_T_LENGTH,
exp_FGMPOLS_DLY.FGM_T_WIDTH as FGM_T_WIDTH,
exp_FGMPOLS_DLY.FGM_T_TIE_DOWN as FGM_T_TIE_DOWN,
exp_FGMPOLS_DLY.FGM_T_FOUNDATION as FGM_T_FOUNDATION,
exp_FGMPOLS_DLY.FGM_T_IN_PARK as FGM_T_IN_PARK,
exp_FGMPOLS_DLY.FGM_T_OCCUPANCY as FGM_T_OCCUPANCY,
exp_FGMPOLS_DLY.FGM_T_OCC_FT as FGM_T_OCC_FT,
exp_FGMPOLS_DLY.FGM_T_RATE_CLASS as FGM_T_RATE_CLASS,
exp_FGMPOLS_DLY.FGM_T_ENDORSEMENT as FGM_T_ENDORSEMENT,
exp_FGMPOLS_DLY.FGM_T_VC_PERCENT as FGM_T_VC_PERCENT,
exp_FGMPOLS_DLY.FGM_T_VC_DATE as FGM_T_VC_DATE,
exp_FGMPOLS_DLY.FGM_SP_BT_CLASS as FGM_SP_BT_CLASS,
exp_FGMPOLS_DLY.FGM_FC_NUM_ACRES as FGM_FC_NUM_ACRES,
exp_FGMPOLS_DLY.FGM_FC_ADD_PREM as FGM_FC_ADD_PREM,
exp_FGMPOLS_DLY.FGM_FC_ADD_RENT as FGM_FC_ADD_RENT,
exp_FGMPOLS_DLY.FGM_FC_SEC_RES as FGM_FC_SEC_RES,
exp_FGMPOLS_DLY.FGM_FC_NUM_RENTED as FGM_FC_NUM_RENTED,
exp_FGMPOLS_DLY.FGM_FC_ADD_INSRD as FGM_FC_ADD_INSRD,
exp_FGMPOLS_DLY.FGM_FC_AN_COLL_CD as FGM_FC_AN_COLL_CD,
exp_FGMPOLS_DLY.FGM_FC_NUM_EMP as FGM_FC_NUM_EMP,
exp_FGMPOLS_DLY.FGM_FC_PAYROLL as FGM_FC_PAYROLL,
exp_FGMPOLS_DLY.FGM_FC_CUST_FRM_CD as FGM_FC_CUST_FRM_CD,
exp_FGMPOLS_DLY.FGM_DEDUCTIBLE as FGM_DEDUCTIBLE,
exp_FGMPOLS_DLY.FGM_LOCATION as FGM_LOCATION,
exp_FGMPOLS_DLY.FGM_SM_POLICY_IND as FGM_SM_POLICY_IND,
exp_FGMPOLS_DLY.FGM_CM_HALF_TERM as FGM_CM_HALF_TERM,
exp_FGMPOLS_DLY.FGM_CM_FULL_TERM as FGM_CM_FULL_TERM,
exp_FGMPOLS_DLY.FGM_SP5_ENDR_IND as FGM_SP5_ENDR_IND,
exp_FGMPOLS_DLY.FGM_SP_BOAT_IND as FGM_SP_BOAT_IND,
exp_FGMPOLS_DLY.FGM_MB_TYPE as FGM_MB_TYPE,
exp_FGMPOLS_DLY.FGM_MB_ACCT_NUM as FGM_MB_ACCT_NUM,
exp_FGMPOLS_DLY.FGM_GL_COV_TYPE as FGM_GL_COV_TYPE,
exp_FGMPOLS_DLY.LOAD_DT as LOAD_DT,
exp_FGMPOLS_DLY.FEED_IND as FEED_IND,
exp_FGMPOLS_DLY.ECTL_PRGM_ID as ECTL_PRGM_ID,
exp_FGMPOLS_DLY.ECTL_SRC_ID as ECTL_SRC_ID,
exp_FGMPOLS_DLY.ECTL_SRC_INST_ID as ECTL_SRC_INST_ID,
exp_FGMPOLS_DLY.ECTL_BATCH_ID as ECTL_BATCH_ID,
exp_FGMPOLS_DLY.ORIG_INS_TS as ORIG_INS_TS,
exp_FGMPOLS_DLY.ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE,
exp_FGMPOLS_DLY.FLG as FLG,
exp_FGMPOLS_DLY.source_record_id
FROM
exp_FGMPOLS_DLY
WHERE exp_FGMPOLS_DLY.FLG = ''UPD'';


-- Component exp_GET_EXP_DATE, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_GET_EXP_DATE AS
(
SELECT
rtr_INS_UPD_UPDATE.SC_POLICY_NUM_lkp as SC_POLICY_NUM_lkp3,
rtr_INS_UPD_UPDATE.CHG_EFF_DT_lkp as CHG_EFF_DT_lkp3,
rtr_INS_UPD_UPDATE.ECTL_BATCH_ID as ECTL_BATCH_ID3,
rtr_INS_UPD_UPDATE.FLG as FLG3,
 rtr_INS_UPD_UPDATE.LOAD_DT  - 1  as var_CHG_EXP_DT_NEW,
CASE WHEN rtr_INS_UPD_UPDATE.CHG_EFF_DT_lkp >= var_CHG_EXP_DT_NEW THEN rtr_INS_UPD_UPDATE.CHG_EFF_DT_lkp ELSE var_CHG_EXP_DT_NEW END as out_CHG_EXP_DT_NEW,
CURRENT_TIMESTAMP as out_ECTL_END_DT,
rtr_INS_UPD_UPDATE.ORIG_INS_TS as ORIG_INS_TS3,
rtr_INS_UPD_UPDATE.source_record_id
FROM
rtr_INS_UPD_UPDATE
);


-- Component exp_GET_EFF_DATE, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_GET_EFF_DATE AS
(
SELECT
rtr_INS_UPD_INSERT.SC_DWNLD_PRIORITY as SC_DWNLD_PRIORITY1,
rtr_INS_UPD_INSERT.SC_SERVICE_CENTER as SC_SERVICE_CENTER1,
rtr_INS_UPD_INSERT.SC_POLICY_NUM as SC_POLICY_NUM1,
rtr_INS_UPD_INSERT.SC_FLT_ITEM as SC_FLT_ITEM1,
rtr_INS_UPD_INSERT.SC_FILE_TYPE as SC_FILE_TYPE1,
rtr_INS_UPD_INSERT.SC_REC_TRANS_CODE as SC_REC_TRANS_CODE1,
rtr_INS_UPD_INSERT.SC_TRANS_DATE as SC_TRANS_DATE1,
rtr_INS_UPD_INSERT.SC_TRANS_TYPE as SC_TRANS_TYPE1,
rtr_INS_UPD_INSERT.PC_ALPHA_CODE as PC_ALPHA_CODE1,
rtr_INS_UPD_INSERT.PC_NAME_1 as PC_NAME_11,
rtr_INS_UPD_INSERT.PC_NAME_2 as PC_NAME_21,
rtr_INS_UPD_INSERT.PC_ADDRESS_1 as PC_ADDRESS_11,
rtr_INS_UPD_INSERT.PC_ADDRESS_2 as PC_ADDRESS_21,
rtr_INS_UPD_INSERT.PC_CITYST as PC_CITYST1,
rtr_INS_UPD_INSERT.PC_ZIP as PC_ZIP1,
rtr_INS_UPD_INSERT.PC_TAX_CODE as PC_TAX_CODE1,
rtr_INS_UPD_INSERT.PC_AGENT as PC_AGENT1,
rtr_INS_UPD_INSERT.PC_MEMBER_NUMBER as PC_MEMBER_NUMBER1,
rtr_INS_UPD_INSERT.PC_RATE_CODE as PC_RATE_CODE1,
rtr_INS_UPD_INSERT.PC_ENCUMBRANCE as PC_ENCUMBRANCE1,
rtr_INS_UPD_INSERT.PC_PREM_FIN as PC_PREM_FIN1,
rtr_INS_UPD_INSERT.PC_MORT_IND as PC_MORT_IND1,
rtr_INS_UPD_INSERT.PC_COMPANY as PC_COMPANY1,
rtr_INS_UPD_INSERT.PC_INCEPT_DATE as PC_INCEPT_DATE1,
rtr_INS_UPD_INSERT.PC_EXP_DATE as PC_EXP_DATE1,
rtr_INS_UPD_INSERT.PC_EFF_DATE as PC_EFF_DATE1,
rtr_INS_UPD_INSERT.PC_STATUS as PC_STATUS1,
rtr_INS_UPD_INSERT.FGM_TOT_PREM as FGM_TOT_PREM1,
rtr_INS_UPD_INSERT.FGM_REWRITE_IND as FGM_REWRITE_IND1,
rtr_INS_UPD_INSERT.FGM_REWRITE_DT as FGM_REWRITE_DT1,
rtr_INS_UPD_INSERT.FGM_OUTST_AMT as FGM_OUTST_AMT1,
rtr_INS_UPD_INSERT.FGM_OUTST_TYPE as FGM_OUTST_TYPE1,
rtr_INS_UPD_INSERT.FGM_OUTST_DATE as FGM_OUTST_DATE1,
rtr_INS_UPD_INSERT.FGM_OUTST_PD_DATE as FGM_OUTST_PD_DATE1,
rtr_INS_UPD_INSERT.FGM_SUSPENSE_CD as FGM_SUSPENSE_CD1,
rtr_INS_UPD_INSERT.FGM_SUSPENSE_CAN as FGM_SUSPENSE_CAN1,
rtr_INS_UPD_INSERT.FGM_SSN_1 as FGM_SSN_11,
rtr_INS_UPD_INSERT.FGM_SSN_2 as FGM_SSN_21,
rtr_INS_UPD_INSERT.FGM_UW_REVIEW_DT as FGM_UW_REVIEW_DT1,
rtr_INS_UPD_INSERT.FGM_UW_INITIALS as FGM_UW_INITIALS1,
rtr_INS_UPD_INSERT.FGM_MORT_NAME_1 as FGM_MORT_NAME_11,
rtr_INS_UPD_INSERT.FGM_MORT_NAME_2 as FGM_MORT_NAME_21,
rtr_INS_UPD_INSERT.FGM_MORT_ADD_1 as FGM_MORT_ADD_11,
rtr_INS_UPD_INSERT.FGM_MORT_ADD_2 as FGM_MORT_ADD_21,
rtr_INS_UPD_INSERT.FGM_MORT_CTYST as FGM_MORT_CTYST1,
rtr_INS_UPD_INSERT.FGM_MORT_ZIP as FGM_MORT_ZIP1,
rtr_INS_UPD_INSERT.FGM_STATE as FGM_STATE1,
rtr_INS_UPD_INSERT.FGM_MORT_TYPE as FGM_MORT_TYPE1,
rtr_INS_UPD_INSERT.FGM_CANC_CODE as FGM_CANC_CODE1,
rtr_INS_UPD_INSERT.FGM_LOAN_NUM as FGM_LOAN_NUM1,
rtr_INS_UPD_INSERT.FGM_SLOAN_NUM as FGM_SLOAN_NUM1,
rtr_INS_UPD_INSERT.FGM_SMORT_NAME_1 as FGM_SMORT_NAME_11,
rtr_INS_UPD_INSERT.FGM_SMORT_NAME_2 as FGM_SMORT_NAME_21,
rtr_INS_UPD_INSERT.FGM_SMORT_ADD_1 as FGM_SMORT_ADD_11,
rtr_INS_UPD_INSERT.FGM_SMORT_ADD_2 as FGM_SMORT_ADD_21,
rtr_INS_UPD_INSERT.FGM_SMORT_CTYST as FGM_SMORT_CTYST1,
rtr_INS_UPD_INSERT.FGM_SMORT_ZIP as FGM_SMORT_ZIP1,
rtr_INS_UPD_INSERT.FGM_SMORT_TYPE as FGM_SMORT_TYPE1,
rtr_INS_UPD_INSERT.FGM_PREMIUM_1 as FGM_PREMIUM_11,
rtr_INS_UPD_INSERT.FGM_PREMIUM_2 as FGM_PREMIUM_21,
rtr_INS_UPD_INSERT.FGM_PREMIUM_3 as FGM_PREMIUM_31,
rtr_INS_UPD_INSERT.FGM_PREMIUM_4 as FGM_PREMIUM_41,
rtr_INS_UPD_INSERT.FGM_PREMIUM_5 as FGM_PREMIUM_51,
rtr_INS_UPD_INSERT.FGM_PREMIUM_6 as FGM_PREMIUM_61,
rtr_INS_UPD_INSERT.FGM_COVERAGE_1 as FGM_COVERAGE_11,
rtr_INS_UPD_INSERT.FGM_COVERAGE_2 as FGM_COVERAGE_21,
rtr_INS_UPD_INSERT.FGM_COVERAGE_3 as FGM_COVERAGE_31,
rtr_INS_UPD_INSERT.FGM_COVERAGE_4 as FGM_COVERAGE_41,
rtr_INS_UPD_INSERT.FGM_COVERAGE_5 as FGM_COVERAGE_51,
rtr_INS_UPD_INSERT.FGM_COVERAGE_6 as FGM_COVERAGE_61,
rtr_INS_UPD_INSERT.FGM_COVERAGE_7 as FGM_COVERAGE_71,
rtr_INS_UPD_INSERT.FGM_COVERAGE_8 as FGM_COVERAGE_81,
rtr_INS_UPD_INSERT.FGM_T_PUR_PRICE as FGM_T_PUR_PRICE1,
rtr_INS_UPD_INSERT.FGM_T_PUR_DATE as FGM_T_PUR_DATE1,
rtr_INS_UPD_INSERT.FGM_T_AMT_OWED as FGM_T_AMT_OWED1,
rtr_INS_UPD_INSERT.FGM_T_MODEL_YEAR as FGM_T_MODEL_YEAR1,
rtr_INS_UPD_INSERT.FGM_T_LENGTH as FGM_T_LENGTH1,
rtr_INS_UPD_INSERT.FGM_T_WIDTH as FGM_T_WIDTH1,
rtr_INS_UPD_INSERT.FGM_T_TIE_DOWN as FGM_T_TIE_DOWN1,
rtr_INS_UPD_INSERT.FGM_T_FOUNDATION as FGM_T_FOUNDATION1,
rtr_INS_UPD_INSERT.FGM_T_IN_PARK as FGM_T_IN_PARK1,
rtr_INS_UPD_INSERT.FGM_T_OCCUPANCY as FGM_T_OCCUPANCY1,
rtr_INS_UPD_INSERT.FGM_T_OCC_FT as FGM_T_OCC_FT1,
rtr_INS_UPD_INSERT.FGM_T_RATE_CLASS as FGM_T_RATE_CLASS1,
rtr_INS_UPD_INSERT.FGM_T_ENDORSEMENT as FGM_T_ENDORSEMENT1,
rtr_INS_UPD_INSERT.FGM_T_VC_PERCENT as FGM_T_VC_PERCENT1,
rtr_INS_UPD_INSERT.FGM_T_VC_DATE as FGM_T_VC_DATE1,
rtr_INS_UPD_INSERT.FGM_SP_BT_CLASS as FGM_SP_BT_CLASS1,
rtr_INS_UPD_INSERT.FGM_FC_NUM_ACRES as FGM_FC_NUM_ACRES1,
rtr_INS_UPD_INSERT.FGM_FC_ADD_PREM as FGM_FC_ADD_PREM1,
rtr_INS_UPD_INSERT.FGM_FC_ADD_RENT as FGM_FC_ADD_RENT1,
rtr_INS_UPD_INSERT.FGM_FC_SEC_RES as FGM_FC_SEC_RES1,
rtr_INS_UPD_INSERT.FGM_FC_NUM_RENTED as FGM_FC_NUM_RENTED1,
rtr_INS_UPD_INSERT.FGM_FC_ADD_INSRD as FGM_FC_ADD_INSRD1,
rtr_INS_UPD_INSERT.FGM_FC_AN_COLL_CD as FGM_FC_AN_COLL_CD1,
rtr_INS_UPD_INSERT.FGM_FC_NUM_EMP as FGM_FC_NUM_EMP1,
rtr_INS_UPD_INSERT.FGM_FC_PAYROLL as FGM_FC_PAYROLL1,
rtr_INS_UPD_INSERT.FGM_FC_CUST_FRM_CD as FGM_FC_CUST_FRM_CD1,
rtr_INS_UPD_INSERT.FGM_DEDUCTIBLE as FGM_DEDUCTIBLE1,
rtr_INS_UPD_INSERT.FGM_LOCATION as FGM_LOCATION1,
rtr_INS_UPD_INSERT.FGM_SM_POLICY_IND as FGM_SM_POLICY_IND1,
rtr_INS_UPD_INSERT.FGM_CM_HALF_TERM as FGM_CM_HALF_TERM1,
rtr_INS_UPD_INSERT.FGM_CM_FULL_TERM as FGM_CM_FULL_TERM1,
rtr_INS_UPD_INSERT.FGM_SP5_ENDR_IND as FGM_SP5_ENDR_IND1,
rtr_INS_UPD_INSERT.FGM_SP_BOAT_IND as FGM_SP_BOAT_IND1,
rtr_INS_UPD_INSERT.FGM_MB_TYPE as FGM_MB_TYPE1,
rtr_INS_UPD_INSERT.FGM_MB_ACCT_NUM as FGM_MB_ACCT_NUM1,
rtr_INS_UPD_INSERT.FGM_GL_COV_TYPE as FGM_GL_COV_TYPE1,
rtr_INS_UPD_INSERT.FEED_IND as FEED_IND1,
rtr_INS_UPD_INSERT.ECTL_PRGM_ID as ECTL_PRGM_ID1,
rtr_INS_UPD_INSERT.ECTL_SRC_ID as ECTL_SRC_ID1,
rtr_INS_UPD_INSERT.ECTL_SRC_INST_ID as ECTL_SRC_INST_ID1,
rtr_INS_UPD_INSERT.ECTL_BATCH_ID as ECTL_BATCH_ID1,
rtr_INS_UPD_INSERT.ORIG_INS_TS as ORIG_INS_TS1,
rtr_INS_UPD_INSERT.ECTL_BATCH_START_DATE as ECTL_BATCH_START_DATE,
''NEW'' as out_ECTL_TX_CD,
CASE WHEN rtr_INS_UPD_INSERT.CHG_EFF_DT_lkp >= rtr_INS_UPD_INSERT.LOAD_DT THEN  rtr_INS_UPD_INSERT.CHG_EFF_DT_lkp + 1  ELSE rtr_INS_UPD_INSERT.LOAD_DT END as out_CHG_EFF_DT,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as out_CHG_EXP_DT_NEW,
TO_DATE ( ''9999-12-31'' , ''YYYY-MM-DD'' ) as out_ECTL_END_DT,
rtr_INS_UPD_INSERT.source_record_id
FROM
rtr_INS_UPD_INSERT
);


-- Component upd_FGMPOLS, Type UPDATE 
CREATE OR REPLACE TEMPORARY TABLE upd_FGMPOLS AS
(
/* UPDATE_STRATEGY_ACTION = 0 FOR INSERT / UPDATE_STRATEGY_ACTION = 1 FOR UPDATE / UPDATE_STRATEGY_ACTION = 2 FOR DELETE / UPDATE_STRATEGY_ACTION = 3 FOR REJECT */
SELECT
exp_GET_EXP_DATE.SC_POLICY_NUM_lkp3 as SC_POLICY_NUM_lkp3,
exp_GET_EXP_DATE.CHG_EFF_DT_lkp3 as CHG_EFF_DT_lkp3,
exp_GET_EXP_DATE.ECTL_BATCH_ID3 as ECTL_BATCH_ID3,
exp_GET_EXP_DATE.ORIG_INS_TS3 as ORIG_INS_TS3,
exp_GET_EXP_DATE.FLG3 as FLG3,
exp_GET_EXP_DATE.out_CHG_EXP_DT_NEW as out_CHG_EXP_DT_NEW,
exp_GET_EXP_DATE.out_ECTL_END_DT as out_ECTL_END_DT,
1 as UPDATE_STRATEGY_ACTION
FROM
exp_GET_EXP_DATE
);


-- Component FGMPOLS_DLY_INS, Type TARGET 
INSERT INTO DB_T_CORE_MEMBXREF_PROD.FGMPOLS_DLY
(
SC_DWNLD_PRIORITY,
SC_SERVICE_CENTER,
SC_POLICY_NUM,
CHG_EFF_DT,
CHG_EXP_DT,
SC_FLT_ITEM,
SC_FILE_TYPE,
SC_REC_TRANS_CODE,
SC_TRANS_DATE,
SC_TRANS_TYPE,
PC_ALPHA_CODE,
PC_NAME_1,
PC_NAME_2,
PC_ADDRESS_1,
PC_ADDRESS_2,
PC_CITYST,
PC_ZIP,
PC_TAX_CODE,
PC_AGENT,
PC_MEMBER_NUMBER,
PC_RATE_CODE,
PC_ENCUMBRANCE,
PC_PREM_FIN,
PC_MORT_IND,
PC_COMPANY,
PC_INCEPT_DATE,
PC_EXP_DATE,
PC_EFF_DATE,
PC_STATUS,
FGM_TOT_PREM,
FGM_REWRITE_IND,
FGM_REWRITE_DT,
FGM_OUTST_AMT,
FGM_OUTST_TYPE,
FGM_OUTST_DATE,
FGM_OUTST_PD_DATE,
FGM_SUSPENSE_CD,
FGM_SUSPENSE_CAN,
FGM_SSN_1,
FGM_SSN_2,
FGM_UW_REVIEW_DT,
FGM_UW_INITIALS,
FGM_MORT_NAME_1,
FGM_MORT_NAME_2,
FGM_MORT_ADD_1,
FGM_MORT_ADD_2,
FGM_MORT_CTYST,
FGM_MORT_ZIP,
FGM_STATE,
FGM_MORT_TYPE,
FGM_CANC_CODE,
FGM_LOAN_NUM,
FGM_SLOAN_NUM,
FGM_SMORT_NAME_1,
FGM_SMORT_NAME_2,
FGM_SMORT_ADD_1,
FGM_SMORT_ADD_2,
FGM_SMORT_CTYST,
FGM_SMORT_ZIP,
FGM_SMORT_TYPE,
FGM_PREMIUM_1,
FGM_PREMIUM_2,
FGM_PREMIUM_3,
FGM_PREMIUM_4,
FGM_PREMIUM_5,
FGM_PREMIUM_6,
FGM_COVERAGE_1,
FGM_COVERAGE_2,
FGM_COVERAGE_3,
FGM_COVERAGE_4,
FGM_COVERAGE_5,
FGM_COVERAGE_6,
FGM_COVERAGE_7,
FGM_COVERAGE_8,
FGM_T_PUR_PRICE,
FGM_T_PUR_DATE,
FGM_T_AMT_OWED,
FGM_T_MODEL_YEAR,
FGM_T_LENGTH,
FGM_T_WIDTH,
FGM_T_TIE_DOWN,
FGM_T_FOUNDATION,
FGM_T_IN_PARK,
FGM_T_OCCUPANCY,
FGM_T_OCC_FT,
FGM_T_RATE_CLASS,
FGM_T_ENDORSEMENT,
FGM_T_VC_PERCENT,
FGM_T_VC_DATE,
FGM_SP_BT_CLASS,
FGM_FC_NUM_ACRES,
FGM_FC_ADD_PREM,
FGM_FC_ADD_RENT,
FGM_FC_SEC_RES,
FGM_FC_NUM_RENTED,
FGM_FC_ADD_INSRD,
FGM_FC_AN_COLL_CD,
FGM_FC_NUM_EMP,
FGM_FC_PAYROLL,
FGM_FC_CUST_FRM_CD,
FGM_DEDUCTIBLE,
FGM_LOCATION,
FGM_SM_POLICY_IND,
FGM_CM_HALF_TERM,
FGM_CM_FULL_TERM,
FGM_SP5_ENDR_IND,
FGM_SP_BOAT_IND,
FGM_MB_TYPE,
FGM_MB_ACCT_NUM,
FGM_GL_COV_TYPE,
FEED_IND,
ECTL_BATCH_ID,
ECTL_ORIG_INS_TS,
ECTL_MODIFY_TS,
ECTL_SRC_ID,
ECTL_SRC_INST_ID,
ECTL_PRGM_ID,
ECTL_TX_CD,
ECTL_START_DATE,
ECTL_END_DATE
)
SELECT
exp_GET_EFF_DATE.SC_DWNLD_PRIORITY1 as SC_DWNLD_PRIORITY,
exp_GET_EFF_DATE.SC_SERVICE_CENTER1 as SC_SERVICE_CENTER,
exp_GET_EFF_DATE.SC_POLICY_NUM1 as SC_POLICY_NUM,
exp_GET_EFF_DATE.out_CHG_EFF_DT as CHG_EFF_DT,
exp_GET_EFF_DATE.out_CHG_EXP_DT_NEW as CHG_EXP_DT,
exp_GET_EFF_DATE.SC_FLT_ITEM1 as SC_FLT_ITEM,
exp_GET_EFF_DATE.SC_FILE_TYPE1 as SC_FILE_TYPE,
exp_GET_EFF_DATE.SC_REC_TRANS_CODE1 as SC_REC_TRANS_CODE,
exp_GET_EFF_DATE.SC_TRANS_DATE1 as SC_TRANS_DATE,
exp_GET_EFF_DATE.SC_TRANS_TYPE1 as SC_TRANS_TYPE,
exp_GET_EFF_DATE.PC_ALPHA_CODE1 as PC_ALPHA_CODE,
exp_GET_EFF_DATE.PC_NAME_11 as PC_NAME_1,
exp_GET_EFF_DATE.PC_NAME_21 as PC_NAME_2,
exp_GET_EFF_DATE.PC_ADDRESS_11 as PC_ADDRESS_1,
exp_GET_EFF_DATE.PC_ADDRESS_21 as PC_ADDRESS_2,
exp_GET_EFF_DATE.PC_CITYST1 as PC_CITYST,
exp_GET_EFF_DATE.PC_ZIP1 as PC_ZIP,
exp_GET_EFF_DATE.PC_TAX_CODE1 as PC_TAX_CODE,
exp_GET_EFF_DATE.PC_AGENT1 as PC_AGENT,
exp_GET_EFF_DATE.PC_MEMBER_NUMBER1 as PC_MEMBER_NUMBER,
exp_GET_EFF_DATE.PC_RATE_CODE1 as PC_RATE_CODE,
exp_GET_EFF_DATE.PC_ENCUMBRANCE1 as PC_ENCUMBRANCE,
exp_GET_EFF_DATE.PC_PREM_FIN1 as PC_PREM_FIN,
exp_GET_EFF_DATE.PC_MORT_IND1 as PC_MORT_IND,
exp_GET_EFF_DATE.PC_COMPANY1 as PC_COMPANY,
exp_GET_EFF_DATE.PC_INCEPT_DATE1 as PC_INCEPT_DATE,
exp_GET_EFF_DATE.PC_EXP_DATE1 as PC_EXP_DATE,
exp_GET_EFF_DATE.PC_EFF_DATE1 as PC_EFF_DATE,
exp_GET_EFF_DATE.PC_STATUS1 as PC_STATUS,
exp_GET_EFF_DATE.FGM_TOT_PREM1 as FGM_TOT_PREM,
exp_GET_EFF_DATE.FGM_REWRITE_IND1 as FGM_REWRITE_IND,
exp_GET_EFF_DATE.FGM_REWRITE_DT1 as FGM_REWRITE_DT,
exp_GET_EFF_DATE.FGM_OUTST_AMT1 as FGM_OUTST_AMT,
exp_GET_EFF_DATE.FGM_OUTST_TYPE1 as FGM_OUTST_TYPE,
exp_GET_EFF_DATE.FGM_OUTST_DATE1 as FGM_OUTST_DATE,
exp_GET_EFF_DATE.FGM_OUTST_PD_DATE1 as FGM_OUTST_PD_DATE,
exp_GET_EFF_DATE.FGM_SUSPENSE_CD1 as FGM_SUSPENSE_CD,
exp_GET_EFF_DATE.FGM_SUSPENSE_CAN1 as FGM_SUSPENSE_CAN,
exp_GET_EFF_DATE.FGM_SSN_11 as FGM_SSN_1,
exp_GET_EFF_DATE.FGM_SSN_21 as FGM_SSN_2,
exp_GET_EFF_DATE.FGM_UW_REVIEW_DT1 as FGM_UW_REVIEW_DT,
exp_GET_EFF_DATE.FGM_UW_INITIALS1 as FGM_UW_INITIALS,
exp_GET_EFF_DATE.FGM_MORT_NAME_11 as FGM_MORT_NAME_1,
exp_GET_EFF_DATE.FGM_MORT_NAME_21 as FGM_MORT_NAME_2,
exp_GET_EFF_DATE.FGM_MORT_ADD_11 as FGM_MORT_ADD_1,
exp_GET_EFF_DATE.FGM_MORT_ADD_21 as FGM_MORT_ADD_2,
exp_GET_EFF_DATE.FGM_MORT_CTYST1 as FGM_MORT_CTYST,
exp_GET_EFF_DATE.FGM_MORT_ZIP1 as FGM_MORT_ZIP,
exp_GET_EFF_DATE.FGM_STATE1 as FGM_STATE,
exp_GET_EFF_DATE.FGM_MORT_TYPE1 as FGM_MORT_TYPE,
exp_GET_EFF_DATE.FGM_CANC_CODE1 as FGM_CANC_CODE,
exp_GET_EFF_DATE.FGM_LOAN_NUM1 as FGM_LOAN_NUM,
exp_GET_EFF_DATE.FGM_SLOAN_NUM1 as FGM_SLOAN_NUM,
exp_GET_EFF_DATE.FGM_SMORT_NAME_11 as FGM_SMORT_NAME_1,
exp_GET_EFF_DATE.FGM_SMORT_NAME_21 as FGM_SMORT_NAME_2,
exp_GET_EFF_DATE.FGM_SMORT_ADD_11 as FGM_SMORT_ADD_1,
exp_GET_EFF_DATE.FGM_SMORT_ADD_21 as FGM_SMORT_ADD_2,
exp_GET_EFF_DATE.FGM_SMORT_CTYST1 as FGM_SMORT_CTYST,
exp_GET_EFF_DATE.FGM_SMORT_ZIP1 as FGM_SMORT_ZIP,
exp_GET_EFF_DATE.FGM_SMORT_TYPE1 as FGM_SMORT_TYPE,
exp_GET_EFF_DATE.FGM_PREMIUM_11 as FGM_PREMIUM_1,
exp_GET_EFF_DATE.FGM_PREMIUM_21 as FGM_PREMIUM_2,
exp_GET_EFF_DATE.FGM_PREMIUM_31 as FGM_PREMIUM_3,
exp_GET_EFF_DATE.FGM_PREMIUM_41 as FGM_PREMIUM_4,
exp_GET_EFF_DATE.FGM_PREMIUM_51 as FGM_PREMIUM_5,
exp_GET_EFF_DATE.FGM_PREMIUM_61 as FGM_PREMIUM_6,
exp_GET_EFF_DATE.FGM_COVERAGE_11 as FGM_COVERAGE_1,
exp_GET_EFF_DATE.FGM_COVERAGE_21 as FGM_COVERAGE_2,
exp_GET_EFF_DATE.FGM_COVERAGE_31 as FGM_COVERAGE_3,
exp_GET_EFF_DATE.FGM_COVERAGE_41 as FGM_COVERAGE_4,
exp_GET_EFF_DATE.FGM_COVERAGE_51 as FGM_COVERAGE_5,
exp_GET_EFF_DATE.FGM_COVERAGE_61 as FGM_COVERAGE_6,
exp_GET_EFF_DATE.FGM_COVERAGE_71 as FGM_COVERAGE_7,
exp_GET_EFF_DATE.FGM_COVERAGE_81 as FGM_COVERAGE_8,
exp_GET_EFF_DATE.FGM_T_PUR_PRICE1 as FGM_T_PUR_PRICE,
exp_GET_EFF_DATE.FGM_T_PUR_DATE1 as FGM_T_PUR_DATE,
exp_GET_EFF_DATE.FGM_T_AMT_OWED1 as FGM_T_AMT_OWED,
exp_GET_EFF_DATE.FGM_T_MODEL_YEAR1 as FGM_T_MODEL_YEAR,
exp_GET_EFF_DATE.FGM_T_LENGTH1 as FGM_T_LENGTH,
exp_GET_EFF_DATE.FGM_T_WIDTH1 as FGM_T_WIDTH,
exp_GET_EFF_DATE.FGM_T_TIE_DOWN1 as FGM_T_TIE_DOWN,
exp_GET_EFF_DATE.FGM_T_FOUNDATION1 as FGM_T_FOUNDATION,
exp_GET_EFF_DATE.FGM_T_IN_PARK1 as FGM_T_IN_PARK,
exp_GET_EFF_DATE.FGM_T_OCCUPANCY1 as FGM_T_OCCUPANCY,
exp_GET_EFF_DATE.FGM_T_OCC_FT1 as FGM_T_OCC_FT,
exp_GET_EFF_DATE.FGM_T_RATE_CLASS1 as FGM_T_RATE_CLASS,
exp_GET_EFF_DATE.FGM_T_ENDORSEMENT1 as FGM_T_ENDORSEMENT,
exp_GET_EFF_DATE.FGM_T_VC_PERCENT1 as FGM_T_VC_PERCENT,
exp_GET_EFF_DATE.FGM_T_VC_DATE1 as FGM_T_VC_DATE,
exp_GET_EFF_DATE.FGM_SP_BT_CLASS1 as FGM_SP_BT_CLASS,
exp_GET_EFF_DATE.FGM_FC_NUM_ACRES1 as FGM_FC_NUM_ACRES,
exp_GET_EFF_DATE.FGM_FC_ADD_PREM1 as FGM_FC_ADD_PREM,
exp_GET_EFF_DATE.FGM_FC_ADD_RENT1 as FGM_FC_ADD_RENT,
exp_GET_EFF_DATE.FGM_FC_SEC_RES1 as FGM_FC_SEC_RES,
exp_GET_EFF_DATE.FGM_FC_NUM_RENTED1 as FGM_FC_NUM_RENTED,
exp_GET_EFF_DATE.FGM_FC_ADD_INSRD1 as FGM_FC_ADD_INSRD,
exp_GET_EFF_DATE.FGM_FC_AN_COLL_CD1 as FGM_FC_AN_COLL_CD,
exp_GET_EFF_DATE.FGM_FC_NUM_EMP1 as FGM_FC_NUM_EMP,
exp_GET_EFF_DATE.FGM_FC_PAYROLL1 as FGM_FC_PAYROLL,
exp_GET_EFF_DATE.FGM_FC_CUST_FRM_CD1 as FGM_FC_CUST_FRM_CD,
exp_GET_EFF_DATE.FGM_DEDUCTIBLE1 as FGM_DEDUCTIBLE,
exp_GET_EFF_DATE.FGM_LOCATION1 as FGM_LOCATION,
exp_GET_EFF_DATE.FGM_SM_POLICY_IND1 as FGM_SM_POLICY_IND,
exp_GET_EFF_DATE.FGM_CM_HALF_TERM1 as FGM_CM_HALF_TERM,
exp_GET_EFF_DATE.FGM_CM_FULL_TERM1 as FGM_CM_FULL_TERM,
exp_GET_EFF_DATE.FGM_SP5_ENDR_IND1 as FGM_SP5_ENDR_IND,
exp_GET_EFF_DATE.FGM_SP_BOAT_IND1 as FGM_SP_BOAT_IND,
exp_GET_EFF_DATE.FGM_MB_TYPE1 as FGM_MB_TYPE,
exp_GET_EFF_DATE.FGM_MB_ACCT_NUM1 as FGM_MB_ACCT_NUM,
exp_GET_EFF_DATE.FGM_GL_COV_TYPE1 as FGM_GL_COV_TYPE,
nvl(exp_GET_EFF_DATE.FEED_IND1,''1'') as FEED_IND,
nvl(exp_GET_EFF_DATE.ECTL_BATCH_ID1,''1'') as ECTL_BATCH_ID,
nvl(exp_GET_EFF_DATE.ORIG_INS_TS1,''1900-01-01'') as ECTL_ORIG_INS_TS,
nvl(exp_GET_EFF_DATE.ORIG_INS_TS1,''1900-01-01'') as ECTL_MODIFY_TS,
nvl(exp_GET_EFF_DATE.ECTL_SRC_ID1,''1'') as ECTL_SRC_ID,
nvl(exp_GET_EFF_DATE.ECTL_SRC_INST_ID1,''1'') as ECTL_SRC_INST_ID,
nvl(exp_GET_EFF_DATE.ECTL_PRGM_ID1,''1'') as ECTL_PRGM_ID,
nvl(exp_GET_EFF_DATE.out_ECTL_TX_CD,''1'') as ECTL_TX_CD,
nvl(exp_GET_EFF_DATE.ECTL_BATCH_START_DATE,''1900-01-01'') as ECTL_START_DATE,
nvl(exp_GET_EFF_DATE.out_ECTL_END_DT,''1900-01-01'') as ECTL_END_DATE
FROM
exp_GET_EFF_DATE;


-- Component FGMPOLS_DLY_UPD, Type TARGET 
/* Perform Updates */
MERGE INTO DB_T_CORE_MEMBXREF_PROD.FGMPOLS_DLY
USING upd_FGMPOLS
ON (SC_POLICY_NUM = 
''1'' --upd_FGMPOLS.SC_POLICY_NUM 
AND CHG_EFF_DT = 
null --upd_FGMPOLS.CHG_EFF_DT
)
WHEN MATCHED THEN UPDATE SET
CHG_EXP_DT = 
null --upd_FGMPOLS.CHG_EXP_DT
, ECTL_BATCH_ID = 
null --upd_FGMPOLS.ECTL_BATCH_ID
, ECTL_MODIFY_TS = 
null --upd_FGMPOLS.ECTL_MODIFY_TS
, ECTL_TX_CD = 
null --upd_FGMPOLS.ECTL_TX_CD
, ECTL_END_DATE = 
null --upd_FGMPOLS.ECTL_END_DATE
;


-- PIPELINE END FOR 1

-- PIPELINE START FOR 2

-- Component sq_FGMPOLS_DLY, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE sq_FGMPOLS_DLY AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as SC_POLICY_NUM,
$2 as CHG_EFF_DT,
$3 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT FGMPOLS_DLY.SC_POLICY_NUM ,FGMPOLS_DLY.CHG_EFF_DT 
FROM
 DB_T_CORE_MEMBXREF_PROD.FGMPOLS_DLY WHERE CHG_EXP_DT = CAST(''9999-12-31'' AS DATE )
) SRC
)
);


-- Component exp_FGMPOLS_DUMMY_TG, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_FGMPOLS_DUMMY_TG AS
(
SELECT
sq_FGMPOLS_DLY.SC_POLICY_NUM as SC_POLICY_NUM,
sq_FGMPOLS_DLY.CHG_EFF_DT as CHG_EFF_DT,
''FGMPOLS_DLY'' as var_TABLENAME,
LKP_1.FEED_DT /* replaced lookup LKP_STG_MEMBXEF_TRIGGER_DLY */ as var_LOAD_DT,
 TO_DATE ( var_LOAD_DT ) - 1  as out_LOAD_DT,
sq_FGMPOLS_DLY.source_record_id,
row_number() over (partition by sq_FGMPOLS_DLY.source_record_id order by sq_FGMPOLS_DLY.source_record_id) as RNK
FROM
sq_FGMPOLS_DLY
LEFT JOIN LKP_STG_MEMBXEF_TRIGGER_DLY LKP_1 ON LKP_1.TABLENAME = var_TABLENAME
QUALIFY RNK = 1
);


-- Component LKP_STG_FGMPOLS_DLY, Type LOOKUP 
CREATE OR REPLACE TEMPORARY TABLE LKP_STG_FGMPOLS_DLY AS
(
SELECT
LKP.SC_POLICY_NUM,
exp_FGMPOLS_DUMMY_TG.source_record_id,
ROW_NUMBER() OVER(PARTITION BY exp_FGMPOLS_DUMMY_TG.source_record_id ORDER BY LKP.SC_POLICY_NUM asc) RNK
FROM
exp_FGMPOLS_DUMMY_TG
LEFT JOIN (
SELECT LTRIM(RTRIM(STG_FGMPOLS_DLY.SC_POLICY_NUM)) as SC_POLICY_NUM FROM DB_T_stag_MEMBXREF_PROD.STG_FGMPOLS_DLY
) LKP ON LKP.SC_POLICY_NUM = exp_FGMPOLS_DUMMY_TG.SC_POLICY_NUM
QUALIFY RNK = 1
);


-- Component fil_EXPIRED_POLS, Type FILTER 
CREATE OR REPLACE TEMPORARY TABLE fil_EXPIRED_POLS AS
(
SELECT
LKP_STG_FGMPOLS_DLY.SC_POLICY_NUM as SC_POLICY_NUM_tgt,
exp_FGMPOLS_DUMMY_TG.SC_POLICY_NUM as SC_POLICY_NUM_src,
exp_FGMPOLS_DUMMY_TG.CHG_EFF_DT as CHG_EFF_DT,
exp_FGMPOLS_DUMMY_TG.out_LOAD_DT as out_FEED_DT,
exp_FGMPOLS_DUMMY_TG.source_record_id
FROM
exp_FGMPOLS_DUMMY_TG
LEFT JOIN LKP_STG_FGMPOLS_DLY ON exp_FGMPOLS_DUMMY_TG.source_record_id = LKP_STG_FGMPOLS_DLY.source_record_id
WHERE LKP_STG_FGMPOLS_DLY.SC_POLICY_NUM IS NULL
);


-- Component exp_INPUT_ECTL_FIELD, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_INPUT_ECTL_FIELD AS
(
SELECT
fil_EXPIRED_POLS.SC_POLICY_NUM_src as SC_POLICY_NUM_src,
fil_EXPIRED_POLS.CHG_EFF_DT as CHG_EFF_DT,
LTRIM ( RTRIM ( :PMMappingName ) ) as out_PROJ_NAME,
:PROJ_ID as out_PROJ_ID,
:BATCH_ACTIVE_IND as out_BATCH_ACTIVE_IND,
''UPD'' as ECTL_TX_CD,
 fil_EXPIRED_POLS.out_FEED_DT  - 1  as var_CHG_EXP_DT_new,
CASE WHEN fil_EXPIRED_POLS.CHG_EFF_DT >= var_CHG_EXP_DT_new THEN fil_EXPIRED_POLS.CHG_EFF_DT ELSE var_CHG_EXP_DT_new END as out_CHG_EXP_DT_new,
CURRENT_TIMESTAMP as ECTL_END_DATE,
fil_EXPIRED_POLS.source_record_id
FROM
fil_EXPIRED_POLS
);


-- Component mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1, Type MAPPLET 
--MAPPLET NOT REGISTERED: mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE, mapplet instance mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1;


-- Component upd_FGMPOLS_EXPIRED_POLS, Type UPDATE 
CREATE OR REPLACE TEMPORARY TABLE upd_FGMPOLS_EXPIRED_POLS AS
(
/* UPDATE_STRATEGY_ACTION = 0 FOR INSERT / UPDATE_STRATEGY_ACTION = 1 FOR UPDATE / UPDATE_STRATEGY_ACTION = 2 FOR DELETE / UPDATE_STRATEGY_ACTION = 3 FOR REJECT */
SELECT
exp_INPUT_ECTL_FIELD.SC_POLICY_NUM_src as SC_POLICY_NUM_src,
exp_INPUT_ECTL_FIELD.CHG_EFF_DT as CHG_EFF_DT,
exp_INPUT_ECTL_FIELD.out_CHG_EXP_DT_new as out_CHG_EXP_DT_new,
exp_INPUT_ECTL_FIELD.ECTL_TX_CD as ECTL_TX_CD,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1.out_ECTL_BATCH_ID as out_ECTL_BATCH_ID,
mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1.out_ORIG_INS_TS as out_ORIG_INS_TS,
--null as out_ECTL_BATCH_ID,
--null as out_ORIG_INS_TS,
exp_INPUT_ECTL_FIELD.ECTL_END_DATE as ECTL_END_DATE,
1 as UPDATE_STRATEGY_ACTION
FROM
exp_INPUT_ECTL_FIELD
LEFT JOIN mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1 ON exp_INPUT_ECTL_FIELD.source_record_id = mplt_LKP_ECTL_BATCH_PRGM_VALIDATION_CORE1.source_record_id
);


-- Component FGMPOLS_DLY_UPD_EXPIRED, Type TARGET 
INSERT INTO DB_T_CORE_MEMBXREF_PROD.FGMPOLS_DLY
(
SC_POLICY_NUM,
CHG_EFF_DT,
CHG_EXP_DT,
ECTL_BATCH_ID,
ECTL_MODIFY_TS,
ECTL_TX_CD,
ECTL_END_DATE
)
SELECT
upd_FGMPOLS_EXPIRED_POLS.SC_POLICY_NUM_src as SC_POLICY_NUM,
upd_FGMPOLS_EXPIRED_POLS.CHG_EFF_DT as CHG_EFF_DT,
upd_FGMPOLS_EXPIRED_POLS.out_CHG_EXP_DT_new as CHG_EXP_DT,
nvl(upd_FGMPOLS_EXPIRED_POLS.out_ECTL_BATCH_ID,''1'') as ECTL_BATCH_ID,
nvl(upd_FGMPOLS_EXPIRED_POLS.out_ORIG_INS_TS,''1900-01-01'') as ECTL_MODIFY_TS,
nvl(upd_FGMPOLS_EXPIRED_POLS.ECTL_TX_CD,''1'') as ECTL_TX_CD,
nvl(upd_FGMPOLS_EXPIRED_POLS.ECTL_END_DATE,''1900-01-01'') as ECTL_END_DATE
FROM
upd_FGMPOLS_EXPIRED_POLS
WHERE UPDATE_STRATEGY_ACTION = 0;

/* Perform Updates */
MERGE INTO DB_T_CORE_MEMBXREF_PROD.FGMPOLS_DLY
USING upd_FGMPOLS_EXPIRED_POLS ON (UPDATE_STRATEGY_ACTION = 1  )
WHEN MATCHED THEN UPDATE
SET
SC_POLICY_NUM = upd_FGMPOLS_EXPIRED_POLS.SC_POLICY_NUM_src,
CHG_EFF_DT = upd_FGMPOLS_EXPIRED_POLS.CHG_EFF_DT,
CHG_EXP_DT = upd_FGMPOLS_EXPIRED_POLS.out_CHG_EXP_DT_new,
ECTL_BATCH_ID = nvl(upd_FGMPOLS_EXPIRED_POLS.out_ECTL_BATCH_ID,''1''),
ECTL_MODIFY_TS = nvl(upd_FGMPOLS_EXPIRED_POLS.out_ORIG_INS_TS,''1900-01-01''),
ECTL_TX_CD = nvl(upd_FGMPOLS_EXPIRED_POLS.ECTL_TX_CD,''1''),
ECTL_END_DATE = nvl(upd_FGMPOLS_EXPIRED_POLS.ECTL_END_DATE,''1900-01-01'')
;


-- PIPELINE END FOR 2

END; ';