-- Object Type: PROCEDURES
CREATE OR REPLACE PROCEDURE ALFA_EDW_DEV.PUBLIC.M_STAG_QUOTES_QUAD_INS("RUN_ID" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS ' BEGIN 

-- PIPELINE START FOR 1

-- Component SQ_QUOTES_PRTY_QUOTN_INTRM, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_QUOTES_PRTY_QUOTN_INTRM AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as CO_NAME,
$2 as FRST_NAME,
$3 as MDL_NAME,
$4 as LAST_NAME,
$5 as NAME_PREFIX_TXT,
$6 as NAME_SFX_TXT,
$7 as ADDR_LN_1_TXT,
$8 as ADDR_LN_2_TXT,
$9 as CITY_NAME,
$10 as CNTY_NAME,
$11 as ST_NAME,
$12 as ZIP,
$13 as TAX_IDNTFTN_NUM,
$14 as BIRTH_DT,
$15 as DRVG_LIC_NUM,
$16 as AGE_OF_QUOT_CNT,
$17 as AGNT_NAME,
$18 as AGNT_NUM,
$19 as RISK_LOC_CITY_NAME,
$20 as RISK_LOC_CTRY_NAME,
$21 as RISK_LOC_CNTY_NAME,
$22 as CVGE_CD,
$23 as CVGE_AMT,
$24 as CVGE_DESC,
$25 as PRMRY_INSRD_ADDR_DESC,
$26 as PRMRY_INSRD_NAME,
$27 as LOB,
$28 as UNDRWRTG_CO_NAME,
$29 as MSTR_CO_NUM,
$30 as RNEWL_STS,
$31 as PLCY_ACCNTG_DT,
$32 as PLCY_ASGND_DT,
$33 as PLCY_EFF_DT,
$34 as PLCY_TERM_EXPN_DT,
$35 as PLCY_ISSU_DT,
$36 as PLCY_NUM,
$37 as PLCY_RJCTN_RSN_DESC,
$38 as SCNDRY_INSRD_NAME,
$39 as ADDL_INSRD_NAME,
$40 as PLCY_ADDL_INSRD_NAME,
$41 as VEH_ADDL_INSRD_NAME,
$42 as QUOT_INITATN_DTTM,
$43 as QUOT_PREM_AMT,
$44 as QUOT_STS,
$45 as SLS_SRVC_CTR_NAME,
$46 as SLS_SRVC_CTR_ADDR,
$47 as PLCY_ORIG_ST_NAME,
$48 as PLCY_WRTN_ST_NAME,
$49 as TOT_WRTN_PREM_AMT,
$50 as TRANS_TYPE_DESC,
$51 as TRANS_DT,
$52 as TRNRND_TM_TXT,
$53 as UNDRWRTG_CO_TIER_DESC,
$54 as MRTL_STS,
$55 as OCPTN_DESC,
$56 as DEDCTB_AMT,
$57 as MORTGAGEE,
$58 as PLCY_TYPE_DESC,
$59 as CNSTRCTN_DESC,
$60 as HTG_DESC,
$61 as COOLG_DESC,
$62 as CNSTRCTN_DT,
$63 as AUTO_LATE_PAY_NUM,
$64 as AUTO_PMT_FRQCY_DESC,
$65 as PRMRY_RSPNS_SRVC_DESC,
$66 as UNDERPINNING_CR_DESC,
$67 as MH_RTG_CLAS_DESC,
$68 as MH_PRK_NAME,
$69 as MH_PRK_CD,
$70 as CLAS_OF_PRPTY_DESC,
$71 as BODILY_INJRY_LMT_AMT,
$72 as VEH_WTH_DMG_CNT,
$73 as PLCY_DSCNT_NAME,
$74 as DRVR_CLAS_DESC,
$75 as EXCLN_WAIVD_RSN_DESC,
$76 as GNDR_TYPE_DESC,
$77 as LIABTY_ONLY_IND,
$78 as NO_PRIOR_INSRNC_IND,
$79 as PRPTY_DMG_LMT_AMT,
$80 as PLCY_INT_TYPE_DESC,
$81 as PRIOR_INSRNC_CARIER_NAME,
$82 as RATE_UPS_DESC,
$83 as RLTNSHP_DESC,
$84 as TAX_CITY_NAME,
$85 as VEH_SYMB_COLLISION_CD,
$86 as VEH_TYPE_DESC,
$87 as VEH_USE_DESC,
$88 as VEH_MODL_YR,
$89 as YRS_WTH_ALFA,
$90 as VEH_INDENTIFICATION_NUM,
$91 as PLCY_WRTN_ST_CD,
$92 as SLS_RGN_ST_NAME,
$93 as SLS_RGN_DSTRCT_NAME,
$94 as SRVC_CTR_NUM,
$95 as AGNT_CLNT_NUM,
$96 as INSRNC_SCR_CD,
$97 as NAME_INSRD_MRTL_STS_DESC,
$98 as NAME_INSRD_AGE_DESC,
$99 as COMBO_DSCNT_IND,
$100 as MULT_CAR_DSCNT_IND,
$101 as VAL_CLNT_DSCNT_IND,
$102 as LIF_PLCY_DSCNT_IND,
$103 as HOME_OWNRSHP_DSCNT_IND,
$104 as AUTO_DSCNT_IND,
$105 as NEW_HOME_DSCNT_PCTG,
$106 as VAL_CLNT_DSCNT_PCTG,
$107 as HOME_ALRT_DSCNT_PCTG,
$108 as HOME_ALRT_CD,
$109 as INSRD_PRPTY_CNTY_NAME,
$110 as DWLNG_CVGE_AMT,
$111 as PERSNL_PRPTY_CVGE_AMT,
$112 as CNSTRCTN_TYPE_DESC,
$113 as OCPTN_CD,
$114 as PRIOR_INSRNC_CARIER_CD,
$115 as LGCY_DSCNT_IND,
$116 as LATE_PMT_PCTG,
$117 as PLCY_PRD_STRT_DT,
$118 as PLCY_PRD_END_DT,
$119 as TERM_NUM,
$120 as INSRD_EML_TXT,
$121 as INSRD_TLPHN_NUM,
$122 as TOT_UNITS_CNT,
$123 as ENDRSMT_DESC,
$124 as ANULZD_TOT_WRTN_PREM_AMT,
$125 as PRTCTN_CLAS_DESC,
$126 as PLCY_CNCLTN_SRC_DESC,
$127 as PREM_DUE_AMT,
$128 as MBR_NUM,
$129 as CUST_ID,
$130 as PLCY_INCPTN_DT,
$131 as PLCY_AGE,
$132 as SRC_USR_NUM,
$133 as PREM_BILD_AMT,
$134 as ENCMCE_CD,
$135 as RSDNC_TYEP_DESC,
$136 as VEH_GARGD_LOC_NAME,
$137 as ROOF_YR,
$138 as CNTNUS_SRVC_DT,
$139 as DWLNG_VAL_AMT,
$140 as DRVR_PNT_DESC,
$141 as ARS_SCR,
$142 as AGE_OF_HOME,
$143 as QUOT_CHNL_TXT,
$144 as QUOT_RTD_IND,
$145 as TOT_UNEARND_PREM_AMT,
$146 as ADDR_TYPE_DESC,
$147 as DOG_ON_PREMS_IND,
$148 as DWLNG_APRSL_DT,
$149 as DWLNG_SQUAR_FOOTGE,
$150 as VEH_BODY_TYPE_DESC,
$151 as VEH_COLOR_DESC,
$152 as VEH_MAKE_DESC,
$153 as VEH_MODL_DESC,
$154 as VEH_PRCH_DT,
$155 as DWLNG_PRCH_DT,
$156 as DWLNG_NUM_OF_STORIES_CNT,
$157 as RATE_AS_OF_DT_AMT,
$158 as TRANS_CLSD_DT,
$159 as GAR_CRPT_DESC,
$160 as SCREENED_POOL_IND,
$161 as DWLNG_FIRE_DEPT_CD,
$162 as PLCY_FRST_ISSU_DT,
$163 as DWLNG_FNDTN_TYPE,
$164 as DWLNG_USE_DESC,
$165 as DWLNG_OCPYD_DESC,
$166 as FIRE_HYDRANT_1000_FEET_IND,
$167 as FIRE_HYDRANT_5_MILE_IND,
$168 as SWIMMING_POOL_IND,
$169 as WIND_AND_HAIL_EXCLDD_IND,
$170 as PLCY_ISSUD_IND,
$171 as DWLNG_LAT_MEAS,
$172 as DWLNG_LNGTD_MEAS,
$173 as INSRD_LIC_ST_NAME,
$174 as DWLNG_VALUT_METH_NAME,
$175 as DWLNG_CVGE_LMT_AMT,
$176 as PRPTY_VALUT_METH_DESC,
$177 as PERSNL_PRPTY_CVGE_LMT_AMT,
$178 as OTH_STRC_CVGE_LMT_AMT,
$179 as LOSS_OF_USE_CVGE_LMT_AMT,
$180 as PRPTY_ZN_DESC,
$181 as DWLNG_PRCH_AMT,
$182 as DWLNG_ROOF_TYPE_DESC,
$183 as PLCY_TERM_TYPE,
$184 as PLCY_TOT_COST_AMT,
$185 as EARND_PREM_AMT,
$186 as MBR_TYPE_DESC,
$187 as MOST_RCENT_QUOT_VERS_DT,
$188 as TOT_VEHICAL_UNIT_CNT,
$189 as QUOT_STS_DESC,
$190 as QUOT_VERS_NUM,
$191 as PROD_LN_DESC,
$192 as CO_TO_CO_TFR_DESC,
$193 as NEW_PRPTY_CUST_IND,
$194 as TOT_FIRE_LOSS_IND,
$195 as TOT_LOSS_10_YR_IND,
$196 as PRPTY_LOSS_5_YR_IND,
$197 as TWO_WEA_LOSS_5_YR_IND,
$198 as ONE_WEA_LOSS_5_YR_IND,
$199 as LOSS_3_YR_IND,
$200 as THEFT_LOSS_IND,
$201 as LOSS_5_YR_IND,
$202 as DCLND_5_YR_IND,
$203 as LTGTN_PEND_IND,
$204 as FRCLSR_5_YR_IND,
$205 as TRFC_VLATN_IND,
$206 as AUTO_INSRNC_CANCELLED_12_MTH_I,
$207 as LIC_SUSPD_5_YR_IND,
$208 as RPOSESN_3_YR_IND,
$209 as RPOSESN_DT,
$210 as ARRESTED_5_YR_IND,
$211 as FAULT_ACDNT_5_YR_IND,
$212 as APLCNT_CURRENTLY_INSRD_TXT,
$213 as LIC_CURRENTLY_SUSPD_IND,
$214 as LIC_SUSPD_IND,
$215 as SBMN_JOB_CRT_DT,
$216 as SBMN_JOB_UPDT_DT,
$217 as SBMN_JOB_CLS_DT,
$218 as SBMN_JOB_CRT_USR_NAME,
$219 as SBMN_JOB_UPDT_USR_NAME,
$220 as SBMN_JOB_EFF_DT,
$221 as BRNCH_NUM,
$222 as BRNCH_NAME,
$223 as PRD_ID,
$224 as UNDRWRTG_ISSU_TYPE_DESC,
$225 as UNDRWRTG_ISSU_STS,
$226 as QUOTN_ID,
$227 as NK_JOB_NBR,
$228 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
select 

distinct PRTY.CO_NAME,

PRTY.FRST_NAME

,PRTY.MDL_NAME

,PRTY.LAST_NAME

,PRTY.NAME_PREFIX_TXT

,PRTY.NAME_SFX_TXT

,PRTY.ADDR_LN_1_TXT

,PRTY.ADDR_LN_2_TXT

,PRTY.CITY_NAME

,PRTY.CNTY_NAME

,PRTY.ST_NAME

,PRTY.ZIP

,PRTY.TAX_IDNTFTN_NUM

,DATE_TRUNC(DAY, PRTY.BIRTH_DT)

,PRTY.DRVG_LIC_NUM

,null as AGE_OF_QUOT_CNT

,PRTY.AGNT_NAME

,PRTY.AGNT_NUM

,null as RISK_LOC_CITY_NAME

,null as RISK_LOC_CTRY_NAME

,null as RISK_LOC_CNTY_NAME

,null as CVGE_CD

,null as CVGE_AMT

,null as CVGE_DESC

,null as PRMRY_INSRD_ADDR_DESC

,null as PRMRY_INSRD_NAME

,null as LOB

,PRTY.UNDRWRTG_CO_NAME

,PRTY.MSTR_CO_NUM

,null as RNEWL_STS

,null as PLCY_ACCNTG_DT

,null as PLCY_ASGND_DT

,null as PLCY_EFF_DT

,null as PLCY_TERM_EXPN_DT

,null as PLCY_ISSU_DT

,null as PLCY_NUM

,null as  PLCY_RJCTN_RSN_DESC

,null as SCNDRY_INSRD_NAME

,null as ADDL_INSRD_NAME

,null as PLCY_ADDL_INSRD_NAME

,null as VEH_ADDL_INSRD_NAME

,null as QUOT_INITATN_DTTM

,null as QUOT_PREM_AMT

,null as QUOT_STS

,PRTY.SLS_SRVC_CTR_NAME

,null as SLS_SRVC_CTR_ADDR

,null as PLCY_ORIG_ST_NAME

,null as PLCY_WRTN_ST_NAME

,null as TOT_WRTN_PREM_AMT

,null as TRANS_TYPE_DESC

,null as TRANS_DT

,null as TRNRND_TM_TXT

,null as UNDRWRTG_CO_TIER_DESC

,null as MRTL_STS

,PRTY.OCPTN_DESC

,null as DEDCTB_AMT

,null as  MORTGAGEE

,null as PLCY_TYPE_DESC

,null as CNSTRCTN_DESC

,null as HTG_DESC

,null as COOLG_DESC

,null as CNSTRCTN_DT

,null as AUTO_LATE_PAY_NUM

,null as AUTO_PMT_FRQCY_DESC

,null as PRMRY_RSPNS_SRVC_DESC

,null as UNDERPINNING_CR_DESC

,null as MH_RTG_CLAS_DESC

/* ,PRTY.MH_PRK_NAME */
/* ,PRTY.MH_PRK_CD */
,null as MH_PRK_NAME

,null as MH_PRK_CD

,null as CLAS_OF_PRPTY_DESC

,null as BODILY_INJRY_LMT_AMT

,null as VEH_WTH_DMG_CNT

,null as PLCY_DSCNT_NAME

,null as DRVR_CLAS_DESC

,null as EXCLN_WAIVD_RSN_DESC

,null as GNDR_TYPE_DESC

,null as LIABTY_ONLY_IND

,null as NO_PRIOR_INSRNC_IND

,null as PRPTY_DMG_LMT_AMT

,null as PLCY_INT_TYPE_DESC

,PRTY.PRIOR_INSRNC_CARIER_NAME

,null as RATE_UPS_DESC

,null as RLTNSHP_DESC

,null as TAX_CITY_NAME

,null as VEH_SYMB_COLLISION_CD

,null as VEH_TYPE_DESC

,null as VEH_USE_DESC

,null as VEH_MODL_YR

,null as YRS_WTH_ALFA

,null as VEH_INDENTIFICATION_NUM

,null as PLCY_WRTN_ST_CD

,null as SLS_RGN_ST_NAME

,null as SLS_RGN_DSTRCT_NAME

,PRTY.SRVC_CTR_NUM

,prty.AGNT_CLNT_NUM

,prty.INSRNC_SCR_CD

,NULL AS NAME_INSRD_MRTL_STS_DESC

,null as NAME_INSRD_PRTYE_DESC

,null as COMBO_DSCNT_IND

,null as MULT_CAR_DSCNT_IND

,null as VAL_CLNT_DSCNT_IND

,null as LIF_PLCY_DSCNT_IND

,null as HOME_OWNRSHP_DSCNT_IND

,null as AUTO_DSCNT_IND

,null as NEW_HOME_DSCNT_PCTG

,null as VAL_CLNT_DSCNT_PCTG

,null as HOME_ALRT_DSCNT_PCTG

,null as HOME_ALRT_CD

,null as INSRD_PRPTY_CNTY_NAME

,null as DWLNG_CVGE_AMT

,null as PERSNL_PRPTY_CVGE_AMT

,null as CNSTRCTN_TYPE_DESC

,PRTY.OCPTN_CD

,PRTY.PRIOR_INSRNC_CARIER_CD

,null as LGCY_DSCNT_IND

,null as LATE_PMT_PCTG

,null as PLCY_PRD_STRT_DT

,null as PLCY_PRD_END_DT

,null as TERM_NUM

,null as INSRD_EML_TXT

,null as INSRD_TLPHN_NUM

,null as TOT_UNITS_CNT

,null as ENDRSMT_DESC

,null as ANULZD_TOT_WRTN_PREM_AMT

,null as PRTCTN_CLAS_DESC

,null as PLCY_CNCLTN_SRC_DESC

,null as PREM_DUE_AMT

,null as MBR_NUM

,PRTY.CUST_ID

,null as PLCY_INCPTN_DT

,null as PLCY_AGE

,PRTY.SRC_USR_NUM

,null as PREM_BILD_AMT

,null as ENCMCE_CD

,null as RSDNC_TYEP_DESC

,null as VEH_GARGD_LOC_NAME

,null as ROOF_YR

,null as CNTNUS_SRVC_DT

,null as DWLNG_VAL_AMT

,null as DRVR_PNT_DESC

,null as ARS_SCR

,null as AGE_OF_HOME

,null as  QUOT_CHNL_TXT

,null as QUOT_RTD_IND

,null as TOT_UNEARND_PREM_AMT

,PRTY.ADDR_TYPE_DESC

,null as DOG_ON_PREMS_IND

,null as DWLNG_APRSL_DT

,null as DWLNG_SQUAR_FOOTGE

,null as VEH_BODY_TYPE_DESC

,null as VEH_COLOR_DESC

,null as VEH_MAKE_DESC

,null as VEH_MODL_DESC

,null as VEH_PRCH_DT

,null as DWLNG_PRCH_DT

,null as DWLNG_NUM_OF_STORIES_CNT

,null as  RATE_AS_OF_DT_AMT

,null as TRANS_CLSD_DT

,null as GAR_CRPT_DESC

,null as SCREENED_POOL_IND

,null as DWLNG_FIRE_DEPT_CD

,null as PLCY_FRST_ISSU_DT

,null as DWLNG_FNDTN_TYPE

,null as DWLNG_USE_DESC

,null as DWLNG_OCPYD_DESC

,null as FIRE_HYDRANT_1000_FEET_IND

,null as FIRE_HYDRANT_5_MILE_IND

,null as SWIMMING_POOL_IND

,null as WIND_AND_HAIL_EXCLDD_IND

,null as PLCY_ISSUD_IND

,null as DWLNG_LAT_MEAS

,null as DWLNG_LNGTD_MEAS

,null as INSRD_LIC_ST_NAME

,null as DWLNG_VALUT_METH_NAME

,null as DWLNG_CVGE_LMT_AMT

,null as PRPTY_VALUT_METH_DESC

,null as PERSNL_PRPTY_CVGE_LMT_AMT

,null as OTH_STRC_CVGE_LMT_AMT

,null as LOSS_OF_USE_CVGE_LMT_AMT

,null as PRPTY_ZN_DESC

,null as DWLNG_PRCH_AMT

,null as DWLNG_ROOF_TYPE_DESC

,null as PLCY_TERM_TYPE

,null as PLCY_TOT_COST_AMT

,null as EARND_PREM_AMT

,null as MBR_TYPE_DESC

,null as MOST_RCENT_QUOT_VERS_DT

,null as TOT_VEHICAL_UNIT_CNT

,null as QUOT_STS_DESC

,null as  QUOT_VERS_NUM

,null as PROD_LN_DESC

,null as CO_TO_CO_TFR_DESC

,null as  NEW_PRPTY_CUST_IND

,null as TOT_FIRE_LOSS_IND

,null as TOT_LOSS_10_YR_IND

,null as PRPTY_LOSS_5_YR_IND

,null as TWO_WEA_LOSS_5_YR_IND

,null as ONE_WEA_LOSS_5_YR_IND

,null as LOSS_3_YR_IND

,null as THEFT_LOSS_IND

,null as LOSS_5_YR_IND

,null as DCLND_5_YR_IND

,null as LTGTN_PEND_IND

,null as FRCLSR_5_YR_IND

,null as TRFC_VLATN_IND

,null as AUTO_INSRNC_CANCELLED_12_MTH_I

,null as LIC_SUSPD_5_YR_IND

,null as RPOSESN_3_YR_IND

,null as RPOSESN_DT

,null as ARRESTED_5_YR_IND

,null as FAULT_ACDNT_5_YR_IND

,null as APLCNT_CURRENTLY_INSRD_TXT

,null as LIC_CURRENTLY_SUSPD_IND

,null as LIC_SUSPD_IND

,null as  SBMN_JOB_CRT_DT

,null as SBMN_JOB_UPDT_DT

,null as SBMN_JOB_CLS_DT

,PRTY.SBMN_JOB_CRT_USR_NAME

,PRTY.SBMN_JOB_UPDT_USR_NAME

,null as  SBMN_JOB_EFF_DT

,null as  BRNCH_NUM

,null as BRNCH_NAME

,null as  PRD_ID

,null as UNDRWRTG_ISSU_TYPE_DESC

,null as UNDRWRTG_ISSU_STS

,PRTY.QUOTN_ID 

,null as NK_JOB_NBR

from (

select DISTINCT

INSRNC_QUOTN_Q.QUOTN_ID,

PRTY_QUOTN_Q.PRTY_ID,

OCPTN_CD_Q.OCPTN_CD as OCPTN_CD,

OCPTN_CD_Q.OCPTN_CD as OCPTN_DESC,

PRIOT_INSU_CARRIER_CD_Q.PRIOT_INSU_CARRIER_CD as PRIOR_INSRNC_CARIER_CD,

PRIOT_INSU_CARRIER_CD_Q.PRIOT_INSU_CARRIER_CD as PRIOR_INSRNC_CARIER_NAME,

BIRTH_DT_Q.BIRTH_DT,

ORG_NAME as CO_NAME,

NAME_Q.GVN_NAME as  FRST_NAME,

NAME_Q.MDL_NAME as MDL_NAME,

NAME_Q.FMLY_NAME as LAST_NAME ,

NAME_Q.NAME_PREFIX_TXT as NAME_PREFIX_TXT,

NAME_Q.NAME_SFX_TXT as NAME_SFX_TXT,

STREET_Q.ADDR_LN_1_TXT as ADDR_LN_1_TXT,

STREET_Q.ADDR_LN_2_TXT as ADDR_LN_2_TXT,

STREET_Q.CITY_ID as CITY_NAME,

STREET_Q.CNTY_ID as CNTY_NAME,

STREET_Q.TERR_ID As ST_NAME,

STREET_Q.POSTL_CD_ID as ZIP,

INDIV_PRTY_ID_Q.INDIV_PRTY_ID As  CUST_ID,

LOCTR_USGE_TYPE_CD_Q.LOCTR_USGE_TYPE_CD as ADDR_TYPE_DESC,

prty_scr_q.INSRNC_SCR_CD,

SRC_USR_NUM_Q.SRC_USR_NUM ,

AGNT_NUM_Q.AGNT_NUM as AGNT_CLNT_NUM,

AGNT_NUM_Q.AGNT_NUM as AGNT_NUM,

AGNT_NUM_Q.TAX_IDNTFTN_NUM as TAX_IDNTFTN_NUM,

AGNT_NUM_Q.DLN_NUMBER as DRVG_LIC_NUM,

prty_id_crtd_Q.c_prty_id as SBMN_JOB_CRT_USR_NAME,

prty_id_updt_Q.u_prty_id as SBMN_JOB_UPDT_USR_NAME,

prty_num_q.UNDWRTR_CO_NAME as UNDRWRTG_CO_NAME,

prty_num_q.MSTR_CO_NUM,

prty_num_q.SLS_SRVC_CTR_NAME,

prty_num_q.SRVC_CTR_NUM,

AGNT_NAME_Q.AGNT_NAME as AGNT_NAME

from

(SELECT DISTINCT QUOTN_ID  FROM DB_T_PROD_CORE.INSRNC_QUOTN WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND QUOTN_SBTYPE_CD IN (''SBMSSN'',''RENEWAL'',''PLCYCHG'')) INSRNC_QUOTN_Q

LEFT OUTER JOIN  

(SELECT *  FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND PRTY_QUOTN_ROLE_CD= ''PLCYPRININS'') PRTY_QUOTN_Q ON INSRNC_QUOTN_Q.QUOTN_ID = PRTY_QUOTN_Q.QUOTN_ID

LEFT OUTER JOIN

 (select distinct QUOTN.PRTY_ID,

CAST(OCPTN.OCPTN_TYPE_CD AS VARCHAR(100))  as OCPTN_CD, 

QUOTN.QUOTN_ID     

from (select * from DB_T_PROD_CORE.PRTY_QUOTN  where  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND  PRTY_QUOTN_ROLE_CD = ''PLCYPRININS''  )QUOTN INNER JOIN

 (SELECT OCPTN_TYPE_CD,EDW_END_DTTM,INDIV_PRTY_ID FROM DB_T_PROD_CORE.INDIV_OCPTN WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999''

 qualify row_number ()  over  ( partition by INDIV_PRTY_ID order by EDW_STRT_DTTM desc  )=1)  OCPTN

on OCPTN.INDIV_PRTY_ID= QUOTN.PRTY_ID ) OCPTN_CD_Q on ( OCPTN_CD_Q.QUOTN_ID=PRTY_QUOTN_Q.QUOTN_ID AND  OCPTN_CD_Q.PRTY_ID=PRTY_QUOTN_Q.PRTY_ID)



/*  RETURNING DUPLICATED FOR  PRTY_RLTD_ROLE_CD=''PRIINSCAR''  */
LEFT OUTER JOIN

(SELECT  DISTINCT QUOTN.PRTY_ID,CAST(ORG_NAME AS VARCHAR(100)) PRIOT_INSU_CARRIER_CD,  

QUOTN.QUOTN_ID

FROM (SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN  WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND prty_quotn_role_cd = ''PLCYPRININS'' )QUOTN

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.PRTY_RLTD WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999''  AND  PRTY_RLTD_ROLE_CD=''PRIINSCAR''

qualify row_number ()  over  ( partition by PRTY_ID order by (RLTD_PRTY_ID ) desc )=1

) PRTY 

 on PRTY.PRTY_ID=QUOTN.PRTY_ID

inner  JOIN (SELECT PRTY_ID,EDW_END_DTTM, ORG_NAME FROM DB_T_PROD_CORE.ORG_NAME WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'')ORG  

on ORG.PRTY_ID= PRTY.RLTD_PRTY_ID) PRIOT_INSU_CARRIER_CD_Q  

on ( PRIOT_INSU_CARRIER_CD_Q.QUOTN_ID=PRTY_QUOTN_Q.QUOTN_ID AND  PRIOT_INSU_CARRIER_CD_Q.PRTY_ID=PRTY_QUOTN_Q.PRTY_ID)



LEFT OUTER JOIN

(SELECT DISTINCT QUOTN.PRTY_ID,BIRTH_DT,QUOTN.QUOTN_ID  FROM 

(SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND PRTY_QUOTN_ROLE_CD=''PLCYPRININS'') QUOTN

INNER JOIN

(SELECT * FROM DB_T_PROD_CORE.INDIV WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') INDIV 

ON QUOTN.PRTY_ID=INDIV.INDIV_PRTY_ID ) BIRTH_DT_Q on ( BIRTH_DT_Q.QUOTN_ID=PRTY_QUOTN_Q.QUOTN_ID AND  BIRTH_DT_Q.PRTY_ID=PRTY_QUOTN_Q.PRTY_ID)



LEFT OUTER JOIN

(SELECT distinct QUOTN.PRTY_ID,ORG_NAME, QUOTN.QUOTN_ID FROM      

(SELECT * FROM DB_T_PROD_CORE.ORG_NAME WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'') ORG 

INNER JOIN 

(SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND PRTY_QUOTN_ROLE_CD=''PLCYPRININS''  ) QUOTN ON  QUOTN.PRTY_ID=ORG.PRTY_ID) Company_name_Q ON ( PRTY_QUOTN_Q.QUOTN_ID=Company_name_Q.QUOTN_ID AND  Company_name_Q.PRTY_ID=PRTY_QUOTN_Q.PRTY_ID)



LEFT OUTER JOIN

(SELECT distinct QUOTN.PRTY_ID, INDIV.MDL_NAME ,INDIV.GVN_NAME ,INDIV.FMLY_NAME,QUOTN.QUOTN_ID,INDIV.NAME_PREFIX_TXT,

INDIV.NAME_SFX_TXT,INDIV.INDIV_FULL_NAME FROM 

(SELECT * FROM DB_T_PROD_CORE.INDIV_NAME WHERE  TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'') INDIV INNER JOIN 

(SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND PRTY_QUOTN_ROLE_CD=''PLCYPRININS'' ) QUOTN

ON INDIV.INDIV_PRTY_ID=QUOTN.PRTY_ID ) NAME_Q ON (PRTY_QUOTN_Q.QUOTN_ID=NAME_Q.QUOTN_ID AND NAME_Q.PRTY_ID=PRTY_QUOTN_Q.PRTY_ID) 



/*  DONE ABOVE */
LEFT OUTER JOIN

(SELECT QUOTN_ID

,PRTY_ID

,MAX(TERR_ID) AS TERR_ID

,MAX(CITY_ID) AS CITY_ID

,MAX(CNTY_ID)  AS CNTY_ID

,MAX(POSTL_CD_ID)  AS POSTL_CD_ID

,MAX( ADDR_LN_1_TXT) AS ADDR_LN_1_TXT

,MAX( ADDR_LN_2_TXT ) AS  ADDR_LN_2_TXT

FROM

(SELECT  QUOTN_ID, PQ.PRTY_ID

,CASE WHEN geogrcl_area_sbtype_cd =''TER''    THEN TERR_NAME  ELSE NULL END AS TERR_ID

,CASE WHEN geogrcl_area_sbtype_cd =''CY''    THEN CITY_NAME  ELSE NULL END AS CITY_ID

,CASE WHEN geogrcl_area_sbtype_cd =''CNTY''    THEN CNTY_NAME  ELSE NULL END AS CNTY_ID

,CASE WHEN geogrcl_area_sbtype_cd =''PC''    THEN PSTL_NAME  ELSE NULL END AS POSTL_CD_ID

,CASE WHEN ADDR_SBTYPE_CD = ''STADR'' THEN ADDR_LN_1_TXT ELSE NULL END AS ADDR_LN_1_TXT

,CASE WHEN ADDR_SBTYPE_CD = ''STADR'' THEN ADDR_LN_2_TXT ELSE NULL END AS  ADDR_LN_2_TXT

FROM

(SELECT QUOTN_ID,PRTY_ID FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND PRTY_QUOTN_ROLE_CD = ''PLCYPRININS'' )  AS PQ

INNER JOIN (select loc_id, prty_id , PRTY_ADDR_USGE_TYPE_CD from DB_T_PROD_CORE.PRTY_ADDR where   TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'' 

) PAR ON PQ.PRTY_ID = PAR.PRTY_ID

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.PRTY_LOCTR WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') PR_LOC ON   PAR.PRTY_ID = PR_LOC.PRTY_ID AND PR_LOC.LOCTR_USGE_TYPE_CD = PAR.PRTY_ADDR_USGE_TYPE_CD

inner join

(

select loctr.loctr_id, geogrcl_area_sbtype_cd  , ADDR_SBTYPE_CD,

ctry_id, ctry_name, terr_id, terr_name, cnty_id, cnty_name, city_id, city_name, postl_cd_id,pstl_name, street_addr_id, ADDR_LN_1_TXT,ADDR_LN_2_TXT

from

(SELECT *  FROM  DB_T_PROD_CORE.LOCTR  WHERE GEOGRCL_AREA_SBTYPE_CD IS NOT NULL OR ADDR_SBTYPE_CD = ''STADR'') LOCTR

LEFT OUTER JOIN (SELECT CTRY_ID,GEOGRCL_AREA_NAME as ctry_name FROM DB_T_PROD_CORE.CTRY WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') C ON loctr.loctr_id = C.CTRY_ID

LEFT OUTER JOIN (SELECT TERR_ID,GEOGRCL_AREA_NAME as terr_name FROM DB_T_PROD_CORE.TERR WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') T ON loctr.loctr_id = T.TERR_ID

LEFT OUTER JOIN (SELECT CNTY_ID,GEOGRCL_AREA_NAME cnty_name FROM DB_T_PROD_CORE.CNTY WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') COUNTY ON loctr.loctr_id = COUNTY.CNTY_ID

LEFT OUTER JOIN (SELECT CITY_ID,GEOGRCL_AREA_NAME city_name FROM DB_T_PROD_CORE.CITY WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') CITY ON loctr.loctr_id = CITY.CITY_ID

LEFT OUTER JOIN (SELECT POSTL_CD_ID,POSTL_CD_NUM pstl_name FROM DB_T_PROD_CORE.POSTL_CD WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') POSTL ON loctr.loctr_id = POSTL.POSTL_CD_ID

LEFT OUTER JOIN (SELECT street_addr_id,ADDR_LN_1_TXT,ADDR_LN_2_TXT FROM DB_T_PROD_CORE.STREET_ADDR WHERE   TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') STREET ON loctr.loctr_id = STREET.STREET_ADDR_ID

) LOCTR

ON  PAR.LOC_ID = LOCTR.LOCTR_ID )  QUOT_ADDDR

GROUP BY QUOTN_ID, PRTY_ID

) STREET_Q ON  (PRTY_QUOTN_Q.QUOTN_ID=STREET_Q.QUOTN_ID AND STREET_Q.PRTY_ID=PRTY_QUOTN_Q.PRTY_ID) 



LEFT OUTER JOIN

(SELECT distinct INDIV_PRTY_ID ,QUOTN.QUOTN_ID, QUOTN.PRTY_ID FROM 

(SELECT * FROM DB_T_PROD_CORE.INDIV WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') INDIV INNER JOIN 

(SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND PRTY_QUOTN_ROLE_CD = ''PLCYPRININS'' ) QUOTN

ON QUOTN.PRTY_ID=INDIV.INDIV_PRTY_ID) INDIV_PRTY_ID_Q ON  (PRTY_QUOTN_Q.QUOTN_ID=INDIV_PRTY_ID_Q.QUOTN_ID AND INDIV_PRTY_ID_Q.PRTY_ID=PRTY_QUOTN_Q.PRTY_ID) 



LEFT OUTER JOIN  

(SELECT DISTINCT LOCTR_USGE_TYPE_CD, QUOTN.PRTY_ID,QUOTN_ID  FROM 

(SELECT * FROM DB_T_PROD_CORE.PRTY_LOCTR WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')  LOCTR   

INNER JOIN ( SELECT * FROM  DB_T_PROD_CORE.PRTY_QUOTN WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  AND PRTY_QUOTN_ROLE_CD = ''PLCYPRININS'') QUOTN

ON QUOTN.PRTY_ID=LOCTR.PRTY_ID) LOCTR_USGE_TYPE_CD_Q ON (PRTY_QUOTN_Q.QUOTN_ID=LOCTR_USGE_TYPE_CD_Q.QUOTN_ID AND LOCTR_USGE_TYPE_CD_Q.PRTY_ID=PRTY_QUOTN_Q.PRTY_ID)



LEFT OUTER JOIN 

(SELECT distinct PQ1.QUOTN_ID, PQ1.PRTY_ID, SCR.PRTY_SCR_VAL AS INSRNC_SCR_CD

FROM

(SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  AND PRTY_QUOTN_ROLE_CD = ''PLCYPRININS'' ) PQ1

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.PRTY_SCR  

qualify row_number ()  over  ( partition by modl_id,PRTY_ID order by ( modl_run_id) desc )=1) SCR ON PQ1.PRTY_ID = SCR.PRTY_ID) prty_scr_q ON (PRTY_QUOTN_Q.QUOTN_ID=prty_scr_q.QUOTN_ID AND prty_scr_q.PRTY_ID=PRTY_QUOTN_Q.PRTY_ID)



LEFT OUTER JOIN

(

SELECT distinct QUOTN_ID, INDIV_FULL_NAME AS SRC_USR_NUM FROM

(SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND PRTY_QUOTN_ROLE_CD = ''CRE'')PQ

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.INDIV WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') INDIV ON PQ.PRTY_ID = INDIV.INDIV_PRTY_ID

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.INDIV_NAME WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'') INM ON INDIV.INDIV_PRTY_ID = INM.INDIV_PRTY_ID

) SRC_USR_NUM_Q on PRTY_QUOTN_Q.QUOTN_ID = SRC_USR_NUM_Q.QUOTN_ID





LEFT OUTER JOIN

(select max(AGNT_NUM ) AGNT_NUM,max(TAX_IDNTFTN_NUM) TAX_IDNTFTN_NUM,max(DLN_NUMBER) DLN_NUMBER ,MAX(AGNT_CLIENT_NUM) AGNT_CLIENT_NUM,QUOTN_ID FROM 

(select case  when PRTY_IDNTFTN_TYPE_CD=''AGT'' then PRTY_IDNTFTN_NUM else null end as AGNT_NUM,

case  when PRTY_IDNTFTN_TYPE_CD in (''TIN'') then PRTY_IDNTFTN_NUM else null end as TAX_IDNTFTN_NUM,

case  when PRTY_IDNTFTN_TYPE_CD  =''DLN'' AND PRTY_QUOTN_ROLE_CD = ''PLCYDRVR'' then PRTY_IDNTFTN_NUM else null end as DLN_NUMBER,

case  when PRTY_IDNTFTN_TYPE_CD  =''GWID'' then PRTY_IDNTFTN_NUM else null end as AGNT_CLIENT_NUM,

QUOTN.QUOTN_ID

from (SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') QUOTN 

INNER  join (SELECT PRTY_ID,PRTY_IDNTFTN_NUM,PRTY_IDNTFTN_TYPE_CD FROM DB_T_PROD_CORE.PRTY_IDNTFTN WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'') IDNTFTN

on IDNTFTN.PRTY_ID=QUOTN.PRTY_ID

where PRTY_IDNTFTN_TYPE_CD in (''AGT'',''TIN'',''DLN'',''GWID''))X

GROUP BY QUOTN_ID

) AGNT_NUM_Q on PRTY_QUOTN_Q.QUOTN_ID=AGNT_NUM_Q.QUOTN_ID



LEFT OUTER JOIN

(select iv.username as c_prty_id,QUOTN_ID, P.PRTY_ID from 

(SELECT prty_id, QUOTN_ID  from DB_T_PROD_CORE.PRTY_QUOTN WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'' AND PRTY_QUOTN_ROLE_CD=''CRTD'')  P 

INNER JOIN

(SELECT * FROM DB_T_PROD_CORE.INDIV WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'') INDIV ON P.PRTY_ID = INDIV.INDIV_PRTY_ID

INNER JOIN

(select indiv_prty_id , INDIV_FULL_NAME as username FROM DB_T_PROD_CORE.INDIV_NAME where to_char(edw_end_dttm, ''mm/dd/yyyy'') = ''12/31/9999'') iv on INDIV.INDIV_PRTY_ID = IV.INDIV_PRTY_ID) prty_id_crtd_Q on PRTY_QUOTN_Q.QUOTN_ID=prty_id_crtd_Q.QUOTN_ID

 

LEFT OUTER JOIN 

(select iv.username as u_prty_id,QUOTN_ID , P.PRTY_ID from 

(SELECT prty_id, QUOTN_ID  from DB_T_PROD_CORE.PRTY_QUOTN WHERE  TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'' AND PRTY_QUOTN_ROLE_CD=''UPTD'')  P

INNER JOIN

(SELECT * FROM DB_T_PROD_CORE.INDIV WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'') INDIV ON P.PRTY_ID = INDIV.INDIV_PRTY_ID

INNER JOIN

(select indiv_prty_id , INDIV_FULL_NAME as username FROM DB_T_PROD_CORE.INDIV_NAME where to_char(edw_end_dttm, ''mm/dd/yyyy'') = ''12/31/9999'') iv on INDIV.INDIV_PRTY_ID = IV.INDIV_PRTY_ID) prty_id_updt_Q on PRTY_QUOTN_Q.QUOTN_ID=prty_id_updt_Q.QUOTN_ID

 

 LEFT OUTER JOIN

 (SELECT  PRTYQUON_DET.QUOTN_ID,

MAX(MSTR_CO_NUM) AS  MSTR_CO_NUM,

MAX(UNDWRTR_CO_NAME) AS UNDWRTR_CO_NAME,

MAX(SLS_SRVC_CTR_NAME) AS SLS_SRVC_CTR_NAME,

MAX(SRVC_CTR_NUM) AS SRVC_CTR_NUM

FROM (

SELECT  PRTYQUON_DET.QUOTN_ID,

PRTYQUON_DET.MSTR_CO_NUM_INT AS MSTR_CO_NUM,

PRTYQUON_DET.UNDWRTR_CO_NAME,

PRTYQUON_DET.SLS_SRVC_CTR_NAME_ORG AS SLS_SRVC_CTR_NAME,

PRTYQUON_DET.SRVC_CTR_NUM_ORG AS SRVC_CTR_NUM



FROM (

SELECT PQ1.QUOTN_ID,

CASE WHEN (PQ1.PRTY_QUOTN_ROLE_CD = ''CMP'' AND IORG.INTRNL_ORG_SBTYPE_CD=''CO'' AND IORG.INTRNL_ORG_TYPE_CD=''INT'') THEN IORG.INTRNL_ORG_NUM END AS  MSTR_CO_NUM_INT,

CASE WHEN (PQ1.PRTY_QUOTN_ROLE_CD = ''CMP'' AND IORG.INTRNL_ORG_SBTYPE_CD=''CO'' AND IORG.INTRNL_ORG_TYPE_CD=''INT'') THEN IORG.PRTY_DESC END AS  UNDWRTR_CO_NAME,

CASE WHEN (PQ1.PRTY_QUOTN_ROLE_CD = ''SVC'' AND IORG.INTRNL_ORG_SBTYPE_CD=''SERVICECENTER_ALFA'' AND IORG.INTRNL_ORG_TYPE_CD=''INT'' ) 

THEN ORG_NAME END AS  SLS_SRVC_CTR_NAME_ORG,

CASE WHEN (PQ1.PRTY_QUOTN_ROLE_CD = ''SVC'' AND IORG.INTRNL_ORG_SBTYPE_CD=''SERVICECENTER_ALFA'' AND IORG.INTRNL_ORG_TYPE_CD=''INT'' ) 

THEN IORG.INTRNL_ORG_NUM END AS  SRVC_CTR_NUM_ORG

FROM 

(select * from DB_T_PROD_CORE.PRTY_QUOTN WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'' ) PQ1

INNER JOIN  (SELECT * FROM DB_T_PROD_CORE.INTRNL_ORG WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'') IORG ON PQ1.PRTY_ID = IORG.INTRNL_ORG_PRTY_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.ORG_NAME WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'') O ON O.PRTY_ID = IORG.INTRNL_ORG_PRTY_ID

) PRTYQUON_DET) AS PRTYQUON_DET  

GROUP BY QUOTN_ID) prty_num_q ON PRTY_QUOTN_Q.QUOTN_ID=prty_num_q.QUOTN_ID



LEFT OUTER JOIN

(SELECT PQ.PRTY_ID,QUOTN_ID, INDIV_FULL_NAME AS AGNT_NAME FROM

(SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'' AND PRTY_QUOTN_ROLE_CD = ''AGT'')PQ

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.INDIV WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'' ) INDIV ON PQ.PRTY_ID = INDIV.INDIV_PRTY_ID 

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.INDIV_NAME WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'') INM ON INDIV.INDIV_PRTY_ID = INM.INDIV_PRTY_ID) AGNT_NAME_Q  

ON  PRTY_QUOTN_Q.QUOTN_ID=AGNT_NAME_Q.QUOTN_ID

) PRTY
) SRC
)
);


-- Component ex_pass_to_tgt_intrm, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE ex_pass_to_tgt_intrm AS
(
SELECT
SQ_QUOTES_PRTY_QUOTN_INTRM.CO_NAME as CO_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.FRST_NAME as FRST_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.MDL_NAME as MDL_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.LAST_NAME as LAST_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.NAME_PREFIX_TXT as NAME_PREFIX_TXT,
SQ_QUOTES_PRTY_QUOTN_INTRM.NAME_SFX_TXT as NAME_SFX_TXT,
SQ_QUOTES_PRTY_QUOTN_INTRM.ADDR_LN_1_TXT as ADDR_LN_1_TXT,
SQ_QUOTES_PRTY_QUOTN_INTRM.ADDR_LN_2_TXT as ADDR_LN_2_TXT,
SQ_QUOTES_PRTY_QUOTN_INTRM.CITY_NAME as CITY_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.CNTY_NAME as CNTY_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.ST_NAME as ST_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.ZIP as ZIP,
SQ_QUOTES_PRTY_QUOTN_INTRM.TAX_IDNTFTN_NUM as TAX_IDNTFTN_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.BIRTH_DT as BIRTH_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.DRVG_LIC_NUM as DRVG_LIC_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.AGE_OF_QUOT_CNT as AGE_OF_QUOT_CNT,
SQ_QUOTES_PRTY_QUOTN_INTRM.AGNT_NAME as AGNT_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.AGNT_NUM as AGNT_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.RISK_LOC_CITY_NAME as RISK_LOC_CITY_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.RISK_LOC_CTRY_NAME as RISK_LOC_CTRY_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.RISK_LOC_CNTY_NAME as RISK_LOC_CNTY_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.CVGE_CD as CVGE_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.CVGE_AMT as CVGE_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.CVGE_DESC as CVGE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRMRY_INSRD_ADDR_DESC as PRMRY_INSRD_ADDR_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRMRY_INSRD_NAME as PRMRY_INSRD_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.LOB as LOB,
SQ_QUOTES_PRTY_QUOTN_INTRM.UNDRWRTG_CO_NAME as UNDRWRTG_CO_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.MSTR_CO_NUM as MSTR_CO_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.RNEWL_STS as RNEWL_STS,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_ACCNTG_DT as PLCY_ACCNTG_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_ASGND_DT as PLCY_ASGND_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_EFF_DT as PLCY_EFF_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_TERM_EXPN_DT as PLCY_TERM_EXPN_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_ISSU_DT as PLCY_ISSU_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_NUM as PLCY_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_RJCTN_RSN_DESC as PLCY_RJCTN_RSN_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.SCNDRY_INSRD_NAME as SCNDRY_INSRD_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.ADDL_INSRD_NAME as ADDL_INSRD_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_ADDL_INSRD_NAME as PLCY_ADDL_INSRD_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_ADDL_INSRD_NAME as VEH_ADDL_INSRD_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.QUOT_INITATN_DTTM as QUOT_INITATN_DTTM,
SQ_QUOTES_PRTY_QUOTN_INTRM.QUOT_PREM_AMT as QUOT_PREM_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.QUOT_STS as QUOT_STS,
SQ_QUOTES_PRTY_QUOTN_INTRM.SLS_SRVC_CTR_NAME as SLS_SRVC_CTR_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.SLS_SRVC_CTR_ADDR as SLS_SRVC_CTR_ADDR,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_ORIG_ST_NAME as PLCY_ORIG_ST_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_WRTN_ST_NAME as PLCY_WRTN_ST_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.TOT_WRTN_PREM_AMT as TOT_WRTN_PREM_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.TRANS_TYPE_DESC as TRANS_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.TRANS_DT as TRANS_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.TRNRND_TM_TXT as TRNRND_TM_TXT,
SQ_QUOTES_PRTY_QUOTN_INTRM.UNDRWRTG_CO_TIER_DESC as UNDRWRTG_CO_TIER_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.MRTL_STS as MRTL_STS,
SQ_QUOTES_PRTY_QUOTN_INTRM.OCPTN_DESC as OCPTN_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.DEDCTB_AMT as DEDCTB_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.MORTGAGEE as MORTGAGEE,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_TYPE_DESC as PLCY_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.CNSTRCTN_DESC as CNSTRCTN_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.HTG_DESC as HTG_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.COOLG_DESC as COOLG_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.CNSTRCTN_DT as CNSTRCTN_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.AUTO_LATE_PAY_NUM as AUTO_LATE_PAY_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.AUTO_PMT_FRQCY_DESC as AUTO_PMT_FRQCY_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRMRY_RSPNS_SRVC_DESC as PRMRY_RSPNS_SRVC_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.UNDERPINNING_CR_DESC as UNDERPINNING_CR_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.MH_RTG_CLAS_DESC as MH_RTG_CLAS_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.MH_PRK_NAME as MH_PRK_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.MH_PRK_CD as MH_PRK_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.CLAS_OF_PRPTY_DESC as CLAS_OF_PRPTY_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.BODILY_INJRY_LMT_AMT as BODILY_INJRY_LMT_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_WTH_DMG_CNT as VEH_WTH_DMG_CNT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_DSCNT_NAME as PLCY_DSCNT_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.DRVR_CLAS_DESC as DRVR_CLAS_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.EXCLN_WAIVD_RSN_DESC as EXCLN_WAIVD_RSN_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.GNDR_TYPE_DESC as GNDR_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.LIABTY_ONLY_IND as LIABTY_ONLY_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.NO_PRIOR_INSRNC_IND as NO_PRIOR_INSRNC_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRPTY_DMG_LMT_AMT as PRPTY_DMG_LMT_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_INT_TYPE_DESC as PLCY_INT_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRIOR_INSRNC_CARIER_NAME as PRIOR_INSRNC_CARIER_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.RATE_UPS_DESC as RATE_UPS_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.RLTNSHP_DESC as RLTNSHP_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.TAX_CITY_NAME as TAX_CITY_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_SYMB_COLLISION_CD as VEH_SYMB_COLLISION_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_TYPE_DESC as VEH_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_USE_DESC as VEH_USE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_MODL_YR as VEH_MODL_YR,
SQ_QUOTES_PRTY_QUOTN_INTRM.YRS_WTH_ALFA as YRS_WTH_ALFA,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_INDENTIFICATION_NUM as VEH_INDENTIFICATION_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_WRTN_ST_CD as PLCY_WRTN_ST_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.SLS_RGN_ST_NAME as SLS_RGN_ST_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.SLS_RGN_DSTRCT_NAME as SLS_RGN_DSTRCT_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.SRVC_CTR_NUM as SRVC_CTR_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.AGNT_CLNT_NUM as AGNT_CLNT_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.INSRNC_SCR_CD as INSRNC_SCR_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.NAME_INSRD_MRTL_STS_DESC as NAME_INSRD_MRTL_STS_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.NAME_INSRD_AGE_DESC as NAME_INSRD_AGE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.COMBO_DSCNT_IND as COMBO_DSCNT_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.MULT_CAR_DSCNT_IND as MULT_CAR_DSCNT_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.VAL_CLNT_DSCNT_IND as VAL_CLNT_DSCNT_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.LIF_PLCY_DSCNT_IND as LIF_PLCY_DSCNT_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.HOME_OWNRSHP_DSCNT_IND as HOME_OWNRSHP_DSCNT_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.AUTO_DSCNT_IND as AUTO_DSCNT_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.NEW_HOME_DSCNT_PCTG as NEW_HOME_DSCNT_PCTG,
SQ_QUOTES_PRTY_QUOTN_INTRM.VAL_CLNT_DSCNT_PCTG as VAL_CLNT_DSCNT_PCTG,
SQ_QUOTES_PRTY_QUOTN_INTRM.HOME_ALRT_DSCNT_PCTG as HOME_ALRT_DSCNT_PCTG,
SQ_QUOTES_PRTY_QUOTN_INTRM.HOME_ALRT_CD as HOME_ALRT_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.INSRD_PRPTY_CNTY_NAME as INSRD_PRPTY_CNTY_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_CVGE_AMT as DWLNG_CVGE_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PERSNL_PRPTY_CVGE_AMT as PERSNL_PRPTY_CVGE_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.CNSTRCTN_TYPE_DESC as CNSTRCTN_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.OCPTN_CD as OCPTN_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRIOR_INSRNC_CARIER_CD as PRIOR_INSRNC_CARIER_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.LGCY_DSCNT_IND as LGCY_DSCNT_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.LATE_PMT_PCTG as LATE_PMT_PCTG,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_PRD_STRT_DT as PLCY_PRD_STRT_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_PRD_END_DT as PLCY_PRD_END_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.TERM_NUM as TERM_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.INSRD_EML_TXT as INSRD_EML_TXT,
SQ_QUOTES_PRTY_QUOTN_INTRM.INSRD_TLPHN_NUM as INSRD_TLPHN_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.TOT_UNITS_CNT as TOT_UNITS_CNT,
SQ_QUOTES_PRTY_QUOTN_INTRM.ENDRSMT_DESC as ENDRSMT_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.ANULZD_TOT_WRTN_PREM_AMT as ANULZD_TOT_WRTN_PREM_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRTCTN_CLAS_DESC as PRTCTN_CLAS_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_CNCLTN_SRC_DESC as PLCY_CNCLTN_SRC_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.PREM_DUE_AMT as PREM_DUE_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.MBR_NUM as MBR_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.CUST_ID as CUST_ID,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_INCPTN_DT as PLCY_INCPTN_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_AGE as PLCY_AGE,
SQ_QUOTES_PRTY_QUOTN_INTRM.SRC_USR_NUM as SRC_USR_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.PREM_BILD_AMT as PREM_BILD_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.ENCMCE_CD as ENCMCE_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.RSDNC_TYEP_DESC as RSDNC_TYEP_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_GARGD_LOC_NAME as VEH_GARGD_LOC_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.ROOF_YR as ROOF_YR,
SQ_QUOTES_PRTY_QUOTN_INTRM.CNTNUS_SRVC_DT as CNTNUS_SRVC_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_VAL_AMT as DWLNG_VAL_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.DRVR_PNT_DESC as DRVR_PNT_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.ARS_SCR as ARS_SCR,
SQ_QUOTES_PRTY_QUOTN_INTRM.AGE_OF_HOME as AGE_OF_HOME,
SQ_QUOTES_PRTY_QUOTN_INTRM.QUOT_CHNL_TXT as QUOT_CHNL_TXT,
SQ_QUOTES_PRTY_QUOTN_INTRM.QUOT_RTD_IND as QUOT_RTD_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.TOT_UNEARND_PREM_AMT as TOT_UNEARND_PREM_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.ADDR_TYPE_DESC as ADDR_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.DOG_ON_PREMS_IND as DOG_ON_PREMS_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_APRSL_DT as DWLNG_APRSL_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_SQUAR_FOOTGE as DWLNG_SQUAR_FOOTGE,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_BODY_TYPE_DESC as VEH_BODY_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_COLOR_DESC as VEH_COLOR_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_MAKE_DESC as VEH_MAKE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_MODL_DESC as VEH_MODL_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.VEH_PRCH_DT as VEH_PRCH_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_PRCH_DT as DWLNG_PRCH_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_NUM_OF_STORIES_CNT as DWLNG_NUM_OF_STORIES_CNT,
SQ_QUOTES_PRTY_QUOTN_INTRM.RATE_AS_OF_DT_AMT as RATE_AS_OF_DT_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.TRANS_CLSD_DT as TRANS_CLSD_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.GAR_CRPT_DESC as GAR_CRPT_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.SCREENED_POOL_IND as SCREENED_POOL_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_FIRE_DEPT_CD as DWLNG_FIRE_DEPT_CD,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_FRST_ISSU_DT as PLCY_FRST_ISSU_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_FNDTN_TYPE as DWLNG_FNDTN_TYPE,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_USE_DESC as DWLNG_USE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_OCPYD_DESC as DWLNG_OCPYD_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.FIRE_HYDRANT_1000_FEET_IND as FIRE_HYDRANT_1000_FEET_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.FIRE_HYDRANT_5_MILE_IND as FIRE_HYDRANT_5_MILE_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.SWIMMING_POOL_IND as SWIMMING_POOL_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.WIND_AND_HAIL_EXCLDD_IND as WIND_AND_HAIL_EXCLDD_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_ISSUD_IND as PLCY_ISSUD_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_LAT_MEAS as DWLNG_LAT_MEAS,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_LNGTD_MEAS as DWLNG_LNGTD_MEAS,
SQ_QUOTES_PRTY_QUOTN_INTRM.INSRD_LIC_ST_NAME as INSRD_LIC_ST_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_VALUT_METH_NAME as DWLNG_VALUT_METH_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_CVGE_LMT_AMT as DWLNG_CVGE_LMT_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRPTY_VALUT_METH_DESC as PRPTY_VALUT_METH_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.PERSNL_PRPTY_CVGE_LMT_AMT as PERSNL_PRPTY_CVGE_LMT_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.OTH_STRC_CVGE_LMT_AMT as OTH_STRC_CVGE_LMT_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.LOSS_OF_USE_CVGE_LMT_AMT as LOSS_OF_USE_CVGE_LMT_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRPTY_ZN_DESC as PRPTY_ZN_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_PRCH_AMT as DWLNG_PRCH_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.DWLNG_ROOF_TYPE_DESC as DWLNG_ROOF_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_TERM_TYPE as PLCY_TERM_TYPE,
SQ_QUOTES_PRTY_QUOTN_INTRM.PLCY_TOT_COST_AMT as PLCY_TOT_COST_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.EARND_PREM_AMT as EARND_PREM_AMT,
SQ_QUOTES_PRTY_QUOTN_INTRM.MBR_TYPE_DESC as MBR_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.MOST_RCENT_QUOT_VERS_DT as MOST_RCENT_QUOT_VERS_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.TOT_VEHICAL_UNIT_CNT as TOT_VEHICAL_UNIT_CNT,
SQ_QUOTES_PRTY_QUOTN_INTRM.QUOT_STS_DESC as QUOT_STS_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.QUOT_VERS_NUM as QUOT_VERS_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.PROD_LN_DESC as PROD_LN_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.CO_TO_CO_TFR_DESC as CO_TO_CO_TFR_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.NEW_PRPTY_CUST_IND as NEW_PRPTY_CUST_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.TOT_FIRE_LOSS_IND as TOT_FIRE_LOSS_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.TOT_LOSS_10_YR_IND as TOT_LOSS_10_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRPTY_LOSS_5_YR_IND as PRPTY_LOSS_5_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.TWO_WEA_LOSS_5_YR_IND as TWO_WEA_LOSS_5_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.ONE_WEA_LOSS_5_YR_IND as ONE_WEA_LOSS_5_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.LOSS_3_YR_IND as LOSS_3_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.THEFT_LOSS_IND as THEFT_LOSS_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.LOSS_5_YR_IND as LOSS_5_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.DCLND_5_YR_IND as DCLND_5_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.LTGTN_PEND_IND as LTGTN_PEND_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.FRCLSR_5_YR_IND as FRCLSR_5_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.TRFC_VLATN_IND as TRFC_VLATN_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.AUTO_INSRNC_CANCELLED_12_MTH_I as AUTO_INSRNC_CANCELLED_12_MTH_I,
SQ_QUOTES_PRTY_QUOTN_INTRM.LIC_SUSPD_5_YR_IND as LIC_SUSPD_5_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.RPOSESN_3_YR_IND as RPOSESN_3_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.RPOSESN_DT as RPOSESN_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.ARRESTED_5_YR_IND as ARRESTED_5_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.FAULT_ACDNT_5_YR_IND as FAULT_ACDNT_5_YR_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.APLCNT_CURRENTLY_INSRD_TXT as APLCNT_CURRENTLY_INSRD_TXT,
SQ_QUOTES_PRTY_QUOTN_INTRM.LIC_CURRENTLY_SUSPD_IND as LIC_CURRENTLY_SUSPD_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.LIC_SUSPD_IND as LIC_SUSPD_IND,
SQ_QUOTES_PRTY_QUOTN_INTRM.SBMN_JOB_CRT_DT as SBMN_JOB_CRT_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.SBMN_JOB_UPDT_DT as SBMN_JOB_UPDT_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.SBMN_JOB_CLS_DT as SBMN_JOB_CLS_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.SBMN_JOB_CRT_USR_NAME as SBMN_JOB_CRT_USR_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.SBMN_JOB_UPDT_USR_NAME as SBMN_JOB_UPDT_USR_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.SBMN_JOB_EFF_DT as SBMN_JOB_EFF_DT,
SQ_QUOTES_PRTY_QUOTN_INTRM.BRNCH_NUM as BRNCH_NUM,
SQ_QUOTES_PRTY_QUOTN_INTRM.BRNCH_NAME as BRNCH_NAME,
SQ_QUOTES_PRTY_QUOTN_INTRM.PRD_ID as PRD_ID,
SQ_QUOTES_PRTY_QUOTN_INTRM.UNDRWRTG_ISSU_TYPE_DESC as UNDRWRTG_ISSU_TYPE_DESC,
SQ_QUOTES_PRTY_QUOTN_INTRM.UNDRWRTG_ISSU_STS as UNDRWRTG_ISSU_STS,
SQ_QUOTES_PRTY_QUOTN_INTRM.QUOTN_ID as QUOTN_ID,
SQ_QUOTES_PRTY_QUOTN_INTRM.NK_JOB_NBR as NK_JOB_NBR,
SQ_QUOTES_PRTY_QUOTN_INTRM.source_record_id
FROM
SQ_QUOTES_PRTY_QUOTN_INTRM
);


-- Component TGT_QUOTES_PRTY_QUOTN_INTRM, Type TARGET 

/*INSERT INTO QUOTES_PRTY_QUOTN_INTRM

(
CO_NAME,
FRST_NAME,
MDL_NAME,
LAST_NAME,
NAME_PREFIX_TXT,
NAME_SFX_TXT,
ADDR_LN_1_TXT,
ADDR_LN_2_TXT,
CITY_NAME,
CNTY_NAME,
ST_NAME,
ZIP,
TAX_IDNTFTN_NUM,
BIRTH_DT,
DRVG_LIC_NUM,
AGE_OF_QUOT_CNT,
AGNT_NAME,
AGNT_NUM,
RISK_LOC_CITY_NAME,
RISK_LOC_CTRY_NAME,
RISK_LOC_CNTY_NAME,
CVGE_CD,
CVGE_AMT,
CVGE_DESC,
PRMRY_INSRD_ADDR_DESC,
PRMRY_INSRD_NAME,
LOB,
UNDRWRTG_CO_NAME,
MSTR_CO_NUM,
RNEWL_STS,
PLCY_ACCNTG_DT,
PLCY_ASGND_DT,
PLCY_EFF_DT,
PLCY_TERM_EXPN_DT,
PLCY_ISSU_DT,
PLCY_NUM,
PLCY_RJCTN_RSN_DESC,
SCNDRY_INSRD_NAME,
ADDL_INSRD_NAME,
PLCY_ADDL_INSRD_NAME,
VEH_ADDL_INSRD_NAME,
QUOT_INITATN_DTTM,
QUOT_PREM_AMT,
QUOT_STS,
SLS_SRVC_CTR_NAME,
SLS_SRVC_CTR_ADDR,
PLCY_ORIG_ST_NAME,
PLCY_WRTN_ST_NAME,
TOT_WRTN_PREM_AMT,
TRANS_TYPE_DESC,
TRANS_DT,
TRNRND_TM_TXT,
UNDRWRTG_CO_TIER_DESC,
MRTL_STS,
OCPTN_DESC,
DEDCTB_AMT,
MORTGAGEE,
PLCY_TYPE_DESC,
CNSTRCTN_DESC,
HTG_DESC,
COOLG_DESC,
CNSTRCTN_DT,
AUTO_LATE_PAY_NUM,
AUTO_PMT_FRQCY_DESC,
PRMRY_RSPNS_SRVC_DESC,
UNDERPINNING_CR_DESC,
MH_RTG_CLAS_DESC,
MH_PRK_NAME,
MH_PRK_CD,
CLAS_OF_PRPTY_DESC,
BODILY_INJRY_LMT_AMT,
VEH_WTH_DMG_CNT,
PLCY_DSCNT_NAME,
DRVR_CLAS_DESC,
EXCLN_WAIVD_RSN_DESC,
GNDR_TYPE_DESC,
LIABTY_ONLY_IND,
NO_PRIOR_INSRNC_IND,
PRPTY_DMG_LMT_AMT,
PLCY_INT_TYPE_DESC,
PRIOR_INSRNC_CARIER_NAME,
RATE_UPS_DESC,
RLTNSHP_DESC,
TAX_CITY_NAME,
VEH_SYMB_COLLISION_CD,
VEH_TYPE_DESC,
VEH_USE_DESC,
VEH_MODL_YR,
YRS_WTH_ALFA,
VEH_INDENTIFICATION_NUM,
PLCY_WRTN_ST_CD,
SLS_RGN_ST_NAME,
SLS_RGN_DSTRCT_NAME,
SRVC_CTR_NUM,
AGNT_CLNT_NUM,
INSRNC_SCR_CD,
NAME_INSRD_MRTL_STS_DESC,
COMBO_DSCNT_IND,
MULT_CAR_DSCNT_IND,
VAL_CLNT_DSCNT_IND,
LIF_PLCY_DSCNT_IND,
HOME_OWNRSHP_DSCNT_IND,
AUTO_DSCNT_IND,
NEW_HOME_DSCNT_PCTG,
VAL_CLNT_DSCNT_PCTG,
HOME_ALRT_DSCNT_PCTG,
HOME_ALRT_CD,
INSRD_PRPTY_CNTY_NAME,
DWLNG_CVGE_AMT,
PERSNL_PRPTY_CVGE_AMT,
CNSTRCTN_TYPE_DESC,
OCPTN_CD,
PRIOR_INSRNC_CARIER_CD,
LGCY_DSCNT_IND,
LATE_PMT_PCTG,
PLCY_PRD_STRT_DT,
PLCY_PRD_END_DT,
TERM_NUM,
INSRD_EML_TXT,
INSRD_TLPHN_NUM,
TOT_UNITS_CNT,
ENDRSMT_DESC,
ANULZD_TOT_WRTN_PREM_AMT,
PRTCTN_CLAS_DESC,
PLCY_CNCLTN_SRC_DESC,
PREM_DUE_AMT,
MBR_NUM,
CUST_ID,
PLCY_INCPTN_DT,
PLCY_AGE,
SRC_USR_NUM,
PREM_BILD_AMT,
ENCMCE_CD,
RSDNC_TYEP_DESC,
VEH_GARGD_LOC_NAME,
ROOF_YR,
CNTNUS_SRVC_DT,
DWLNG_VAL_AMT,
DRVR_PNT_DESC,
ARS_SCR,
AGE_OF_HOME,
QUOT_CHNL_TXT,
QUOT_RTD_IND,
TOT_UNEARND_PREM_AMT,
ADDR_TYPE_DESC,
DOG_ON_PREMS_IND,
DWLNG_APRSL_DT,
DWLNG_SQUAR_FOOTGE,
VEH_BODY_TYPE_DESC,
VEH_COLOR_DESC,
VEH_MAKE_DESC,
VEH_MODL_DESC,
VEH_PRCH_DT,
DWLNG_PRCH_DT,
DWLNG_NUM_OF_STORIES_CNT,
RATE_AS_OF_DT_AMT,
TRANS_CLSD_DT,
GAR_CRPT_DESC,
SCREENED_POOL_IND,
DWLNG_FIRE_DEPT_CD,
PLCY_FRST_ISSU_DT,
DWLNG_FNDTN_TYPE,
DWLNG_USE_DESC,
DWLNG_OCPYD_DESC,
FIRE_HYDRANT_1000_FEET_IND,
FIRE_HYDRANT_5_MILE_IND,
SWIMMING_POOL_IND,
WIND_AND_HAIL_EXCLDD_IND,
PLCY_ISSUD_IND,
DWLNG_LAT_MEAS,
DWLNG_LNGTD_MEAS,
INSRD_LIC_ST_NAME,
DWLNG_VALUT_METH_NAME,
DWLNG_CVGE_LMT_AMT,
PRPTY_VALUT_METH_DESC,
PERSNL_PRPTY_CVGE_LMT_AMT,
OTH_STRC_CVGE_LMT_AMT,
LOSS_OF_USE_CVGE_LMT_AMT,
PRPTY_ZN_DESC,
DWLNG_PRCH_AMT,
DWLNG_ROOF_TYPE_DESC,
PLCY_TERM_TYPE,
PLCY_TOT_COST_AMT,
EARND_PREM_AMT,
MBR_TYPE_DESC,
MOST_RCENT_QUOT_VERS_DT,
TOT_VEHICAL_UNIT_CNT,
QUOT_STS_DESC,
QUOT_VERS_NUM,
PROD_LN_DESC,
CO_TO_CO_TFR_DESC,
NEW_PRPTY_CUST_IND,
TOT_FIRE_LOSS_IND,
TOT_LOSS_10_YR_IND,
PRPTY_LOSS_5_YR_IND,
TWO_WEA_LOSS_5_YR_IND,
ONE_WEA_LOSS_5_YR_IND,
LOSS_3_YR_IND,
THEFT_LOSS_IND,
LOSS_5_YR_IND,
DCLND_5_YR_IND,
LTGTN_PEND_IND,
FRCLSR_5_YR_IND,
TRFC_VLATN_IND,
AUTO_INSRNC_CANCELLED_12_MTH_I,
LIC_SUSPD_5_YR_IND,
RPOSESN_3_YR_IND,
RPOSESN_DT,
ARRESTED_5_YR_IND,
FAULT_ACDNT_5_YR_IND,
APLCNT_CURRENTLY_INSRD_TXT,
LIC_CURRENTLY_SUSPD_IND,
LIC_SUSPD_IND,
SBMN_JOB_CRT_DT,
SBMN_JOB_UPDT_DT,
SBMN_JOB_CLS_DT,
SBMN_JOB_CRT_USR_NAME,
SBMN_JOB_UPDT_USR_NAME,
SBMN_JOB_EFF_DT,
BRNCH_NUM,
BRNCH_NAME,
PRD_ID,
UNDRWRTG_ISSU_TYPE_DESC,
UNDRWRTG_ISSU_STS,
NK_JOB_NBR,
QUOTN_ID
)
commented for missing table*/
CREATE OR REPLACE TEMPORARY TABLE QUOTES_PRTY_QUOTN_INTRM AS
(SELECT
ex_pass_to_tgt_intrm.CO_NAME as CO_NAME,
ex_pass_to_tgt_intrm.FRST_NAME as FRST_NAME,
ex_pass_to_tgt_intrm.MDL_NAME as MDL_NAME,
ex_pass_to_tgt_intrm.LAST_NAME as LAST_NAME,
ex_pass_to_tgt_intrm.NAME_PREFIX_TXT as NAME_PREFIX_TXT,
ex_pass_to_tgt_intrm.NAME_SFX_TXT as NAME_SFX_TXT,
ex_pass_to_tgt_intrm.ADDR_LN_1_TXT as ADDR_LN_1_TXT,
ex_pass_to_tgt_intrm.ADDR_LN_2_TXT as ADDR_LN_2_TXT,
ex_pass_to_tgt_intrm.CITY_NAME as CITY_NAME,
ex_pass_to_tgt_intrm.CNTY_NAME as CNTY_NAME,
ex_pass_to_tgt_intrm.ST_NAME as ST_NAME,
ex_pass_to_tgt_intrm.ZIP as ZIP,
ex_pass_to_tgt_intrm.TAX_IDNTFTN_NUM as TAX_IDNTFTN_NUM,
ex_pass_to_tgt_intrm.BIRTH_DT as BIRTH_DT,
ex_pass_to_tgt_intrm.DRVG_LIC_NUM as DRVG_LIC_NUM,
ex_pass_to_tgt_intrm.AGE_OF_QUOT_CNT as AGE_OF_QUOT_CNT,
ex_pass_to_tgt_intrm.AGNT_NAME as AGNT_NAME,
ex_pass_to_tgt_intrm.AGNT_NUM as AGNT_NUM,
ex_pass_to_tgt_intrm.RISK_LOC_CITY_NAME as RISK_LOC_CITY_NAME,
ex_pass_to_tgt_intrm.RISK_LOC_CTRY_NAME as RISK_LOC_CTRY_NAME,
ex_pass_to_tgt_intrm.RISK_LOC_CNTY_NAME as RISK_LOC_CNTY_NAME,
ex_pass_to_tgt_intrm.CVGE_CD as CVGE_CD,
ex_pass_to_tgt_intrm.CVGE_AMT as CVGE_AMT,
ex_pass_to_tgt_intrm.CVGE_DESC as CVGE_DESC,
ex_pass_to_tgt_intrm.PRMRY_INSRD_ADDR_DESC as PRMRY_INSRD_ADDR_DESC,
ex_pass_to_tgt_intrm.PRMRY_INSRD_NAME as PRMRY_INSRD_NAME,
ex_pass_to_tgt_intrm.LOB as LOB,
ex_pass_to_tgt_intrm.UNDRWRTG_CO_NAME as UNDRWRTG_CO_NAME,
ex_pass_to_tgt_intrm.MSTR_CO_NUM as MSTR_CO_NUM,
ex_pass_to_tgt_intrm.RNEWL_STS as RNEWL_STS,
ex_pass_to_tgt_intrm.PLCY_ACCNTG_DT as PLCY_ACCNTG_DT,
ex_pass_to_tgt_intrm.PLCY_ASGND_DT as PLCY_ASGND_DT,
ex_pass_to_tgt_intrm.PLCY_EFF_DT as PLCY_EFF_DT,
ex_pass_to_tgt_intrm.PLCY_TERM_EXPN_DT as PLCY_TERM_EXPN_DT,
ex_pass_to_tgt_intrm.PLCY_ISSU_DT as PLCY_ISSU_DT,
ex_pass_to_tgt_intrm.PLCY_NUM as PLCY_NUM,
ex_pass_to_tgt_intrm.PLCY_RJCTN_RSN_DESC as PLCY_RJCTN_RSN_DESC,
ex_pass_to_tgt_intrm.SCNDRY_INSRD_NAME as SCNDRY_INSRD_NAME,
ex_pass_to_tgt_intrm.ADDL_INSRD_NAME as ADDL_INSRD_NAME,
ex_pass_to_tgt_intrm.PLCY_ADDL_INSRD_NAME as PLCY_ADDL_INSRD_NAME,
ex_pass_to_tgt_intrm.VEH_ADDL_INSRD_NAME as VEH_ADDL_INSRD_NAME,
ex_pass_to_tgt_intrm.QUOT_INITATN_DTTM as QUOT_INITATN_DTTM,
ex_pass_to_tgt_intrm.QUOT_PREM_AMT as QUOT_PREM_AMT,
ex_pass_to_tgt_intrm.QUOT_STS as QUOT_STS,
ex_pass_to_tgt_intrm.SLS_SRVC_CTR_NAME as SLS_SRVC_CTR_NAME,
ex_pass_to_tgt_intrm.SLS_SRVC_CTR_ADDR as SLS_SRVC_CTR_ADDR,
ex_pass_to_tgt_intrm.PLCY_ORIG_ST_NAME as PLCY_ORIG_ST_NAME,
ex_pass_to_tgt_intrm.PLCY_WRTN_ST_NAME as PLCY_WRTN_ST_NAME,
ex_pass_to_tgt_intrm.TOT_WRTN_PREM_AMT as TOT_WRTN_PREM_AMT,
ex_pass_to_tgt_intrm.TRANS_TYPE_DESC as TRANS_TYPE_DESC,
ex_pass_to_tgt_intrm.TRANS_DT as TRANS_DT,
ex_pass_to_tgt_intrm.TRNRND_TM_TXT as TRNRND_TM_TXT,
ex_pass_to_tgt_intrm.UNDRWRTG_CO_TIER_DESC as UNDRWRTG_CO_TIER_DESC,
ex_pass_to_tgt_intrm.MRTL_STS as MRTL_STS,
ex_pass_to_tgt_intrm.OCPTN_DESC as OCPTN_DESC,
ex_pass_to_tgt_intrm.DEDCTB_AMT as DEDCTB_AMT,
ex_pass_to_tgt_intrm.MORTGAGEE as MORTGAGEE,
ex_pass_to_tgt_intrm.PLCY_TYPE_DESC as PLCY_TYPE_DESC,
ex_pass_to_tgt_intrm.CNSTRCTN_DESC as CNSTRCTN_DESC,
ex_pass_to_tgt_intrm.HTG_DESC as HTG_DESC,
ex_pass_to_tgt_intrm.COOLG_DESC as COOLG_DESC,
ex_pass_to_tgt_intrm.CNSTRCTN_DT as CNSTRCTN_DT,
ex_pass_to_tgt_intrm.AUTO_LATE_PAY_NUM as AUTO_LATE_PAY_NUM,
ex_pass_to_tgt_intrm.AUTO_PMT_FRQCY_DESC as AUTO_PMT_FRQCY_DESC,
ex_pass_to_tgt_intrm.PRMRY_RSPNS_SRVC_DESC as PRMRY_RSPNS_SRVC_DESC,
ex_pass_to_tgt_intrm.UNDERPINNING_CR_DESC as UNDERPINNING_CR_DESC,
ex_pass_to_tgt_intrm.MH_RTG_CLAS_DESC as MH_RTG_CLAS_DESC,
ex_pass_to_tgt_intrm.MH_PRK_NAME as MH_PRK_NAME,
ex_pass_to_tgt_intrm.MH_PRK_CD as MH_PRK_CD,
ex_pass_to_tgt_intrm.CLAS_OF_PRPTY_DESC as CLAS_OF_PRPTY_DESC,
ex_pass_to_tgt_intrm.BODILY_INJRY_LMT_AMT as BODILY_INJRY_LMT_AMT,
ex_pass_to_tgt_intrm.VEH_WTH_DMG_CNT as VEH_WTH_DMG_CNT,
ex_pass_to_tgt_intrm.PLCY_DSCNT_NAME as PLCY_DSCNT_NAME,
ex_pass_to_tgt_intrm.DRVR_CLAS_DESC as DRVR_CLAS_DESC,
ex_pass_to_tgt_intrm.EXCLN_WAIVD_RSN_DESC as EXCLN_WAIVD_RSN_DESC,
ex_pass_to_tgt_intrm.GNDR_TYPE_DESC as GNDR_TYPE_DESC,
ex_pass_to_tgt_intrm.LIABTY_ONLY_IND as LIABTY_ONLY_IND,
ex_pass_to_tgt_intrm.NO_PRIOR_INSRNC_IND as NO_PRIOR_INSRNC_IND,
ex_pass_to_tgt_intrm.PRPTY_DMG_LMT_AMT as PRPTY_DMG_LMT_AMT,
ex_pass_to_tgt_intrm.PLCY_INT_TYPE_DESC as PLCY_INT_TYPE_DESC,
ex_pass_to_tgt_intrm.PRIOR_INSRNC_CARIER_NAME as PRIOR_INSRNC_CARIER_NAME,
ex_pass_to_tgt_intrm.RATE_UPS_DESC as RATE_UPS_DESC,
ex_pass_to_tgt_intrm.RLTNSHP_DESC as RLTNSHP_DESC,
ex_pass_to_tgt_intrm.TAX_CITY_NAME as TAX_CITY_NAME,
ex_pass_to_tgt_intrm.VEH_SYMB_COLLISION_CD as VEH_SYMB_COLLISION_CD,
ex_pass_to_tgt_intrm.VEH_TYPE_DESC as VEH_TYPE_DESC,
ex_pass_to_tgt_intrm.VEH_USE_DESC as VEH_USE_DESC,
ex_pass_to_tgt_intrm.VEH_MODL_YR as VEH_MODL_YR,
ex_pass_to_tgt_intrm.YRS_WTH_ALFA as YRS_WTH_ALFA,
ex_pass_to_tgt_intrm.VEH_INDENTIFICATION_NUM as VEH_INDENTIFICATION_NUM,
ex_pass_to_tgt_intrm.PLCY_WRTN_ST_CD as PLCY_WRTN_ST_CD,
ex_pass_to_tgt_intrm.SLS_RGN_ST_NAME as SLS_RGN_ST_NAME,
ex_pass_to_tgt_intrm.SLS_RGN_DSTRCT_NAME as SLS_RGN_DSTRCT_NAME,
ex_pass_to_tgt_intrm.SRVC_CTR_NUM as SRVC_CTR_NUM,
ex_pass_to_tgt_intrm.AGNT_CLNT_NUM as AGNT_CLNT_NUM,
ex_pass_to_tgt_intrm.INSRNC_SCR_CD as INSRNC_SCR_CD,
ex_pass_to_tgt_intrm.NAME_INSRD_MRTL_STS_DESC as NAME_INSRD_MRTL_STS_DESC,
ex_pass_to_tgt_intrm.COMBO_DSCNT_IND as COMBO_DSCNT_IND,
ex_pass_to_tgt_intrm.MULT_CAR_DSCNT_IND as MULT_CAR_DSCNT_IND,
ex_pass_to_tgt_intrm.VAL_CLNT_DSCNT_IND as VAL_CLNT_DSCNT_IND,
ex_pass_to_tgt_intrm.LIF_PLCY_DSCNT_IND as LIF_PLCY_DSCNT_IND,
ex_pass_to_tgt_intrm.HOME_OWNRSHP_DSCNT_IND as HOME_OWNRSHP_DSCNT_IND,
ex_pass_to_tgt_intrm.AUTO_DSCNT_IND as AUTO_DSCNT_IND,
ex_pass_to_tgt_intrm.NEW_HOME_DSCNT_PCTG as NEW_HOME_DSCNT_PCTG,
ex_pass_to_tgt_intrm.VAL_CLNT_DSCNT_PCTG as VAL_CLNT_DSCNT_PCTG,
ex_pass_to_tgt_intrm.HOME_ALRT_DSCNT_PCTG as HOME_ALRT_DSCNT_PCTG,
ex_pass_to_tgt_intrm.HOME_ALRT_CD as HOME_ALRT_CD,
ex_pass_to_tgt_intrm.INSRD_PRPTY_CNTY_NAME as INSRD_PRPTY_CNTY_NAME,
ex_pass_to_tgt_intrm.DWLNG_CVGE_AMT as DWLNG_CVGE_AMT,
ex_pass_to_tgt_intrm.PERSNL_PRPTY_CVGE_AMT as PERSNL_PRPTY_CVGE_AMT,
ex_pass_to_tgt_intrm.CNSTRCTN_TYPE_DESC as CNSTRCTN_TYPE_DESC,
ex_pass_to_tgt_intrm.OCPTN_CD as OCPTN_CD,
ex_pass_to_tgt_intrm.PRIOR_INSRNC_CARIER_CD as PRIOR_INSRNC_CARIER_CD,
ex_pass_to_tgt_intrm.LGCY_DSCNT_IND as LGCY_DSCNT_IND,
ex_pass_to_tgt_intrm.LATE_PMT_PCTG as LATE_PMT_PCTG,
ex_pass_to_tgt_intrm.PLCY_PRD_STRT_DT as PLCY_PRD_STRT_DT,
ex_pass_to_tgt_intrm.PLCY_PRD_END_DT as PLCY_PRD_END_DT,
ex_pass_to_tgt_intrm.TERM_NUM as TERM_NUM,
ex_pass_to_tgt_intrm.INSRD_EML_TXT as INSRD_EML_TXT,
ex_pass_to_tgt_intrm.INSRD_TLPHN_NUM as INSRD_TLPHN_NUM,
ex_pass_to_tgt_intrm.TOT_UNITS_CNT as TOT_UNITS_CNT,
ex_pass_to_tgt_intrm.ENDRSMT_DESC as ENDRSMT_DESC,
ex_pass_to_tgt_intrm.ANULZD_TOT_WRTN_PREM_AMT as ANULZD_TOT_WRTN_PREM_AMT,
ex_pass_to_tgt_intrm.PRTCTN_CLAS_DESC as PRTCTN_CLAS_DESC,
ex_pass_to_tgt_intrm.PLCY_CNCLTN_SRC_DESC as PLCY_CNCLTN_SRC_DESC,
ex_pass_to_tgt_intrm.PREM_DUE_AMT as PREM_DUE_AMT,
ex_pass_to_tgt_intrm.MBR_NUM as MBR_NUM,
ex_pass_to_tgt_intrm.CUST_ID as CUST_ID,
ex_pass_to_tgt_intrm.PLCY_INCPTN_DT as PLCY_INCPTN_DT,
ex_pass_to_tgt_intrm.PLCY_AGE as PLCY_AGE,
ex_pass_to_tgt_intrm.SRC_USR_NUM as SRC_USR_NUM,
ex_pass_to_tgt_intrm.PREM_BILD_AMT as PREM_BILD_AMT,
ex_pass_to_tgt_intrm.ENCMCE_CD as ENCMCE_CD,
ex_pass_to_tgt_intrm.RSDNC_TYEP_DESC as RSDNC_TYEP_DESC,
ex_pass_to_tgt_intrm.VEH_GARGD_LOC_NAME as VEH_GARGD_LOC_NAME,
ex_pass_to_tgt_intrm.ROOF_YR as ROOF_YR,
ex_pass_to_tgt_intrm.CNTNUS_SRVC_DT as CNTNUS_SRVC_DT,
ex_pass_to_tgt_intrm.DWLNG_VAL_AMT as DWLNG_VAL_AMT,
ex_pass_to_tgt_intrm.DRVR_PNT_DESC as DRVR_PNT_DESC,
ex_pass_to_tgt_intrm.ARS_SCR as ARS_SCR,
ex_pass_to_tgt_intrm.AGE_OF_HOME as AGE_OF_HOME,
ex_pass_to_tgt_intrm.QUOT_CHNL_TXT as QUOT_CHNL_TXT,
ex_pass_to_tgt_intrm.QUOT_RTD_IND as QUOT_RTD_IND,
ex_pass_to_tgt_intrm.TOT_UNEARND_PREM_AMT as TOT_UNEARND_PREM_AMT,
ex_pass_to_tgt_intrm.ADDR_TYPE_DESC as ADDR_TYPE_DESC,
ex_pass_to_tgt_intrm.DOG_ON_PREMS_IND as DOG_ON_PREMS_IND,
ex_pass_to_tgt_intrm.DWLNG_APRSL_DT as DWLNG_APRSL_DT,
ex_pass_to_tgt_intrm.DWLNG_SQUAR_FOOTGE as DWLNG_SQUAR_FOOTGE,
ex_pass_to_tgt_intrm.VEH_BODY_TYPE_DESC as VEH_BODY_TYPE_DESC,
ex_pass_to_tgt_intrm.VEH_COLOR_DESC as VEH_COLOR_DESC,
ex_pass_to_tgt_intrm.VEH_MAKE_DESC as VEH_MAKE_DESC,
ex_pass_to_tgt_intrm.VEH_MODL_DESC as VEH_MODL_DESC,
ex_pass_to_tgt_intrm.VEH_PRCH_DT as VEH_PRCH_DT,
ex_pass_to_tgt_intrm.DWLNG_PRCH_DT as DWLNG_PRCH_DT,
ex_pass_to_tgt_intrm.DWLNG_NUM_OF_STORIES_CNT as DWLNG_NUM_OF_STORIES_CNT,
ex_pass_to_tgt_intrm.RATE_AS_OF_DT_AMT as RATE_AS_OF_DT_AMT,
ex_pass_to_tgt_intrm.TRANS_CLSD_DT as TRANS_CLSD_DT,
ex_pass_to_tgt_intrm.GAR_CRPT_DESC as GAR_CRPT_DESC,
ex_pass_to_tgt_intrm.SCREENED_POOL_IND as SCREENED_POOL_IND,
ex_pass_to_tgt_intrm.DWLNG_FIRE_DEPT_CD as DWLNG_FIRE_DEPT_CD,
ex_pass_to_tgt_intrm.PLCY_FRST_ISSU_DT as PLCY_FRST_ISSU_DT,
ex_pass_to_tgt_intrm.DWLNG_FNDTN_TYPE as DWLNG_FNDTN_TYPE,
ex_pass_to_tgt_intrm.DWLNG_USE_DESC as DWLNG_USE_DESC,
ex_pass_to_tgt_intrm.DWLNG_OCPYD_DESC as DWLNG_OCPYD_DESC,
ex_pass_to_tgt_intrm.FIRE_HYDRANT_1000_FEET_IND as FIRE_HYDRANT_1000_FEET_IND,
ex_pass_to_tgt_intrm.FIRE_HYDRANT_5_MILE_IND as FIRE_HYDRANT_5_MILE_IND,
ex_pass_to_tgt_intrm.SWIMMING_POOL_IND as SWIMMING_POOL_IND,
ex_pass_to_tgt_intrm.WIND_AND_HAIL_EXCLDD_IND as WIND_AND_HAIL_EXCLDD_IND,
ex_pass_to_tgt_intrm.PLCY_ISSUD_IND as PLCY_ISSUD_IND,
ex_pass_to_tgt_intrm.DWLNG_LAT_MEAS as DWLNG_LAT_MEAS,
ex_pass_to_tgt_intrm.DWLNG_LNGTD_MEAS as DWLNG_LNGTD_MEAS,
ex_pass_to_tgt_intrm.INSRD_LIC_ST_NAME as INSRD_LIC_ST_NAME,
ex_pass_to_tgt_intrm.DWLNG_VALUT_METH_NAME as DWLNG_VALUT_METH_NAME,
ex_pass_to_tgt_intrm.DWLNG_CVGE_LMT_AMT as DWLNG_CVGE_LMT_AMT,
ex_pass_to_tgt_intrm.PRPTY_VALUT_METH_DESC as PRPTY_VALUT_METH_DESC,
ex_pass_to_tgt_intrm.PERSNL_PRPTY_CVGE_LMT_AMT as PERSNL_PRPTY_CVGE_LMT_AMT,
ex_pass_to_tgt_intrm.OTH_STRC_CVGE_LMT_AMT as OTH_STRC_CVGE_LMT_AMT,
ex_pass_to_tgt_intrm.LOSS_OF_USE_CVGE_LMT_AMT as LOSS_OF_USE_CVGE_LMT_AMT,
ex_pass_to_tgt_intrm.PRPTY_ZN_DESC as PRPTY_ZN_DESC,
ex_pass_to_tgt_intrm.DWLNG_PRCH_AMT as DWLNG_PRCH_AMT,
ex_pass_to_tgt_intrm.DWLNG_ROOF_TYPE_DESC as DWLNG_ROOF_TYPE_DESC,
ex_pass_to_tgt_intrm.PLCY_TERM_TYPE as PLCY_TERM_TYPE,
ex_pass_to_tgt_intrm.PLCY_TOT_COST_AMT as PLCY_TOT_COST_AMT,
ex_pass_to_tgt_intrm.EARND_PREM_AMT as EARND_PREM_AMT,
ex_pass_to_tgt_intrm.MBR_TYPE_DESC as MBR_TYPE_DESC,
ex_pass_to_tgt_intrm.MOST_RCENT_QUOT_VERS_DT as MOST_RCENT_QUOT_VERS_DT,
ex_pass_to_tgt_intrm.TOT_VEHICAL_UNIT_CNT as TOT_VEHICAL_UNIT_CNT,
ex_pass_to_tgt_intrm.QUOT_STS_DESC as QUOT_STS_DESC,
ex_pass_to_tgt_intrm.QUOT_VERS_NUM as QUOT_VERS_NUM,
ex_pass_to_tgt_intrm.PROD_LN_DESC as PROD_LN_DESC,
ex_pass_to_tgt_intrm.CO_TO_CO_TFR_DESC as CO_TO_CO_TFR_DESC,
ex_pass_to_tgt_intrm.NEW_PRPTY_CUST_IND as NEW_PRPTY_CUST_IND,
ex_pass_to_tgt_intrm.TOT_FIRE_LOSS_IND as TOT_FIRE_LOSS_IND,
ex_pass_to_tgt_intrm.TOT_LOSS_10_YR_IND as TOT_LOSS_10_YR_IND,
ex_pass_to_tgt_intrm.PRPTY_LOSS_5_YR_IND as PRPTY_LOSS_5_YR_IND,
ex_pass_to_tgt_intrm.TWO_WEA_LOSS_5_YR_IND as TWO_WEA_LOSS_5_YR_IND,
ex_pass_to_tgt_intrm.ONE_WEA_LOSS_5_YR_IND as ONE_WEA_LOSS_5_YR_IND,
ex_pass_to_tgt_intrm.LOSS_3_YR_IND as LOSS_3_YR_IND,
ex_pass_to_tgt_intrm.THEFT_LOSS_IND as THEFT_LOSS_IND,
ex_pass_to_tgt_intrm.LOSS_5_YR_IND as LOSS_5_YR_IND,
ex_pass_to_tgt_intrm.DCLND_5_YR_IND as DCLND_5_YR_IND,
ex_pass_to_tgt_intrm.LTGTN_PEND_IND as LTGTN_PEND_IND,
ex_pass_to_tgt_intrm.FRCLSR_5_YR_IND as FRCLSR_5_YR_IND,
ex_pass_to_tgt_intrm.TRFC_VLATN_IND as TRFC_VLATN_IND,
ex_pass_to_tgt_intrm.AUTO_INSRNC_CANCELLED_12_MTH_I as AUTO_INSRNC_CANCELLED_12_MTH_I,
ex_pass_to_tgt_intrm.LIC_SUSPD_5_YR_IND as LIC_SUSPD_5_YR_IND,
ex_pass_to_tgt_intrm.RPOSESN_3_YR_IND as RPOSESN_3_YR_IND,
ex_pass_to_tgt_intrm.RPOSESN_DT as RPOSESN_DT,
ex_pass_to_tgt_intrm.ARRESTED_5_YR_IND as ARRESTED_5_YR_IND,
ex_pass_to_tgt_intrm.FAULT_ACDNT_5_YR_IND as FAULT_ACDNT_5_YR_IND,
ex_pass_to_tgt_intrm.APLCNT_CURRENTLY_INSRD_TXT as APLCNT_CURRENTLY_INSRD_TXT,
ex_pass_to_tgt_intrm.LIC_CURRENTLY_SUSPD_IND as LIC_CURRENTLY_SUSPD_IND,
ex_pass_to_tgt_intrm.LIC_SUSPD_IND as LIC_SUSPD_IND,
ex_pass_to_tgt_intrm.SBMN_JOB_CRT_DT as SBMN_JOB_CRT_DT,
ex_pass_to_tgt_intrm.SBMN_JOB_UPDT_DT as SBMN_JOB_UPDT_DT,
ex_pass_to_tgt_intrm.SBMN_JOB_CLS_DT as SBMN_JOB_CLS_DT,
ex_pass_to_tgt_intrm.SBMN_JOB_CRT_USR_NAME as SBMN_JOB_CRT_USR_NAME,
ex_pass_to_tgt_intrm.SBMN_JOB_UPDT_USR_NAME as SBMN_JOB_UPDT_USR_NAME,
ex_pass_to_tgt_intrm.SBMN_JOB_EFF_DT as SBMN_JOB_EFF_DT,
ex_pass_to_tgt_intrm.BRNCH_NUM as BRNCH_NUM,
ex_pass_to_tgt_intrm.BRNCH_NAME as BRNCH_NAME,
ex_pass_to_tgt_intrm.PRD_ID as PRD_ID,
ex_pass_to_tgt_intrm.UNDRWRTG_ISSU_TYPE_DESC as UNDRWRTG_ISSU_TYPE_DESC,
ex_pass_to_tgt_intrm.UNDRWRTG_ISSU_STS as UNDRWRTG_ISSU_STS,
ex_pass_to_tgt_intrm.NK_JOB_NBR as NK_JOB_NBR,
ex_pass_to_tgt_intrm.QUOTN_ID as QUOTN_ID
FROM
ex_pass_to_tgt_intrm);


-- PIPELINE END FOR 1

-- PIPELINE START FOR 2

-- Component SQ_QUOTES_INSRNC_INTRM, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_QUOTES_INSRNC_INTRM AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as CO_NAME,
$2 as FRST_NAME,
$3 as MDL_NAME,
$4 as LAST_NAME,
$5 as NAME_PREFIX_TXT,
$6 as NAME_SFX_TXT,
$7 as ADDR_LN_1_TXT,
$8 as ADDR_LN_2_TXT,
$9 as CITY_NAME,
$10 as CNTY_NAME,
$11 as ST_NAME,
$12 as ZIP,
$13 as TAX_IDNTFTN_NUM,
$14 as BIRTH_DT,
$15 as DRVG_LIC_NUM,
$16 as AGE_OF_QUOT_CNT,
$17 as AGNT_NAME,
$18 as AGNT_NUM,
$19 as RISK_LOC_CITY_NAME,
$20 as RISK_LOC_CTRY_NAME,
$21 as RISK_LOC_CNTY_NAME,
$22 as CVGE_CD,
$23 as CVGE_AMT,
$24 as CVGE_DESC,
$25 as PRMRY_INSRD_ADDR_DESC,
$26 as PRMRY_INSRD_NAME,
$27 as LOB,
$28 as UNDRWRTG_CO_NAME,
$29 as MSTR_CO_NUM,
$30 as RNEWL_STS,
$31 as PLCY_ACCNTG_DT,
$32 as PLCY_ASGND_DT,
$33 as PLCY_EFF_DT,
$34 as PLCY_TERM_EXPN_DT,
$35 as PLCY_ISSU_DT,
$36 as PLCY_NUM,
$37 as PLCY_RJCTN_RSN_DESC,
$38 as SCNDRY_INSRD_NAME,
$39 as ADDL_INSRD_NAME,
$40 as PLCY_ADDL_INSRD_NAME,
$41 as VEH_ADDL_INSRD_NAME,
$42 as QUOT_INITATN_DTTM,
$43 as QUOT_PREM_AMT,
$44 as QUOT_STS,
$45 as SLS_SRVC_CTR_NAME,
$46 as SLS_SRVC_CTR_ADDR,
$47 as PLCY_ORIG_ST_NAME,
$48 as PLCY_WRTN_ST_NAME,
$49 as TOT_WRTN_PREM_AMT,
$50 as TRANS_TYPE_DESC,
$51 as TRANS_DT,
$52 as TRNRND_TM_TXT,
$53 as UNDRWRTG_CO_TIER_DESC,
$54 as MRTL_STS,
$55 as OCPTN_DESC,
$56 as DEDCTB_AMT,
$57 as MORTGAGEE,
$58 as PLCY_TYPE_DESC,
$59 as CNSTRCTN_DESC,
$60 as HTG_DESC,
$61 as COOLG_DESC,
$62 as CNSTRCTN_DT,
$63 as AUTO_LATE_PAY_NUM,
$64 as AUTO_PMT_FRQCY_DESC,
$65 as PRMRY_RSPNS_SRVC_DESC,
$66 as UNDERPINNING_CR_DESC,
$67 as MH_RTG_CLAS_DESC,
$68 as MH_PRK_NAME,
$69 as MH_PRK_CD,
$70 as CLAS_OF_PRPTY_DESC,
$71 as BODILY_INJRY_LMT_AMT,
$72 as VEH_WTH_DMG_CNT,
$73 as PLCY_DSCNT_NAME,
$74 as DRVR_CLAS_DESC,
$75 as EXCLN_WAIVD_RSN_DESC,
$76 as GNDR_TYPE_DESC,
$77 as LIABTY_ONLY_IND,
$78 as NO_PRIOR_INSRNC_IND,
$79 as PRPTY_DMG_LMT_AMT,
$80 as PLCY_INT_TYPE_DESC,
$81 as PRIOR_INSRNC_CARIER_NAME,
$82 as RATE_UPS_DESC,
$83 as RLTNSHP_DESC,
$84 as TAX_CITY_NAME,
$85 as VEH_SYMB_COLLISION_CD,
$86 as VEH_TYPE_DESC,
$87 as VEH_USE_DESC,
$88 as VEH_MODL_YR,
$89 as YRS_WTH_ALFA,
$90 as VEH_INDENTIFICATION_NUM,
$91 as PLCY_WRTN_ST_CD,
$92 as SLS_RGN_ST_NAME,
$93 as SLS_RGN_DSTRCT_NAME,
$94 as SRVC_CTR_NUM,
$95 as AGNT_CLNT_NUM,
$96 as INSRNC_SCR_CD,
$97 as NAME_INSRD_MRTL_STS_DESC,
$98 as NAME_INSRD_AGE_DESC,
$99 as COMBO_DSCNT_IND,
$100 as MULT_CAR_DSCNT_IND,
$101 as VAL_CLNT_DSCNT_IND,
$102 as LIF_PLCY_DSCNT_IND,
$103 as HOME_OWNRSHP_DSCNT_IND,
$104 as AUTO_DSCNT_IND,
$105 as NEW_HOME_DSCNT_PCTG,
$106 as VAL_CLNT_DSCNT_PCTG,
$107 as HOME_ALRT_DSCNT_PCTG,
$108 as HOME_ALRT_CD,
$109 as INSRD_PRPTY_CNTY_NAME,
$110 as DWLNG_CVGE_AMT,
$111 as PERSNL_PRPTY_CVGE_AMT,
$112 as CNSTRCTN_TYPE_DESC,
$113 as OCPTN_CD,
$114 as PRIOR_INSRNC_CARIER_CD,
$115 as LGCY_DSCNT_IND,
$116 as LATE_PMT_PCTG,
$117 as PLCY_PRD_STRT_DT,
$118 as PLCY_PRD_END_DT,
$119 as TERM_NUM,
$120 as INSRD_EML_TXT,
$121 as INSRD_TLPHN_NUM,
$122 as TOT_UNITS_CNT,
$123 as ENDRSMT_DESC,
$124 as ANULZD_TOT_WRTN_PREM_AMT,
$125 as PRTCTN_CLAS_DESC,
$126 as PLCY_CNCLTN_SRC_DESC,
$127 as PREM_DUE_AMT,
$128 as MBR_NUM,
$129 as CUST_ID,
$130 as PLCY_INCPTN_DT,
$131 as PLCY_AGE,
$132 as SRC_USR_NUM,
$133 as PREM_BILD_AMT,
$134 as ENCMCE_CD,
$135 as RSDNC_TYEP_DESC,
$136 as VEH_GARGD_LOC_NAME,
$137 as ROOF_YR,
$138 as CNTNUS_SRVC_DT,
$139 as DWLNG_VAL_AMT,
$140 as DRVR_PNT_DESC,
$141 as ARS_SCR,
$142 as AGE_OF_HOME,
$143 as QUOT_CHNL_TXT,
$144 as QUOT_RTD_IND,
$145 as TOT_UNEARND_PREM_AMT,
$146 as ADDR_TYPE_DESC,
$147 as DOG_ON_PREMS_IND,
$148 as DWLNG_APRSL_DT,
$149 as DWLNG_SQUAR_FOOTGE,
$150 as VEH_BODY_TYPE_DESC,
$151 as VEH_COLOR_DESC,
$152 as VEH_MAKE_DESC,
$153 as VEH_MODL_DESC,
$154 as VEH_PRCH_DT,
$155 as DWLNG_PRCH_DT,
$156 as DWLNG_NUM_OF_STORIES_CNT,
$157 as RATE_AS_OF_DT_AMT,
$158 as TRANS_CLSD_DT,
$159 as GAR_CRPT_DESC,
$160 as SCREENED_POOL_IND,
$161 as DWLNG_FIRE_DEPT_CD,
$162 as PLCY_FRST_ISSU_DT,
$163 as DWLNG_FNDTN_TYPE,
$164 as DWLNG_USE_DESC,
$165 as DWLNG_OCPYD_DESC,
$166 as FIRE_HYDRANT_1000_FEET_IND,
$167 as FIRE_HYDRANT_5_MILE_IND,
$168 as SWIMMING_POOL_IND,
$169 as WIND_AND_HAIL_EXCLDD_IND,
$170 as PLCY_ISSUD_IND,
$171 as DWLNG_LAT_MEAS,
$172 as DWLNG_LNGTD_MEAS,
$173 as INSRD_LIC_ST_NAME,
$174 as DWLNG_VALUT_METH_NAME,
$175 as DWLNG_CVGE_LMT_AMT,
$176 as PRPTY_VALUT_METH_DESC,
$177 as PERSNL_PRPTY_CVGE_LMT_AMT,
$178 as OTH_STRC_CVGE_LMT_AMT,
$179 as LOSS_OF_USE_CVGE_LMT_AMT,
$180 as PRPTY_ZN_DESC,
$181 as DWLNG_PRCH_AMT,
$182 as DWLNG_ROOF_TYPE_DESC,
$183 as PLCY_TERM_TYPE,
$184 as PLCY_TOT_COST_AMT,
$185 as EARND_PREM_AMT,
$186 as MBR_TYPE_DESC,
$187 as MOST_RCENT_QUOT_VERS_DT,
$188 as TOT_VEHICAL_UNIT_CNT,
$189 as QUOT_STS_DESC,
$190 as QUOT_VERS_NUM,
$191 as PROD_LN_DESC,
$192 as CO_TO_CO_TFR_DESC,
$193 as NEW_PRPTY_CUST_IND,
$194 as TOT_FIRE_LOSS_IND,
$195 as TOT_LOSS_10_YR_IND,
$196 as PRPTY_LOSS_5_YR_IND,
$197 as TWO_WEA_LOSS_5_YR_IND,
$198 as ONE_WEA_LOSS_5_YR_IND,
$199 as LOSS_3_YR_IND,
$200 as THEFT_LOSS_IND,
$201 as LOSS_5_YR_IND,
$202 as DCLND_5_YR_IND,
$203 as LTGTN_PEND_IND,
$204 as FRCLSR_5_YR_IND,
$205 as TRFC_VLATN_IND,
$206 as AUTO_INSRNC_CANCELLED_12_MTH_I,
$207 as LIC_SUSPD_5_YR_IND,
$208 as RPOSESN_3_YR_IND,
$209 as RPOSESN_DT,
$210 as ARRESTED_5_YR_IND,
$211 as FAULT_ACDNT_5_YR_IND,
$212 as APLCNT_CURRENTLY_INSRD_TXT,
$213 as LIC_CURRENTLY_SUSPD_IND,
$214 as LIC_SUSPD_IND,
$215 as SBMN_JOB_CRT_DT,
$216 as SBMN_JOB_UPDT_DT,
$217 as SBMN_JOB_CLS_DT,
$218 as SBMN_JOB_CRT_USR_NAME,
$219 as SBMN_JOB_UPDT_USR_NAME,
$220 as SBMN_JOB_EFF_DT,
$221 as BRNCH_NUM,
$222 as BRNCH_NAME,
$223 as PRD_ID,
$224 as UNDRWRTG_ISSU_TYPE_DESC,
$225 as UNDRWRTG_ISSU_STS,
$226 as QUOTN_ID,
$227 as NK_JOB_NBR,
$228 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
select distinct 

QUOTES.CO_NAME

,QUOTES.FRST_NAME

,QUOTES.MDL_NAME

,QUOTES.LAST_NAME

,QUOTES.NAME_PREFIX_TXT

,QUOTES.NAME_SFX_TXT

,QUOTES.ADDR_LN_1_TXT

,QUOTES.ADDR_LN_2_TXT

,QUOTES.CITY_NAME

,QUOTES.CNTY_NAME

,QUOTES.ST_NAME

,QUOTES.ZIP

,QUOTES.TAX_IDNTFTN_NUM

,QUOTES.BIRTH_DT

,QUOTES.DRVG_LIC_NUM

,QUOTES.AGE_OF_QUOT_CNT

,QUOTES.AGNT_NAME

,QUOTES.AGNT_NUM

,QUOTES.RISK_LOC_CITY_NAME

,QUOTES.RISK_LOC_CTRY_NAME

,QUOTES.RISK_LOC_CNTY_NAME

,QUOTES.CVGE_CD

,QUOTES.CVGE_AMT

,QUOTES.CVGE_DESC

,QUOTES.PRMRY_INSRD_ADDR_DESC

,QUOTES.PRMRY_INSRD_NAME

,QUOTES.LOB

,QUOTES.UNDRWRTG_CO_NAME

,QUOTES.MSTR_CO_NUM

,QUOTES.RNEWL_STS

,QUOTES.PLCY_ACCNTG_DT

,QUOTES.PLCY_ASGND_DT

,QUOTES.PLCY_EFF_DT

,QUOTES.PLCY_TERM_EXPN_DT

,QUOTES.PLCY_ISSU_DT

,QUOTES.PLCY_NUM

,QUOTES.PLCY_RJCTN_RSN_DESC

,QUOTES.SCNDRY_INSRD_NAME

,QUOTES.ADDL_INSRD_NAME

,QUOTES.PLCY_ADDL_INSRD_NAME

,QUOTES.VEH_ADDL_INSRD_NAME

,QUOTES. QUOT_INITATN_DTTM

,QUOTES. QUOT_PREM_AMT

,QUOTES. QUOT_STS

,QUOTES. SLS_SRVC_CTR_NAME

,QUOTES.SLS_SRVC_CTR_ADDR

,QUOTES.PLCY_ORIG_ST_NAME

,QUOTES.PLCY_WRTN_ST_NAME

,QUOTES.TOT_WRTN_PREM_AMT

,QUOTES.TRANS_TYPE_DESC

,QUOTES.TRANS_DT

,QUOTES.TRNRND_TM_TXT

,QUOTES.UNDRWRTG_CO_TIER_DESC

,QUOTES. MRTL_STS

,QUOTES.OCPTN_DESC

,QUOTES.DEDCTB_AMT

,QUOTES.MORTGAGEE

,QUOTES.PLCY_TYPE_DESC

,QUOTES.CNSTRCTN_DESC

,QUOTES.HTG_DESC

,QUOTES.COOLG_DESC

,QUOTES.CNSTRCTN_DT

,QUOTES.AUTO_LATE_PAY_NUM

,QUOTES.AUTO_PMT_FRQCY_DESC

,QUOTES.PRMRY_RSPNS_SRVC_DESC

,case when QUOTES.UNDERPINNING_CR_DESC=1 then ''Yes'' when QUOTES.UNDERPINNING_CR_DESC=0 then ''No'' else NULL end as UNDERPINNING_CR_DESC

,QUOTES.MH_RTG_CLAS_DESC

,QUOTES.MH_PRK_NAME

,QUOTES.MH_PRK_CD

,QUOTES.CLAS_OF_PRPTY_DESC

,QUOTES.BODILY_INJRY_LMT_AMT

,QUOTES.VEH_WTH_DMG_CNT

,QUOTES.PLCY_DSCNT_NAME

,QUOTES.DRVR_CLAS_DESC

,null as EXCLN_WAIVD_RSN_DESC

,QUOTES.GNDR_TYPE_DESC

,case when QUOTES.LIABTY_ONLY_IND is not null then ''Yes'' else ''No'' end as LIABTY_ONLY_IND

,QUOTES.NO_PRIOR_INSRNC_IND

,QUOTES.PRPTY_DMG_LMT_AMT

,null as PLCY_INT_TYPE_DESC

,QUOTES.PRIOR_INSRNC_CARIER_NAME

,QUOTES.RATE_UPS_DESC

,QUOTES.RLTNSHP_DESC

,QUOTES.TAX_CITY_NAME

,null AS VEH_SYMB_COLLISION_CD

,QUOTES.VEH_TYPE_DESC

,QUOTES.VEH_USE_DESC

,QUOTES.VEH_MODL_YR

,QUOTES.YRS_WTH_ALFA

,QUOTES.VEH_INDENTIFICATION_NUM

,QUOTES.PLCY_WRTN_ST_CD

,QUOTES.SLS_RGN_ST_NAME

,QUOTES.SLS_RGN_DSTRCT_NAME

,QUOTES.SRVC_CTR_NUM

,QUOTES.AGNT_CLNT_NUM

,QUOTES.INSRNC_SCR_CD

,QUOTES.NAME_INSRD_MRTL_STS_DESC

,QUOTES.NAME_INSRD_AGE_DESC

,QUOTES.COMBO_DSCNT_IND

,QUOTES.MULT_CAR_DSCNT_IND

,QUOTES.VAL_CLNT_DSCNT_IND

,QUOTES.LIF_PLCY_DSCNT_IND

,QUOTES.HOME_OWNRSHP_DSCNT_IND

,QUOTES.AUTO_DSCNT_IND

,QUOTES.NEW_HOME_DSCNT_PCTG

,QUOTES.VAL_CLNT_DSCNT_PCTG

,QUOTES.HOME_ALRT_DSCNT_PCTG

,case when QUOTES.HOME_ALRT_CD=1 then ''Yes'' when QUOTES.HOME_ALRT_CD=0 then ''No'' else NULL end as HOME_ALRT_CD

,QUOTES.INSRD_PRPTY_CNTY_NAME

,QUOTES.DWLNG_CVGE_AMT

,QUOTES.PERSNL_PRPTY_CVGE_AMT

,QUOTES.CNSTRCTN_TYPE_DESC

,QUOTES.OCPTN_CD

,QUOTES.PRIOR_INSRNC_CARIER_CD

,null as LGCY_DSCNT_IND

,QUOTES.LATE_PMT_PCTG

,QUOTES.PLCY_PRD_STRT_DT

,QUOTES.PLCY_PRD_END_DT

,QUOTES.TERM_NUM

,QUOTES.INSRD_EML_TXT

,QUOTES.INSRD_TLPHN_NUM

,QUOTES.TOT_UNITS_CNT

,QUOTES.ENDRSMT_DESC

,QUOTES.ANULZD_TOT_WRTN_PREM_AMT

,QUOTES.PRTCTN_CLAS_DESC

,QUOTES.PLCY_CNCLTN_SRC_DESC

,QUOTES.PREM_DUE_AMT

,QUOTES.MBR_NUM

,QUOTES.CUST_ID

,QUOTES.PLCY_INCPTN_DT

,QUOTES.PLCY_AGE

,QUOTES.SRC_USR_NUM

,null as PREM_BILD_AMT

,QUOTES.ENCMCE_CD

,QUOTES.RSDNC_TYEP_DESC

,QUOTES.VEH_GARGD_LOC_NAME

,QUOTES.ROOF_YR

,QUOTES.CNTNUS_SRVC_DT

,QUOTES.DWLNG_VAL_AMT

,QUOTES.DRVR_PNT_DESC

,QUOTES.ARS_SCR

,QUOTES.AGE_OF_HOME

,QUOTES.  QUOT_CHNL_TXT

,QUOTES.QUOT_RTD_IND

,null as TOT_UNEARND_PREM_AMT

,QUOTES.ADDR_TYPE_DESC

,CASE WHEN QUOTES.DOG_ON_PREMS_IND = 1 THEN ''Yes'' WHEN QUOTES.DOG_ON_PREMS_IND = 0 THEN ''No'' ELSE NULL end As DOG_ON_PREMS_IND

,QUOTES.DWLNG_APRSL_DT

,QUOTES.DWLNG_SQUAR_FOOTGE

,QUOTES.VEH_BODY_TYPE_DESC

,QUOTES.VEH_COLOR_DESC

,QUOTES.VEH_MAKE_DESC

,QUOTES.VEH_MODL_DESC

,QUOTES.VEH_PRCH_DT

,QUOTES.DWLNG_PRCH_DT

,QUOTES.DWLNG_NUM_OF_STORIES_CNT

,QUOTES. RATE_AS_OF_DT_AMT

,null as TRANS_CLSD_DT

,QUOTES.GAR_CRPT_DESC

,case when QUOTES.SCREENED_POOL_IND=1 then ''Yes'' when QUOTES.SCREENED_POOL_IND =0 then ''No'' else NULL end as SCREENED_POOL_IND 

,QUOTES.DWLNG_FIRE_DEPT_CD

,QUOTES.PLCY_FRST_ISSU_DT

,QUOTES.DWLNG_FNDTN_TYPE

,QUOTES.DWLNG_USE_DESC

,QUOTES.DWLNG_OCPYD_DESC

,NULL AS FIRE_HYDRANT_1000_FEET_IND

,NULL AS FIRE_HYDRANT_5_MILE_IND

,NULL AS SWIMMING_POOL_IND

,QUOTES.WIND_AND_HAIL_EXCLDD_IND

,QUOTES.PLCY_ISSUD_IND

,QUOTES.DWLNG_LAT_MEAS

,QUOTES.DWLNG_LNGTD_MEAS

,QUOTES.INSRD_LIC_ST_NAME

,QUOTES.DWLNG_VALUT_METH_NAME

,QUOTES.DWLNG_CVGE_LMT_AMT

,QUOTES.PRPTY_VALUT_METH_DESC

,QUOTES.PERSNL_PRPTY_CVGE_LMT_AMT

,QUOTES.OTH_STRC_CVGE_LMT_AMT

,QUOTES.LOSS_OF_USE_CVGE_LMT_AMT

,QUOTES.PRPTY_ZN_DESC

,QUOTES.DWLNG_PRCH_AMT

,QUOTES.DWLNG_ROOF_TYPE_DESC

,QUOTES.PLCY_TERM_TYPE

,QUOTES.PLCY_TOT_COST_AMT

,null as EARND_PREM_AMT

,QUOTES.MBR_TYPE_DESC

,QUOTES.MOST_RCENT_QUOT_VERS_DT

,QUOTES.TOT_VEHICAL_UNIT_CNT

,QUOTES.QUOT_STS_DESC

,QUOTES.QUOT_VERS_NUM

,QUOTES.PROD_LN_DESC

,null as CO_TO_CO_TFR_DESC

,case when QUOTES.NEW_PRPTY_CUST_IND=1 then ''Yes'' when QUOTES.NEW_PRPTY_CUST_IND=0 then ''No'' else NULL end as NEW_PRPTY_CUST_IND

,case when QUOTES.TOT_FIRE_LOSS_IND=1 then ''Yes'' when QUOTES.TOT_FIRE_LOSS_IND=0 then ''No'' else NULL end as  TOT_FIRE_LOSS_IND

,case when QUOTES.TOT_LOSS_10_YR_IND=1 then ''Yes'' when QUOTES.TOT_LOSS_10_YR_IND=0 then ''No'' else NULL end as  TOT_LOSS_10_YR_IND

,case when QUOTES.PRPTY_LOSS_5_YR_IND=1 then ''Yes'' when QUOTES.PRPTY_LOSS_5_YR_IND=0 then ''No'' else NULL end as  PRPTY_LOSS_5_YR_IND

,case when QUOTES.TWO_WEA_LOSS_5_YR_IND=1 then ''Yes'' when QUOTES.TWO_WEA_LOSS_5_YR_IND=0 then ''No'' else NULL end as  TWO_WEA_LOSS_5_YR_IND

,case when QUOTES.ONE_WEA_LOSS_5_YR_IND=1 then ''Yes'' when QUOTES.ONE_WEA_LOSS_5_YR_IND=0 then ''No'' else NULL end as  ONE_WEA_LOSS_5_YR_IND

,case when QUOTES.LOSS_3_YR_IND=1 then ''Yes'' when QUOTES.LOSS_3_YR_IND=0 then ''No'' else NULL end as  LOSS_3_YR_IND

,case when QUOTES.THEFT_LOSS_IND=1 then ''Yes'' when QUOTES.THEFT_LOSS_IND=0 then ''No'' else NULL end as THEFT_LOSS_IND

,case when QUOTES.LOSS_5_YR_IND=1 then ''Yes'' when QUOTES.LOSS_5_YR_IND=0 then ''No'' else NULL end as LOSS_5_YR_IND

,case when QUOTES.DCLND_5_YR_IND=1 then ''Yes'' when QUOTES.DCLND_5_YR_IND=0 then ''No'' else NULL end as DCLND_5_YR_IND

,case when QUOTES.LTGTN_PEND_IND=1 then ''Yes'' when QUOTES.LTGTN_PEND_IND=0 then ''No'' else NULL end as LTGTN_PEND_IND

,case when QUOTES.FRCLSR_5_YR_IND=1 then ''Yes'' when QUOTES.FRCLSR_5_YR_IND=0 then ''No'' else NULL end as FRCLSR_5_YR_IND

,case when QUOTES.TRFC_VLATN_IND=1 then ''Yes'' when QUOTES.TRFC_VLATN_IND=0 then ''No'' else NULL end as TRFC_VLATN_IND

,case when QUOTES.AUTO_INSRNC_CANCELLED_12_MTH_I=1 then ''Yes'' when QUOTES.AUTO_INSRNC_CANCELLED_12_MTH_I=0 then ''No'' else NULL end as AUTO_INSRNC_CANCELLED_12_MTH_I

,case when QUOTES.LIC_SUSPD_5_YR_IND=1 then ''Yes'' when QUOTES.LIC_SUSPD_5_YR_IND=0 then ''No'' else NULL end as LIC_SUSPD_5_YR_IND

,case when QUOTES.RPOSESN_3_YR_IND=1 then ''Yes'' when QUOTES.RPOSESN_3_YR_IND=0 then ''No'' else NULL end as RPOSESN_3_YR_IND

,QUOTES.RPOSESN_DT

,case when QUOTES.ARRESTED_5_YR_IND=1 then ''Yes'' when QUOTES.ARRESTED_5_YR_IND=0 then ''No'' else NULL end as ARRESTED_5_YR_IND

,case when QUOTES.FAULT_ACDNT_5_YR_IND=1 then ''Yes'' when QUOTES.FAULT_ACDNT_5_YR_IND=0 then ''No'' else NULL end as FAULT_ACDNT_5_YR_IND

,case when QUOTES.APLCNT_CURRENTLY_INSRD_TXT=1 then ''Yes'' when QUOTES.APLCNT_CURRENTLY_INSRD_TXT=0 then ''No'' else NULL end as APLCNT_CURRENTLY_INSRD_TXT

,case when QUOTES.LIC_CURRENTLY_SUSPD_IND=1 then ''Yes'' when QUOTES.LIC_CURRENTLY_SUSPD_IND=0 then ''No'' else NULL end as LIC_CURRENTLY_SUSPD_IND

,case when QUOTES.LIC_SUSPD_IND=1 then ''Yes'' when QUOTES.LIC_SUSPD_IND=0 then ''No'' else NULL end as LIC_SUSPD_IND

,QUOTES.SBMN_JOB_CRT_DT

,QUOTES.SBMN_JOB_UPDT_DT

,QUOTES.SBMN_JOB_CLS_DT

,QUOTES.SBMN_JOB_CRT_USR_NAME

,QUOTES.SBMN_JOB_UPDT_USR_NAME

,QUOTES.SBMN_JOB_EFF_DT

,QUOTES.BRNCH_NUM

,QUOTES.BRNCH_NAME

,QUOTES.PRD_ID

,QUOTES.UNDRWRTG_ISSU_TYPE_DESC

,QUOTES.UNDRWRTG_ISSU_STS

,QUOTES.QUOTN_ID

,QUOTES.NK_JOB_NBR 

/* --------------------------------------------------------- */


FROM (SELECT INSQTN.NK_JOB_NBR,

((CURRENT_DATE - cast(INSQTN.QUOTN_OPN_DTTM as date ))) AS  AGE_OF_QUOT_CNT

,NULL AS  PLCY_RJCTN_RSN_DESC

,INSQTN.QUOTN_OPN_DTTM AS  QUOT_INITATN_DTTM

,INSQTN.PREM_AMT AS QUOT_PREM_AMT

,INSQTN.QUOTN_STS_TYPE_CD AS  QUOT_STS

,INSQTN.QUOTN_ORIGN_CD AS  QUOT_CHNL_TXT

,CASE WHEN INSQTN.RTD_DTTM IS NULL THEN   ''Yes'' ELSE  ''No''  END AS  QUOT_RTD_IND

,INSQTN.RTD_DTTM AS  RATE_AS_OF_DT_AMT

,NULL AS   PLCY_ISSUD_IND

,INSQTN.QUOTN_OPN_DTTM AS  MOST_RCENT_QUOT_VERS_DT

,CASE WHEN INSQTN.QUOTN_STS_TYPE_CD  =''QUOTED'' THEN ''Q'' 

WHEN   INSQTN.QUOTN_STS_TYPE_CD  = ''BOUND''  THEN   ''N'' ELSE  NULL  END AS  QUOT_STS_DESC

,INSQTN.VERS_NBR AS  QUOT_VERS_NUM

,INSQTN.QUOTN_OPN_DTTM AS   SBMN_JOB_CRT_DT

,INSQTN.QUOTN_UPDT_DTTM AS  SBMN_JOB_UPDT_DT

,INSQTN.QUOTN_CLS_DTTM AS  SBMN_JOB_CLS_DT

,INSQTN.QUOTN_PLND_AGMT_OPN_DTTM AS  SBMN_JOB_EFF_DT

,INSQTN.VERS_NBR AS  BRNCH_NUM

,INSQTN.VERS_NBR AS  BRNCH_NAME

,INSQTN.QUOTN_ID

,TT.TIER_TYPE_DESC AS UNDRWRTG_CO_TIER_DESC

,CASE WHEN INSQTN.QUOTN_STS_TYPE_CD = ''BOUND'' THEN (CAST(INSQTN.QUOTN_CLS_DTTM  as date)  - CAST( INSQTN.QUOTN_OPN_DTTM as date) )  * 24  END As  TRNRND_TM_TXT

,APLCTN.HOME_ALRT_CD

,APLCTN.NEW_PRPTY_CUST_IND

,APLCTN.TOT_FIRE_LOSS_IND

,APLCTN.PRPTY_LOSS_5_YR_IND

,APLCTN.THEFT_LOSS_IND

,APLCTN.LOSS_5_YR_IND

,APLCTN.DCLND_5_YR_IND

,APLCTN.LTGTN_PEND_IND

,APLCTN.FRCLSR_5_YR_IND

,APLCTN.TRFC_VLATN_IND

,APLCTN.AUTO_INSRNC_CANCELLED_12_MTH_I

,APLCTN.LIC_SUSPD_5_YR_IND

,APLCTN.RPOSESN_3_YR_IND

,APLCTN.RPOSESN_DT

,APLCTN.ARRESTED_5_YR_IND

,APLCTN.FAULT_ACDNT_5_YR_IND

,APLCTN.LIC_CURRENTLY_SUSPD_IND

,APLCTN.LIC_SUSPD_IND

,APLCTN.DOG_ON_PREMS_IND

,APLCTN.UNDERPINNING_CR_DESC

,APLCNT_MRTL_STS.MRTL_STS_CD AS MRTL_STS

,APLCTN.APLCNT_CURRENTLY_INSRD_TXT

,APLCTN.TOT_LOSS_10_YR_IND

,APLCTN.TWO_WEA_LOSS_5_YR_IND

,APLCTN.ONE_WEA_LOSS_5_YR_IND

,APLCTN.LOSS_3_YR_IND

,UWRS.UNDRWRTG_ISSU_STS

,UWR.UNDRWRTG_ISSU_TYPE_DESC

,APLCTN_X.VEH_WTH_DMG_CNT

/**************************Agmt Details    **********************/

,NULL AS PLCY_INCPTN_DT

,NULL AS  PLCY_AGE

,NULL AS  PLCY_EFF_DT

,NULL AS  PLCY_TERM_EXPN_DT

,NULL AS  PLCY_ISSU_DT

,NULL AS  PLCY_NUM

,NULL AS  TRANS_TYPE_DESC

,NULL AS  TRANS_DT

,NULL AS  MORTGAGEE

,NULL AS  AUTO_PMT_FRQCY_DESC

,NULL AS  NO_PRIOR_INSRNC_IND

,NULL AS  YRS_WTH_ALFA

,NULL AS  PLCY_PRD_STRT_DT

,NULL AS  PLCY_PRD_END_DT

,NULL AS  TERM_NUM

,NULL AS  CNTNUS_SRVC_DT

,NULL AS  PLCY_FRST_ISSU_DT

,NULL AS  PLCY_TERM_TYPE

,NULL AS  PRD_ID

,NULL AS  ARS_SCR

,NULL AS  VAL_CLNT_DSCNT_IND

,NULL AS  HTG_DESC

,NULL AS  COOLG_DESC

,NULL AS  PRMRY_RSPNS_SRVC_DESC

,NULL AS  DWLNG_NUM_OF_STORIES_CNT

,NULL AS  GAR_CRPT_DESC

,NULL AS  SCREENED_POOL_IND

,NULL AS  DWLNG_SQUAR_FOOTGE

,NULL AS  VEH_BODY_TYPE_DESC

,NULL AS  VEH_COLOR_DESC

,NULL AS  VEH_MAKE_DESC

,NULL AS  VEH_MODL_DESC

,NULL AS  CNSTRCTN_DT

,NULL AS  CLAS_OF_PRPTY_DESC

,NULL AS  VEH_PRCH_DT

,NULL AS  DWLNG_PRCH_DT

,NULL AS  RISK_LOC_CITY_NAME

,NULL AS  RISK_LOC_CTRY_NAME

,NULL AS  RISK_LOC_CNTY_NAME

,NULL AS  PLCY_ORIG_ST_NAME

,NULL AS  PLCY_WRTN_ST_NAME

,NULL AS  TAX_CITY_NAME

,NULL AS  PLCY_WRTN_ST_CD

,NULL AS  SLS_RGN_ST_NAME

,NULL AS  SLS_RGN_DSTRCT_NAME

,NULL AS  PRMRY_INSRD_NAME

,NULL AS  PLCY_ASGND_DT

,NULL AS  SCNDRY_INSRD_NAME

,NULL AS  ADDL_INSRD_NAME

,NULL AS  PLCY_ADDL_INSRD_NAME

,NULL AS  VEH_ADDL_INSRD_NAME

,NULL AS  GNDR_TYPE_DESC

,NULL AS   NAME_INSRD_MRTL_STS_DESC

,NULL AS  NAME_INSRD_AGE_DESC

,NULL AS  PRMRY_INSRD_ADDR_DESC

,NULL AS  SLS_SRVC_CTR_ADDR

,NULL AS  INSRD_EML_TXT

,NULL AS  INSRD_TLPHN_NUM

,NULL AS  DRVR_PNT_DESC

,NULL AS  INSRD_LIC_ST_NAME

,NULL AS  CVGE_AMT

,NULL AS  CVGE_CD

,NULL AS  CVGE_DESC

,NULL AS  DEDCTB_AMT

,NULL AS  BODILY_INJRY_LMT_AMT

,NULL AS  LIABTY_ONLY_IND

,NULL AS  PRPTY_DMG_LMT_AMT

,NULL AS  DWLNG_CVGE_AMT

,NULL AS  PERSNL_PRPTY_CVGE_AMT

,NULL AS  DWLNG_CVGE_LMT_AMT

,NULL AS  LOB

,NULL AS PLCY_TYPE_DESC

,NULL AS  TOT_WRTN_PREM_AMT

,NULL AS  ANULZD_TOT_WRTN_PREM_AMT

,NULL AS  MULT_CAR_DSCNT_IND

,NULL AS  LIF_PLCY_DSCNT_IND

,NULL AS  HOME_OWNRSHP_DSCNT_IND

,NULL AS  TOT_VEHICAL_UNIT_CNT

,NULL AS  PRPTY_VALUT_METH_DESC

,NULL AS  DWLNG_VALUT_METH_NAME

,NULL AS  WIND_AND_HAIL_EXCLDD_IND

,NULL AS  COMBO_DSCNT_IND

,NULL AS  AUTO_DSCNT_IND

,NULL AS  NEW_HOME_DSCNT_PCTG

,NULL AS  VAL_CLNT_DSCNT_PCTG

,NULL AS  HOME_ALRT_DSCNT_PCTG

,NULL AS LATE_PMT_PCTG

,NULL AS  PLCY_CNCLTN_SRC_DESC

,NULL AS  TOT_UNITS_CNT

,NULL AS  RLTNSHP_DESC

,NULL AS  MH_RTG_CLAS_DESC

,NULL AS  DRVR_CLAS_DESC

,NULL AS  CNSTRCTN_DESC

,NULL AS  CNSTRCTN_TYPE_DESC

,NULL AS  RSDNC_TYEP_DESC 

,NULL AS  DWLNG_FNDTN_TYPE

,NULL AS  DWLNG_USE_DESC

,NULL AS  PRPTY_ZN_DESC

,NULL AS  DWLNG_VAL_AMT

,NULL AS  DWLNG_OCPYD_DESC

,NULL AS  PLCY_TOT_COST_AMT

,NULL AS  PREM_DUE_AMT

,NULL AS  RNEWL_STS

,NULL AS  AUTO_LATE_PAY_NUM

,NULL AS  PLCY_DSCNT_NAME

,NULL AS  INSRD_PRPTY_CNTY_NAME

,NULL AS  ENCMCE_CD

,NULL AS ENDRSMT_DESC

,NULL AS VEH_GARGD_LOC_NAME

,NULL AS DWLNG_APRSL_DT

,NULL AS DWLNG_FIRE_DEPT_CD

,NULL AS PERSNL_PRPTY_CVGE_LMT_AMT

,NULL AS OTH_STRC_CVGE_LMT_AMT

,NULL AS LOSS_OF_USE_CVGE_LMT_AMT

,NULL AS DWLNG_PRCH_AMT

,NULL AS DWLNG_ROOF_TYPE_DESC

,NULL AS PROD_LN_DESC

,NULL AS RATE_UPS_DESC

,NULL AS PLCY_ACCNTG_DT

,NULL AS PRTCTN_CLAS_DESC

,NULL AS VEH_TYPE_DESC

,NULL AS VEH_MODL_YR

,NULL AS VEH_INDENTIFICATION_NUM

,NULL AS VEH_USE_DESC

,NULL AS AGE_OF_HOME

,NULL AS FIRE_HYDRANT_1000_FEET_IND

,NULL AS FIRE_HYDRANT_5_MILE_IND

,NULL AS SWIMMING_POOL_IND

,NULL AS ROOF_YR

,NULL AS MBR_TYPE_DESC

,NULL AS MBR_NUM









,null as CO_NAME

,null as FRST_NAME

,null as MDL_NAME

,null as LAST_NAME

,null as NAME_PREFIX_TXT

,null as NAME_SFX_TXT

,null as ADDR_LN_1_TXT

,null as ADDR_LN_2_TXT

,null as CITY_NAME

,null as CNTY_NAME

,null as ST_NAME

,null as ZIP

,null as TAX_IDNTFTN_NUM

,null as BIRTH_DT

,null as DRVG_LIC_NUM

,null as AGNT_NAME

,null as AGNT_NUM

,null as UNDRWRTG_CO_NAME

/* ,null as UNDRWRTG_CO_TIER_DESC */
,null as OCPTN_DESC

,null as PRIOR_INSRNC_CARIER_NAME

/* ,null as VEH_SYMB_COLLISION_CD */
/* ,null as VEH_TYPE_DESC */
/* ,null as VEH_USE_DESC */
/* ,null as VEH_MODL_YR */
/* ,null as VEH_INDENTIFICATION_NUM */
,null as OCPTN_CD

,null as PRIOR_INSRNC_CARIER_CD

/* ,null as PRTCTN_CLAS_DESC */
/* ,null as MBR_NUM */
,null as CUST_ID

/* ,null as ROOF_YR */
/* ,null as AGE_OF_HOME */
,null as ADDR_TYPE_DESC

/* ,null as FIRE_HYDRANT_1000_FEET_IND */
/* ,null as FIRE_HYDRANT_5_MILE_IND */
/* ,null as SWIMMING_POOL_IND */
,null as DWLNG_LAT_MEAS

,null as DWLNG_LNGTD_MEAS

/* ,null as DWLNG_PRCH_AMT */
/* ,null as DWLNG_ROOF_TYPE_DESC */
/* ,null as MBR_TYPE_DESC */
,null as SBMN_JOB_CRT_USR_NAME

,null as SBMN_JOB_UPDT_USR_NAME

,null as  AGNT_CLNT_NUM 

,null as  MSTR_CO_NUM

,null as  SLS_SRVC_CTR_NAME

,null as  SRVC_CTR_NUM

,null as  INSRNC_SCR_CD

,null as  MH_PRK_NAME

,null as  MH_PRK_CD

,null as SRC_USR_NUM

FROM (SELECT *  FROM DB_T_PROD_CORE.INSRNC_QUOTN WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   AND QUOTN_SBTYPE_CD IN (''SBMSSN'',''RENEWAL'',''PLCYCHG''))   INSQTN 

LEFT OUTER JOIN DB_T_PROD_CORE.TIER_TYPE TT ON INSQTN.TIER_TYPE_CD = TT.TIER_TYPE_CD

LEFT OUTER JOIN 

(

SELECT APLCTN_ID, UNDRWRTG_STS_CD AS  UNDRWRTG_ISSU_STS FROM

( SELECT S.APLCTN_ID,S.UNDRWRTG_STS_CD,  ROW_NUMBER()  OVER (PARTITION BY APLCTN_ID ORDER BY APLCTN_UNDRWRT_STS_END_DTTM desc) ROW_NUM

FROM DB_T_PROD_CORE.APLCTN_UNDRWRT_REQMT_STS S WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  /*  change on 04/01 */
)  UW_STS

WHERE ROW_NUM =1

) UWRS ON UWRS.APLCTN_ID = INSQTN.APLCTN_ID

LEFT OUTER JOIN 

(

SELECT   APLCTN_ID , UNDRWRTG_REQMT_TYPE_CD AS UNDRWRTG_ISSU_TYPE_DESC

 FROM (SELECT APLCTN_ID, UNDRWRTG_REQMT_TYPE_CD, ROW_NUMBER()  OVER (PARTITION BY APLCTN_ID ORDER BY REQMT_UPDT_DTTM  desc) ROW_NUM

FROM DB_T_PROD_CORE.APLCTN_UNDRWRT_REQMT WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   /*  change on 04/01 */
 )  UWR WHERE ROW_NUM = 1

) UWR ON UWR.APLCTN_ID = INSQTN.APLCTN_ID

LEFT OUTER JOIN   

(SELECT APLCTN_ID, COUNT(1) AS VEH_WTH_DMG_CNT

FROM DB_T_PROD_CORE.APLCTN_QUES_RSPNS  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''  and aplctn_frm_ques_num = ''PVDamage''

GROUP BY APLCTN_ID ) APLCTN_X ON APLCTN_X.APLCTN_ID = INSQTN.APLCTN_ID

/******  Application Response requirements*******/

LEFT OUTER JOIN

(

SELECT APLCTN.APLCTN_ID

,MAX(HOME_ALRT_CD) As HOME_ALRT_CD

,MAX(NEW_PRPTY_CUST_IND) As NEW_PRPTY_CUST_IND

,MAX(TOT_FIRE_LOSS_IND) As TOT_FIRE_LOSS_IND

,MAX( PRPTY_LOSS_5_YR_IND) As PRPTY_LOSS_5_YR_IND

,MAX(THEFT_LOSS_IND) As THEFT_LOSS_IND

,MAX(LOSS_5_YR_IND) As LOSS_5_YR_IND

,MAX(DCLND_5_YR_IND) As DCLND_5_YR_IND

,MAX(LTGTN_PEND_IND) As LTGTN_PEND_IND

,MAX(FRCLSR_5_YR_IND) As FRCLSR_5_YR_IND

,MAX(TRFC_VLATN_IND) As TRFC_VLATN_IND

,MAX(AUTO_INSRNC_CANCELLED_12_MTH_I) As AUTO_INSRNC_CANCELLED_12_MTH_I

,MAX(LIC_SUSPD_5_YR_IND) As LIC_SUSPD_5_YR_IND

,MAX(RPOSESN_3_YR_IND) As RPOSESN_3_YR_IND

,MAX(RPOSESN_DT) As RPOSESN_DT

,MAX(ARRESTED_5_YR_IND) As ARRESTED_5_YR_IND

,MAX(FAULT_ACDNT_5_YR_IND) As FAULT_ACDNT_5_YR_IND

,MAX(LIC_CURRENTLY_SUSPD_IND) As LIC_CURRENTLY_SUSPD_IND

,MAX(LIC_SUSPD_IND) As  LIC_SUSPD_IND

,MAX(DOG_ON_PREMS_IND) As DOG_ON_PREMS_IND

,MAX(UNDERPINNING_CR_DESC) As UNDERPINNING_CR_DESC

,MAX(APLCNT_CURRENTLY_INSRD_TXT) AS APLCNT_CURRENTLY_INSRD_TXT

,MAX(TOT_LOSS_10_YR_IND)  As TOT_LOSS_10_YR_IND

,MAX(TWO_WEA_LOSS_5_YR_IND)   As TWO_WEA_LOSS_5_YR_IND

,MAX(ONE_WEA_LOSS_5_YR_IND)   As ONE_WEA_LOSS_5_YR_IND

,MAX(LOSS_3_YR_IND)   As LOSS_3_YR_IND





FROM

(SELECT  APLCTN.APLCTN_ID

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOFireExtentinguishersExists_alfa'' THEN  APLCTN.APLCTN_RSPNS_IND   ELSE 0 END  As  HOME_ALRT_CD

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HONewPropCust_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As NEW_PRPTY_CUST_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOTotalFireLoss_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As TOT_FIRE_LOSS_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOPropLiaLoss_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As PRPTY_LOSS_5_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HODisappearanceLoss_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As  THEFT_LOSS_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOLiaLoss_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As  LOSS_5_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HORiskReasons_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As  DCLND_5_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOLitigation_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As  LTGTN_PEND_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOForeclosure_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As FRCLSR_5_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HODUI_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As  TRFC_VLATN_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''PARefused_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As  AUTO_INSRNC_CANCELLED_12_MTH_I

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''PARevoked_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As  LIC_SUSPD_5_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''PARepossesion_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As RPOSESN_3_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''PARepDate_alfa'' THEN APLCTN.APLCTN_RSPNS_DTTM ELSE NULL END As  RPOSESN_DT

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''PAArrested_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As ARRESTED_5_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''PAFaultAcc_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As FAULT_ACDNT_5_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''CurrentSuspense'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As LIC_CURRENTLY_SUSPD_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''Suspense'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As LIC_SUSPD_IND  /*  change on 11/17 */
,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOGenDangerousAnimalsExist_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As DOG_ON_PREMS_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HODwellingConstructionUnderpinningQualifies'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As UNDERPINNING_CR_DESC

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''PACurrentlyInsured'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As APLCNT_CURRENTLY_INSRD_TXT

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOPriorFireLoss_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As TOT_LOSS_10_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOTwoOrMoreLoss_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As TWO_WEA_LOSS_5_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOMoreThanFiveKPaid_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As ONE_WEA_LOSS_5_YR_IND

,CASE WHEN APLCTN.APLCTN_FRM_QUES_NUM=''HOLossInThreeYears_alfa'' THEN APLCTN.APLCTN_RSPNS_IND ELSE 0 END  As LOSS_3_YR_IND

FROM  (SELECT *  FROM DB_T_PROD_CORE.APLCTN_QUES_RSPNS  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'')   APLCTN 

) AS APLCTN

GROUP BY APLCTN_ID



) APLCTN ON APLCTN.APLCTN_ID = INSQTN.APLCTN_ID

/**********Applicant MRTL Status*****************/

LEFT OUTER JOIN 

(SELECT   PA.QUOTN_ID,UPPER(IMS.MRTL_STS_CD) AS MRTL_STS_CD FROM 

(SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' AND PRTY_QUOTN_ROLE_CD =''PLCYPRININS'')  PA /*  CHANGE ON 04/01 */
INNER JOIN (SELECT * FROM DB_T_PROD_CORE.INDIV_MRTL_STS WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'') IMS ON IMS.INDIV_PRTY_ID = PA.PRTY_ID) APLCNT_MRTL_STS ON APLCNT_MRTL_STS.QUOTN_ID = INSQTN.QUOTN_ID)QUOTES
) SRC
)
);


-- Component exp_pass_to_tgt_insrnc, Type EXPRESSION 
CREATE OR REPLACE TEMPORARY TABLE exp_pass_to_tgt_insrnc AS
(
SELECT
SQ_QUOTES_INSRNC_INTRM.CO_NAME as CO_NAME,
SQ_QUOTES_INSRNC_INTRM.FRST_NAME as FRST_NAME,
SQ_QUOTES_INSRNC_INTRM.MDL_NAME as MDL_NAME,
SQ_QUOTES_INSRNC_INTRM.LAST_NAME as LAST_NAME,
SQ_QUOTES_INSRNC_INTRM.NAME_PREFIX_TXT as NAME_PREFIX_TXT,
SQ_QUOTES_INSRNC_INTRM.NAME_SFX_TXT as NAME_SFX_TXT,
SQ_QUOTES_INSRNC_INTRM.ADDR_LN_1_TXT as ADDR_LN_1_TXT,
SQ_QUOTES_INSRNC_INTRM.ADDR_LN_2_TXT as ADDR_LN_2_TXT,
SQ_QUOTES_INSRNC_INTRM.CITY_NAME as CITY_NAME,
SQ_QUOTES_INSRNC_INTRM.CNTY_NAME as CNTY_NAME,
SQ_QUOTES_INSRNC_INTRM.ST_NAME as ST_NAME,
SQ_QUOTES_INSRNC_INTRM.ZIP as ZIP,
SQ_QUOTES_INSRNC_INTRM.TAX_IDNTFTN_NUM as TAX_IDNTFTN_NUM,
SQ_QUOTES_INSRNC_INTRM.BIRTH_DT as BIRTH_DT,
SQ_QUOTES_INSRNC_INTRM.DRVG_LIC_NUM as DRVG_LIC_NUM,
SQ_QUOTES_INSRNC_INTRM.AGE_OF_QUOT_CNT as AGE_OF_QUOT_CNT,
SQ_QUOTES_INSRNC_INTRM.AGNT_NAME as AGNT_NAME,
SQ_QUOTES_INSRNC_INTRM.AGNT_NUM as AGNT_NUM,
SQ_QUOTES_INSRNC_INTRM.RISK_LOC_CITY_NAME as RISK_LOC_CITY_NAME,
SQ_QUOTES_INSRNC_INTRM.RISK_LOC_CTRY_NAME as RISK_LOC_CTRY_NAME,
SQ_QUOTES_INSRNC_INTRM.RISK_LOC_CNTY_NAME as RISK_LOC_CNTY_NAME,
SQ_QUOTES_INSRNC_INTRM.CVGE_CD as CVGE_CD,
SQ_QUOTES_INSRNC_INTRM.CVGE_AMT as CVGE_AMT,
SQ_QUOTES_INSRNC_INTRM.CVGE_DESC as CVGE_DESC,
SQ_QUOTES_INSRNC_INTRM.PRMRY_INSRD_ADDR_DESC as PRMRY_INSRD_ADDR_DESC,
SQ_QUOTES_INSRNC_INTRM.PRMRY_INSRD_NAME as PRMRY_INSRD_NAME,
SQ_QUOTES_INSRNC_INTRM.LOB as LOB,
SQ_QUOTES_INSRNC_INTRM.UNDRWRTG_CO_NAME as UNDRWRTG_CO_NAME,
SQ_QUOTES_INSRNC_INTRM.MSTR_CO_NUM as MSTR_CO_NUM,
SQ_QUOTES_INSRNC_INTRM.RNEWL_STS as RNEWL_STS,
SQ_QUOTES_INSRNC_INTRM.PLCY_ACCNTG_DT as PLCY_ACCNTG_DT,
SQ_QUOTES_INSRNC_INTRM.PLCY_ASGND_DT as PLCY_ASGND_DT,
SQ_QUOTES_INSRNC_INTRM.PLCY_EFF_DT as PLCY_EFF_DT,
SQ_QUOTES_INSRNC_INTRM.PLCY_TERM_EXPN_DT as PLCY_TERM_EXPN_DT,
SQ_QUOTES_INSRNC_INTRM.PLCY_ISSU_DT as PLCY_ISSU_DT,
SQ_QUOTES_INSRNC_INTRM.PLCY_NUM as PLCY_NUM,
SQ_QUOTES_INSRNC_INTRM.PLCY_RJCTN_RSN_DESC as PLCY_RJCTN_RSN_DESC,
SQ_QUOTES_INSRNC_INTRM.SCNDRY_INSRD_NAME as SCNDRY_INSRD_NAME,
SQ_QUOTES_INSRNC_INTRM.ADDL_INSRD_NAME as ADDL_INSRD_NAME,
SQ_QUOTES_INSRNC_INTRM.PLCY_ADDL_INSRD_NAME as PLCY_ADDL_INSRD_NAME,
SQ_QUOTES_INSRNC_INTRM.VEH_ADDL_INSRD_NAME as VEH_ADDL_INSRD_NAME,
SQ_QUOTES_INSRNC_INTRM.QUOT_INITATN_DTTM as QUOT_INITATN_DTTM,
SQ_QUOTES_INSRNC_INTRM.QUOT_PREM_AMT as QUOT_PREM_AMT,
SQ_QUOTES_INSRNC_INTRM.QUOT_STS as QUOT_STS,
SQ_QUOTES_INSRNC_INTRM.SLS_SRVC_CTR_NAME as SLS_SRVC_CTR_NAME,
SQ_QUOTES_INSRNC_INTRM.SLS_SRVC_CTR_ADDR as SLS_SRVC_CTR_ADDR,
SQ_QUOTES_INSRNC_INTRM.PLCY_ORIG_ST_NAME as PLCY_ORIG_ST_NAME,
SQ_QUOTES_INSRNC_INTRM.PLCY_WRTN_ST_NAME as PLCY_WRTN_ST_NAME,
SQ_QUOTES_INSRNC_INTRM.TOT_WRTN_PREM_AMT as TOT_WRTN_PREM_AMT,
SQ_QUOTES_INSRNC_INTRM.TRANS_TYPE_DESC as TRANS_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.TRANS_DT as TRANS_DT,
SQ_QUOTES_INSRNC_INTRM.TRNRND_TM_TXT as TRNRND_TM_TXT,
SQ_QUOTES_INSRNC_INTRM.UNDRWRTG_CO_TIER_DESC as UNDRWRTG_CO_TIER_DESC,
SQ_QUOTES_INSRNC_INTRM.MRTL_STS as MRTL_STS,
SQ_QUOTES_INSRNC_INTRM.OCPTN_DESC as OCPTN_DESC,
SQ_QUOTES_INSRNC_INTRM.DEDCTB_AMT as DEDCTB_AMT,
SQ_QUOTES_INSRNC_INTRM.MORTGAGEE as MORTGAGEE,
SQ_QUOTES_INSRNC_INTRM.PLCY_TYPE_DESC as PLCY_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.CNSTRCTN_DESC as CNSTRCTN_DESC,
SQ_QUOTES_INSRNC_INTRM.HTG_DESC as HTG_DESC,
SQ_QUOTES_INSRNC_INTRM.COOLG_DESC as COOLG_DESC,
SQ_QUOTES_INSRNC_INTRM.CNSTRCTN_DT as CNSTRCTN_DT,
SQ_QUOTES_INSRNC_INTRM.AUTO_LATE_PAY_NUM as AUTO_LATE_PAY_NUM,
SQ_QUOTES_INSRNC_INTRM.AUTO_PMT_FRQCY_DESC as AUTO_PMT_FRQCY_DESC,
SQ_QUOTES_INSRNC_INTRM.PRMRY_RSPNS_SRVC_DESC as PRMRY_RSPNS_SRVC_DESC,
SQ_QUOTES_INSRNC_INTRM.UNDERPINNING_CR_DESC as UNDERPINNING_CR_DESC,
SQ_QUOTES_INSRNC_INTRM.MH_RTG_CLAS_DESC as MH_RTG_CLAS_DESC,
SQ_QUOTES_INSRNC_INTRM.MH_PRK_NAME as MH_PRK_NAME,
SQ_QUOTES_INSRNC_INTRM.MH_PRK_CD as MH_PRK_CD,
SQ_QUOTES_INSRNC_INTRM.CLAS_OF_PRPTY_DESC as CLAS_OF_PRPTY_DESC,
SQ_QUOTES_INSRNC_INTRM.BODILY_INJRY_LMT_AMT as BODILY_INJRY_LMT_AMT,
SQ_QUOTES_INSRNC_INTRM.VEH_WTH_DMG_CNT as VEH_WTH_DMG_CNT,
SQ_QUOTES_INSRNC_INTRM.PLCY_DSCNT_NAME as PLCY_DSCNT_NAME,
SQ_QUOTES_INSRNC_INTRM.DRVR_CLAS_DESC as DRVR_CLAS_DESC,
SQ_QUOTES_INSRNC_INTRM.EXCLN_WAIVD_RSN_DESC as EXCLN_WAIVD_RSN_DESC,
SQ_QUOTES_INSRNC_INTRM.GNDR_TYPE_DESC as GNDR_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.LIABTY_ONLY_IND as LIABTY_ONLY_IND,
SQ_QUOTES_INSRNC_INTRM.NO_PRIOR_INSRNC_IND as NO_PRIOR_INSRNC_IND,
SQ_QUOTES_INSRNC_INTRM.PRPTY_DMG_LMT_AMT as PRPTY_DMG_LMT_AMT,
SQ_QUOTES_INSRNC_INTRM.PLCY_INT_TYPE_DESC as PLCY_INT_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.PRIOR_INSRNC_CARIER_NAME as PRIOR_INSRNC_CARIER_NAME,
SQ_QUOTES_INSRNC_INTRM.RATE_UPS_DESC as RATE_UPS_DESC,
SQ_QUOTES_INSRNC_INTRM.RLTNSHP_DESC as RLTNSHP_DESC,
SQ_QUOTES_INSRNC_INTRM.TAX_CITY_NAME as TAX_CITY_NAME,
SQ_QUOTES_INSRNC_INTRM.VEH_SYMB_COLLISION_CD as VEH_SYMB_COLLISION_CD,
SQ_QUOTES_INSRNC_INTRM.VEH_TYPE_DESC as VEH_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.VEH_USE_DESC as VEH_USE_DESC,
SQ_QUOTES_INSRNC_INTRM.VEH_MODL_YR as VEH_MODL_YR,
SQ_QUOTES_INSRNC_INTRM.YRS_WTH_ALFA as YRS_WTH_ALFA,
SQ_QUOTES_INSRNC_INTRM.VEH_INDENTIFICATION_NUM as VEH_INDENTIFICATION_NUM,
SQ_QUOTES_INSRNC_INTRM.PLCY_WRTN_ST_CD as PLCY_WRTN_ST_CD,
SQ_QUOTES_INSRNC_INTRM.SLS_RGN_ST_NAME as SLS_RGN_ST_NAME,
SQ_QUOTES_INSRNC_INTRM.SLS_RGN_DSTRCT_NAME as SLS_RGN_DSTRCT_NAME,
SQ_QUOTES_INSRNC_INTRM.SRVC_CTR_NUM as SRVC_CTR_NUM,
SQ_QUOTES_INSRNC_INTRM.AGNT_CLNT_NUM as AGNT_CLNT_NUM,
SQ_QUOTES_INSRNC_INTRM.INSRNC_SCR_CD as INSRNC_SCR_CD,
SQ_QUOTES_INSRNC_INTRM.NAME_INSRD_MRTL_STS_DESC as NAME_INSRD_MRTL_STS_DESC,
SQ_QUOTES_INSRNC_INTRM.NAME_INSRD_AGE_DESC as NAME_INSRD_AGE_DESC,
SQ_QUOTES_INSRNC_INTRM.COMBO_DSCNT_IND as COMBO_DSCNT_IND,
SQ_QUOTES_INSRNC_INTRM.MULT_CAR_DSCNT_IND as MULT_CAR_DSCNT_IND,
SQ_QUOTES_INSRNC_INTRM.VAL_CLNT_DSCNT_IND as VAL_CLNT_DSCNT_IND,
SQ_QUOTES_INSRNC_INTRM.LIF_PLCY_DSCNT_IND as LIF_PLCY_DSCNT_IND,
SQ_QUOTES_INSRNC_INTRM.HOME_OWNRSHP_DSCNT_IND as HOME_OWNRSHP_DSCNT_IND,
SQ_QUOTES_INSRNC_INTRM.AUTO_DSCNT_IND as AUTO_DSCNT_IND,
SQ_QUOTES_INSRNC_INTRM.NEW_HOME_DSCNT_PCTG as NEW_HOME_DSCNT_PCTG,
SQ_QUOTES_INSRNC_INTRM.VAL_CLNT_DSCNT_PCTG as VAL_CLNT_DSCNT_PCTG,
SQ_QUOTES_INSRNC_INTRM.HOME_ALRT_DSCNT_PCTG as HOME_ALRT_DSCNT_PCTG,
SQ_QUOTES_INSRNC_INTRM.HOME_ALRT_CD as HOME_ALRT_CD,
SQ_QUOTES_INSRNC_INTRM.INSRD_PRPTY_CNTY_NAME as INSRD_PRPTY_CNTY_NAME,
SQ_QUOTES_INSRNC_INTRM.DWLNG_CVGE_AMT as DWLNG_CVGE_AMT,
SQ_QUOTES_INSRNC_INTRM.PERSNL_PRPTY_CVGE_AMT as PERSNL_PRPTY_CVGE_AMT,
SQ_QUOTES_INSRNC_INTRM.CNSTRCTN_TYPE_DESC as CNSTRCTN_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.OCPTN_CD as OCPTN_CD,
SQ_QUOTES_INSRNC_INTRM.PRIOR_INSRNC_CARIER_CD as PRIOR_INSRNC_CARIER_CD,
SQ_QUOTES_INSRNC_INTRM.LGCY_DSCNT_IND as LGCY_DSCNT_IND,
SQ_QUOTES_INSRNC_INTRM.LATE_PMT_PCTG as LATE_PMT_PCTG,
SQ_QUOTES_INSRNC_INTRM.PLCY_PRD_STRT_DT as PLCY_PRD_STRT_DT,
SQ_QUOTES_INSRNC_INTRM.PLCY_PRD_END_DT as PLCY_PRD_END_DT,
SQ_QUOTES_INSRNC_INTRM.TERM_NUM as TERM_NUM,
SQ_QUOTES_INSRNC_INTRM.INSRD_EML_TXT as INSRD_EML_TXT,
SQ_QUOTES_INSRNC_INTRM.INSRD_TLPHN_NUM as INSRD_TLPHN_NUM,
SQ_QUOTES_INSRNC_INTRM.TOT_UNITS_CNT as TOT_UNITS_CNT,
SQ_QUOTES_INSRNC_INTRM.ENDRSMT_DESC as ENDRSMT_DESC,
SQ_QUOTES_INSRNC_INTRM.ANULZD_TOT_WRTN_PREM_AMT as ANULZD_TOT_WRTN_PREM_AMT,
SQ_QUOTES_INSRNC_INTRM.PRTCTN_CLAS_DESC as PRTCTN_CLAS_DESC,
SQ_QUOTES_INSRNC_INTRM.PLCY_CNCLTN_SRC_DESC as PLCY_CNCLTN_SRC_DESC,
SQ_QUOTES_INSRNC_INTRM.PREM_DUE_AMT as PREM_DUE_AMT,
SQ_QUOTES_INSRNC_INTRM.MBR_NUM as MBR_NUM,
SQ_QUOTES_INSRNC_INTRM.CUST_ID as CUST_ID,
SQ_QUOTES_INSRNC_INTRM.PLCY_INCPTN_DT as PLCY_INCPTN_DT,
SQ_QUOTES_INSRNC_INTRM.PLCY_AGE as PLCY_AGE,
SQ_QUOTES_INSRNC_INTRM.SRC_USR_NUM as SRC_USR_NUM,
SQ_QUOTES_INSRNC_INTRM.PREM_BILD_AMT as PREM_BILD_AMT,
SQ_QUOTES_INSRNC_INTRM.ENCMCE_CD as ENCMCE_CD,
SQ_QUOTES_INSRNC_INTRM.RSDNC_TYEP_DESC as RSDNC_TYEP_DESC,
SQ_QUOTES_INSRNC_INTRM.VEH_GARGD_LOC_NAME as VEH_GARGD_LOC_NAME,
SQ_QUOTES_INSRNC_INTRM.ROOF_YR as ROOF_YR,
SQ_QUOTES_INSRNC_INTRM.CNTNUS_SRVC_DT as CNTNUS_SRVC_DT,
SQ_QUOTES_INSRNC_INTRM.DWLNG_VAL_AMT as DWLNG_VAL_AMT,
SQ_QUOTES_INSRNC_INTRM.DRVR_PNT_DESC as DRVR_PNT_DESC,
SQ_QUOTES_INSRNC_INTRM.ARS_SCR as ARS_SCR,
SQ_QUOTES_INSRNC_INTRM.AGE_OF_HOME as AGE_OF_HOME,
SQ_QUOTES_INSRNC_INTRM.QUOT_CHNL_TXT as QUOT_CHNL_TXT,
SQ_QUOTES_INSRNC_INTRM.QUOT_RTD_IND as QUOT_RTD_IND,
SQ_QUOTES_INSRNC_INTRM.TOT_UNEARND_PREM_AMT as TOT_UNEARND_PREM_AMT,
SQ_QUOTES_INSRNC_INTRM.ADDR_TYPE_DESC as ADDR_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.DOG_ON_PREMS_IND as DOG_ON_PREMS_IND,
SQ_QUOTES_INSRNC_INTRM.DWLNG_APRSL_DT as DWLNG_APRSL_DT,
SQ_QUOTES_INSRNC_INTRM.DWLNG_SQUAR_FOOTGE as DWLNG_SQUAR_FOOTGE,
SQ_QUOTES_INSRNC_INTRM.VEH_BODY_TYPE_DESC as VEH_BODY_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.VEH_COLOR_DESC as VEH_COLOR_DESC,
SQ_QUOTES_INSRNC_INTRM.VEH_MAKE_DESC as VEH_MAKE_DESC,
SQ_QUOTES_INSRNC_INTRM.VEH_MODL_DESC as VEH_MODL_DESC,
SQ_QUOTES_INSRNC_INTRM.VEH_PRCH_DT as VEH_PRCH_DT,
SQ_QUOTES_INSRNC_INTRM.DWLNG_PRCH_DT as DWLNG_PRCH_DT,
SQ_QUOTES_INSRNC_INTRM.DWLNG_NUM_OF_STORIES_CNT as DWLNG_NUM_OF_STORIES_CNT,
SQ_QUOTES_INSRNC_INTRM.RATE_AS_OF_DT_AMT as RATE_AS_OF_DT_AMT,
SQ_QUOTES_INSRNC_INTRM.TRANS_CLSD_DT as TRANS_CLSD_DT,
SQ_QUOTES_INSRNC_INTRM.GAR_CRPT_DESC as GAR_CRPT_DESC,
SQ_QUOTES_INSRNC_INTRM.SCREENED_POOL_IND as SCREENED_POOL_IND,
SQ_QUOTES_INSRNC_INTRM.DWLNG_FIRE_DEPT_CD as DWLNG_FIRE_DEPT_CD,
SQ_QUOTES_INSRNC_INTRM.PLCY_FRST_ISSU_DT as PLCY_FRST_ISSU_DT,
SQ_QUOTES_INSRNC_INTRM.DWLNG_FNDTN_TYPE as DWLNG_FNDTN_TYPE,
SQ_QUOTES_INSRNC_INTRM.DWLNG_USE_DESC as DWLNG_USE_DESC,
SQ_QUOTES_INSRNC_INTRM.DWLNG_OCPYD_DESC as DWLNG_OCPYD_DESC,
SQ_QUOTES_INSRNC_INTRM.FIRE_HYDRANT_1000_FEET_IND as FIRE_HYDRANT_1000_FEET_IND,
SQ_QUOTES_INSRNC_INTRM.FIRE_HYDRANT_5_MILE_IND as FIRE_HYDRANT_5_MILE_IND,
SQ_QUOTES_INSRNC_INTRM.SWIMMING_POOL_IND as SWIMMING_POOL_IND,
SQ_QUOTES_INSRNC_INTRM.WIND_AND_HAIL_EXCLDD_IND as WIND_AND_HAIL_EXCLDD_IND,
SQ_QUOTES_INSRNC_INTRM.PLCY_ISSUD_IND as PLCY_ISSUD_IND,
SQ_QUOTES_INSRNC_INTRM.DWLNG_LAT_MEAS as DWLNG_LAT_MEAS,
SQ_QUOTES_INSRNC_INTRM.DWLNG_LNGTD_MEAS as DWLNG_LNGTD_MEAS,
SQ_QUOTES_INSRNC_INTRM.INSRD_LIC_ST_NAME as INSRD_LIC_ST_NAME,
SQ_QUOTES_INSRNC_INTRM.DWLNG_VALUT_METH_NAME as DWLNG_VALUT_METH_NAME,
SQ_QUOTES_INSRNC_INTRM.DWLNG_CVGE_LMT_AMT as DWLNG_CVGE_LMT_AMT,
SQ_QUOTES_INSRNC_INTRM.PRPTY_VALUT_METH_DESC as PRPTY_VALUT_METH_DESC,
SQ_QUOTES_INSRNC_INTRM.PERSNL_PRPTY_CVGE_LMT_AMT as PERSNL_PRPTY_CVGE_LMT_AMT,
SQ_QUOTES_INSRNC_INTRM.OTH_STRC_CVGE_LMT_AMT as OTH_STRC_CVGE_LMT_AMT,
SQ_QUOTES_INSRNC_INTRM.LOSS_OF_USE_CVGE_LMT_AMT as LOSS_OF_USE_CVGE_LMT_AMT,
SQ_QUOTES_INSRNC_INTRM.PRPTY_ZN_DESC as PRPTY_ZN_DESC,
SQ_QUOTES_INSRNC_INTRM.DWLNG_PRCH_AMT as DWLNG_PRCH_AMT,
SQ_QUOTES_INSRNC_INTRM.DWLNG_ROOF_TYPE_DESC as DWLNG_ROOF_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.PLCY_TERM_TYPE as PLCY_TERM_TYPE,
SQ_QUOTES_INSRNC_INTRM.PLCY_TOT_COST_AMT as PLCY_TOT_COST_AMT,
SQ_QUOTES_INSRNC_INTRM.EARND_PREM_AMT as EARND_PREM_AMT,
SQ_QUOTES_INSRNC_INTRM.MBR_TYPE_DESC as MBR_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.MOST_RCENT_QUOT_VERS_DT as MOST_RCENT_QUOT_VERS_DT,
SQ_QUOTES_INSRNC_INTRM.TOT_VEHICAL_UNIT_CNT as TOT_VEHICAL_UNIT_CNT,
SQ_QUOTES_INSRNC_INTRM.QUOT_STS_DESC as QUOT_STS_DESC,
SQ_QUOTES_INSRNC_INTRM.QUOT_VERS_NUM as QUOT_VERS_NUM,
SQ_QUOTES_INSRNC_INTRM.PROD_LN_DESC as PROD_LN_DESC,
SQ_QUOTES_INSRNC_INTRM.CO_TO_CO_TFR_DESC as CO_TO_CO_TFR_DESC,
SQ_QUOTES_INSRNC_INTRM.NEW_PRPTY_CUST_IND as NEW_PRPTY_CUST_IND,
SQ_QUOTES_INSRNC_INTRM.TOT_FIRE_LOSS_IND as TOT_FIRE_LOSS_IND,
SQ_QUOTES_INSRNC_INTRM.TOT_LOSS_10_YR_IND as TOT_LOSS_10_YR_IND,
SQ_QUOTES_INSRNC_INTRM.PRPTY_LOSS_5_YR_IND as PRPTY_LOSS_5_YR_IND,
SQ_QUOTES_INSRNC_INTRM.TWO_WEA_LOSS_5_YR_IND as TWO_WEA_LOSS_5_YR_IND,
SQ_QUOTES_INSRNC_INTRM.ONE_WEA_LOSS_5_YR_IND as ONE_WEA_LOSS_5_YR_IND,
SQ_QUOTES_INSRNC_INTRM.LOSS_3_YR_IND as LOSS_3_YR_IND,
SQ_QUOTES_INSRNC_INTRM.THEFT_LOSS_IND as THEFT_LOSS_IND,
SQ_QUOTES_INSRNC_INTRM.LOSS_5_YR_IND as LOSS_5_YR_IND,
SQ_QUOTES_INSRNC_INTRM.DCLND_5_YR_IND as DCLND_5_YR_IND,
SQ_QUOTES_INSRNC_INTRM.LTGTN_PEND_IND as LTGTN_PEND_IND,
SQ_QUOTES_INSRNC_INTRM.FRCLSR_5_YR_IND as FRCLSR_5_YR_IND,
SQ_QUOTES_INSRNC_INTRM.TRFC_VLATN_IND as TRFC_VLATN_IND,
SQ_QUOTES_INSRNC_INTRM.AUTO_INSRNC_CANCELLED_12_MTH_I as AUTO_INSRNC_CANCELLED_12_MTH_I,
SQ_QUOTES_INSRNC_INTRM.LIC_SUSPD_5_YR_IND as LIC_SUSPD_5_YR_IND,
SQ_QUOTES_INSRNC_INTRM.RPOSESN_3_YR_IND as RPOSESN_3_YR_IND,
SQ_QUOTES_INSRNC_INTRM.RPOSESN_DT as RPOSESN_DT,
SQ_QUOTES_INSRNC_INTRM.ARRESTED_5_YR_IND as ARRESTED_5_YR_IND,
SQ_QUOTES_INSRNC_INTRM.FAULT_ACDNT_5_YR_IND as FAULT_ACDNT_5_YR_IND,
SQ_QUOTES_INSRNC_INTRM.APLCNT_CURRENTLY_INSRD_TXT as APLCNT_CURRENTLY_INSRD_TXT,
SQ_QUOTES_INSRNC_INTRM.LIC_CURRENTLY_SUSPD_IND as LIC_CURRENTLY_SUSPD_IND,
SQ_QUOTES_INSRNC_INTRM.LIC_SUSPD_IND as LIC_SUSPD_IND,
SQ_QUOTES_INSRNC_INTRM.SBMN_JOB_CRT_DT as SBMN_JOB_CRT_DT,
SQ_QUOTES_INSRNC_INTRM.SBMN_JOB_UPDT_DT as SBMN_JOB_UPDT_DT,
SQ_QUOTES_INSRNC_INTRM.SBMN_JOB_CLS_DT as SBMN_JOB_CLS_DT,
SQ_QUOTES_INSRNC_INTRM.SBMN_JOB_CRT_USR_NAME as SBMN_JOB_CRT_USR_NAME,
SQ_QUOTES_INSRNC_INTRM.SBMN_JOB_UPDT_USR_NAME as SBMN_JOB_UPDT_USR_NAME,
SQ_QUOTES_INSRNC_INTRM.SBMN_JOB_EFF_DT as SBMN_JOB_EFF_DT,
SQ_QUOTES_INSRNC_INTRM.BRNCH_NUM as BRNCH_NUM,
SQ_QUOTES_INSRNC_INTRM.BRNCH_NAME as BRNCH_NAME,
SQ_QUOTES_INSRNC_INTRM.PRD_ID as PRD_ID,
SQ_QUOTES_INSRNC_INTRM.UNDRWRTG_ISSU_TYPE_DESC as UNDRWRTG_ISSU_TYPE_DESC,
SQ_QUOTES_INSRNC_INTRM.UNDRWRTG_ISSU_STS as UNDRWRTG_ISSU_STS,
SQ_QUOTES_INSRNC_INTRM.QUOTN_ID as QUOTN_ID,
SQ_QUOTES_INSRNC_INTRM.NK_JOB_NBR as NK_JOB_NBR,
SQ_QUOTES_INSRNC_INTRM.source_record_id
FROM
SQ_QUOTES_INSRNC_INTRM
);


-- Component TGT_QUOTES_INSRNC_INTRM, Type TARGET 
INSERT INTO QUOTES_INSRNC_INTRM
(
CO_NAME,
FRST_NAME,
MDL_NAME,
LAST_NAME,
NAME_PREFIX_TXT,
NAME_SFX_TXT,
ADDR_LN_1_TXT,
ADDR_LN_2_TXT,
CITY_NAME,
CNTY_NAME,
ST_NAME,
ZIP,
TAX_IDNTFTN_NUM,
BIRTH_DT,
DRVG_LIC_NUM,
AGE_OF_QUOT_CNT,
AGNT_NAME,
AGNT_NUM,
RISK_LOC_CITY_NAME,
RISK_LOC_CTRY_NAME,
RISK_LOC_CNTY_NAME,
CVGE_CD,
CVGE_AMT,
CVGE_DESC,
PRMRY_INSRD_ADDR_DESC,
PRMRY_INSRD_NAME,
LOB,
UNDRWRTG_CO_NAME,
MSTR_CO_NUM,
RNEWL_STS,
PLCY_ACCNTG_DT,
PLCY_ASGND_DT,
PLCY_EFF_DT,
PLCY_TERM_EXPN_DT,
PLCY_ISSU_DT,
PLCY_NUM,
PLCY_RJCTN_RSN_DESC,
SCNDRY_INSRD_NAME,
ADDL_INSRD_NAME,
PLCY_ADDL_INSRD_NAME,
VEH_ADDL_INSRD_NAME,
QUOT_INITATN_DTTM,
QUOT_PREM_AMT,
QUOT_STS,
SLS_SRVC_CTR_NAME,
SLS_SRVC_CTR_ADDR,
PLCY_ORIG_ST_NAME,
PLCY_WRTN_ST_NAME,
TOT_WRTN_PREM_AMT,
TRANS_TYPE_DESC,
TRANS_DT,
TRNRND_TM_TXT,
UNDRWRTG_CO_TIER_DESC,
MRTL_STS,
OCPTN_DESC,
DEDCTB_AMT,
MORTGAGEE,
PLCY_TYPE_DESC,
CNSTRCTN_DESC,
HTG_DESC,
COOLG_DESC,
CNSTRCTN_DT,
AUTO_LATE_PAY_NUM,
AUTO_PMT_FRQCY_DESC,
PRMRY_RSPNS_SRVC_DESC,
UNDERPINNING_CR_DESC,
MH_RTG_CLAS_DESC,
MH_PRK_NAME,
MH_PRK_CD,
CLAS_OF_PRPTY_DESC,
BODILY_INJRY_LMT_AMT,
VEH_WTH_DMG_CNT,
PLCY_DSCNT_NAME,
DRVR_CLAS_DESC,
EXCLN_WAIVD_RSN_DESC,
GNDR_TYPE_DESC,
LIABTY_ONLY_IND,
NO_PRIOR_INSRNC_IND,
PRPTY_DMG_LMT_AMT,
PLCY_INT_TYPE_DESC,
PRIOR_INSRNC_CARIER_NAME,
RATE_UPS_DESC,
RLTNSHP_DESC,
TAX_CITY_NAME,
VEH_SYMB_COLLISION_CD,
VEH_TYPE_DESC,
VEH_USE_DESC,
VEH_MODL_YR,
YRS_WTH_ALFA,
VEH_INDENTIFICATION_NUM,
PLCY_WRTN_ST_CD,
SLS_RGN_ST_NAME,
SLS_RGN_DSTRCT_NAME,
SRVC_CTR_NUM,
AGNT_CLNT_NUM,
INSRNC_SCR_CD,
NAME_INSRD_MRTL_STS_DESC,
NAME_INSRD_AGE_DESC,
COMBO_DSCNT_IND,
MULT_CAR_DSCNT_IND,
VAL_CLNT_DSCNT_IND,
LIF_PLCY_DSCNT_IND,
HOME_OWNRSHP_DSCNT_IND,
AUTO_DSCNT_IND,
NEW_HOME_DSCNT_PCTG,
VAL_CLNT_DSCNT_PCTG,
HOME_ALRT_DSCNT_PCTG,
HOME_ALRT_CD,
INSRD_PRPTY_CNTY_NAME,
DWLNG_CVGE_AMT,
PERSNL_PRPTY_CVGE_AMT,
CNSTRCTN_TYPE_DESC,
OCPTN_CD,
PRIOR_INSRNC_CARIER_CD,
LGCY_DSCNT_IND,
LATE_PMT_PCTG,
PLCY_PRD_STRT_DT,
PLCY_PRD_END_DT,
TERM_NUM,
INSRD_EML_TXT,
INSRD_TLPHN_NUM,
TOT_UNITS_CNT,
ENDRSMT_DESC,
ANULZD_TOT_WRTN_PREM_AMT,
PRTCTN_CLAS_DESC,
PLCY_CNCLTN_SRC_DESC,
PREM_DUE_AMT,
MBR_NUM,
CUST_ID,
PLCY_INCPTN_DT,
PLCY_AGE,
SRC_USR_NUM,
PREM_BILD_AMT,
ENCMCE_CD,
RSDNC_TYEP_DESC,
VEH_GARGD_LOC_NAME,
ROOF_YR,
CNTNUS_SRVC_DT,
DWLNG_VAL_AMT,
DRVR_PNT_DESC,
ARS_SCR,
AGE_OF_HOME,
QUOT_CHNL_TXT,
QUOT_RTD_IND,
TOT_UNEARND_PREM_AMT,
ADDR_TYPE_DESC,
DOG_ON_PREMS_IND,
DWLNG_APRSL_DT,
DWLNG_SQUAR_FOOTGE,
VEH_BODY_TYPE_DESC,
VEH_COLOR_DESC,
VEH_MAKE_DESC,
VEH_MODL_DESC,
VEH_PRCH_DT,
DWLNG_PRCH_DT,
DWLNG_NUM_OF_STORIES_CNT,
RATE_AS_OF_DT_AMT,
TRANS_CLSD_DT,
GAR_CRPT_DESC,
SCREENED_POOL_IND,
DWLNG_FIRE_DEPT_CD,
PLCY_FRST_ISSU_DT,
DWLNG_FNDTN_TYPE,
DWLNG_USE_DESC,
DWLNG_OCPYD_DESC,
FIRE_HYDRANT_1000_FEET_IND,
FIRE_HYDRANT_5_MILE_IND,
SWIMMING_POOL_IND,
WIND_AND_HAIL_EXCLDD_IND,
PLCY_ISSUD_IND,
DWLNG_LAT_MEAS,
DWLNG_LNGTD_MEAS,
INSRD_LIC_ST_NAME,
DWLNG_VALUT_METH_NAME,
DWLNG_CVGE_LMT_AMT,
PRPTY_VALUT_METH_DESC,
PERSNL_PRPTY_CVGE_LMT_AMT,
OTH_STRC_CVGE_LMT_AMT,
LOSS_OF_USE_CVGE_LMT_AMT,
PRPTY_ZN_DESC,
DWLNG_PRCH_AMT,
DWLNG_ROOF_TYPE_DESC,
PLCY_TERM_TYPE,
PLCY_TOT_COST_AMT,
EARND_PREM_AMT,
MBR_TYPE_DESC,
MOST_RCENT_QUOT_VERS_DT,
TOT_VEHICAL_UNIT_CNT,
QUOT_STS_DESC,
QUOT_VERS_NUM,
PROD_LN_DESC,
CO_TO_CO_TFR_DESC,
NEW_PRPTY_CUST_IND,
TOT_FIRE_LOSS_IND,
TOT_LOSS_10_YR_IND,
PRPTY_LOSS_5_YR_IND,
TWO_WEA_LOSS_5_YR_IND,
ONE_WEA_LOSS_5_YR_IND,
LOSS_3_YR_IND,
THEFT_LOSS_IND,
LOSS_5_YR_IND,
DCLND_5_YR_IND,
LTGTN_PEND_IND,
FRCLSR_5_YR_IND,
TRFC_VLATN_IND,
AUTO_INSRNC_CANCELLED_12_MTH_I,
LIC_SUSPD_5_YR_IND,
RPOSESN_3_YR_IND,
RPOSESN_DT,
ARRESTED_5_YR_IND,
FAULT_ACDNT_5_YR_IND,
APLCNT_CURRENTLY_INSRD_TXT,
LIC_CURRENTLY_SUSPD_IND,
LIC_SUSPD_IND,
SBMN_JOB_CRT_DT,
SBMN_JOB_UPDT_DT,
SBMN_JOB_CLS_DT,
SBMN_JOB_CRT_USR_NAME,
SBMN_JOB_UPDT_USR_NAME,
SBMN_JOB_EFF_DT,
BRNCH_NUM,
BRNCH_NAME,
PRD_ID,
UNDRWRTG_ISSU_TYPE_DESC,
UNDRWRTG_ISSU_STS,
NK_JOB_NBR,
QUOTN_ID
)
SELECT
exp_pass_to_tgt_insrnc.CO_NAME as CO_NAME,
exp_pass_to_tgt_insrnc.FRST_NAME as FRST_NAME,
exp_pass_to_tgt_insrnc.MDL_NAME as MDL_NAME,
exp_pass_to_tgt_insrnc.LAST_NAME as LAST_NAME,
exp_pass_to_tgt_insrnc.NAME_PREFIX_TXT as NAME_PREFIX_TXT,
exp_pass_to_tgt_insrnc.NAME_SFX_TXT as NAME_SFX_TXT,
exp_pass_to_tgt_insrnc.ADDR_LN_1_TXT as ADDR_LN_1_TXT,
exp_pass_to_tgt_insrnc.ADDR_LN_2_TXT as ADDR_LN_2_TXT,
exp_pass_to_tgt_insrnc.CITY_NAME as CITY_NAME,
exp_pass_to_tgt_insrnc.CNTY_NAME as CNTY_NAME,
exp_pass_to_tgt_insrnc.ST_NAME as ST_NAME,
exp_pass_to_tgt_insrnc.ZIP as ZIP,
exp_pass_to_tgt_insrnc.TAX_IDNTFTN_NUM as TAX_IDNTFTN_NUM,
exp_pass_to_tgt_insrnc.BIRTH_DT as BIRTH_DT,
exp_pass_to_tgt_insrnc.DRVG_LIC_NUM as DRVG_LIC_NUM,
exp_pass_to_tgt_insrnc.AGE_OF_QUOT_CNT as AGE_OF_QUOT_CNT,
exp_pass_to_tgt_insrnc.AGNT_NAME as AGNT_NAME,
exp_pass_to_tgt_insrnc.AGNT_NUM as AGNT_NUM,
exp_pass_to_tgt_insrnc.RISK_LOC_CITY_NAME as RISK_LOC_CITY_NAME,
exp_pass_to_tgt_insrnc.RISK_LOC_CTRY_NAME as RISK_LOC_CTRY_NAME,
exp_pass_to_tgt_insrnc.RISK_LOC_CNTY_NAME as RISK_LOC_CNTY_NAME,
exp_pass_to_tgt_insrnc.CVGE_CD as CVGE_CD,
exp_pass_to_tgt_insrnc.CVGE_AMT as CVGE_AMT,
exp_pass_to_tgt_insrnc.CVGE_DESC as CVGE_DESC,
exp_pass_to_tgt_insrnc.PRMRY_INSRD_ADDR_DESC as PRMRY_INSRD_ADDR_DESC,
exp_pass_to_tgt_insrnc.PRMRY_INSRD_NAME as PRMRY_INSRD_NAME,
exp_pass_to_tgt_insrnc.LOB as LOB,
exp_pass_to_tgt_insrnc.UNDRWRTG_CO_NAME as UNDRWRTG_CO_NAME,
exp_pass_to_tgt_insrnc.MSTR_CO_NUM as MSTR_CO_NUM,
exp_pass_to_tgt_insrnc.RNEWL_STS as RNEWL_STS,
exp_pass_to_tgt_insrnc.PLCY_ACCNTG_DT as PLCY_ACCNTG_DT,
exp_pass_to_tgt_insrnc.PLCY_ASGND_DT as PLCY_ASGND_DT,
exp_pass_to_tgt_insrnc.PLCY_EFF_DT as PLCY_EFF_DT,
exp_pass_to_tgt_insrnc.PLCY_TERM_EXPN_DT as PLCY_TERM_EXPN_DT,
exp_pass_to_tgt_insrnc.PLCY_ISSU_DT as PLCY_ISSU_DT,
exp_pass_to_tgt_insrnc.PLCY_NUM as PLCY_NUM,
exp_pass_to_tgt_insrnc.PLCY_RJCTN_RSN_DESC as PLCY_RJCTN_RSN_DESC,
exp_pass_to_tgt_insrnc.SCNDRY_INSRD_NAME as SCNDRY_INSRD_NAME,
exp_pass_to_tgt_insrnc.ADDL_INSRD_NAME as ADDL_INSRD_NAME,
exp_pass_to_tgt_insrnc.PLCY_ADDL_INSRD_NAME as PLCY_ADDL_INSRD_NAME,
exp_pass_to_tgt_insrnc.VEH_ADDL_INSRD_NAME as VEH_ADDL_INSRD_NAME,
exp_pass_to_tgt_insrnc.QUOT_INITATN_DTTM as QUOT_INITATN_DTTM,
exp_pass_to_tgt_insrnc.QUOT_PREM_AMT as QUOT_PREM_AMT,
exp_pass_to_tgt_insrnc.QUOT_STS as QUOT_STS,
exp_pass_to_tgt_insrnc.SLS_SRVC_CTR_NAME as SLS_SRVC_CTR_NAME,
exp_pass_to_tgt_insrnc.SLS_SRVC_CTR_ADDR as SLS_SRVC_CTR_ADDR,
exp_pass_to_tgt_insrnc.PLCY_ORIG_ST_NAME as PLCY_ORIG_ST_NAME,
exp_pass_to_tgt_insrnc.PLCY_WRTN_ST_NAME as PLCY_WRTN_ST_NAME,
exp_pass_to_tgt_insrnc.TOT_WRTN_PREM_AMT as TOT_WRTN_PREM_AMT,
exp_pass_to_tgt_insrnc.TRANS_TYPE_DESC as TRANS_TYPE_DESC,
exp_pass_to_tgt_insrnc.TRANS_DT as TRANS_DT,
exp_pass_to_tgt_insrnc.TRNRND_TM_TXT as TRNRND_TM_TXT,
exp_pass_to_tgt_insrnc.UNDRWRTG_CO_TIER_DESC as UNDRWRTG_CO_TIER_DESC,
exp_pass_to_tgt_insrnc.MRTL_STS as MRTL_STS,
exp_pass_to_tgt_insrnc.OCPTN_DESC as OCPTN_DESC,
exp_pass_to_tgt_insrnc.DEDCTB_AMT as DEDCTB_AMT,
exp_pass_to_tgt_insrnc.MORTGAGEE as MORTGAGEE,
exp_pass_to_tgt_insrnc.PLCY_TYPE_DESC as PLCY_TYPE_DESC,
exp_pass_to_tgt_insrnc.CNSTRCTN_DESC as CNSTRCTN_DESC,
exp_pass_to_tgt_insrnc.HTG_DESC as HTG_DESC,
exp_pass_to_tgt_insrnc.COOLG_DESC as COOLG_DESC,
exp_pass_to_tgt_insrnc.CNSTRCTN_DT as CNSTRCTN_DT,
exp_pass_to_tgt_insrnc.AUTO_LATE_PAY_NUM as AUTO_LATE_PAY_NUM,
exp_pass_to_tgt_insrnc.AUTO_PMT_FRQCY_DESC as AUTO_PMT_FRQCY_DESC,
exp_pass_to_tgt_insrnc.PRMRY_RSPNS_SRVC_DESC as PRMRY_RSPNS_SRVC_DESC,
exp_pass_to_tgt_insrnc.UNDERPINNING_CR_DESC as UNDERPINNING_CR_DESC,
exp_pass_to_tgt_insrnc.MH_RTG_CLAS_DESC as MH_RTG_CLAS_DESC,
exp_pass_to_tgt_insrnc.MH_PRK_NAME as MH_PRK_NAME,
exp_pass_to_tgt_insrnc.MH_PRK_CD as MH_PRK_CD,
exp_pass_to_tgt_insrnc.CLAS_OF_PRPTY_DESC as CLAS_OF_PRPTY_DESC,
exp_pass_to_tgt_insrnc.BODILY_INJRY_LMT_AMT as BODILY_INJRY_LMT_AMT,
exp_pass_to_tgt_insrnc.VEH_WTH_DMG_CNT as VEH_WTH_DMG_CNT,
exp_pass_to_tgt_insrnc.PLCY_DSCNT_NAME as PLCY_DSCNT_NAME,
exp_pass_to_tgt_insrnc.DRVR_CLAS_DESC as DRVR_CLAS_DESC,
exp_pass_to_tgt_insrnc.EXCLN_WAIVD_RSN_DESC as EXCLN_WAIVD_RSN_DESC,
exp_pass_to_tgt_insrnc.GNDR_TYPE_DESC as GNDR_TYPE_DESC,
exp_pass_to_tgt_insrnc.LIABTY_ONLY_IND as LIABTY_ONLY_IND,
exp_pass_to_tgt_insrnc.NO_PRIOR_INSRNC_IND as NO_PRIOR_INSRNC_IND,
exp_pass_to_tgt_insrnc.PRPTY_DMG_LMT_AMT as PRPTY_DMG_LMT_AMT,
exp_pass_to_tgt_insrnc.PLCY_INT_TYPE_DESC as PLCY_INT_TYPE_DESC,
exp_pass_to_tgt_insrnc.PRIOR_INSRNC_CARIER_NAME as PRIOR_INSRNC_CARIER_NAME,
exp_pass_to_tgt_insrnc.RATE_UPS_DESC as RATE_UPS_DESC,
exp_pass_to_tgt_insrnc.RLTNSHP_DESC as RLTNSHP_DESC,
exp_pass_to_tgt_insrnc.TAX_CITY_NAME as TAX_CITY_NAME,
exp_pass_to_tgt_insrnc.VEH_SYMB_COLLISION_CD as VEH_SYMB_COLLISION_CD,
exp_pass_to_tgt_insrnc.VEH_TYPE_DESC as VEH_TYPE_DESC,
exp_pass_to_tgt_insrnc.VEH_USE_DESC as VEH_USE_DESC,
exp_pass_to_tgt_insrnc.VEH_MODL_YR as VEH_MODL_YR,
exp_pass_to_tgt_insrnc.YRS_WTH_ALFA as YRS_WTH_ALFA,
exp_pass_to_tgt_insrnc.VEH_INDENTIFICATION_NUM as VEH_INDENTIFICATION_NUM,
exp_pass_to_tgt_insrnc.PLCY_WRTN_ST_CD as PLCY_WRTN_ST_CD,
exp_pass_to_tgt_insrnc.SLS_RGN_ST_NAME as SLS_RGN_ST_NAME,
exp_pass_to_tgt_insrnc.SLS_RGN_DSTRCT_NAME as SLS_RGN_DSTRCT_NAME,
exp_pass_to_tgt_insrnc.SRVC_CTR_NUM as SRVC_CTR_NUM,
exp_pass_to_tgt_insrnc.AGNT_CLNT_NUM as AGNT_CLNT_NUM,
exp_pass_to_tgt_insrnc.INSRNC_SCR_CD as INSRNC_SCR_CD,
exp_pass_to_tgt_insrnc.NAME_INSRD_MRTL_STS_DESC as NAME_INSRD_MRTL_STS_DESC,
exp_pass_to_tgt_insrnc.NAME_INSRD_AGE_DESC as NAME_INSRD_AGE_DESC,
exp_pass_to_tgt_insrnc.COMBO_DSCNT_IND as COMBO_DSCNT_IND,
exp_pass_to_tgt_insrnc.MULT_CAR_DSCNT_IND as MULT_CAR_DSCNT_IND,
exp_pass_to_tgt_insrnc.VAL_CLNT_DSCNT_IND as VAL_CLNT_DSCNT_IND,
exp_pass_to_tgt_insrnc.LIF_PLCY_DSCNT_IND as LIF_PLCY_DSCNT_IND,
exp_pass_to_tgt_insrnc.HOME_OWNRSHP_DSCNT_IND as HOME_OWNRSHP_DSCNT_IND,
exp_pass_to_tgt_insrnc.AUTO_DSCNT_IND as AUTO_DSCNT_IND,
exp_pass_to_tgt_insrnc.NEW_HOME_DSCNT_PCTG as NEW_HOME_DSCNT_PCTG,
exp_pass_to_tgt_insrnc.VAL_CLNT_DSCNT_PCTG as VAL_CLNT_DSCNT_PCTG,
exp_pass_to_tgt_insrnc.HOME_ALRT_DSCNT_PCTG as HOME_ALRT_DSCNT_PCTG,
exp_pass_to_tgt_insrnc.HOME_ALRT_CD as HOME_ALRT_CD,
exp_pass_to_tgt_insrnc.INSRD_PRPTY_CNTY_NAME as INSRD_PRPTY_CNTY_NAME,
exp_pass_to_tgt_insrnc.DWLNG_CVGE_AMT as DWLNG_CVGE_AMT,
exp_pass_to_tgt_insrnc.PERSNL_PRPTY_CVGE_AMT as PERSNL_PRPTY_CVGE_AMT,
exp_pass_to_tgt_insrnc.CNSTRCTN_TYPE_DESC as CNSTRCTN_TYPE_DESC,
exp_pass_to_tgt_insrnc.OCPTN_CD as OCPTN_CD,
exp_pass_to_tgt_insrnc.PRIOR_INSRNC_CARIER_CD as PRIOR_INSRNC_CARIER_CD,
exp_pass_to_tgt_insrnc.LGCY_DSCNT_IND as LGCY_DSCNT_IND,
exp_pass_to_tgt_insrnc.LATE_PMT_PCTG as LATE_PMT_PCTG,
exp_pass_to_tgt_insrnc.PLCY_PRD_STRT_DT as PLCY_PRD_STRT_DT,
exp_pass_to_tgt_insrnc.PLCY_PRD_END_DT as PLCY_PRD_END_DT,
exp_pass_to_tgt_insrnc.TERM_NUM as TERM_NUM,
exp_pass_to_tgt_insrnc.INSRD_EML_TXT as INSRD_EML_TXT,
exp_pass_to_tgt_insrnc.INSRD_TLPHN_NUM as INSRD_TLPHN_NUM,
exp_pass_to_tgt_insrnc.TOT_UNITS_CNT as TOT_UNITS_CNT,
exp_pass_to_tgt_insrnc.ENDRSMT_DESC as ENDRSMT_DESC,
exp_pass_to_tgt_insrnc.ANULZD_TOT_WRTN_PREM_AMT as ANULZD_TOT_WRTN_PREM_AMT,
exp_pass_to_tgt_insrnc.PRTCTN_CLAS_DESC as PRTCTN_CLAS_DESC,
exp_pass_to_tgt_insrnc.PLCY_CNCLTN_SRC_DESC as PLCY_CNCLTN_SRC_DESC,
exp_pass_to_tgt_insrnc.PREM_DUE_AMT as PREM_DUE_AMT,
exp_pass_to_tgt_insrnc.MBR_NUM as MBR_NUM,
exp_pass_to_tgt_insrnc.CUST_ID as CUST_ID,
exp_pass_to_tgt_insrnc.PLCY_INCPTN_DT as PLCY_INCPTN_DT,
exp_pass_to_tgt_insrnc.PLCY_AGE as PLCY_AGE,
exp_pass_to_tgt_insrnc.SRC_USR_NUM as SRC_USR_NUM,
exp_pass_to_tgt_insrnc.PREM_BILD_AMT as PREM_BILD_AMT,
exp_pass_to_tgt_insrnc.ENCMCE_CD as ENCMCE_CD,
exp_pass_to_tgt_insrnc.RSDNC_TYEP_DESC as RSDNC_TYEP_DESC,
exp_pass_to_tgt_insrnc.VEH_GARGD_LOC_NAME as VEH_GARGD_LOC_NAME,
exp_pass_to_tgt_insrnc.ROOF_YR as ROOF_YR,
exp_pass_to_tgt_insrnc.CNTNUS_SRVC_DT as CNTNUS_SRVC_DT,
exp_pass_to_tgt_insrnc.DWLNG_VAL_AMT as DWLNG_VAL_AMT,
exp_pass_to_tgt_insrnc.DRVR_PNT_DESC as DRVR_PNT_DESC,
exp_pass_to_tgt_insrnc.ARS_SCR as ARS_SCR,
exp_pass_to_tgt_insrnc.AGE_OF_HOME as AGE_OF_HOME,
exp_pass_to_tgt_insrnc.QUOT_CHNL_TXT as QUOT_CHNL_TXT,
exp_pass_to_tgt_insrnc.QUOT_RTD_IND as QUOT_RTD_IND,
exp_pass_to_tgt_insrnc.TOT_UNEARND_PREM_AMT as TOT_UNEARND_PREM_AMT,
exp_pass_to_tgt_insrnc.ADDR_TYPE_DESC as ADDR_TYPE_DESC,
exp_pass_to_tgt_insrnc.DOG_ON_PREMS_IND as DOG_ON_PREMS_IND,
exp_pass_to_tgt_insrnc.DWLNG_APRSL_DT as DWLNG_APRSL_DT,
exp_pass_to_tgt_insrnc.DWLNG_SQUAR_FOOTGE as DWLNG_SQUAR_FOOTGE,
exp_pass_to_tgt_insrnc.VEH_BODY_TYPE_DESC as VEH_BODY_TYPE_DESC,
exp_pass_to_tgt_insrnc.VEH_COLOR_DESC as VEH_COLOR_DESC,
exp_pass_to_tgt_insrnc.VEH_MAKE_DESC as VEH_MAKE_DESC,
exp_pass_to_tgt_insrnc.VEH_MODL_DESC as VEH_MODL_DESC,
exp_pass_to_tgt_insrnc.VEH_PRCH_DT as VEH_PRCH_DT,
exp_pass_to_tgt_insrnc.DWLNG_PRCH_DT as DWLNG_PRCH_DT,
exp_pass_to_tgt_insrnc.DWLNG_NUM_OF_STORIES_CNT as DWLNG_NUM_OF_STORIES_CNT,
exp_pass_to_tgt_insrnc.RATE_AS_OF_DT_AMT as RATE_AS_OF_DT_AMT,
exp_pass_to_tgt_insrnc.TRANS_CLSD_DT as TRANS_CLSD_DT,
exp_pass_to_tgt_insrnc.GAR_CRPT_DESC as GAR_CRPT_DESC,
exp_pass_to_tgt_insrnc.SCREENED_POOL_IND as SCREENED_POOL_IND,
exp_pass_to_tgt_insrnc.DWLNG_FIRE_DEPT_CD as DWLNG_FIRE_DEPT_CD,
exp_pass_to_tgt_insrnc.PLCY_FRST_ISSU_DT as PLCY_FRST_ISSU_DT,
exp_pass_to_tgt_insrnc.DWLNG_FNDTN_TYPE as DWLNG_FNDTN_TYPE,
exp_pass_to_tgt_insrnc.DWLNG_USE_DESC as DWLNG_USE_DESC,
exp_pass_to_tgt_insrnc.DWLNG_OCPYD_DESC as DWLNG_OCPYD_DESC,
exp_pass_to_tgt_insrnc.FIRE_HYDRANT_1000_FEET_IND as FIRE_HYDRANT_1000_FEET_IND,
exp_pass_to_tgt_insrnc.FIRE_HYDRANT_5_MILE_IND as FIRE_HYDRANT_5_MILE_IND,
exp_pass_to_tgt_insrnc.SWIMMING_POOL_IND as SWIMMING_POOL_IND,
exp_pass_to_tgt_insrnc.WIND_AND_HAIL_EXCLDD_IND as WIND_AND_HAIL_EXCLDD_IND,
exp_pass_to_tgt_insrnc.PLCY_ISSUD_IND as PLCY_ISSUD_IND,
exp_pass_to_tgt_insrnc.DWLNG_LAT_MEAS as DWLNG_LAT_MEAS,
exp_pass_to_tgt_insrnc.DWLNG_LNGTD_MEAS as DWLNG_LNGTD_MEAS,
exp_pass_to_tgt_insrnc.INSRD_LIC_ST_NAME as INSRD_LIC_ST_NAME,
exp_pass_to_tgt_insrnc.DWLNG_VALUT_METH_NAME as DWLNG_VALUT_METH_NAME,
exp_pass_to_tgt_insrnc.DWLNG_CVGE_LMT_AMT as DWLNG_CVGE_LMT_AMT,
exp_pass_to_tgt_insrnc.PRPTY_VALUT_METH_DESC as PRPTY_VALUT_METH_DESC,
exp_pass_to_tgt_insrnc.PERSNL_PRPTY_CVGE_LMT_AMT as PERSNL_PRPTY_CVGE_LMT_AMT,
exp_pass_to_tgt_insrnc.OTH_STRC_CVGE_LMT_AMT as OTH_STRC_CVGE_LMT_AMT,
exp_pass_to_tgt_insrnc.LOSS_OF_USE_CVGE_LMT_AMT as LOSS_OF_USE_CVGE_LMT_AMT,
exp_pass_to_tgt_insrnc.PRPTY_ZN_DESC as PRPTY_ZN_DESC,
exp_pass_to_tgt_insrnc.DWLNG_PRCH_AMT as DWLNG_PRCH_AMT,
exp_pass_to_tgt_insrnc.DWLNG_ROOF_TYPE_DESC as DWLNG_ROOF_TYPE_DESC,
exp_pass_to_tgt_insrnc.PLCY_TERM_TYPE as PLCY_TERM_TYPE,
exp_pass_to_tgt_insrnc.PLCY_TOT_COST_AMT as PLCY_TOT_COST_AMT,
exp_pass_to_tgt_insrnc.EARND_PREM_AMT as EARND_PREM_AMT,
exp_pass_to_tgt_insrnc.MBR_TYPE_DESC as MBR_TYPE_DESC,
exp_pass_to_tgt_insrnc.MOST_RCENT_QUOT_VERS_DT as MOST_RCENT_QUOT_VERS_DT,
exp_pass_to_tgt_insrnc.TOT_VEHICAL_UNIT_CNT as TOT_VEHICAL_UNIT_CNT,
exp_pass_to_tgt_insrnc.QUOT_STS_DESC as QUOT_STS_DESC,
exp_pass_to_tgt_insrnc.QUOT_VERS_NUM as QUOT_VERS_NUM,
exp_pass_to_tgt_insrnc.PROD_LN_DESC as PROD_LN_DESC,
exp_pass_to_tgt_insrnc.CO_TO_CO_TFR_DESC as CO_TO_CO_TFR_DESC,
exp_pass_to_tgt_insrnc.NEW_PRPTY_CUST_IND as NEW_PRPTY_CUST_IND,
exp_pass_to_tgt_insrnc.TOT_FIRE_LOSS_IND as TOT_FIRE_LOSS_IND,
exp_pass_to_tgt_insrnc.TOT_LOSS_10_YR_IND as TOT_LOSS_10_YR_IND,
exp_pass_to_tgt_insrnc.PRPTY_LOSS_5_YR_IND as PRPTY_LOSS_5_YR_IND,
exp_pass_to_tgt_insrnc.TWO_WEA_LOSS_5_YR_IND as TWO_WEA_LOSS_5_YR_IND,
exp_pass_to_tgt_insrnc.ONE_WEA_LOSS_5_YR_IND as ONE_WEA_LOSS_5_YR_IND,
exp_pass_to_tgt_insrnc.LOSS_3_YR_IND as LOSS_3_YR_IND,
exp_pass_to_tgt_insrnc.THEFT_LOSS_IND as THEFT_LOSS_IND,
exp_pass_to_tgt_insrnc.LOSS_5_YR_IND as LOSS_5_YR_IND,
exp_pass_to_tgt_insrnc.DCLND_5_YR_IND as DCLND_5_YR_IND,
exp_pass_to_tgt_insrnc.LTGTN_PEND_IND as LTGTN_PEND_IND,
exp_pass_to_tgt_insrnc.FRCLSR_5_YR_IND as FRCLSR_5_YR_IND,
exp_pass_to_tgt_insrnc.TRFC_VLATN_IND as TRFC_VLATN_IND,
exp_pass_to_tgt_insrnc.AUTO_INSRNC_CANCELLED_12_MTH_I as AUTO_INSRNC_CANCELLED_12_MTH_I,
exp_pass_to_tgt_insrnc.LIC_SUSPD_5_YR_IND as LIC_SUSPD_5_YR_IND,
exp_pass_to_tgt_insrnc.RPOSESN_3_YR_IND as RPOSESN_3_YR_IND,
exp_pass_to_tgt_insrnc.RPOSESN_DT as RPOSESN_DT,
exp_pass_to_tgt_insrnc.ARRESTED_5_YR_IND as ARRESTED_5_YR_IND,
exp_pass_to_tgt_insrnc.FAULT_ACDNT_5_YR_IND as FAULT_ACDNT_5_YR_IND,
exp_pass_to_tgt_insrnc.APLCNT_CURRENTLY_INSRD_TXT as APLCNT_CURRENTLY_INSRD_TXT,
exp_pass_to_tgt_insrnc.LIC_CURRENTLY_SUSPD_IND as LIC_CURRENTLY_SUSPD_IND,
exp_pass_to_tgt_insrnc.LIC_SUSPD_IND as LIC_SUSPD_IND,
exp_pass_to_tgt_insrnc.SBMN_JOB_CRT_DT as SBMN_JOB_CRT_DT,
exp_pass_to_tgt_insrnc.SBMN_JOB_UPDT_DT as SBMN_JOB_UPDT_DT,
exp_pass_to_tgt_insrnc.SBMN_JOB_CLS_DT as SBMN_JOB_CLS_DT,
exp_pass_to_tgt_insrnc.SBMN_JOB_CRT_USR_NAME as SBMN_JOB_CRT_USR_NAME,
exp_pass_to_tgt_insrnc.SBMN_JOB_UPDT_USR_NAME as SBMN_JOB_UPDT_USR_NAME,
exp_pass_to_tgt_insrnc.SBMN_JOB_EFF_DT as SBMN_JOB_EFF_DT,
exp_pass_to_tgt_insrnc.BRNCH_NUM as BRNCH_NUM,
exp_pass_to_tgt_insrnc.BRNCH_NAME as BRNCH_NAME,
exp_pass_to_tgt_insrnc.PRD_ID as PRD_ID,
exp_pass_to_tgt_insrnc.UNDRWRTG_ISSU_TYPE_DESC as UNDRWRTG_ISSU_TYPE_DESC,
exp_pass_to_tgt_insrnc.UNDRWRTG_ISSU_STS as UNDRWRTG_ISSU_STS,
exp_pass_to_tgt_insrnc.NK_JOB_NBR as NK_JOB_NBR,
exp_pass_to_tgt_insrnc.QUOTN_ID as QUOTN_ID
FROM
exp_pass_to_tgt_insrnc;


-- PIPELINE END FOR 2

-- PIPELINE START FOR 3

-- Component SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as QUOTN_ID,
$2 as AGMT_ID,
$3 as HTG_DESC,
$4 as COOLG_DESC,
$5 as PRMRY_RSPNS_SRVC_DESC,
$6 as DWLNG_NUM_OF_STORIES_CNT,
$7 as GAR_CRPT_DESC,
$8 as SCREENED_POOL_IND,
$9 as DWLNG_SQUAR_FOOTGE,
$10 as VEH_BODY_TYPE_DESC,
$11 as VEH_COLOR_DESC,
$12 as VEH_MAKE_DESC,
$13 as VEH_MODL_DESC,
$14 as CNSTRCTN_DT,
$15 as CLAS_OF_PRPTY_DESC,
$16 as VEH_PRCH_DT,
$17 as DWLNG_PRCH_DT,
$18 as CNSTRCTN_DESC,
$19 as CNSTRCTN_TYPE_DESC,
$20 as RSDNC_TYEP_DESC,
$21 as DWLNG_FNDTN_TYPE,
$22 as DWLNG_USE_DESC,
$23 as PRPTY_ZN_DESC,
$24 as DWLNG_VAL_AMT,
$25 as DWLNG_OCPYD_DESC,
$26 as VEH_GARGD_LOC_NAME,
$27 as DWLNG_APRSL_DT,
$28 as DWLNG_PRCH_AMT,
$29 as PRTCTN_CLAS_DESC,
$30 as VEH_TYPE_DESC,
$31 as VEH_MODL_YR,
$32 as VEH_INDENTIFICATION_NUM,
$33 as VEH_USE_DESC,
$34 as AGE_OF_HOME,
$35 as FIRE_HYDRANT_1000_FEET_IND,
$36 as FIRE_HYDRANT_5_MILE_IND,
$37 as SWIMMING_POOL_IND,
$38 as PLCY_INT_TYPE_DESC,
$39 as VEH_SYMB_COLLISION_CD,
$40 as DWLNG_LAT_MEAS,
$41 as DWLNG_LNGTD_MEAS,
$42 as MH_PRK_NAME,
$43 as MH_PRK_CD,
$44 as MH_RTG_CLAS_DESC,
$45 as DRVR_CLAS_DESC,
$46 as INSRD_PRPTY_CNTY_NAME,
$47 as DWLNG_ROOF_TYPE_DESC,
$48 as ROOF_YR,
$49 as ENCMCE_CD,
$50 as DWLNG_FIRE_DEPT_CD,
$51 as TOT_UNEARND_PREM_AMT,
$52 as EARND_PREM_AMT,
$53 as NK_JOB_NBR,
$54 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT 

distinct

AGMT.INS_QUOTN_ID AS QUOTN_ID

,AGMT.AGMT_ID

,AGMT.HTG_DESC

,AGMT.COOLG_DESC

,AGMT.PRMRY_RSPNS_SRVC_DESC

,AGMT.DWLNG_NUM_OF_STORIES_CNT

,AGMT.GAR_CRPT_DESC

,case when AGMT.SCREENED_POOL_IND=1 then ''Yes'' when AGMT.SCREENED_POOL_IND=0 then ''No'' else NULL end as SCREENED_POOL_IND

,AGMT.DWLNG_SQUAR_FOOTGE

,AGMT.VEH_BODY_TYPE_DESC

,AGMT.VEH_COLOR_DESC

,AGMT.VEH_MAKE_DESC

,AGMT.VEH_MODL_DESC

,AGMT.CNSTRCTN_DT

,AGMT.CLAS_OF_PRPTY_DESC

,AGMT.VEH_PRCH_DT

,AGMT.DWLNG_PRCH_DT

,AGMT.CNSTRCTN_DESC

,AGMT.CNSTRCTN_TYPE_DESC

,AGMT.RSDNC_TYEP_DESC 

,AGMT.DWLNG_FNDTN_TYPE

,AGMT.DWLNG_USE_DESC

,AGMT.PRPTY_ZN_DESC

,AGMT.DWLNG_VAL_AMT

,AGMT.DWLNG_OCPYD_DESC

,AGMT.VEH_GARGD_LOC_NAME

,AGMT.DWLNG_APRSL_DT

,AGMT.DWLNG_PRCH_AMT

,AGMT.PRTCTN_CLAS_DESC

,AGMT.VEH_TYPE_DESC 

,AGMT.VEH_MODL_YR

,AGMT.VEH_INDENTIFICATION_NUM

,AGMT.VEH_USE_DESC

,AGMT.AGE_OF_HOME

,case when AGMT.FIRE_HYDRANT_1000_FEET_IND=1 then ''Yes'' when AGMT.FIRE_HYDRANT_1000_FEET_IND=0 then ''No'' else NULL end as FIRE_HYDRANT_1000_FEET_IND 

,case when AGMT.FIRE_HYDRANT_5_MILE_IND=1 then ''Yes'' when AGMT.FIRE_HYDRANT_5_MILE_IND=0 then ''No'' else NULL end as FIRE_HYDRANT_5_MILE_IND 

,case when AGMT.SWIMMING_POOL_IND=1 then ''Yes'' when AGMT.SWIMMING_POOL_IND =0 then ''No'' else NULL end as SWIMMING_POOL_IND

,AGMT.PLCY_INT_TYPE_DESC

,AGMT.VEH_SYMB_COLLISION_CD

,AGMT.DWLNG_LAT_MEAS

,AGMT.DWLNG_LNGTD_MEAS

,AGMT.MH_PRK_NAME

,AGMT.MH_PRK_CD

,AGMT.MH_RTG_CLAS_DESC

,AGMT.DRVR_CLAS_DESC

,AGMT.INSRD_PRPTY_CNTY_NAME

,AGMT.DWLNG_ROOF_TYPE_DESC

,AGMT.ROOF_YR

,AGMT.ENCMCE_CD

,AGMT.DWLNG_FIRE_DEPT_CD

,AGMT.TOT_UNEARND_PREM_AMT

,AGMT.EARND_PREM_AMT

,null as NK_JOB_NBR

FROM

(

SELECT

INSQTN.QUOTN_ID AS INS_QUOTN_ID,

QU_AS.PRTY_ASSET_ID,

QU_ASSET.HTG_DESC,

QU_ASSET.COOLG_DESC,

QU_ASSET.PRMRY_RSPNS_SRVC_DESC,

QU_ASSET.DWLNG_NUM_OF_STORIES_CNT,

QU_ASSET.GAR_CRPT_DESC,

QU_ASSET.SCREENED_POOL_IND,

QU_ASSET.DWLNG_SQUAR_FOOTGE,

QU_ASSET.VEH_BODY_TYPE_DESC,

QU_ASSET.VEH_COLOR_DESC,

QU_ASSET.VEH_MAKE_DESC,

QU_ASSET.VEH_MODL_DESC, 

QU_ASSET.CNSTRCTN_DT,

QU_ASSET.PRTCTN_CLAS_DESC,

QU_ASSET.VEH_TYPE_DESC, 

QU_ASSET.VEH_MODL_YR,

QU_ASSET.VEH_INDENTIFICATION_NUM,

QU_ASSET.VEH_USE_DESC,

QU_ASSET.FIRE_HYDRANT_1000_FEET_IND,

QU_ASSET.FIRE_HYDRANT_5_MILE_IND ,

QU_ASSET.SWIMMING_POOL_IND,

(current_date - cast(QU_ASSET.CNSTRCTN_DT AS date))/30 AS AGE_OF_HOME,

QU_ASSET.CLAS_OF_PRPTY_DESC,                

QU_ASSET.VEH_PRCH_DT,

QU_ASSET.DWLNG_PRCH_DT,

QU_ASSET.PLCY_INT_TYPE_DESC,

QU_ASSET_X.CNSTRCTN_DESC,

QU_ASSET_X.CNSTRCTN_TYPE_DESC,

QU_ASSET_X.RSDNC_TYEP_DESC ,

QU_ASSET_X.DWLNG_FNDTN_TYPE,

QU_ASSET_X.DWLNG_USE_DESC,

QU_ASSET_X.PRPTY_ZN_DESC,

QU_ASSET_X.DWLNG_VAL_AMT,

QU_ASSET_X.DWLNG_OCPYD_DESC,

QU_ASSET_X.VEH_GARGD_LOC_NAME,

QU_ASSET_X.DWLNG_APRSL_DT,

QU_ASSET_X.DWLNG_PRCH_AMT,

QU_ASSETRTCLASS.MH_RTG_CLAS_DESC,

QU_ASSET_DRVCLASS.DRVR_CLAS_DESC,

QU_INS_PNAME.INSRD_PRPTY_CNTY_NAME,

QU_ENCM.DWLNG_ROOF_TYPE_DESC,

QU_ENCM.ROOF_YR,

QU_ENCM.ENCMCE_CD,

QU_FIRE_DEPT.DWLNG_FIRE_DEPT_CD,

LAT_MEAS_Q.LAT_MEAS  as  DWLNG_LAT_MEAS,

LAT_MEAS_Q.LNGTD_MEAS as DWLNG_LNGTD_MEAS,

MFG_HOME_PRK_NAME_Q.MFG_HOME_PRK_NAME as MH_PRK_NAME,

MFG_HOME_PRK_NAME_Q.MFG_HOME_PRK_CD as MH_PRK_CD,

AGMT.TOT_UNEARND_PREM_AMT, 

AGMT.EARND_PREM_AMT,

AGMT.VEH_SYMB_COLLISION_CD,

AGMT.AGMT_ID



FROM 

(SELECT DISTINCT QUOTN_ID FROM DB_T_PROD_CORE.INSRNC_QUOTN WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''   

 AND QUOTN_SBTYPE_CD IN (''SBMSSN'',''RENEWAL'',''PLCYCHG'') )   INSQTN

INNER JOIN

 (SELECT * FROM DB_T_PROD_CORE.QUOTN_ASSET WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) QU_AS ON INSQTN.QUOTN_ID = QU_AS.QUOTN_ID

LEFT OUTER JOIN

(SELECT PRTYAST_DET.QUOTN_ID,

PRTYAST_DET.PRTY_ASSET_ID,

MAX(HTG_DESC) AS HTG_DESC,

MAX(COOLG_DESC) AS COOLG_DESC,

MAX(PRMRY_RSPNS_SRVC_DESC) AS PRMRY_RSPNS_SRVC_DESC,

MAX(DWLNG_NUM_OF_STORIES_CNT) AS DWLNG_NUM_OF_STORIES_CNT,

MAX(GAR_CRPT_DESC) AS GAR_CRPT_DESC,

MAX(SCREENED_POOL_IND) AS SCREENED_POOL_IND,

MAX(DWLNG_SQUAR_FOOTGE) AS DWLNG_SQUAR_FOOTGE,

MAX(VEH_BODY_TYPE_DESC) AS  VEH_BODY_TYPE_DESC,

MAX(VEH_COLOR_DESC) AS VEH_COLOR_DESC,

MAX(VEH_MAKE_DESC) AS VEH_MAKE_DESC,

MAX(VEH_MODL_DESC) AS VEH_MODL_DESC,

MAX(CNSTRCTN_DT) AS CNSTRCTN_DT,

MAX(CLAS_OF_PRPTY_DESC) AS CLAS_OF_PRPTY_DESC,

MAX(VEH_PRCH_DT) AS VEH_PRCH_DT,

MAX(DWLNG_PRCH_DT) AS  DWLNG_PRCH_DT,

MAX(PRTCTN_CLAS_DESC) AS PRTCTN_CLAS_DESC,

MAX(VEH_TYPE_DESC) AS VEH_TYPE_DESC, 

MAX(VEH_MODL_YR) AS VEH_MODL_YR,

MAX(VEH_INDENTIFICATION_NUM) AS VEH_INDENTIFICATION_NUM,

MAX(VEH_USE_DESC) AS VEH_USE_DESC,

MAX(FIRE_HYDRANT_1000_FEET_IND) AS FIRE_HYDRANT_1000_FEET_IND,

MAX(FIRE_HYDRANT_5_MILE_IND) AS FIRE_HYDRANT_5_MILE_IND ,

MAX(SWIMMING_POOL_IND) AS SWIMMING_POOL_IND,

MAX(PLCY_INT_TYPE_DESC) AS PLCY_INT_TYPE_DESC

FROM (

SELECT PRTYAST_DET.QUOTN_ID, PRTYAST_DET.PRTY_ASSET_ID,

PRTYAST_DET.HTG_DESC_SCHM AS HTG_DESC,

PRTYAST_DET.COOLG_DESC_SCHM AS COOLG_DESC,

PRTYAST_DET.PRMRY_RSPNS_SRVC_DESC_SCHM AS PRMRY_RSPNS_SRVC_DESC,

PRTYAST_DET.DWLNG_NUM_OF_STORIES_CNT_FLOOR AS DWLNG_NUM_OF_STORIES_CNT,

PRTYAST_DET.GAR_CRPT_DESC_IND AS GAR_CRPT_DESC,

PRTYAST_DET.SCREENED_POOL_IND_VAL AS  SCREENED_POOL_IND,

PRTYAST_DET.DWLNG_SQUAR_FOOTGE_MEAS AS  DWLNG_SQUAR_FOOTGE,

PRTYAST_DET.VEH_BODY_TYPE_DESC_CD AS VEH_BODY_TYPE_DESC,

PRTYAST_DET.VEH_COLOR_DESC_CD AS VEH_COLOR_DESC,

PRTYAST_DET.VEH_MAKE_DESC_MFGR AS  VEH_MAKE_DESC,

PRTYAST_DET.VEH_MODL_DESC_MODL AS  VEH_MODL_DESC,

PRTYAST_DET.CNSTRCTN_DT_RE AS CNSTRCTN_DT,

PRTYAST_DET.CLAS_OF_PRPTY_DESC_PAST AS CLAS_OF_PRPTY_DESC,

PRTYAST_DET.VEH_PRCH_DT1 AS VEH_PRCH_DT,

PRTYAST_DET.DWLNG_PRCH_DT1 AS  DWLNG_PRCH_DT,

PRTYAST_DET.PRTCTN_CLAS_DESC AS PRTCTN_CLAS_DESC,

PRTYAST_DET.MOTR_VEH_TYPE_CD AS VEH_TYPE_DESC, 

PRTYAST_DET.MFG_YR_NUM AS VEH_MODL_YR,

PRTYAST_DET.MOTR_VEH_SER_NUM AS VEH_INDENTIFICATION_NUM,

PRTYAST_DET.VEH_USE_DESC AS VEH_USE_DESC,

PRTYAST_DET.FIRE_HYDRANT_1000_FEET_IND,

PRTYAST_DET.FIRE_HYDRANT_5_MILE_IND,

PRTYAST_DET.SWIMMING_POOL_IND,

PRTYAST_DET.PLCY_INT_TYPE_DESC



FROM (

SELECT  QU_AS1.QUOTN_ID, QU_AS1.PRTY_ASSET_ID,

CASE WHEN ADST.ASSET_DTL_SCHM_TYPE_CD =''HEAT'' THEN ADT.ASSET_DTL_DESC ELSE NULL END AS  HTG_DESC_SCHM,

CASE WHEN ADST.ASSET_DTL_SCHM_TYPE_CD =''COOL'' THEN  ADT.ASSET_DTL_DESC ELSE NULL END AS  COOLG_DESC_SCHM,

CASE WHEN ADST.ASSET_DTL_SCHM_TYPE_CD =''DWEL''  THEN  ADT.ASSET_DTL_DESC ELSE NULL END  AS  PRMRY_RSPNS_SRVC_DESC_SCHM,

CASE WHEN PAS.PRTY_ASSET_SPEC_TYPE_CD =''FLOOR''  THEN  PAS.PRTY_ASSET_SPEC_CNT ELSE NULL END   DWLNG_NUM_OF_STORIES_CNT_FLOOR,

CASE WHEN PAS.PRTY_ASSET_SPEC_TYPE_CD =''GARAGE''  THEN   PAS.PRTY_ASSET_IND ELSE NULL END AS   GAR_CRPT_DESC_IND,

CASE WHEN PAS.PRTY_ASSET_SPEC_TYPE_CD =''POOLENC''  THEN   PAS.PRTY_ASSET_IND  ELSE NULL END  AS  SCREENED_POOL_IND_VAL,

CASE WHEN (PAS.PRTY_ASSET_SPEC_TYPE_CD = ''SIZE'' AND  PAS.PRTY_ASSET_SPEC_UOM_CD = ''SQFT'' ) THEN PAS.PRTY_ASSET_SPEC_MEAS END AS   DWLNG_SQUAR_FOOTGE_MEAS,

MV.BODY_TYPE_CD AS VEH_BODY_TYPE_DESC_CD, MVD.COLOR_DESC AS VEH_COLOR_DESC_CD, MV.VEH_MFGR_CD AS VEH_MAKE_DESC_MFGR, MV.MODL_NAME AS VEH_MODL_DESC_MODL ,

MV.MOTR_VEH_TYPE_CD, 

MV.MFG_YR_NUM,

MV.MOTR_VEH_SER_NUM,

CASE WHEN ADST.ASSET_DTL_SCHM_TYPE_CD =''VEHUSE'' THEN ADT.ASSET_DTL_DESC ELSE NULL END AS  VEH_USE_DESC,

RE.CNSTRCTN_DT AS  CNSTRCTN_DT_RE,

UPPER(PAST.ASSET_DESC) AS CLAS_OF_PRPTY_DESC_PAST,

CASE WHEN (PTPA.ASSET_ROLE_CD=''OWNR''    AND PAST.PRTY_ASSET_SBTYPE_CD = ''MVEH'' ) THEN ASSET_ROLE_DT END AS VEH_PRCH_DT1,

CASE WHEN (PTPA.ASSET_ROLE_CD=''OWNR'' AND PAST.PRTY_ASSET_SBTYPE_CD IN (''REALDW'', ''REALSP'' ))  THEN ASSET_ROLE_DT END AS  DWLNG_PRCH_DT1,

CASE WHEN PAS.PRTY_ASSET_SPEC_TYPE_CD =''PROT''  THEN  PAS.PRTY_ASSET_SPEC_VAL ELSE NULL END   PRTCTN_CLAS_DESC,

case when PAS.PRTY_ASSET_SPEC_TYPE_CD=''FHT'' then PAS.PRTY_ASSET_IND else null  end as FIRE_HYDRANT_1000_FEET_IND,

case when PAS.PRTY_ASSET_SPEC_TYPE_CD=''FDDT'' then PAS.PRTY_ASSET_IND else null end as FIRE_HYDRANT_5_MILE_IND, 

case when PAS.PRTY_ASSET_SPEC_TYPE_CD=''POOLEXST'' then PAS.PRTY_ASSET_IND else null end as SWIMMING_POOL_IND,

PLCY_INT_TYPE_DESC

FROM

(select *  from DB_T_PROD_CORE.QUOTN_ASSET  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''  ) QU_AS1

INNER JOIN  (SELECT * FROM DB_T_PROD_CORE.PRTY_ASSET WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) PAST ON QU_AS1.PRTY_ASSET_ID = PAST.PRTY_ASSET_ID

LEFT OUTER JOIN (select *  from DB_T_PROD_CORE.ASSET_DTL_CD_XREF WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) ADCX  on PAST.PRTY_ASSET_ID = ADCX.PRTY_ASSET_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.ASSET_DTL_TYPE ) ADT  on ADT.ASSET_DTL_CD = ADCX.ASSET_DTL_CD

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.ASSET_DTL_SCHM_TYPE ) ADST ON ADST.ASSET_DTL_SCHM_TYPE_CD=ADT.ASSET_DTL_SCHM_TYPE_CD

LEFT OUTER JOIN (select *  from DB_T_PROD_CORE.PRTY_ASSET_SPEC  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) PAS  on PAST.PRTY_ASSET_ID = PAS.PRTY_ASSET_ID

LEFT OUTER JOIN (select *  from DB_T_PROD_CORE.MOTR_VEH WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  ) MV  on PAST.PRTY_ASSET_ID = MV.PRTY_ASSET_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.MOTR_VEH_DTL WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) MVD on PAST.PRTY_ASSET_ID = MVD.PRTY_ASSET_ID

LEFT OUTER JOIN (select *  from DB_T_PROD_CORE.REAL_ESTAT WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) RE  on PAST.PRTY_ASSET_ID = RE.PRTY_ASSET_ID

LEFT OUTER JOIN (

SELECT PTPA.PRTY_ID, PTPA.PRTY_ASSET_ID, PTPA.ASSET_ROLE_CD, ASSET_ROLE_DT, LPT.LIENHLDR_POSITN_DESC AS PLCY_INT_TYPE_DESC FROM

(SELECT * FROM DB_T_PROD_CORE.PRTY_TO_PRTY_ASSET WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') PTPA

LEFT OUTER JOIN  DB_T_PROD_CORE.LIENHLDR_POSITN_TYPE LPT ON PTPA.LIENHLDR_POSITN_CD = LPT.LIENHLDR_POSITN_CD

) PTPA ON PTPA.PRTY_ASSET_ID =  PAST.PRTY_ASSET_ID

) PRTYAST_DET) AS PRTYAST_DET

GROUP BY QUOTN_ID , PRTY_ASSET_ID

) QU_ASSET  ON ( QU_AS.QUOTN_ID = QU_ASSET.QUOTN_ID AND QU_AS.PRTY_ASSET_ID = QU_ASSET.PRTY_ASSET_ID)



LEFT OUTER JOIN

(

SELECT   QUAST_DET.QUOTN_ID,QUAST_DET.PRTY_ASSET_ID,

MAX(CNSTRCTN_DESC) AS  CNSTRCTN_DESC,

MAX(CNSTRCTN_TYPE_DESC) AS CNSTRCTN_TYPE_DESC,

MAX(RSDNC_TYEP_DESC) AS RSDNC_TYEP_DESC ,

MAX(DWLNG_FNDTN_TYPE) AS DWLNG_FNDTN_TYPE,

MAX(DWLNG_USE_DESC) AS DWLNG_USE_DESC,

MAX(PRPTY_ZN_DESC) AS PRPTY_ZN_DESC,

MAX(DWLNG_VAL_AMT) AS DWLNG_VAL_AMT,

MAX(DWLNG_OCPYD_DESC) AS DWLNG_OCPYD_DESC,

MAX(VEH_GARGD_LOC_NAME) AS VEH_GARGD_LOC_NAME,

MAX(DWLNG_APRSL_DT) AS DWLNG_APRSL_DT,

MAX(DWLNG_PRCH_AMT) AS DWLNG_PRCH_AMT

FROM (

SELECT  QUAST_DET.QUOTN_ID,QUAST_DET.PRTY_ASSET_ID,

QUAST_DET.CNSTRCTN_DESC_CD AS CNSTRCTN_DESC,

QUAST_DET.CNSTRCTN_TYPE_DESC_CD AS CNSTRCTN_TYPE_DESC,

QUAST_DET.RSDNC_TYEP_DESC_CD AS RSDNC_TYEP_DESC,

QUAST_DET.DWLNG_FNDTN_TYPE_CD AS DWLNG_FNDTN_TYPE,

QUAST_DET.DWLNG_USE_DESC_CD AS DWLNG_USE_DESC,

QUAST_DET.PRPTY_ZN_DESC_CD AS PRPTY_ZN_DESC,

QUAST_DET.DWLNG_VAL_AMT_A AS DWLNG_VAL_AMT,

QUAST_DET.DWLNG_OCPYD_DESC_CD AS  DWLNG_OCPYD_DESC,

QUAST_DET.VEH_GARGD_LOC_NAME AS VEH_GARGD_LOC_NAME,

QUAST_DET.DWLNG_APRSL_DT AS  DWLNG_APRSL_DT,

QUAST_DET.DWLNG_PRCH_AMT AS DWLNG_PRCH_AMT

FROM (

SELECT QUAS.QUOTN_ID, QUAS.PRTY_ASSET_ID,

RES.CNSTRCTN_TYPE_CD AS   CNSTRCTN_DESC_CD,

RES. CNSTRCTN_TYPE_CD AS  CNSTRCTN_TYPE_DESC_CD ,

CASE  WHEN ( ADST.ASSET_DTL_SCHM_TYPE_CD = ''RESD'' ) THEN ADT.ASSET_DTL_DESC END AS RSDNC_TYEP_DESC_CD,

CASE  WHEN ( ADST.ASSET_DTL_SCHM_TYPE_CD = ''FOUND'' and  adt.ASSET_DTL_DESC<> ''Type Unknown'') THEN ADT.ASSET_DTL_DESC END AS DWLNG_FNDTN_TYPE_CD,

CASE  WHEN ( ADST.ASSET_DTL_SCHM_TYPE_CD = ''DWEL'' ) THEN ADT.ASSET_DTL_DESC END AS  DWLNG_USE_DESC_CD,

CASE  WHEN ( ADST.ASSET_DTL_SCHM_TYPE_CD = ''DWELUSE'' ) THEN ADT.ASSET_DTL_DESC END AS DWLNG_OCPYD_DESC_CD,

CASE  WHEN ( ADST.ASSET_DTL_SCHM_TYPE_CD = ''TERR'' ) THEN ADT.ASSET_DTL_DESC END AS PRPTY_ZN_DESC_CD,

CASE WHEN ( AV.ASSET_VALUT_AMT_CD = ''DWLAMT'' ) THEN AV.ASSET_VAL_AMT END AS DWLNG_VAL_AMT_A,

CASE  WHEN ( ADST.ASSET_DTL_SCHM_TYPE_CD = ''TERR'' ) THEN ADT.ASSET_DTL_DESC END AS VEH_GARGD_LOC_NAME,

CASE  WHEN ( AV.ASSET_VALUT_AMT_CD = ''MKTVAL'' ) THEN AV.ASSET_VAL_STRT_DTTM END AS DWLNG_APRSL_DT,

CASE  WHEN ( AV.ASSET_VALUT_AMT_CD = ''PRCHPRC'' ) THEN AV.ASSET_VAL_AMT END AS DWLNG_PRCH_AMT

FROM

(SELECT * FROM DB_T_PROD_CORE.QUOTN_ASSET WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') QUAS 

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.PRTY_ASSET WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') PA ON QUAS.PRTY_ASSET_ID = PA.PRTY_ASSET_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.REAL_ESTAT WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') RES ON RES.PRTY_ASSET_ID = QUAS.PRTY_ASSET_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.ASSET_DTL_CD_XREF WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') XREF ON XREF.PRTY_ASSET_ID = QUAS.PRTY_ASSET_ID

LEFT OUTER JOIN (SELECT * FROM ASSET_DTL_TYPE) ADT ON ADT.ASSET_DTL_CD = XREF.ASSET_DTL_CD

LEFT OUTER JOIN (SELECT * FROM ASSET_DTL_SCHM_TYPE) ADST ON ADST.ASSET_DTL_SCHM_TYPE_CD = ADT.ASSET_DTL_SCHM_TYPE_CD

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.ASSET_VAL WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') AV ON AV.PRTY_ASSET_ID = QUAS.PRTY_ASSET_ID

) QUAST_DET) AS QUAST_DET

GROUP BY QUOTN_ID

, PRTY_ASSET_ID

) QU_ASSET_X ON (QU_AS.QUOTN_ID = QU_ASSET_X.QUOTN_ID AND QU_AS.PRTY_ASSET_ID = QU_ASSET_X.PRTY_ASSET_ID)



LEFT OUTER JOIN

(

SELECT QUOTN_ID , QA.PRTY_ASSET_ID, SPTL_PNT AS LAT_MEAS , SPTL_PNT AS LNGTD_MEAS FROM

(SELECT * FROM DB_T_PROD_CORE.QUOTN_ASSET WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'' ) QA

INNER JOIN

(SELECT * FROM DB_T_PROD_CORE.PRTY_ASSET_LOCTR WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'' ) PAL ON QA.PRTY_ASSET_ID = PAL.PRTY_ASSET_ID

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.STREET_ADDR  WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'') SA ON SA.STREET_ADDR_ID = PAL.LOC_ID

) LAT_MEAS_Q on (QU_AS.QUOTN_ID=LAT_MEAS_Q.QUOTN_ID AND QU_AS.PRTY_ASSET_ID = LAT_MEAS_Q.PRTY_ASSET_ID)



LEFT OUTER JOIN

( SELECT distinct QUOTN.QUOTN_ID, QUOTN.PRTY_ASSET_ID , PRK.MFG_HOME_PRK_NAME  ,PRK.MFG_HOME_PRK_CD

FROM 

(SELECT * FROM DB_T_PROD_CORE.QUOTN_ASSET WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) QUOTN

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.PRTY_ASSET_LOCTR WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) LOCTR ON QUOTN.PRTY_ASSET_ID = LOCTR.PRTY_ASSET_ID

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.MFG_HOME_PRK WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') PRK ON  LOCTR.MFG_HOME_PRK_ID = PRK.MFG_HOME_PRK_ID) 

MFG_HOME_PRK_NAME_Q on  (QU_AS.QUOTN_ID=MFG_HOME_PRK_NAME_Q.QUOTN_ID AND QU_AS.PRTY_ASSET_ID = MFG_HOME_PRK_NAME_Q.PRTY_ASSET_ID)



LEFT OUTER JOIN

(

SELECT AGS.QUOTN_ID, PAS.PRTY_ASSET_ID, PRTY_ASSET_SPEC_VAL AS MH_RTG_CLAS_DESC

FROM (SELECT * FROM  DB_T_PROD_CORE.PRTY_ASSET_SPEC  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')  PAS

INNER JOIN (SELECT * FROM  DB_T_PROD_CORE.QUOTN_ASSET  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')  AGS ON  AGS.PRTY_ASSET_ID = PAS.PRTY_ASSET_ID

WHERE PRTY_ASSET_SPEC_TYPE_CD = ''PROT'') QU_ASSETRTCLASS ON (QU_AS.QUOTN_ID=QU_ASSETRTCLASS.QUOTN_ID AND QU_AS.PRTY_ASSET_ID = QU_ASSETRTCLASS.PRTY_ASSET_ID)

LEFT OUTER JOIN

(

SELECT DISTINCT QUOTN_ID, AGS.PRTY_ASSET_ID, DRVR_CLAS_CD AS DRVR_CLAS_DESC  FROM  (SELECT * FROM  DB_T_PROD_CORE.QUOTN_ASSET  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') AGS 

INNER JOIN (SELECT PRTY_ASSET_ID, DRVR_CLAS_CD   FROM DB_T_PROD_CORE.PRTY_TO_PRTY_ASSET WHERE ASSET_ROLE_CD in  (''OWNR'')  and TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') PTPA 

ON AGS.PRTY_ASSET_ID = PTPA.PRTY_ASSET_ID) QU_ASSET_DRVCLASS ON (QU_AS.QUOTN_ID=QU_ASSET_DRVCLASS.QUOTN_ID AND QU_AS.PRTY_ASSET_ID = QU_ASSET_DRVCLASS.PRTY_ASSET_ID)



LEFT OUTER JOIN

(

SELECT QUOTN_ID , AG_AS.PRTY_ASSET_ID,CNTY.GEOGRCL_AREA_NAME AS INSRD_PRPTY_CNTY_NAME

FROM

(select *  from DB_T_PROD_CORE.QUOTN_ASSET  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''  ) AG_AS

INNER JOIN (select *  from DB_T_PROD_CORE.PRTY_ASSET_LOCTR  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''

AND PRTY_ASSET_LOCTR_ROLE_CD = ''PHYSADR''

)   PAL ON AG_AS.PRTY_ASSET_ID = PAL.PRTY_ASSET_ID

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.CNTY WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'') CNTY ON PAL.LOC_ID = CNTY.CNTY_ID 

) QU_INS_PNAME ON (QU_AS.QUOTN_ID=QU_INS_PNAME.QUOTN_ID AND QU_AS.PRTY_ASSET_ID = QU_INS_PNAME.PRTY_ASSET_ID)



LEFT OUTER JOIN 

(SELECT AG_AS.QUOTN_ID, RE.PRTY_ASSET_ID,  RE.ENCMCE_TYPE_CD as ENCMCE_CD , ROOF_CNSTRCTN_TYPE_DESC  AS DWLNG_ROOF_TYPE_DESC, ROOF_YR  from

(SELECT QUOTN_ID, prty_asset_id  FROM DB_T_PROD_CORE.QUOTN_ASSET WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'') AG_AS

INNER JOIN (SELECT prty_asset_id, ENCMCE_TYPE_CD, ROOF_CNSTRCTN_TYPE_CD, ROOF_YR  FROM DB_T_PROD_CORE.REAL_ESTAT_DTL  WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'') RE

ON AG_AS.PRTY_ASSET_ID = RE.PRTY_ASSET_ID

LEFT OUTER JOIN  DB_T_PROD_CORE.ROOF_CNSTRCTN_TYPE RCT ON RCT.ROOF_CNSTRCTN_TYPE_CD  = RE.ROOF_CNSTRCTN_TYPE_CD)  QU_ENCM  ON (QU_AS.QUOTN_ID=QU_ENCM.QUOTN_ID AND QU_AS.PRTY_ASSET_ID = QU_ENCM.PRTY_ASSET_ID)



LEFT OUTER JOIN

(

SELECT DISTINCT QUOTN_ID , QU_AS.PRTY_ASSET_ID,  FIRE_DEPT_NAME  AS DWLNG_FIRE_DEPT_CD

FROM

(select *  from DB_T_PROD_CORE.QUOTN_ASSET  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''  ) QU_AS

INNER JOIN (select *  from DB_T_PROD_CORE.PRTY_ASSET_LOCTR  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'')   PAL ON QU_AS.PRTY_ASSET_ID = PAL.PRTY_ASSET_ID

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.FIRE_DEPT  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'')  FD  ON PAL.FIRE_DEPT_ID =FD.FIRE_DEPT_ID  

) QU_FIRE_DEPT ON  (QU_AS.QUOTN_ID=QU_FIRE_DEPT.QUOTN_ID AND QU_AS.PRTY_ASSET_ID = QU_FIRE_DEPT.PRTY_ASSET_ID)



LEFT OUTER JOIN

(SELECT

QUAG.QUOTN_ID,

AG.AGMT_ID,

AG_AS.PRTY_ASSET_ID,

AG_ERNPREM.TOT_UNEARND_PREM_AMT, 

AG_ERND_PREM.EARND_PREM_AMT,

AG_COLL.VEH_SYMB_COLLISION_CD

FROM

(SELECT * FROM  DB_T_PROD_CORE.QUOTN_AGMT WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') QUAG

INNER JOIN

(SELECT * FROM  DB_T_PROD_CORE.AGMT WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''  and AGMT_TYPE_CD = ''PPV'')  AG ON QUAG.AGMT_ID = AG.AGMT_ID

INNER JOIN

(SELECT * from DB_T_PROD_CORE.AGMT_ASSET WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999'') AG_AS ON AG.AGMT_ID = AG_AS.AGMT_ID

LEFT OUTER JOIN

 (SELECT DISTINCT AG_PREM.AGMT_ID , AG_PREM.PRTY_ASSET_ID,  PLCY_ASSET_CVGE_AMT AS TOT_UNEARND_PREM_AMT

FROM

(SELECT * FROM DB_T_PROD_CORE.PLCY_ASSET_CVGE_MTRC  WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999''  AND INSRNC_MTRC_TYPE_CD = ''UNERNPREM'') AG_PREM

) AG_ERNPREM  ON (AG_ERNPREM.AGMT_ID = AG_AS.AGMT_ID AND AG_ERNPREM.PRTY_ASSET_ID = AG_AS.PRTY_ASSET_ID)



LEFT OUTER JOIN

(SELECT DISTINCT AG_PREM.AGMT_ID , AG_PREM.PRTY_ASSET_ID, PLCY_ASSET_CVGE_AMT AS EARND_PREM_AMT

FROM

(SELECT * FROM DB_T_PROD_CORE.PLCY_ASSET_CVGE_MTRC  WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=''12/31/9999''  AND INSRNC_MTRC_TYPE_CD = ''ERNDPREM'') AG_PREM

) AG_ERND_PREM ON (AG_ERND_PREM.AGMT_ID = AG_AS.AGMT_ID AND AG_ERND_PREM.PRTY_ASSET_ID = AG_AS.PRTY_ASSET_ID) 



LEFT OUTER JOIN

(SELECT AGASF.AGMT_ID,  AGASF.PRTY_ASSET_ID,   AGASF.RATE_SYMB_CD AS VEH_SYMB_COLLISION_CD   

FROM

(SELECT * FROM DB_T_PROD_CORE.AGMT_INSRD_ASSET_FEAT WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999'' ) AGASF 

INNER JOIN

(SELECT * FROM DB_T_PROD_CORE.FEAT WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999''  AND INSRNC_CVGE_TYPE_CD = ''COL'') F ON AGASF.FEAT_ID = F.FEAT_ID

) AG_COLL ON (AG_COLL.AGMT_ID = AG_AS.AGMT_ID AND AG_COLL.PRTY_ASSET_ID = AG_AS.PRTY_ASSET_ID  )



) AGMT ON INSQTN.QUOTN_ID = AGMT.QUOTN_ID

) AGMT
) SRC
)
);


-- PIPELINE START FOR 3

-- Component SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as QUOTN_ID,
$2 as AGMT_ID,
$3 as PLCY_INCPTN_DT,
$4 as PLCY_AGE,
$5 as PLCY_EFF_DT,
$6 as PLCY_TERM_EXPN_DT,
$7 as PLCY_ISSU_DT,
$8 as PLCY_NUM,
$9 as TRANS_DT,
$10 as MORTGAGEE,
$11 as AUTO_PMT_FRQCY_DESC,
$12 as NO_PRIOR_INSRNC_IND,
$13 as YRS_WTH_ALFA,
$14 as PLCY_PRD_STRT_DT,
$15 as PLCY_PRD_END_DT,
$16 as TERM_NUM,
$17 as CNTNUS_SRVC_DT,
$18 as PLCY_FRST_ISSU_DT,
$19 as PLCY_TERM_TYPE,
$20 as PRD_ID,
$21 as ARS_SCR,
$22 as VAL_CLNT_DSCNT_IND,
$23 as RISK_LOC_CITY_NAME,
$24 as RISK_LOC_CTRY_NAME,
$25 as RISK_LOC_CNTY_NAME,
$26 as PLCY_ORIG_ST_NAME,
$27 as PLCY_WRTN_ST_NAME,
$28 as TAX_CITY_NAME,
$29 as PLCY_WRTN_ST_CD,
$30 as SLS_RGN_ST_NAME,
$31 as SLS_RGN_DSTRCT_NAME,
$32 as PRMRY_INSRD_NAME,
$33 as PLCY_ASGND_DT,
$34 as SCNDRY_INSRD_NAME,
$35 as ADDL_INSRD_NAME,
$36 as PLCY_ADDL_INSRD_NAME,
$37 as VEH_ADDL_INSRD_NAME,
$38 as GNDR_TYPE_DESC,
$39 as NAME_INSRD_MRTL_STS_DESC,
$40 as NAME_INSRD_AGE_DESC,
$41 as PRMRY_INSRD_ADDR_DESC,
$42 as SLS_SRVC_CTR_ADDR,
$43 as INSRD_EML_TXT,
$44 as INSRD_TLPHN_NUM,
$45 as DRVR_PNT_DESC,
$46 as INSRD_LIC_ST_NAME,
$47 as MBR_TYPE_DESC,
$48 as MBR_NUM,
$49 as TRANS_TYPE_DESC,
$50 as PLCY_RJCTN_RSN_DESC,
$51 as TRANS_CLSD_DT,
$52 as CO_TO_CO_TFR_DESC,
$53 as TOT_VEHICAL_UNIT_CNT,
$54 as TOT_UNITS_CNT,
$55 as RLTNSHP_DESC,
$56 as PLCY_DSCNT_NAME,
$57 as ENDRSMT_DESC,
$58 as RATE_UPS_DESC,
$59 as LOB,
$60 as PLCY_TYPE_DESC,
$61 as PROD_LN_DESC,
$62 as TOT_WRTN_PREM_AMT,
$63 as ANULZD_TOT_WRTN_PREM_AMT,
$64 as PLCY_TOT_COST_AMT,
$65 as PREM_DUE_AMT,
$66 as PLCY_CNCLTN_SRC_DESC,
$67 as RNEWL_STS,
$68 as AUTO_LATE_PAY_NUM,
$69 as PLCY_ACCNTG_DT,
$70 as EXCLN_WAIVD_RSN_DESC,
$71 as PREM_BILD_AMT,
$72 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT 

distinct

AGMT.INS_QUOTN_ID AS QUOTN_ID

,AGMT.AGMT_ID

,AGMT.AGMT_OPN_DTTM As PLCY_INCPTN_DT

,((CURRENT_DATE - cast(AGMT.AGMT_OPN_DTTM as date))/365.0) as PLCY_AGE

,AGMT.AGMT_OPN_DTTM As  PLCY_EFF_DT

,AGMT.AGMT_PLND_EXPN_DT As  PLCY_TERM_EXPN_DT

,AGMT.AGMT_SIGND_DT As  PLCY_ISSU_DT

,AGMT.HOST_AGMT_NUM As  PLCY_NUM

,AGMT.AGMT_PRCSG_DT As TRANS_DT

,AGMT.BILG_METH_TYPE_CD As  MORTGAGEE

,AGMT.STMT_CYCL_CD As AUTO_PMT_FRQCY_DESC

,CASE when AGMT.PRIOR_INSRNC_IND is not null  then ''Yes'' else ''No''  end As  NO_PRIOR_INSRNC_IND

,((CURRENT_DATE - cast(AGMT.AGMT_OPN_DTTM as date))/365.0) As YRS_WTH_ALFA

,AGMT.AGMT_EFF_DTTM As  PLCY_PRD_STRT_DT

,AGMT.AGMT_PLND_EXPN_DT As  PLCY_PRD_END_DT

,AGMT.TERM_NUM

,AGMT.CNTNUS_SRVC_DT

,AGMT.AGMT_OPN_DTTM As  PLCY_FRST_ISSU_DT

,CASE WHEN PLCY_TERM_TYPE_CALC = 6 THEN ''6 Months''  WHEN  PLCY_TERM_TYPE_CALC = 12 THEN ''12 Months'' ELSE ''Others''  END AS PLCY_TERM_TYPE 

,AGMT.AGMT_ID As PRD_ID

,AGMT.AGMT_SCR_VAL As ARS_SCR

,CASE WHEN AGMT.AGMT_MBRSHP_STRT_DT IS NOT NULL THEN ''Yes'' else ''No'' END   As VAL_CLNT_DSCNT_IND

,AGMT.RISK_LOC_CITY_NAME

,AGMT.RISK_LOC_CTRY_NAME

,AGMT.RISK_LOC_CNTY_NAME

,AGMT.PLCY_ORIG_ST_NAME

,AGMT.PLCY_WRTN_ST_NAME

,AGMT.TAX_CITY_NAME

,AGMT.PLCY_WRTN_ST_CD

,AGMT.SLS_RGN_ST_NAME

,AGMT.SLS_RGN_DSTRCT_NAME

,AGMT.PRMRY_INSRD_NAME

,AGMT.PLCY_ASGND_DT

,AGMT.SCNDRY_INSRD_NAME

,AGMT.ADDL_INSRD_NAME

,AGMT.PLCY_ADDL_INSRD_NAME

,AGMT.VEH_ADDL_INSRD_NAME

,AGMT.GNDR_TYPE_DESC

,AGMT. NAME_INSRD_MRTL_STS_DESC

,AGMT.NAME_INSRD_AGE_DESC

,AGMT.PRMRY_INSRD_ADDR_DESC

,AGMT.SLS_SRVC_CTR_ADDR

,AGMT.INSRD_EML_TXT

,AGMT.INSRD_TLPHN_NUM

,AGMT.DRVR_PNT_DESC

,AGMT.INSRD_LIC_ST_NAME

,AGMT.MBR_TYPE_DESC

,AGMT.MBR_NUM

,AGMT.TRANS_TYPE_DESC

,AGMT.PLCY_RJCTN_RSN_DESC

,AGMT.TRANS_CLSD_DT

,AGMT.CO_TO_CO_TFR_DESC

,AGMT.TOT_VEHICAL_UNIT_CNT

,AGMT.TOT_UNITS_CNT

,AGMT.RLTNSHP_DESC

,AGMT.PLCY_DSCNT_NAME

,AGMT.ENDRSMT_DESC

,AGMT.RATE_UPS_DESC

,AGMT.LOB

,AGMT.PLCY_TYPE_DESC

,AGMT.PROD_LN_DESC

,AGMT.TOT_WRTN_PREM_AMT

,AGMT.ANULZD_TOT_WRTN_PREM_AMT

,AGMT.PLCY_TOT_COST_AMT

,AGMT.PREM_DUE_AMT

,AGMT.PLCY_CNCLTN_SRC_DESC

,AGMT.RNEWL_STS

,AGMT.AUTO_LATE_PAY_NUM

,AGMT.PLCY_ACCNTG_DT

,AGMT.EXCLN_WAIVD_RSN_DESC

,AGMT.PREM_BILD_AMT

FROM

(SELECT AGMT.*,

INSQTN.QUOTN_ID AS INS_QUOTN_ID,

QU_LOC.RISK_LOC_CITY_NAME,

QU_LOC.RISK_LOC_CTRY_NAME,

QU_LOC.RISK_LOC_CNTY_NAME,

QU_LOC.PLCY_WRTN_ST_CD,

QU_HIER.SLS_RGN_ST_NAME,

QU_HIER.SLS_RGN_DSTRCT_NAME,

QU_LOC.PLCY_WRTN_ST_NAME,

QU_LOC1.TAX_CITY_NAME,

QU_HIER.PLCY_ORIG_ST_NAME,

QU_PRTY.PRMRY_INSRD_NAME,

QU_PRTY.PLCY_ASGND_DT,

QU_PRTY.SCNDRY_INSRD_NAME,

QU_PRTY.ADDL_INSRD_NAME,

QU_PRTY.PLCY_ADDL_INSRD_NAME,

QU_PRTY.VEH_ADDL_INSRD_NAME,

QU_PRTY.GNDR_TYPE_DESC,

QU_PRTY. NAME_INSRD_MRTL_STS_DESC,

QU_PRTY.NAME_INSRD_AGE_DESC,

QU_PRTY.PRMRY_INSRD_ADDR_DESC,

QU_PRTY.SLS_SRVC_CTR_ADDR,

QU_PRTY.INSRD_EML_TXT,

QU_PRTY.INSRD_TLPHN_NUM,

QU_PRTY.DRVR_PNT_DESC,

QU_PRTY.INSRD_LIC_ST_NAME,

QU_ASSET_CNT.TOT_VEHICAL_UNIT_CNT,

QU_ASSET_PLCY_CNT.TOT_UNITS_CNT,

QU_DRV.RLTNSHP_DESC,

QU_PLCY_DSC.PLCY_DSCNT_NAME,

QU_ENDRSMT.ENDRSMT_DESC,

QU_RATE_UPS.RATE_UPS_DESC

FROM 

(SELECT DISTINCT QUOTN_ID FROM DB_T_PROD_CORE.INSRNC_QUOTN WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND QUOTN_SBTYPE_CD IN (''SBMSSN'',''RENEWAL'',''PLCYCHG''))   INSQTN

LEFT OUTER JOIN

(SELECT QUOTN_ASSET.QUOTN_ID , COUNT(1) As TOT_VEHICAL_UNIT_CNT FROM 

(SELECT * FROM  DB_T_PROD_CORE.QUOTN_ASSET  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') QUOTN_ASSET INNER JOIN

(SELECT PRTY_ASSET_ID   FROM DB_T_PROD_CORE.PRTY_ASSET WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND PRTY_ASSET_SBTYPE_CD = ''MVEH'') PRTY_ASSET 

ON QUOTN_ASSET.PRTY_ASSET_ID = PRTY_ASSET.PRTY_ASSET_ID

GROUP BY QUOTN_ASSET.QUOTN_ID) QU_ASSET_CNT ON INSQTN.QUOTN_ID = QU_ASSET_CNT.QUOTN_ID

LEFT OUTER JOIN

(

SELECT QUOTN_ASSET.QUOTN_ID , COUNT(1) As TOT_UNITS_CNT FROM (SELECT * FROM  DB_T_PROD_CORE.QUOTN_ASSET  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') QUOTN_ASSET

GROUP BY QUOTN_ASSET.QUOTN_ID

)QU_ASSET_PLCY_CNT  ON INSQTN.QUOTN_ID = QU_ASSET_PLCY_CNT.QUOTN_ID

LEFT OUTER JOIN

(

SELECT DRV.QUOTN_ID,   PRRT.PRTY_RLTD_ROLE_DESC AS RLTNSHP_DESC

FROM

(select QUOTN_ID, PRTY_ID, PRTY_QUOTN_ROLE_CD  from DB_T_PROD_CORE.PRTY_QUOTN   WHERE PRTY_QUOTN_ROLE_CD = ''PLCYDRVR''  AND TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' )  DRV

 INNER JOIN

(SELECT * FROM  DB_T_PROD_CORE.PRTY_RLTD  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') PRTY_RLTD ON DRV.PRTY_ID = PRTY_RLTD.PRTY_ID

LEFT OUTER JOIN DB_T_PROD_CORE.PRTY_RLTD_ROLE PRRT ON PRRT.PRTY_RLTD_ROLE_CD = PRTY_RLTD.PRTY_RLTD_ROLE_CD

WHERE PRTY_RLTD.RLTD_PRTY_ID IN (SELECT PRTY_ID FROM DB_T_PROD_CORE.PRTY_QUOTN   WHERE PRTY_QUOTN_ROLE_CD= ''PLCYPRININS'' 

AND TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''

) )QU_DRV ON INSQTN.QUOTN_ID = QU_DRV.QUOTN_ID

LEFT OUTER JOIN

(

SELECT QUOTN_ID, MAX(FEAT_NAME) AS PLCY_DSCNT_NAME FROM (

SELECT QUOTN_ID, feat.FEAT_ID, FEAT_NAME 

FROM 

(select *  from DB_T_PROD_CORE.QUOTN_FEAT  where to_char(edw_end_dttm,''mm/dd/yyyy'') = ''12/31/9999'' ) QUOTN_FEAT

INNER JOIN 

( SELECT  feat_id, feat_name, feat_lvl_sbtype_cnt FROM DB_T_PROD_CORE.FEAT 

WHERE  to_char(edw_end_dttm,''mm/dd/yyyy'') = ''12/31/9999'' 

AND FEAT.FEAT_NAME LIKE ''%DISCOUNT%'' AND FEAT.FEAT_LVL_SBTYPE_CNT = 1)  FEAT ON QUOTN_FEAT.FEAT_ID = FEAT.FEAT_ID

) DSC GROUP BY QUOTN_ID

) QU_PLCY_DSC ON INSQTN.QUOTN_ID = QU_PLCY_DSC.QUOTN_ID

LEFT OUTER JOIN

(SELECT QUOTN_ID, MAX(ENDRSMT_DESC) AS ENDRSMT_DESC FROM (

SELECT QUOTN_ID,  COMN_FEAT_NAME as ENDRSMT_DESC

FROM 

(select *  from DB_T_PROD_CORE.QUOTN_FEAT  where to_char(edw_end_dttm,''mm/dd/yyyy'') = ''12/31/9999'' ) QUOTN_FEAT

INNER JOIN ( SELECT *  FROM DB_T_PROD_CORE.FEAT WHERE  to_char(edw_end_dttm,''mm/dd/yyyy'') = ''12/31/9999'' AND (FEAT.feat_sbtype_cd=''MOD'' OR feat_insrnc_sbtype_cd=''EXCLUSION'' ) )   FEAT ON QUOTN_FEAT.FEAT_ID = FEAT.FEAT_ID )  ENDRSMT GROUP BY QUOTN_ID

) QU_ENDRSMT ON INSQTN.QUOTN_ID = QU_ENDRSMT.QUOTN_ID

LEFT OUTER JOIN

(SELECT  QUOTN_ID,  case when feat_name is not null then ''Yes'' else ''No'' end as RATE_UPS_DESC

FROM (select *  from DB_T_PROD_CORE.QUOTN_FEAT  where to_char(edw_end_dttm,''mm/dd/yyyy'') = ''12/31/9999'' ) QUOTN_FEAT

INNER JOIN 

( SELECT *  FROM DB_T_PROD_CORE.FEAT WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' AND FEAT_NAME = ''OUT OF DB_T_SHRD_PROD.STATE SURCHARGE'' AND FEAT_SBTYPE_CD = ''MOD'' )   FEAT ON QUOTN_FEAT.FEAT_ID = FEAT.FEAT_ID) QU_RATE_UPS ON INSQTN.QUOTN_ID = QU_RATE_UPS.QUOTN_ID

LEFT OUTER JOIN

(

SELECT QU_LOCTR.QUOTN_ID,

MAX(RISK_LOC_CITY_NAME) AS RISK_LOC_CITY_NAME,

MAX(RISK_LOC_CTRY_NAME) AS RISK_LOC_CTRY_NAME,

MAX(RISK_LOC_CNTY_NAME) AS RISK_LOC_CNTY_NAME,

MAX(PLCY_WRTN_ST_NAME) AS  PLCY_WRTN_ST_NAME,

MAX(PLCY_WRTN_ST_CD) AS PLCY_WRTN_ST_CD

FROM (

SELECT   QU_LOC.QUOTN_ID

,CASE WHEN QUOTN_LOCTR_ROLE_TYPE_CD = ''RISK''  THEN CITY_NAME  ELSE NULL END AS   RISK_LOC_CITY_NAME

,CASE WHEN QUOTN_LOCTR_ROLE_TYPE_CD = ''RISK'' AND CTRY_NAME IS NOT NULL  THEN CTRY_NAME 

WHEN  QUOTN_LOCTR_ROLE_TYPE_CD = ''RISK'' AND CTRY_NAME IS NULL THEN TER_CTRY_NM  ELSE NULL END AS   RISK_LOC_CTRY_NAME

,CASE WHEN QUOTN_LOCTR_ROLE_TYPE_CD = ''RISK''  THEN cnty_name  ELSE NULL END AS   RISK_LOC_CNTY_NAME

,CASE WHEN QUOTN_LOCTR_ROLE_TYPE_CD = ''RISK''  THEN TERR_NAME  ELSE NULL END AS   PLCY_WRTN_ST_NAME

,CASE WHEN QUOTN_LOCTR_ROLE_TYPE_CD = ''AGTWINST''  THEN TERR_CD  ELSE NULL END AS   PLCY_WRTN_ST_CD  

from (SELECT * FROM  DB_T_PROD_CORE.QUOTN_LOCTR  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') QU_LOC

inner join

(

select loctr.loctr_id, geogrcl_area_sbtype_cd  , ADDR_SBTYPE_CD, ctry_id, ctry_name,terr_id, terr_cd, terr_name,cnty_id, cnty_name,TER_CTRY_NM,

city_id, city_name,postl_cd_id,pstl_name,street_addr_id, ADDR_LN_1_TXT,ADDR_LN_2_TXT

from

(SELECT *  FROM  DB_T_PROD_CORE.LOCTR  WHERE GEOGRCL_AREA_SBTYPE_CD IS NOT NULL OR ADDR_SBTYPE_CD = ''STADR'') LOCTR

LEFT OUTER JOIN (SELECT CTRY_ID,GEOGRCL_AREA_NAME as ctry_name FROM DB_T_PROD_CORE.CTRY  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') C ON loctr.loctr_id = C.CTRY_ID

LEFT OUTER JOIN (

SELECT TERR_ID, TERR_NAME, TERR_CD, CTRY.GEOGRCL_AREA_NAME AS TER_CTRY_NM FROM

(SELECT CTRY_ID, TERR_ID,GEOGRCL_AREA_NAME as terr_name, GEOGRCL_AREA_SHRT_NAME as terr_cd FROM DB_T_PROD_CORE.TERR  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') T 

INNER JOIN DB_T_PROD_CORE.CTRY ON CTRY.CTRY_ID = T.CTRY_ID) T ON loctr.loctr_id = T.TERR_ID

LEFT OUTER JOIN (SELECT CNTY_ID,GEOGRCL_AREA_NAME cnty_name FROM DB_T_PROD_CORE.CNTY  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') COUNTY ON loctr.loctr_id = COUNTY.CNTY_ID

LEFT OUTER JOIN (SELECT CITY_ID,GEOGRCL_AREA_NAME city_name FROM DB_T_PROD_CORE.CITY  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') CITY ON loctr.loctr_id = CITY.CITY_ID

LEFT OUTER JOIN (SELECT POSTL_CD_ID,POSTL_CD_NUM pstl_name FROM DB_T_PROD_CORE.POSTL_CD  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') POSTL ON loctr.loctr_id = POSTL.POSTL_CD_ID

LEFT OUTER JOIN (SELECT street_addr_id,ADDR_LN_1_TXT,ADDR_LN_2_TXT FROM DB_T_PROD_CORE.STREET_ADDR  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') STREET ON loctr.loctr_id = STREET.STREET_ADDR_ID

) loc on  qu_loc.loc_id = loc.loctr_id )  QU_LOCTR

GROUP BY QUOTN_ID

) QU_LOC ON INSQTN.QUOTN_ID = QU_LOC.QUOTN_ID

LEFT OUTER JOIN

(SELECT QU_LOCTR.QUOTN_ID, MAX(TAX_CITY_NAME) AS  TAX_CITY_NAME

FROM ( SELECT   QU_LOC.QUOTN_ID ,CASE WHEN QUOTN_LOCTR_ROLE_TYPE_CD = ''TAX''  THEN CITY_NAME  ELSE NULL END AS   TAX_CITY_NAME

from (SELECT * FROM  DB_T_PROD_CORE.QUOTN_LOCTR  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') QU_LOC

INNER JOIN

(SELECT

SA.STREET_ADDR_ID as loc_id,

CNTRY.CTRY_ID , CNTRY.GEOGRCL_AREA_SHRT_NAME AS CTRY_CD ,  CNTRY.GEOGRCL_AREA_NAME AS CTRY_NAME,

T.TERR_ID , T.GEOGRCL_AREA_SHRT_NAME AS TERR_CD ,  T.GEOGRCL_AREA_NAME AS TERR_NAME,

COUNTY.CNTY_ID , COUNTY.GEOGRCL_AREA_SHRT_NAME AS COUNTY_CD ,  COUNTY.GEOGRCL_AREA_NAME AS COUNTY_NAME,

CITY.CITY_ID , CITY.GEOGRCL_AREA_SHRT_NAME AS CITY_CD ,  CITY.GEOGRCL_AREA_NAME AS CITY_NAME

FROM (SELECT * FROM DB_T_PROD_CORE.STREET_ADDR  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') SA LEFT OUTER JOIN

(SELECT * FROM DB_T_PROD_CORE.CTRY WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' )  CNTRY ON SA.CTRY_ID = CNTRY.CTRY_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.TERR WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') T ON SA.TERR_ID = T.TERR_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.CNTY WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') COUNTY ON SA.CNTY_ID = COUNTY.CNTY_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.CITY WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') CITY ON SA.CITY_ID = CITY.CITY_ID) LOC on  QU_LOC.LOC_ID = LOC.LOC_ID )

  QU_LOCTR GROUP BY QUOTN_ID

) QU_LOC1 ON INSQTN.QUOTN_ID = QU_LOC1.QUOTN_ID

LEFT OUTER JOIN

(SELECT PRTYAGT_DET.QUOTN_ID,

MAX(PRMRY_INSRD_NAME) AS PRMRY_INSRD_NAME,

MAX(PLCY_ASGND_DT) AS PLCY_ASGND_DT,

MAX(SCNDRY_INSRD_NAME) AS SCNDRY_INSRD_NAME,

MAX(ADDL_INSRD_NAME) AS ADDL_INSRD_NAME,

MAX(PLCY_ADDL_INSRD_NAME) AS PLCY_ADDL_INSRD_NAME,

MAX(VEH_ADDL_INSRD_NAME) AS VEH_ADDL_INSRD_NAME,

MAX(GNDR_TYPE_DESC) AS GNDR_TYPE_DESC,

MAX( NAME_INSRD_MRTL_STS_DESC) AS  NAME_INSRD_MRTL_STS_DESC,

MAX(NAME_INSRD_AGE_DESC) AS  NAME_INSRD_AGE_DESC,

MAX(PRMRY_INSRD_ADDR_DESC) AS PRMRY_INSRD_ADDR_DESC,

MAX(SLS_SRVC_CTR_ADDR) AS SLS_SRVC_CTR_ADDR,

MAX(INSRD_EML_TXT) AS INSRD_EML_TXT,

MAX(INSRD_TLPHN_NUM) AS INSRD_TLPHN_NUM,

MAX(DRVR_PNT_DESC) AS DRVR_PNT_DESC,

MAX(INSRD_LIC_ST_NAME) AS INSRD_LIC_ST_NAME

FROM (

SELECT PRTYAGT_DET. QUOTN_ID,

PRTYAGT_DET.PRMRY_INSRD_NAME_NM AS PRMRY_INSRD_NAME,

PRTYAGT_DET.PLCY_ASGND_DT_STRT AS PLCY_ASGND_DT,

PRTYAGT_DET.SCNDRY_INSRD_NAME_NM AS SCNDRY_INSRD_NAME,

PRTYAGT_DET.ADDL_INSRD_NAME_NM AS ADDL_INSRD_NAME,

PRTYAGT_DET.PLCY_ADDL_INSRD_NAME_NM AS PLCY_ADDL_INSRD_NAME,

PRTYAGT_DET.VEH_ADDL_INSRD_NAME_NM AS VEH_ADDL_INSRD_NAME,

PRTYAGT_DET.GNDR_TYPE_DESC_CD AS GNDR_TYPE_DESC,

PRTYAGT_DET.NAME_INSRD_MRTL_STS_DESC_CD AS NAME_INSRD_MRTL_STS_DESC,

(CURRENT_DATE - PRTYAGT_DET.NAME_INSRD_AGE_DESC_AGE)  AS NAME_INSRD_AGE_DESC,

PRTYAGT_DET.PRMRY_INSRD_ADDR_DESC_ADD AS PRMRY_INSRD_ADDR_DESC,

PRTYAGT_DET.SLS_SRVC_CTR_ADDR_ADD AS SLS_SRVC_CTR_ADDR,

PRTYAGT_DET.INSRD_EML_TXT_ADD AS INSRD_EML_TXT,

PRTYAGT_DET.INSRD_TLPHN_NUM_NM AS INSRD_TLPHN_NUM,

PRTYAGT_DET.DRVR_PNT_DESC_CNT AS DRVR_PNT_DESC,

PRTYAGT_DET.INSRD_LIC_ST_NAME_NM AS INSRD_LIC_ST_NAME

FROM (

SELECT  PQU.QUOTN_ID,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYPRININS'' ) THEN INM.INDIV_FULL_NAME  END AS PRMRY_INSRD_NAME_NM,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''CMP'' ) THEN PRTY_QUOTN_STRT_DT END AS PLCY_ASGND_DT_STRT,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYSECNINS'' ) THEN INM.INDIV_FULL_NAME  END AS SCNDRY_INSRD_NAME_NM,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYADDNMINS'' ) THEN  INM.INDIV_FULL_NAME  END AS ADDL_INSRD_NAME_NM,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYADDNMINS'' ) THEN  INM.INDIV_FULL_NAME  END AS PLCY_ADDL_INSRD_NAME_NM,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYSECNINS'' ) THEN  INM.INDIV_FULL_NAME  END AS VEH_ADDL_INSRD_NAME_NM,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYPRININS'' ) THEN IND.GNDR_TYPE_CD END AS GNDR_TYPE_DESC_CD,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYPRININS'' ) THEN UPPER(INMS.MRTL_STS_CD) END AS NAME_INSRD_MRTL_STS_DESC_CD ,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYADDNMINS'' ) THEN (CURRENT_DATE-IND.BIRTH_DT) / 365  END AS  NAME_INSRD_AGE_DESC_AGE, 

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYPRININS'') THEN SA.ADDR_LN_1_TXT END AS PRMRY_INSRD_ADDR_DESC_ADD,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''SVC''  AND  PLOC.LOCTR_USGE_TYPE_CD IN (''BUSN'')) THEN SA.ADDR_LN_1_TXT END AS SLS_SRVC_CTR_ADDR_ADD, 

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYPRININS''  AND  PADR.PRTY_ADDR_USGE_TYPE_CD=''PREMAIL'') THEN ELADR.ELCTRNC_ADDR_TXT END AS INSRD_EML_TXT_ADD ,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYPRININS''  AND  PADR.PRTY_ADDR_USGE_TYPE_CD=''HOMEPHN'') THEN DB_T_PROD_CORE.TLPHN_NUM END AS  INSRD_TLPHN_NUM_NM    ,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYDRVR''  ) THEN PDH.PNLTY_PNTS_CNT END AS  DRVR_PNT_DESC_CNT  ,

CASE WHEN (PQU.PRTY_QUOTN_ROLE_CD=''PLCYPRININS'' ) THEN T.GEOGRCL_AREA_NAME  END AS INSRD_LIC_ST_NAME_NM

FROM 

(select * from DB_T_PROD_CORE.PRTY_QUOTN WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''  ) PQU 

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.INDIV  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') IND ON PQU.PRTY_ID= IND.INDIV_PRTY_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.INDIV_NAME WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) INM ON PQU.PRTY_ID = INM.INDIV_PRTY_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.INDIV_MRTL_STS WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' ) INMS ON PQU.PRTY_ID=INMS.INDIV_PRTY_ID

LEFT OUTER JOIN DB_T_PROD_CORE.MRTL_STS_TYPE MST ON INMS.MRTL_STS_CD = MST.MRTL_STS_CD

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.PRTY_LOCTR WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' ) PLOC ON PQU.PRTY_ID = PLOC.PRTY_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.STREET_ADDR WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) SA ON PLOC.LOC_ID =  SA.STREET_ADDR_ID

LEFT OUTER JOIN ( SELECT * FROM DB_T_PROD_CORE.PRTY_ADDR WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) PADR ON PQU.PRTY_ID = PADR.PRTY_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.ELCTRNC_ADDR WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) ELADR ON PADR.LOC_ID = ELADR.ELCTRNC_ADDR_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.TLPHN_NUM WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) TN ON PADR.LOC_ID = TN.TLPHN_NUM_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.PRTY_DRVG_HIST WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  ) PDH ON PQU.PRTY_ID = PDH.INDIV_PRTY_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.TERR WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' ) T ON SA.TERR_ID = T.TERR_ID

LEFT OUTER JOIN (SELECT * FROM DB_T_PROD_CORE.PRTY_DRVG_LIC_HIST WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' )  PDLH ON (PQU.PRTY_ID = PDLH.PRTY_ID AND T.TERR_ID = PDLH.DRVRS_LIC_TERR_ID)

) PRTYAGT_DET) AS PRTYAGT_DET

GROUP BY QUOTN_ID

) QU_PRTY ON INSQTN.QUOTN_ID = QU_PRTY.QUOTN_ID

LEFT OUTER JOIN

(SELECT QUOTN_ID,HIER.SALES_HIERAR_ID, HIER.DSTRCT_NBR AS SLS_RGN_DSTRCT_NAME, HIER.RGN_NBR AS SLS_RGN_ST_NAME, HIER.SALES_ST_NM AS PLCY_ORIG_ST_NAME

FROM

(SELECT * FROM DB_T_PROD_CORE.PRTY_QUOTN WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND  PRTY_QUOTN_ROLE_CD = ''SVC'' )QU_PR

INNER JOIN 

(SELECT 

PA.INTRNL_ORG_PRTY_ID AS SALES_HIERAR_ID

,ORG_NAME AS SRVC_CTR_NM ,PA.INTRNL_ORG_NUM   AS SRVC_CTR_NBR

,PA1.INTRNL_ORG_NUM AS DSTRCT_NBR ,ORG_NAME  AS DSTRCT_NM

,PA2.INTRNL_ORG_NUM AS RGN_NBR ,ORG_NAME  AS RGN_NM

,ORG_NAME  AS SALES_ST_NM

FROM    

(SELECT * FROM DB_T_PROD_CORE.INTRNL_ORG WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) PA 

JOIN (SELECT * FROM DB_T_PROD_CORE.ORG_NAME WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' )  ORN   ON  ORN.PRTY_ID = PA.INTRNL_ORG_PRTY_ID

JOIN (SELECT * FROM DB_T_PROD_CORE.PRTY_RLTD  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')  IND ON  IND.RLTD_PRTY_ID = PA.INTRNL_ORG_PRTY_ID AND   IND.PRTY_RLTD_ROLE_CD =''SLSHRCHY''

JOIN  (SELECT * FROM DB_T_PROD_CORE.INTRNL_ORG  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')   PA1 ON IND.PRTY_ID = PA1.INTRNL_ORG_PRTY_ID

JOIN   (SELECT * FROM DB_T_PROD_CORE.ORG_NAME  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')   ORN1  ON  ORN1.PRTY_ID = PA1.INTRNL_ORG_PRTY_ID

JOIN  (SELECT * FROM DB_T_PROD_CORE.PRTY_RLTD  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')   IND1  ON IND1.RLTD_PRTY_ID = PA1.INTRNL_ORG_PRTY_ID AND IND1.PRTY_RLTD_ROLE_CD =''SLSHRCHY''

JOIN  (SELECT * FROM DB_T_PROD_CORE.INTRNL_ORG  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')   PA2  ON  IND1.PRTY_ID = PA2.INTRNL_ORG_PRTY_ID

JOIN (SELECT * FROM DB_T_PROD_CORE.ORG_NAME WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' )  ORN2  ON  ORN2.PRTY_ID = PA2.INTRNL_ORG_PRTY_ID

JOIN  (SELECT * FROM DB_T_PROD_CORE.PRTY_RLTD  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')  IND2  ON  IND2.RLTD_PRTY_ID = PA2.INTRNL_ORG_PRTY_ID  AND IND2.PRTY_RLTD_ROLE_CD =''SLSHRCHY''

JOIN  (SELECT * FROM DB_T_PROD_CORE.INTRNL_ORG  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'')  PA3  ON  IND2.PRTY_ID = PA3.INTRNL_ORG_PRTY_ID

JOIN  (SELECT * FROM DB_T_PROD_CORE.ORG_NAME WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) ORN3  ON ORN3.PRTY_ID = PA3.INTRNL_ORG_PRTY_ID

WHERE PA.INTRNL_ORG_SBTYPE_CD =''SERVICECENTER_ALFA''



GROUP BY 1,2,3,4,5,6,7,8
qualify row_number ()  over  ( partition by  PA.INTRNL_ORG_PRTY_ID,DB_T_PROD_CORE.ORG_NAME,PA.INTRNL_ORG_NUM,PA1.INTRNL_ORG_NUM,

DB_T_PROD_CORE.ORG_NAME,PA2.INTRNL_ORG_NUM,DB_T_PROD_CORE.ORG_NAME order by (DB_T_PROD_CORE.ORG_NAME ) desc )=1
)   HIER ON QU_PR.PRTY_ID = HIER.SALES_HIERAR_ID

) QU_HIER ON QU_HIER.QUOTN_ID = INSQTN.QUOTN_ID



LEFT OUTER JOIN

(SELECT

QUAG.QUOTN_ID,

AG.*, 

((cast(AG.AGMT_PLND_EXPN_DT AS date) - cast(AG.AGMT_OPN_DTTM as date))/30) As  PLCY_TERM_TYPE_CALC, 

AG_SCR.AGMT_SCR_VAL, 

AG_MBR.AGMT_MBRSHP_STRT_DT ,

AG_MBR.MBR_TYPE_DESC,

AG_MBR.MBR_NUM,

ev_sts_rsn_type.PLCY_RJCTN_RSN_DESC,

trans_ty_desc.TRANS_CLSD_DT,

trans_ty_desc.TRANS_TYPE_DESC,

AG_CO_TO_CO.CO_TO_CO_TFR_DESC,

AG_LOB.LOB,

AG_LOB.PLCY_TYPE_DESC,

AG_LOB.PROD_LN_DESC,

AG_PLCYMTR.TOT_WRTN_PREM_AMT,

AG_PLCYMTR.ANULZD_TOT_WRTN_PREM_AMT,

AG_PLCYMTRTOTCOST.PLCY_TOT_COST_AMT,

AG_PLCYMTRPREMDUE.PREM_DUE_AMT,

AG_STS.PLCY_CNCLTN_SRC_DESC,

AG_RNEWL_STS.RNEWL_STS,

AG_AUTO_LP.AUTO_LATE_PAY_NUM,

AG_PLCY_ACCTDT.PLCY_ACCNTG_DT,

AG_EXCLN_WAIVD_RSN_DESC.EXCLN_WAIVD_RSN_DESC,

AG_PREMBILLD.PREM_BILD_AMT

FROM

(SELECT * FROM  DB_T_PROD_CORE.QUOTN_AGMT WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') QUAG

INNER JOIN

(SELECT * FROM  DB_T_PROD_CORE.AGMT WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''  and AGMT_TYPE_CD = ''PPV'')  AG ON QUAG.AGMT_ID = AG.AGMT_ID

LEFT OUTER JOIN (SELECT * FROM  DB_T_PROD_CORE.AGMT_SCR  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'')AG_SCR ON AG.AGMT_ID = AG_SCR.AGMT_ID

LEFT OUTER JOIN 

(

SELECT AGMT_ID, MBRSHP_TYPE_DESC AS MBR_TYPE_DESC , AGMT_MBRSHP_STRT_DT, MBRSHP_NUM as MBR_NUM

FROM

(SELECT * FROM  DB_T_PROD_CORE.AGMT_MBRSHP WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'') AGMBR 

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.MBRSHP WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' ) MBRSHP ON AGMBR.MBRSHP_ID = MBRSHP.MBRSHP_ID

LEFT OUTER JOIN DB_T_PROD_CORE.MBRSHP_TYPE ON MBRSHP_TYPE.MBRSHP_TYPE_CD = MBRSHP.MBRSHP_TYPE_CD ) AG_MBR ON AG.AGMT_ID = AG_MBR.AGMT_ID

LEFT OUTER JOIN

(

SELECT    AGMT_ID,INSLOB. INSRNC_LOB_TYPE_DESC AS LOB, PROD.PROD_DESC AS PLCY_TYPE_DESC, PROD.PROD_NAME AS PROD_LN_DESC  FROM

(SELECT * FROM DB_T_PROD_CORE.AGMT_PROD WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  ) AGMT_PROD

INNER JOIN DB_T_PROD_CORE.PROD ON  AGMT_PROD.PROD_ID = PROD.PROD_ID

LEFT OUTER JOIN DB_T_PROD_CORE.INSRNC_LOB_TYPE INSLOB ON PROD.INSRNC_LOB_TYPE_CD = INSLOB.INSRNC_LOB_TYPE_CD)AG_LOB ON AG.AGMT_ID = AG_LOB.AGMT_ID

LEFT OUTER JOIN

(SELECT  AGMT_ID,    EV_ACTVY_TYPE_CD AS  TRANS_TYPE_DESC  , EV_END_DTTM AS TRANS_CLSD_DT  

FROM (SELECT * FROM DB_T_PROD_CORE.EV WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999''  AND EV_SBTYPE_CD = ''PLCYTRNS''

AND AGMT_ID IS NOT NULL) trans_desc ) trans_ty_desc ON trans_ty_desc.AGMT_ID = AG.AGMT_ID 



LEFT OUTER JOIN

(SELECT    EV_STS_RSN_CD AS PLCY_RJCTN_RSN_DESC,QU_AG.AGMT_ID

 FROM

(SELECT * FROM DB_T_PROD_CORE.QUOTN_AGMT WHERE  TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999'') QU_AG 

INNER JOIN

(SELECT * FROM DB_T_PROD_CORE.EV_STS WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999'' ) EV_STS ON QU_AG.QUOTN_ID = EV_STS.QUOTN_ID

INNER JOIN

(SELECT * FROM DB_T_PROD_CORE.EV_STS_RSN WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999'' ) EV_STS_RSN ON EV_STS.EV_ID = EV_STS_RSN.EV_ID

 ) ev_sts_rsn_type ON ev_sts_rsn_type.AGMT_ID = AG.AGMT_ID

LEFT OUTER JOIN 

(

SELECT DISTINCT AGMT_ID , CTE.CHNL_TYPE_DESC as CO_TO_CO_TFR_DESC FROM 

(SELECT * FROM DB_T_PROD_CORE.AGMT_CHNL_TYPE WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999'')  ACT

INNER JOIN DB_T_PROD_CORE.CHNL_TYPE CTE ON  ACT.CHNL_TYPE_CD = CTE.CHNL_TYPE_CD

) AG_CO_TO_CO  ON AG_CO_TO_CO.AGMT_ID = AG.AGMT_ID

LEFT OUTER JOIN

(

SELECT PM.AGMT_ID, PM.PLCY_AMT  As  TOT_WRTN_PREM_AMT,

PM.PLCY_AMT  / ( (PM.PLCY_MTRC_END_DT - PM.PLCY_MTRC_STRT_DT)/30.0)   * 12  AS ANULZD_TOT_WRTN_PREM_AMT

FROM DB_T_PROD_CORE.PLCY_MTRC  PM    WHERE TO_CHAR(PM.EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  AND PM.INSRNC_MTRC_TYPE_CD = ''PREM''

)  AG_PLCYMTR ON AG.AGMT_ID = AG_PLCYMTR.AGMT_ID



LEFT OUTER JOIN

(

SELECT PM.AGMT_ID, PM.PLCY_AMT  As  PLCY_TOT_COST_AMT

FROM DB_T_PROD_CORE.PLCY_MTRC  PM    WHERE TO_CHAR(PM.EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  AND PM.INSRNC_MTRC_TYPE_CD = ''TTLPLCYCST''

)  AG_PLCYMTRTOTCOST ON AG.AGMT_ID = AG_PLCYMTRTOTCOST.AGMT_ID



LEFT OUTER JOIN

(

SELECT PM.AGMT_ID, PM.PLCY_AMT  As  PREM_DUE_AMT

FROM DB_T_PROD_CORE.PLCY_MTRC  PM    WHERE TO_CHAR(PM.EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  AND PM.INSRNC_MTRC_TYPE_CD = ''PREMDUE''

)  AG_PLCYMTRPREMDUE ON AG.AGMT_ID = AG_PLCYMTRPREMDUE.AGMT_ID

LEFT OUTER JOIN   

(

SELECT IA.AGMT_ID,  AGMT_STS_SRC_TYPE_CD AS PLCY_CNCLTN_SRC_DESC  FROM

(

SELECT DISTINCT  HOST_AGMT_NUM, AGMT_STS_SRC_TYPE_CD, AST.AGMT_ID  FROM

(SELECT  *  FROM DB_T_PROD_CORE.AGMT_STS WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND  AGMT_STS_CD = ''CNCLD'' ) AST

INNER JOIN (SELECT HOST_AGMT_NUM , AGMT_ID FROM DB_T_PROD_CORE.AGMT WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND AGMT_TYPE_CD = ''PPV'') A

ON  AST.AGMT_ID= A.AGMT_ID) POL

INNER JOIN (SELECT  * FROM DB_T_PROD_CORE.AGMT WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND AGMT_TYPE_CD = ''PPV'') IA

ON POL.HOST_AGMT_NUM = IA.HOST_AGMT_NUM AND POL.AGMT_ID <> IA.AGMT_ID

) AG_STS ON AG.AGMT_ID = AG_STS.AGMT_ID





LEFT OUTER JOIN

(SELECT  AGMT_ID,   CASE WHEN EV_ACTVY_TYPE_CD = ''RENEWAL'' THEN ''Renewed'' else ''Non Renewed'' end as RNEWL_STS

FROM (SELECT * FROM DB_T_PROD_CORE.EV WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999''  AND EV_SBTYPE_CD = ''PLCYTRNS''

AND AGMT_ID <> -1) agrnwl_sts ) AG_RNEWL_STS ON AG_RNEWL_STS.AGMT_ID = AG.AGMT_ID



LEFT OUTER JOIN

(

SELECT PM.AGMT_ID, SUM(PM.PLCY_CNT) AS AUTO_LATE_PAY_NUM

FROM  (SELECT * FROM  DB_T_PROD_CORE.PLCY_MTRC    WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  AND INSRNC_MTRC_TYPE_CD IN ( ''10DLTPY'', ''3DLTPY'') ) PM

INNER JOIN DB_T_PROD_CORE.AGMT_PROD AP ON PM.AGMT_ID = AP.AGMT_ID

INNER JOIN (SELECT * FROM DB_T_PROD_CORE.PROD WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  AND INSRNC_TYPE_CD = ''AUTO'') P ON AP.PROD_ID = P.PROD_ID

GROUP BY PM.AGMT_ID

) AG_AUTO_LP ON AG_AUTO_LP.AGMT_ID = AG.AGMT_ID

LEFT OUTER JOIN

(

SELECT  distinct AGMT_ID,to_date( ACCNTG_DY_NUM ||''/''||

CASE WHEN LENGTH(ACCNTG_MTH_NUM) = 1 THEN ''0''||ACCNTG_MTH_NUM ELSE ACCNTG_MTH_NUM END

||''/''||ACCNTG_YR_NUM, ''dd/mm/yyyy'') as PLCY_ACCNTG_DT

FROM (SELECT * FROM DB_T_PROD_CORE.EV WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999''  AND EV_SBTYPE_CD = ''PLCYTRNS'' AND AGMT_ID IS NOT NULL) EV

INNER JOIN (SELECT   *   FROM DB_T_PROD_CORE.FINCL_EV WHERE TO_CHAR(EDW_END_DTTM,''MM/DD/YYYY'')=  ''12/31/9999''  ) FINCL_EV ON EV.EV_ID = FINCL_EV.EV_ID

 ) AG_PLCY_ACCTDT ON AG_PLCY_ACCTDT.AGMT_ID = AG.AGMT_ID



LEFT OUTER JOIN

(

SELECT PAF.AGMT_ID,

 F.FEAT_NAME AS EXCLN_WAIVD_RSN_DESC   

FROM

(SELECT * FROM DB_T_PROD_CORE.AGMT_PRTY_FEAT  WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND PRTY_AGMT_ROLE_CD = ''DRV'') PAF

INNER  JOIN (SELECT * FROM DB_T_PROD_CORE.FEAT WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND FEAT_SBTYPE_CD IN (''WVRSN'',''MMBREXLSN'' )) F ON  PAF.FEAT_ID = F.FEAT_ID

) AG_EXCLN_WAIVD_RSN_DESC ON AG_EXCLN_WAIVD_RSN_DESC.AGMT_ID = AG.AGMT_ID 

LEFT OUTER JOIN

(SELECT  AGMT_ID , PLCY_AMT- FEE AS PREM_BILD_AMT FROM

(

SELECT PM.AGMT_ID, PM.PLCY_AMT, CASE WHEN FEECALC.FEE IS NULL THEN 0 ELSE FEECALC.FEE END AS FEE

FROM 

(SELECT * FROM DB_T_PROD_CORE.PLCY_MTRC  PM    WHERE TO_CHAR(PM.EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999''  AND PM.INSRNC_MTRC_TYPE_CD = ''PREM'') PM

LEFT OUTER JOIN 

(

SELECT EV.AGMT_ID, EV_TRANS_AMT AS FEE

FROM 

(SELECT  EV_ID, AGMT_ID FROM DB_T_PROD_CORE.EV WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND (AGMT_ID IS NOT NULL AND  AGMT_ID <> -1)) EV

INNER JOIN

(SELECT EV_ID, FINCL_EV_AMT_TYPE_CD, EV_TRANS_AMT FROM DB_T_PROD_CORE.FINCL_EV_AMT WHERE  TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' 

AND FINCL_EV_AMT_TYPE_CD = ''FEE'' ) FEA ON EV.EV_ID = FEA.EV_ID

) FEECALC ON PM.AGMT_ID = FEECALC.AGMT_ID) PREMBILLD) AG_PREMBILLD ON  AG_PREMBILLD.AGMT_ID = AG.AGMT_ID 

) AGMT ON INSQTN.QUOTN_ID = AGMT.QUOTN_ID

) AGMT
) SRC
)
);


-- PIPELINE START FOR 3

-- Component SQ_QUOTES_AGMT_COV, Type SOURCE 
CREATE OR REPLACE TEMPORARY TABLE SQ_QUOTES_AGMT_COV AS
(
SELECT /* adding column aliases to ensure proper downstream column references */
$1 as QUOTN_ID,
$2 as CVGE_AMT,
$3 as CVGE_CD,
$4 as CVGE_DESC,
$5 as DEDCTB_AMT,
$6 as BODILY_INJRY_LMT_AMT,
$7 as LIABTY_ONLY_IND,
$8 as PRPTY_DMG_LMT_AMT,
$9 as DWLNG_CVGE_AMT,
$10 as PERSNL_PRPTY_CVGE_AMT,
$11 as DWLNG_CVGE_LMT_AMT,
$12 as MULT_CAR_DSCNT_IND,
$13 as LIF_PLCY_DSCNT_IND,
$14 as HOME_OWNRSHP_DSCNT_IND,
$15 as PRPTY_VALUT_METH_DESC,
$16 as DWLNG_VALUT_METH_NAME,
$17 as WIND_AND_HAIL_EXCLDD_IND,
$18 as COMBO_DSCNT_IND,
$19 as AUTO_DSCNT_IND,
$20 as NEW_HOME_DSCNT_PCTG,
$21 as VAL_CLNT_DSCNT_PCTG,
$22 as HOME_ALRT_DSCNT_PCTG,
$23 as LATE_PMT_PCTG,
$24 as PERSNL_PRPTY_CVGE_LMT_AMT,
$25 as OTH_STRC_CVGE_LMT_AMT,
$26 as LOSS_OF_USE_CVGE_LMT_AMT,
$27 as source_record_id
FROM (
SELECT SRC.*, row_number() over (order by 1) AS source_record_id FROM (
SELECT 

distinct

AGMT.INS_QUOTN_ID AS QUOTN_ID

,AGMT.CVGE_AMT

,AGMT.CVGE_CD

,AGMT.CVGE_DESC

,AGMT.DEDCTB_AMT

,AGMT.BODILY_INJRY_LMT_AMT

,AGMT.LIABTY_ONLY_IND

,AGMT.PRPTY_DMG_LMT_AMT

,AGMT.DWLNG_CVGE_AMT

,AGMT.PERSNL_PRPTY_CVGE_AMT

,AGMT.DWLNG_CVGE_LMT_AMT

,AGMT.MULT_CAR_DSCNT_IND

,AGMT.LIF_PLCY_DSCNT_IND

,AGMT.HOME_OWNRSHP_DSCNT_IND

,AGMT.PRPTY_VALUT_METH_DESC

,AGMT.DWLNG_VALUT_METH_NAME

,AGMT.WIND_AND_HAIL_EXCLDD_IND

,AGMT.COMBO_DSCNT_IND

,AGMT.AUTO_DSCNT_IND

,AGMT.NEW_HOME_DSCNT_PCTG

,AGMT.VAL_CLNT_DSCNT_PCTG

,AGMT.HOME_ALRT_DSCNT_PCTG

,AGMT.LATE_PMT_PCTG

,AGMT.PERSNL_PRPTY_CVGE_LMT_AMT

,AGMT.OTH_STRC_CVGE_LMT_AMT

,AGMT.LOSS_OF_USE_CVGE_LMT_AMT

FROM

(SELECT 

INSQTN.QUOTN_ID AS INS_QUOTN_ID,

QU_COV.CVGE_AMT,

QU_COV.CVGE_CD,

QU_COV.CVGE_DESC,

QU_COV.DEDCTB_AMT,

QU_COV.BODILY_INJRY_LMT_AMT,

QU_COV.LIABTY_ONLY_IND,

QU_COV.PRPTY_DMG_LMT_AMT,

QU_COV.DWLNG_CVGE_AMT,

QU_COV.PERSNL_PRPTY_CVGE_AMT,

QU_COV.DWLNG_CVGE_LMT_AMT,

QU_COV.MULT_CAR_DSCNT_IND,

QU_COV.LIF_PLCY_DSCNT_IND,

QU_COV.HOME_OWNRSHP_DSCNT_IND,

QU_COV.PRPTY_VALUT_METH_DESC,

QU_COV.DWLNG_VALUT_METH_NAME,

QU_COV.WIND_AND_HAIL_EXCLDD_IND,

QU_COV.COMBO_DSCNT_IND,

QU_COV.AUTO_DSCNT_IND,

QU_COV.NEW_HOME_DSCNT_PCTG,

QU_COV.VAL_CLNT_DSCNT_PCTG,

QU_COV.HOME_ALRT_DSCNT_PCTG,

QU_COV.LATE_PMT_PCTG,

QU_COV.PERSNL_PRPTY_CVGE_LMT_AMT,

QU_COV.OTH_STRC_CVGE_LMT_AMT,

QU_COV.LOSS_OF_USE_CVGE_LMT_AMT

FROM 

(SELECT DISTINCT QUOTN_ID FROM DB_T_PROD_CORE.INSRNC_QUOTN WHERE TO_CHAR(EDW_END_DTTM, ''MM/DD/YYYY'') = ''12/31/9999'' AND QUOTN_SBTYPE_CD IN (''SBMSSN'',''RENEWAL'',''PLCYCHG''))   INSQTN

LEFT OUTER JOIN

(SELECT

QUOTN_FEAT.QUOTN_ID,

CASE WHEN QUOTN_FEAT.CVGE_AMT IS NULL OR QUOTN_FEAT.CVGE_AMT = 0 THEN AGMT_FEAT.CVGE_AMT ELSE QUOTN_FEAT.CVGE_AMT END AS CVGE_AMT,

CASE WHEN QUOTN_FEAT.CVGE_CD IS NULL THEN AGMT_FEAT.CVGE_CD ELSE QUOTN_FEAT.CVGE_CD END AS CVGE_CD,

CASE WHEN QUOTN_FEAT.CVGE_DESC IS NULL THEN AGMT_FEAT.CVGE_DESC ELSE QUOTN_FEAT.CVGE_DESC END AS CVGE_DESC,

CASE WHEN QUOTN_FEAT.DEDCTB_AMT IS NULL THEN AGMT_FEAT.DEDCTB_AMT ELSE QUOTN_FEAT.DEDCTB_AMT END AS DEDCTB_AMT,

CASE WHEN QUOTN_FEAT.BODILY_INJRY_LMT_AMT IS NULL THEN AGMT_FEAT.BODILY_INJRY_LMT_AMT ELSE QUOTN_FEAT.BODILY_INJRY_LMT_AMT END AS BODILY_INJRY_LMT_AMT,

CASE WHEN QUOTN_FEAT.LIABTY_ONLY_IND IS NULL THEN AGMT_FEAT.LIABTY_ONLY_IND ELSE QUOTN_FEAT.LIABTY_ONLY_IND END AS LIABTY_ONLY_IND,

CASE WHEN QUOTN_FEAT.PRPTY_DMG_LMT_AMT IS NULL THEN AGMT_FEAT.PRPTY_DMG_LMT_AMT ELSE QUOTN_FEAT.PRPTY_DMG_LMT_AMT END AS PRPTY_DMG_LMT_AMT,

CASE WHEN QUOTN_FEAT.DWLNG_CVGE_AMT IS NULL THEN AGMT_FEAT.DWLNG_CVGE_AMT ELSE QUOTN_FEAT.DWLNG_CVGE_AMT END AS DWLNG_CVGE_AMT,

CASE WHEN QUOTN_FEAT.PERSNL_PRPTY_CVGE_AMT IS NULL THEN AGMT_FEAT.PERSNL_PRPTY_CVGE_AMT ELSE QUOTN_FEAT.PERSNL_PRPTY_CVGE_AMT END AS PERSNL_PRPTY_CVGE_AMT,

CASE WHEN QUOTN_FEAT.DWLNG_CVGE_LMT_AMT IS NULL THEN AGMT_FEAT.DWLNG_CVGE_LMT_AMT ELSE QUOTN_FEAT.DWLNG_CVGE_LMT_AMT END AS DWLNG_CVGE_LMT_AMT,

CASE WHEN QUOTN_FEAT.MULT_CAR_DSCNT_IND IS NULL THEN AGMT_FEAT.MULT_CAR_DSCNT_IND ELSE QUOTN_FEAT.MULT_CAR_DSCNT_IND END AS MULT_CAR_DSCNT_IND,

CASE WHEN QUOTN_FEAT.LIF_PLCY_DSCNT_IND IS NULL THEN AGMT_FEAT.LIF_PLCY_DSCNT_IND ELSE QUOTN_FEAT.LIF_PLCY_DSCNT_IND END AS LIF_PLCY_DSCNT_IND,

CASE WHEN QUOTN_FEAT.HOME_OWNRSHP_DSCNT_IND IS NULL THEN AGMT_FEAT.HOME_OWNRSHP_DSCNT_IND ELSE QUOTN_FEAT.HOME_OWNRSHP_DSCNT_IND END AS HOME_OWNRSHP_DSCNT_IND,

CASE WHEN QUOTN_FEAT.PRPTY_VALUT_METH_DESC IS NULL THEN AGMT_FEAT.PRPTY_VALUT_METH_DESC ELSE QUOTN_FEAT.PRPTY_VALUT_METH_DESC END AS PRPTY_VALUT_METH_DESC,

CASE WHEN QUOTN_FEAT.DWLNG_VALUT_METH_NAME IS NULL THEN AGMT_FEAT.DWLNG_VALUT_METH_NAME ELSE QUOTN_FEAT.DWLNG_VALUT_METH_NAME END AS DWLNG_VALUT_METH_NAME,

CASE WHEN QUOTN_FEAT.WIND_AND_HAIL_EXCLDD_IND IS NULL THEN AGMT_FEAT.WIND_AND_HAIL_EXCLDD_IND ELSE QUOTN_FEAT.WIND_AND_HAIL_EXCLDD_IND END AS WIND_AND_HAIL_EXCLDD_IND,

CASE WHEN QUOTN_FEAT.COMBO_DSCNT_IND IS NULL THEN AGMT_FEAT.COMBO_DSCNT_IND ELSE QUOTN_FEAT.COMBO_DSCNT_IND END AS COMBO_DSCNT_IND,

CASE WHEN QUOTN_FEAT.AUTO_DSCNT_IND IS NULL THEN AGMT_FEAT.AUTO_DSCNT_IND ELSE QUOTN_FEAT.AUTO_DSCNT_IND END AS AUTO_DSCNT_IND,

CASE WHEN QUOTN_FEAT.NEW_HOME_DSCNT_PCTG IS NULL OR QUOTN_FEAT.NEW_HOME_DSCNT_PCTG = 0 THEN AGMT_FEAT.NEW_HOME_DSCNT_PCTG ELSE QUOTN_FEAT.NEW_HOME_DSCNT_PCTG END AS NEW_HOME_DSCNT_PCTG,

CASE WHEN QUOTN_FEAT.VAL_CLNT_DSCNT_PCTG IS NULL OR QUOTN_FEAT.VAL_CLNT_DSCNT_PCTG = 0  THEN AGMT_FEAT.VAL_CLNT_DSCNT_PCTG ELSE QUOTN_FEAT.VAL_CLNT_DSCNT_PCTG END AS VAL_CLNT_DSCNT_PCTG,

CASE WHEN QUOTN_FEAT.HOME_ALRT_DSCNT_PCTG IS NULL OR QUOTN_FEAT.HOME_ALRT_DSCNT_PCTG = 0   THEN AGMT_FEAT.HOME_ALRT_DSCNT_PCTG ELSE QUOTN_FEAT.HOME_ALRT_DSCNT_PCTG END AS HOME_ALRT_DSCNT_PCTG,

CASE WHEN QUOTN_FEAT.LATE_PMT_PCTG IS NULL  OR QUOTN_FEAT.LATE_PMT_PCTG = 0  THEN AGMT_FEAT.LATE_PMT_PCTG ELSE QUOTN_FEAT.LATE_PMT_PCTG END AS LATE_PMT_PCTG,

CASE WHEN QUOTN_FEAT.PERSNL_PRPTY_CVGE_LMT_AMT IS NULL THEN AGMT_FEAT.PERSNL_PRPTY_CVGE_LMT_AMT ELSE QUOTN_FEAT.PERSNL_PRPTY_CVGE_LMT_AMT END AS PERSNL_PRPTY_CVGE_LMT_AMT,

CASE WHEN QUOTN_FEAT.OTH_STRC_CVGE_LMT_AMT IS NULL THEN AGMT_FEAT.OTH_STRC_CVGE_LMT_AMT ELSE QUOTN_FEAT.OTH_STRC_CVGE_LMT_AMT END AS OTH_STRC_CVGE_LMT_AMT,

CASE WHEN QUOTN_FEAT.LOSS_OF_USE_CVGE_LMT_AMT IS NULL THEN AGMT_FEAT.LOSS_OF_USE_CVGE_LMT_AMT ELSE QUOTN_FEAT.LOSS_OF_USE_CVGE_LMT_AMT END AS LOSS_OF_USE_CVGE_LMT_AMT

FROM

(select 

QAG.AGMT_ID,

QU_FE.* FROM

(SELECT

FEAT_DET.QUOTN_ID, 

MAX(CVGE_AMT) AS CVGE_AMT,

MAX(CVGE_CD) AS CVGE_CD,

MAX(CVGE_DESC) AS CVGE_DESC,

MAX(DEDCTB_AMT) AS DEDCTB_AMT,

MAX(BODILY_INJRY_LMT_AMT) AS BODILY_INJRY_LMT_AMT,

MAX(LIABTY_ONLY_IND) AS LIABTY_ONLY_IND,

MAX(PRPTY_DMG_LMT_AMT) AS PRPTY_DMG_LMT_AMT,

MAX(DWLNG_CVGE_AMT) AS DWLNG_CVGE_AMT,

MAX(PERSNL_PRPTY_CVGE_AMT) AS PERSNL_PRPTY_CVGE_AMT,

MAX(DWLNG_CVGE_LMT_AMT) AS DWLNG_CVGE_LMT_AMT ,

MAX(MULT_CAR_DSCNT_IND) AS MULT_CAR_DSCNT_IND,

MAX(LIF_PLCY_DSCNT_IND) AS LIF_PLCY_DSCNT_IND,

MAX(HOME_OWNRSHP_DSCNT_IND) AS HOME_OWNRSHP_DSCNT_IND,

MAX(PRPTY_VALUT_METH_DESC) AS PRPTY_VALUT_METH_DESC,

MAX(DWLNG_VALUT_METH_NAME) AS DWLNG_VALUT_METH_NAME,

MAX(WIND_AND_HAIL_EXCLDD_IND) AS WIND_AND_HAIL_EXCLDD_IND,

MAX(COMBO_DSCNT_IND) AS COMBO_DSCNT_IND ,

MAX(AUTO_DSCNT_IND) AS AUTO_DSCNT_IND,

MAX(NEW_HOME_DSCNT_PCTG)  AS NEW_HOME_DSCNT_PCTG,

MAX(VAL_CLNT_DSCNT_PCTG)  AS  VAL_CLNT_DSCNT_PCTG,

MAX(HOME_ALRT_DSCNT_PCTG)  AS HOME_ALRT_DSCNT_PCTG,

MAX(LATE_PMT_PCTG) AS LATE_PMT_PCTG,

MAX(PERSNL_PRPTY_CVGE_LMT_AMT) AS PERSNL_PRPTY_CVGE_LMT_AMT,

MAX(OTH_STRC_CVGE_LMT_AMT) AS OTH_STRC_CVGE_LMT_AMT,

MAX(LOSS_OF_USE_CVGE_LMT_AMT) AS LOSS_OF_USE_CVGE_LMT_AMT

FROM

(SELECT FEAT_DET.QUOTN_ID,

FEAT_DET.FEAT_DTL_VAL AS CVGE_AMT,

FEAT_DET.INSRNC_CVGE_TYPE_DESC AS CVGE_CD,

FEAT_DET.FEAT_NAME AS  CVGE_DESC,

FEAT_DET.QUOTN_FEAT_AMT_DEDCTB AS  DEDCTB_AMT,

FEAT_DET.QUOTN_FEAT_AMT_BODILY AS  BODILY_INJRY_LMT_AMT,

FEAT_DET.INSRNC_CVGE_TYPE_CD_LIABTY AS  LIABTY_ONLY_IND,

FEAT_DET.QUOTN_FEAT_AMT_PRPTY AS  PRPTY_DMG_LMT_AMT,

FEAT_DET.QUOTN_FEAT_AMT_COV AS  DWLNG_CVGE_AMT,

FEAT_DET.QUOTN_FEAT_AMT_PERSNL AS PERSNL_PRPTY_CVGE_AMT,

FEAT_DET.QUOTN_FEAT_AMT_COV_LIM AS  DWLNG_CVGE_LMT_AMT,

FEAT_DET.MULT_CAR_DSCNT_IND,

FEAT_DET.LIF_PLCY_DSCNT_IND,

FEAT_DET.HOME_OWNRSHP_DSCNT_IND,

FEAT_DET.PRPTY_VALUT_METH_DESC,

FEAT_DET.DWLNG_VALUT_METH_NAME,

FEAT_DET.WIND_AND_HAIL_EXCLDD_IND,

FEAT_DET.COMBO_DSCNT_IND,

FEAT_DET.AUTO_DSCNT_IND,

FEAT_DET.NEW_HOME_DSCNT_PCTG,

FEAT_DET.VAL_CLNT_DSCNT_PCTG,

FEAT_DET.HOME_ALRT_DSCNT_PCTG,

FEAT_DET.LATE_PMT_PCTG,

FEAT_DET.PERSNL_PRPTY_CVGE_LMT_AMT,

FEAT_DET.OTH_STRC_CVGE_LMT_AMT,

FEAT_DET.LOSS_OF_USE_CVGE_LMT_AMT

FROM

(SELECT  AG_FE.QUOTN_ID,  F.FEAT_DTL_VAL , insr.INSRNC_CVGE_TYPE_DESC, F.FEAT_NAME,

CASE WHEN  F.FEAT_DTL_MODL_TYPE_NAME = ''DEDUCTIBLE''  THEN AG_FE.QUOTN_FEAT_AMT  ELSE NULL END AS QUOTN_FEAT_AMT_DEDCTB,

CASE WHEN  F.INSRNC_CVGE_TYPE_CD=  ''BI'' AND F.FEAT_DTL_MODL_TYPE_NAME= ''Limit'' THEN  F.FEAT_DTL_CD_NAME  ELSE NULL END AS QUOTN_FEAT_AMT_BODILY,

CASE WHEN ( (F.COMN_FEAT_NAME <> ''COLLISION'' AND  F.COMN_FEAT_NAME <> ''COMPREHENSIVE'' ) AND

F.INSRNC_LOB_TYPE_CD=''PERSONAL AUTO/WATERCRAFT LINE'') THEN F.INSRNC_CVGE_TYPE_CD END AS  INSRNC_CVGE_TYPE_CD_LIABTY,

CASE WHEN  F.INSRNC_CVGE_TYPE_CD=  ''PD'' AND F.FEAT_DTL_MODL_TYPE_NAME= ''Limit'' THEN AG_FE.QUOTN_FEAT_AMT  ELSE NULL END AS QUOTN_FEAT_AMT_PRPTY,

CASE WHEN  F.NK_SRC_KEY = ''HODW_DWELLING_COV_HOE'' THEN AG_FE.QUOTN_FEAT_AMT  ELSE NULL END AS QUOTN_FEAT_AMT_COV,

CASE WHEN  F.NK_SRC_KEY = ''HODW_PERSONALPROPERTYLIMIT_ALFA'' THEN  AG_FE.QUOTN_FEAT_AMT  ELSE NULL END AS QUOTN_FEAT_AMT_PERSNL,

CASE WHEN  F.NK_SRC_KEY = ''HODW_DWELLING_LIMIT_HOE'' THEN  AG_FE.QUOTN_FEAT_AMT  ELSE NULL END AS QUOTN_FEAT_AMT_COV_LIM,

CASE WHEN  F.NK_SRC_KEY=''PAMULTICARDISCOUNT'' THEN ''Yes''   ELSE ''No''  END AS MULT_CAR_DSCNT_IND,  

CASE WHEN  F.NK_SRC_KEY=''PALIFEPOLICYDISCOUNT_ALFA'' and F.FEAT_SBTYPE_CD=''MOD'' THEN  ''Yes''  ELSE  ''No''  END AS  LIF_PLCY_DSCNT_IND, CASE WHEN  F.FEAT_NAME= ''HOMEOWNER DISCOUNT'' THEN   ''Yes''  ELSE  ''No'' END AS  HOME_OWNRSHP_DSCNT_IND,

CASE WHEN ( (F.FEAT_DESC =''VALUATION METHOD-OTHER-REPLACEMENT'' AND F.INSRNC_CVGE_TYPE_CD = ''PP'') AND  AG_FE.QUOTN_FEAT_ROLE_CD =''PPV'') THEN F.FEAT_NAME END AS  PRPTY_VALUT_METH_DESC,

CASE WHEN ( (F.FEAT_DESC =''VALUATION METHOD-OTHER-REPLACEMENT'' AND F.INSRNC_CVGE_TYPE_CD = ''DW'') AND  AG_FE.QUOTN_FEAT_ROLE_CD =''PPV'') THEN F.FEAT_NAME END AS  DWLNG_VALUT_METH_NAME,

CASE WHEN F.NK_SRC_KEY=''HODW_SectionI_DedWindAndHailExcl_alfa'' THEN  ''Yes''  ELSE  ''No'' END AS  WIND_AND_HAIL_EXCLDD_IND,

CASE WHEN  F.nk_src_key=''PAHomeownerDiscount_alfa'' THEN ''Yes''   ELSE ''No''  END AS COMBO_DSCNT_IND,

CASE WHEN  F.FEAT_NAME= ''AUTO / HOME DISCOUNT'' THEN  ''Yes''  ELSE  ''No''  END AS  AUTO_DSCNT_IND,

CASE WHEN F.FEAT_SBTYPE_CD=''MOD'' and F.NK_SRC_KEY=''HOCONSTRUCTIONYEAR_ALFA'' THEN AG_FE.QUOTN_FEAT_AMT END AS NEW_HOME_DSCNT_PCTG,

CASE WHEN F.FEAT_SBTYPE_CD=''MOD'' and F.NK_SRC_KEY=''PALENGTHOFSERVICEDISCOUNT_ALFA'' THEN AG_FE.QUOTN_FEAT_AMT END AS VAL_CLNT_DSCNT_PCTG,

CASE WHEN  F.NK_SRC_KEY=''HOHOMEALERT_ALFA'' THEN AG_FE.QUOTN_FEAT_AMT END AS HOME_ALRT_DSCNT_PCTG,

CASE WHEN  F.NK_SRC_KEY=''HOAUTOPAYHISTORY_ALFA'' THEN AG_FE.QUOTN_FEAT_AMT END AS LATE_PMT_PCTG,

CASE WHEN  F.NK_SRC_KEY=''HODW_PERSONALPROPERTYLIMIT_ALFA'' THEN AG_FE.QUOTN_FEAT_AMT END AS PERSNL_PRPTY_CVGE_LMT_AMT,

CASE WHEN  F.NK_SRC_KEY=''HODW_OTHERSTRUCTURESLIMIT_ALFA'' THEN AG_FE.QUOTN_FEAT_AMT END AS OTH_STRC_CVGE_LMT_AMT,

CASE WHEN  F.NK_SRC_KEY=''HODW_LOSSOFUSELIMIT_ALFA'' THEN AG_FE.QUOTN_FEAT_AMT END AS LOSS_OF_USE_CVGE_LMT_AMT

FROM

(select *  from DB_T_PROD_CORE.QUOTN_FEAT  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''  ) AG_FE

inner join (select *  from DB_T_PROD_CORE.FEAT WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' ) F on AG_FE.feat_id = F.feat_id

left outer join DB_T_PROD_CORE.insrnc_cvge_type insr on f.insrnc_cvge_type_cd = insr.insrnc_cvge_type_cd

) FEAT_DET ) AS FEAT_DET

GROUP BY QUOTN_ID) QU_FE

left outer join  (select * from DB_T_PROD_CORE.quotn_agmt where TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' ) qag on QU_FE.QUOTN_ID = QAG.QUOTN_ID

) QUOTN_FEAT

FULL OUTER JOIN

(

select 

QAG.QUOTN_ID,

ag_fe.* 

FROM

(

SELECT

FEAT_DET.AGMT_ID, 

MAX(CVGE_AMT) AS CVGE_AMT,

MAX(CVGE_CD) AS CVGE_CD,

MAX(CVGE_DESC) AS CVGE_DESC,

MAX(DEDCTB_AMT) AS DEDCTB_AMT,

MAX(BODILY_INJRY_LMT_AMT) AS BODILY_INJRY_LMT_AMT,

MAX(LIABTY_ONLY_IND) AS LIABTY_ONLY_IND,

MAX(PRPTY_DMG_LMT_AMT) AS PRPTY_DMG_LMT_AMT,

MAX(DWLNG_CVGE_AMT) AS DWLNG_CVGE_AMT,

MAX(PERSNL_PRPTY_CVGE_AMT) AS PERSNL_PRPTY_CVGE_AMT,

MAX(DWLNG_CVGE_LMT_AMT) AS DWLNG_CVGE_LMT_AMT ,

MAX(MULT_CAR_DSCNT_IND) AS MULT_CAR_DSCNT_IND,

MAX(LIF_PLCY_DSCNT_IND) AS LIF_PLCY_DSCNT_IND,

MAX(HOME_OWNRSHP_DSCNT_IND) AS HOME_OWNRSHP_DSCNT_IND,

MAX(PRPTY_VALUT_METH_DESC) AS PRPTY_VALUT_METH_DESC,

MAX(DWLNG_VALUT_METH_NAME) AS DWLNG_VALUT_METH_NAME,

MAX(WIND_AND_HAIL_EXCLDD_IND) AS WIND_AND_HAIL_EXCLDD_IND,

MAX(COMBO_DSCNT_IND) AS COMBO_DSCNT_IND ,

MAX(AUTO_DSCNT_IND) AS AUTO_DSCNT_IND,

MAX(NEW_HOME_DSCNT_PCTG)  AS NEW_HOME_DSCNT_PCTG,

MAX(VAL_CLNT_DSCNT_PCTG)  AS  VAL_CLNT_DSCNT_PCTG,

MAX(HOME_ALRT_DSCNT_PCTG)  AS HOME_ALRT_DSCNT_PCTG,

MAX(LATE_PMT_PCTG) AS LATE_PMT_PCTG,

MAX(PERSNL_PRPTY_CVGE_LMT_AMT) AS PERSNL_PRPTY_CVGE_LMT_AMT,

MAX(OTH_STRC_CVGE_LMT_AMT) AS OTH_STRC_CVGE_LMT_AMT,

MAX(LOSS_OF_USE_CVGE_LMT_AMT) AS LOSS_OF_USE_CVGE_LMT_AMT

FROM

(SELECT FEAT_DET.AGMT_ID,

FEAT_DET.FEAT_DTL_VAL AS CVGE_AMT,

FEAT_DET.INSRNC_CVGE_TYPE_DESC AS CVGE_CD,

FEAT_DET.FEAT_NAME AS  CVGE_DESC,

FEAT_DET.AGMT_FEAT_AMT_DEDCTB AS  DEDCTB_AMT,

FEAT_DET.AGMT_FEAT_AMT_BODILY AS  BODILY_INJRY_LMT_AMT,

FEAT_DET.INSRNC_CVGE_TYPE_CD_LIABTY AS  LIABTY_ONLY_IND,

FEAT_DET.AGMT_FEAT_AMT_PRPTY AS  PRPTY_DMG_LMT_AMT,

FEAT_DET.AGMT_FEAT_AMT_COV AS  DWLNG_CVGE_AMT,

FEAT_DET.AGMT_FEAT_AMT_PERSNL AS PERSNL_PRPTY_CVGE_AMT,

FEAT_DET.AGMT_FEAT_AMT_COV_LIM AS  DWLNG_CVGE_LMT_AMT,

FEAT_DET.MULT_CAR_DSCNT_IND,

FEAT_DET.LIF_PLCY_DSCNT_IND,

FEAT_DET.HOME_OWNRSHP_DSCNT_IND,

FEAT_DET.PRPTY_VALUT_METH_DESC,

FEAT_DET.DWLNG_VALUT_METH_NAME,

FEAT_DET.WIND_AND_HAIL_EXCLDD_IND,

FEAT_DET.COMBO_DSCNT_IND,

FEAT_DET.AUTO_DSCNT_IND,

FEAT_DET.NEW_HOME_DSCNT_PCTG,

FEAT_DET.VAL_CLNT_DSCNT_PCTG,

FEAT_DET.HOME_ALRT_DSCNT_PCTG,

FEAT_DET.LATE_PMT_PCTG,

FEAT_DET.PERSNL_PRPTY_CVGE_LMT_AMT,

FEAT_DET.OTH_STRC_CVGE_LMT_AMT,

FEAT_DET.LOSS_OF_USE_CVGE_LMT_AMT

FROM

(SELECT  AG_FE.AGMT_ID,  F.FEAT_DTL_VAL , insr.INSRNC_CVGE_TYPE_DESC, F.FEAT_NAME,

CASE WHEN  F.FEAT_DTL_MODL_TYPE_NAME = ''DEDUCTIBLE''  THEN AG_FE.AGMT_FEAT_AMT  ELSE NULL END AS AGMT_FEAT_AMT_DEDCTB,

CASE WHEN  F.INSRNC_CVGE_TYPE_CD=  ''BI'' AND F.FEAT_DTL_MODL_TYPE_NAME= ''Limit'' THEN  F.FEAT_DTL_CD_NAME  ELSE NULL END AS AGMT_FEAT_AMT_BODILY,

CASE WHEN ( (F.COMN_FEAT_NAME <> ''COLLISION'' AND  F.COMN_FEAT_NAME <> ''COMPREHENSIVE'' ) AND

F.INSRNC_LOB_TYPE_CD=''PERSONAL AUTO/WATERCRAFT LINE'') THEN F.INSRNC_CVGE_TYPE_CD END AS  INSRNC_CVGE_TYPE_CD_LIABTY,

CASE WHEN  F.INSRNC_CVGE_TYPE_CD=  ''PD'' AND F.FEAT_DTL_MODL_TYPE_NAME= ''Limit'' THEN AG_FE.AGMT_FEAT_AMT  ELSE NULL END AS AGMT_FEAT_AMT_PRPTY,

CASE WHEN  F.NK_SRC_KEY = ''HODW_DWELLING_COV_HOE'' THEN AG_FE.AGMT_FEAT_AMT  ELSE NULL END AS AGMT_FEAT_AMT_COV,

CASE WHEN  F.NK_SRC_KEY = ''HODW_PERSONALPROPERTYLIMIT_ALFA'' THEN  AG_FE.AGMT_FEAT_AMT  ELSE NULL END AS AGMT_FEAT_AMT_PERSNL,

CASE WHEN  F.NK_SRC_KEY = ''HODW_DWELLING_LIMIT_HOE'' THEN  AG_FE.AGMT_FEAT_AMT  ELSE NULL END AS AGMT_FEAT_AMT_COV_LIM,

CASE WHEN  F.NK_SRC_KEY=''PAMULTICARDISCOUNT'' THEN ''Yes''   ELSE ''No''  END AS MULT_CAR_DSCNT_IND,  

CASE WHEN  F.NK_SRC_KEY=''PALIFEPOLICYDISCOUNT_ALFA'' and F.FEAT_SBTYPE_CD=''MOD'' THEN  ''Yes''  ELSE  ''No''  END AS  LIF_PLCY_DSCNT_IND, CASE WHEN  F.FEAT_NAME= ''HOMEOWNER DISCOUNT'' THEN   ''Yes''  ELSE  ''No'' END AS  HOME_OWNRSHP_DSCNT_IND,

CASE WHEN ( (F.FEAT_DESC =''VALUATION METHOD-OTHER-REPLACEMENT'' AND F.INSRNC_CVGE_TYPE_CD = ''PP'') AND  AG_FE.AGMT_FEAT_ROLE_CD =''PPV'') THEN F.FEAT_NAME END AS  PRPTY_VALUT_METH_DESC,

CASE WHEN ( (F.FEAT_DESC =''VALUATION METHOD-OTHER-REPLACEMENT'' AND F.INSRNC_CVGE_TYPE_CD = ''DW'') AND  AG_FE.AGMT_FEAT_ROLE_CD =''PPV'') THEN F.FEAT_NAME END AS  DWLNG_VALUT_METH_NAME,

CASE WHEN F.NK_SRC_KEY=''HODW_SectionI_DedWindAndHailExcl_alfa'' THEN  ''Yes''  ELSE  ''No'' END AS  WIND_AND_HAIL_EXCLDD_IND,

CASE WHEN  F.nk_src_key=''PAHomeownerDiscount_alfa'' THEN ''Yes''   ELSE ''No''  END AS COMBO_DSCNT_IND,

CASE WHEN  F.FEAT_NAME= ''AUTO / HOME DISCOUNT'' THEN  ''Yes''  ELSE  ''No''  END AS  AUTO_DSCNT_IND,

CASE WHEN F.FEAT_SBTYPE_CD=''MOD'' and F.NK_SRC_KEY=''HOCONSTRUCTIONYEAR_ALFA'' THEN AG_FE.AGMT_FEAT_AMT END AS NEW_HOME_DSCNT_PCTG,

CASE WHEN F.FEAT_SBTYPE_CD=''MOD'' and F.NK_SRC_KEY=''PALENGTHOFSERVICEDISCOUNT_ALFA'' THEN AG_FE.AGMT_FEAT_AMT END AS VAL_CLNT_DSCNT_PCTG,

CASE WHEN  F.NK_SRC_KEY=''HOHOMEALERT_ALFA'' THEN AG_FE.AGMT_FEAT_AMT END AS HOME_ALRT_DSCNT_PCTG,

CASE WHEN  F.NK_SRC_KEY=''HOAUTOPAYHISTORY_ALFA'' THEN AG_FE.AGMT_FEAT_AMT END AS LATE_PMT_PCTG,

CASE WHEN  F.NK_SRC_KEY=''HODW_PERSONALPROPERTYLIMIT_ALFA'' THEN AG_FE.AGMT_FEAT_AMT END AS PERSNL_PRPTY_CVGE_LMT_AMT,

CASE WHEN  F.NK_SRC_KEY=''HODW_OTHERSTRUCTURESLIMIT_ALFA'' THEN AG_FE.AGMT_FEAT_AMT END AS OTH_STRC_CVGE_LMT_AMT,

CASE WHEN  F.NK_SRC_KEY=''HODW_LOSSOFUSELIMIT_ALFA'' THEN AG_FE.AGMT_FEAT_AMT END AS LOSS_OF_USE_CVGE_LMT_AMT

FROM

(select *  from DB_T_PROD_CORE.AGMT_FEAT  WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999''  ) AG_FE

inner join (select *  from DB_T_PROD_CORE.FEAT WHERE TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' ) F on AG_FE.feat_id = F.feat_id

left outer join DB_T_PROD_CORE.insrnc_cvge_type insr on f.insrnc_cvge_type_cd = insr.insrnc_cvge_type_cd

) FEAT_DET 

) AS FEAT_DET

GROUP BY AGMT_ID) ag_fe

left outer join  (select * from DB_T_PROD_CORE.quotn_agmt where TO_CHAR( EDW_END_DTTM,''MM/DD/YYYY'') = ''12/31/9999'' ) qag on ag_fe.agmt_id = qag.agmt_id) AGMT_FEAT

ON QUOTN_FEAT.QUOTN_ID = AGMT_FEAT.QUOTN_ID

WHERE QUOTN_FEAT.QUOTN_ID IS NOT NULL

) QU_COV ON INSQTN.QUOTN_ID = QU_COV.QUOTN_ID 

) AGMT
) SRC
)
);


-- Component jnr1, Type JOINER 
CREATE OR REPLACE TEMPORARY TABLE jnr1 AS
(
SELECT
SQ_QUOTES_AGMT_COV.QUOTN_ID as QUOTN_ID,
SQ_QUOTES_AGMT_COV.CVGE_AMT as CVGE_AMT,
SQ_QUOTES_AGMT_COV.CVGE_CD as CVGE_CD,
SQ_QUOTES_AGMT_COV.CVGE_DESC as CVGE_DESC,
SQ_QUOTES_AGMT_COV.DEDCTB_AMT as DEDCTB_AMT,
SQ_QUOTES_AGMT_COV.BODILY_INJRY_LMT_AMT as BODILY_INJRY_LMT_AMT,
SQ_QUOTES_AGMT_COV.LIABTY_ONLY_IND as LIABTY_ONLY_IND,
SQ_QUOTES_AGMT_COV.PRPTY_DMG_LMT_AMT as PRPTY_DMG_LMT_AMT,
SQ_QUOTES_AGMT_COV.DWLNG_CVGE_AMT as DWLNG_CVGE_AMT,
SQ_QUOTES_AGMT_COV.PERSNL_PRPTY_CVGE_AMT as PERSNL_PRPTY_CVGE_AMT,
SQ_QUOTES_AGMT_COV.DWLNG_CVGE_LMT_AMT as DWLNG_CVGE_LMT_AMT,
SQ_QUOTES_AGMT_COV.MULT_CAR_DSCNT_IND as MULT_CAR_DSCNT_IND,
SQ_QUOTES_AGMT_COV.LIF_PLCY_DSCNT_IND as LIF_PLCY_DSCNT_IND,
SQ_QUOTES_AGMT_COV.HOME_OWNRSHP_DSCNT_IND as HOME_OWNRSHP_DSCNT_IND,
SQ_QUOTES_AGMT_COV.PRPTY_VALUT_METH_DESC as PRPTY_VALUT_METH_DESC,
SQ_QUOTES_AGMT_COV.DWLNG_VALUT_METH_NAME as DWLNG_VALUT_METH_NAME,
SQ_QUOTES_AGMT_COV.WIND_AND_HAIL_EXCLDD_IND as WIND_AND_HAIL_EXCLDD_IND,
SQ_QUOTES_AGMT_COV.COMBO_DSCNT_IND as COMBO_DSCNT_IND,
SQ_QUOTES_AGMT_COV.AUTO_DSCNT_IND as AUTO_DSCNT_IND,
SQ_QUOTES_AGMT_COV.NEW_HOME_DSCNT_PCTG as NEW_HOME_DSCNT_PCTG,
SQ_QUOTES_AGMT_COV.VAL_CLNT_DSCNT_PCTG as VAL_CLNT_DSCNT_PCTG,
SQ_QUOTES_AGMT_COV.HOME_ALRT_DSCNT_PCTG as HOME_ALRT_DSCNT_PCTG,
SQ_QUOTES_AGMT_COV.LATE_PMT_PCTG as LATE_PMT_PCTG,
SQ_QUOTES_AGMT_COV.PERSNL_PRPTY_CVGE_LMT_AMT as PERSNL_PRPTY_CVGE_LMT_AMT,
SQ_QUOTES_AGMT_COV.OTH_STRC_CVGE_LMT_AMT as OTH_STRC_CVGE_LMT_AMT,
SQ_QUOTES_AGMT_COV.LOSS_OF_USE_CVGE_LMT_AMT as LOSS_OF_USE_CVGE_LMT_AMT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.QUOTN_ID as QUOTN_ID1,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.AGMT_ID as AGMT_ID,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_INCPTN_DT as PLCY_INCPTN_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_AGE as PLCY_AGE,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_EFF_DT as PLCY_EFF_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_TERM_EXPN_DT as PLCY_TERM_EXPN_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_ISSU_DT as PLCY_ISSU_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_NUM as PLCY_NUM,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.TRANS_DT as TRANS_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.MORTGAGEE as MORTGAGEE,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.AUTO_PMT_FRQCY_DESC as AUTO_PMT_FRQCY_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.NO_PRIOR_INSRNC_IND as NO_PRIOR_INSRNC_IND,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.YRS_WTH_ALFA as YRS_WTH_ALFA,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_PRD_STRT_DT as PLCY_PRD_STRT_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_PRD_END_DT as PLCY_PRD_END_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.TERM_NUM as TERM_NUM,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.CNTNUS_SRVC_DT as CNTNUS_SRVC_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_FRST_ISSU_DT as PLCY_FRST_ISSU_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_TERM_TYPE as PLCY_TERM_TYPE,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PRD_ID as PRD_ID,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.ARS_SCR as ARS_SCR,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.VAL_CLNT_DSCNT_IND as VAL_CLNT_DSCNT_IND,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.RISK_LOC_CITY_NAME as RISK_LOC_CITY_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.RISK_LOC_CTRY_NAME as RISK_LOC_CTRY_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.RISK_LOC_CNTY_NAME as RISK_LOC_CNTY_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_ORIG_ST_NAME as PLCY_ORIG_ST_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_WRTN_ST_NAME as PLCY_WRTN_ST_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.TAX_CITY_NAME as TAX_CITY_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_WRTN_ST_CD as PLCY_WRTN_ST_CD,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.SLS_RGN_ST_NAME as SLS_RGN_ST_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.SLS_RGN_DSTRCT_NAME as SLS_RGN_DSTRCT_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PRMRY_INSRD_NAME as PRMRY_INSRD_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_ASGND_DT as PLCY_ASGND_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.SCNDRY_INSRD_NAME as SCNDRY_INSRD_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.ADDL_INSRD_NAME as ADDL_INSRD_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_ADDL_INSRD_NAME as PLCY_ADDL_INSRD_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.VEH_ADDL_INSRD_NAME as VEH_ADDL_INSRD_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.GNDR_TYPE_DESC as GNDR_TYPE_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.NAME_INSRD_MRTL_STS_DESC as NAME_INSRD_MRTL_STS_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.NAME_INSRD_AGE_DESC as NAME_INSRD_AGE_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PRMRY_INSRD_ADDR_DESC as PRMRY_INSRD_ADDR_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.SLS_SRVC_CTR_ADDR as SLS_SRVC_CTR_ADDR,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.INSRD_EML_TXT as INSRD_EML_TXT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.INSRD_TLPHN_NUM as INSRD_TLPHN_NUM,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.DRVR_PNT_DESC as DRVR_PNT_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.INSRD_LIC_ST_NAME as INSRD_LIC_ST_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.MBR_TYPE_DESC as MBR_TYPE_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.MBR_NUM as MBR_NUM,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.TRANS_TYPE_DESC as TRANS_TYPE_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_RJCTN_RSN_DESC as PLCY_RJCTN_RSN_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.TRANS_CLSD_DT as TRANS_CLSD_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.CO_TO_CO_TFR_DESC as CO_TO_CO_TFR_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.TOT_VEHICAL_UNIT_CNT as TOT_VEHICAL_UNIT_CNT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.TOT_UNITS_CNT as TOT_UNITS_CNT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.RLTNSHP_DESC as RLTNSHP_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_DSCNT_NAME as PLCY_DSCNT_NAME,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.ENDRSMT_DESC as ENDRSMT_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.RATE_UPS_DESC as RATE_UPS_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.LOB as LOB,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_TYPE_DESC as PLCY_TYPE_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PROD_LN_DESC as PROD_LN_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.TOT_WRTN_PREM_AMT as TOT_WRTN_PREM_AMT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.ANULZD_TOT_WRTN_PREM_AMT as ANULZD_TOT_WRTN_PREM_AMT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_TOT_COST_AMT as PLCY_TOT_COST_AMT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PREM_DUE_AMT as PREM_DUE_AMT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_CNCLTN_SRC_DESC as PLCY_CNCLTN_SRC_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.RNEWL_STS as RNEWL_STS,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.AUTO_LATE_PAY_NUM as AUTO_LATE_PAY_NUM,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PLCY_ACCNTG_DT as PLCY_ACCNTG_DT,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.EXCLN_WAIVD_RSN_DESC as EXCLN_WAIVD_RSN_DESC,
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.PREM_BILD_AMT as PREM_BILD_AMT,
row_number() over (order by 1) AS source_record_id
FROM
SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER
INNER JOIN SQ_QUOTES_AGMT_COV ON SQ_QUOTES_AGMT_WITHOUT_ASSET_LEVEL_MASTER.QUOTN_ID = SQ_QUOTES_AGMT_COV.QUOTN_ID
);


-- Component JNR2, Type JOINER 
CREATE OR REPLACE TEMPORARY TABLE JNR2 AS
(
SELECT
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.QUOTN_ID as QUOTN_ID,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.AGMT_ID as AGMT_ID,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.HTG_DESC as HTG_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.COOLG_DESC as COOLG_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.PRMRY_RSPNS_SRVC_DESC as PRMRY_RSPNS_SRVC_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_NUM_OF_STORIES_CNT as DWLNG_NUM_OF_STORIES_CNT,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.GAR_CRPT_DESC as GAR_CRPT_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.SCREENED_POOL_IND as SCREENED_POOL_IND,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_SQUAR_FOOTGE as DWLNG_SQUAR_FOOTGE,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_BODY_TYPE_DESC as VEH_BODY_TYPE_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_COLOR_DESC as VEH_COLOR_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_MAKE_DESC as VEH_MAKE_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_MODL_DESC as VEH_MODL_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.CNSTRCTN_DT as CNSTRCTN_DT,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.CLAS_OF_PRPTY_DESC as CLAS_OF_PRPTY_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_PRCH_DT as VEH_PRCH_DT,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_PRCH_DT as DWLNG_PRCH_DT,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.CNSTRCTN_DESC as CNSTRCTN_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.CNSTRCTN_TYPE_DESC as CNSTRCTN_TYPE_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.RSDNC_TYEP_DESC as RSDNC_TYEP_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_FNDTN_TYPE as DWLNG_FNDTN_TYPE,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_USE_DESC as DWLNG_USE_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.PRPTY_ZN_DESC as PRPTY_ZN_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_VAL_AMT as DWLNG_VAL_AMT,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_OCPYD_DESC as DWLNG_OCPYD_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_GARGD_LOC_NAME as VEH_GARGD_LOC_NAME,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_APRSL_DT as DWLNG_APRSL_DT,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_PRCH_AMT as DWLNG_PRCH_AMT,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.PRTCTN_CLAS_DESC as PRTCTN_CLAS_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_TYPE_DESC as VEH_TYPE_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_MODL_YR as VEH_MODL_YR,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_INDENTIFICATION_NUM as VEH_INDENTIFICATION_NUM,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_USE_DESC as VEH_USE_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.AGE_OF_HOME as AGE_OF_HOME,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.FIRE_HYDRANT_1000_FEET_IND as FIRE_HYDRANT_1000_FEET_IND,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.FIRE_HYDRANT_5_MILE_IND as FIRE_HYDRANT_5_MILE_IND,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.SWIMMING_POOL_IND as SWIMMING_POOL_IND,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.PLCY_INT_TYPE_DESC as PLCY_INT_TYPE_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.VEH_SYMB_COLLISION_CD as VEH_SYMB_COLLISION_CD,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_LAT_MEAS as DWLNG_LAT_MEAS,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_LNGTD_MEAS as DWLNG_LNGTD_MEAS,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.MH_PRK_NAME as MH_PRK_NAME,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.MH_PRK_CD as MH_PRK_CD,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.MH_RTG_CLAS_DESC as MH_RTG_CLAS_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DRVR_CLAS_DESC as DRVR_CLAS_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.INSRD_PRPTY_CNTY_NAME as INSRD_PRPTY_CNTY_NAME,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_ROOF_TYPE_DESC as DWLNG_ROOF_TYPE_DESC,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.ROOF_YR as ROOF_YR,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.ENCMCE_CD as ENCMCE_CD,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.DWLNG_FIRE_DEPT_CD as DWLNG_FIRE_DEPT_CD,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.TOT_UNEARND_PREM_AMT as TOT_UNEARND_PREM_AMT,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.EARND_PREM_AMT as EARND_PREM_AMT,
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.NK_JOB_NBR as NK_JOB_NBR,
jnr1.CVGE_AMT as CVGE_AMT,
jnr1.CVGE_CD as CVGE_CD,
jnr1.CVGE_DESC as CVGE_DESC,
jnr1.DEDCTB_AMT as DEDCTB_AMT,
jnr1.BODILY_INJRY_LMT_AMT as BODILY_INJRY_LMT_AMT,
jnr1.LIABTY_ONLY_IND as LIABTY_ONLY_IND,
jnr1.PRPTY_DMG_LMT_AMT as PRPTY_DMG_LMT_AMT,
jnr1.DWLNG_CVGE_AMT as DWLNG_CVGE_AMT,
jnr1.PERSNL_PRPTY_CVGE_AMT as PERSNL_PRPTY_CVGE_AMT,
jnr1.DWLNG_CVGE_LMT_AMT as DWLNG_CVGE_LMT_AMT,
jnr1.MULT_CAR_DSCNT_IND as MULT_CAR_DSCNT_IND,
jnr1.LIF_PLCY_DSCNT_IND as LIF_PLCY_DSCNT_IND,
jnr1.HOME_OWNRSHP_DSCNT_IND as HOME_OWNRSHP_DSCNT_IND,
jnr1.PRPTY_VALUT_METH_DESC as PRPTY_VALUT_METH_DESC,
jnr1.DWLNG_VALUT_METH_NAME as DWLNG_VALUT_METH_NAME,
jnr1.WIND_AND_HAIL_EXCLDD_IND as WIND_AND_HAIL_EXCLDD_IND,
jnr1.COMBO_DSCNT_IND as COMBO_DSCNT_IND,
jnr1.AUTO_DSCNT_IND as AUTO_DSCNT_IND,
jnr1.NEW_HOME_DSCNT_PCTG as NEW_HOME_DSCNT_PCTG,
jnr1.VAL_CLNT_DSCNT_PCTG as VAL_CLNT_DSCNT_PCTG,
jnr1.HOME_ALRT_DSCNT_PCTG as HOME_ALRT_DSCNT_PCTG,
jnr1.LATE_PMT_PCTG as LATE_PMT_PCTG,
jnr1.PERSNL_PRPTY_CVGE_LMT_AMT as PERSNL_PRPTY_CVGE_LMT_AMT,
jnr1.OTH_STRC_CVGE_LMT_AMT as OTH_STRC_CVGE_LMT_AMT,
jnr1.LOSS_OF_USE_CVGE_LMT_AMT as LOSS_OF_USE_CVGE_LMT_AMT,
jnr1.QUOTN_ID1 as QUOTN_ID1,
jnr1.AGMT_ID as AGMT_ID1,
jnr1.PLCY_INCPTN_DT as PLCY_INCPTN_DT,
jnr1.PLCY_AGE as PLCY_AGE,
jnr1.PLCY_EFF_DT as PLCY_EFF_DT,
jnr1.PLCY_TERM_EXPN_DT as PLCY_TERM_EXPN_DT,
jnr1.PLCY_ISSU_DT as PLCY_ISSU_DT,
jnr1.PLCY_NUM as PLCY_NUM,
jnr1.TRANS_DT as TRANS_DT,
jnr1.MORTGAGEE as MORTGAGEE,
jnr1.AUTO_PMT_FRQCY_DESC as AUTO_PMT_FRQCY_DESC,
jnr1.NO_PRIOR_INSRNC_IND as NO_PRIOR_INSRNC_IND,
jnr1.YRS_WTH_ALFA as YRS_WTH_ALFA,
jnr1.PLCY_PRD_STRT_DT as PLCY_PRD_STRT_DT,
jnr1.PLCY_PRD_END_DT as PLCY_PRD_END_DT,
jnr1.TERM_NUM as TERM_NUM,
jnr1.CNTNUS_SRVC_DT as CNTNUS_SRVC_DT,
jnr1.PLCY_FRST_ISSU_DT as PLCY_FRST_ISSU_DT,
jnr1.PLCY_TERM_TYPE as PLCY_TERM_TYPE,
jnr1.PRD_ID as PRD_ID,
jnr1.ARS_SCR as ARS_SCR,
jnr1.VAL_CLNT_DSCNT_IND as VAL_CLNT_DSCNT_IND,
jnr1.RISK_LOC_CITY_NAME as RISK_LOC_CITY_NAME,
jnr1.RISK_LOC_CTRY_NAME as RISK_LOC_CTRY_NAME,
jnr1.RISK_LOC_CNTY_NAME as RISK_LOC_CNTY_NAME,
jnr1.PLCY_ORIG_ST_NAME as PLCY_ORIG_ST_NAME,
jnr1.PLCY_WRTN_ST_NAME as PLCY_WRTN_ST_NAME,
jnr1.TAX_CITY_NAME as TAX_CITY_NAME,
jnr1.PLCY_WRTN_ST_CD as PLCY_WRTN_ST_CD,
jnr1.SLS_RGN_ST_NAME as SLS_RGN_ST_NAME,
jnr1.SLS_RGN_DSTRCT_NAME as SLS_RGN_DSTRCT_NAME,
jnr1.PRMRY_INSRD_NAME as PRMRY_INSRD_NAME,
jnr1.PLCY_ASGND_DT as PLCY_ASGND_DT,
jnr1.SCNDRY_INSRD_NAME as SCNDRY_INSRD_NAME,
jnr1.ADDL_INSRD_NAME as ADDL_INSRD_NAME,
jnr1.PLCY_ADDL_INSRD_NAME as PLCY_ADDL_INSRD_NAME,
jnr1.VEH_ADDL_INSRD_NAME as VEH_ADDL_INSRD_NAME,
jnr1.GNDR_TYPE_DESC as GNDR_TYPE_DESC,
jnr1.NAME_INSRD_MRTL_STS_DESC as NAME_INSRD_MRTL_STS_DESC,
jnr1.NAME_INSRD_AGE_DESC as NAME_INSRD_AGE_DESC,
jnr1.PRMRY_INSRD_ADDR_DESC as PRMRY_INSRD_ADDR_DESC,
jnr1.SLS_SRVC_CTR_ADDR as SLS_SRVC_CTR_ADDR,
jnr1.INSRD_EML_TXT as INSRD_EML_TXT,
jnr1.INSRD_TLPHN_NUM as INSRD_TLPHN_NUM,
jnr1.DRVR_PNT_DESC as DRVR_PNT_DESC,
jnr1.INSRD_LIC_ST_NAME as INSRD_LIC_ST_NAME,
jnr1.MBR_TYPE_DESC as MBR_TYPE_DESC,
jnr1.MBR_NUM as MBR_NUM,
jnr1.TRANS_TYPE_DESC as TRANS_TYPE_DESC,
jnr1.PLCY_RJCTN_RSN_DESC as PLCY_RJCTN_RSN_DESC,
jnr1.TRANS_CLSD_DT as TRANS_CLSD_DT,
jnr1.CO_TO_CO_TFR_DESC as CO_TO_CO_TFR_DESC,
jnr1.TOT_VEHICAL_UNIT_CNT as TOT_VEHICAL_UNIT_CNT,
jnr1.TOT_UNITS_CNT as TOT_UNITS_CNT,
jnr1.RLTNSHP_DESC as RLTNSHP_DESC,
jnr1.PLCY_DSCNT_NAME as PLCY_DSCNT_NAME,
jnr1.ENDRSMT_DESC as ENDRSMT_DESC,
jnr1.RATE_UPS_DESC as RATE_UPS_DESC,
jnr1.LOB as LOB,
jnr1.PLCY_TYPE_DESC as PLCY_TYPE_DESC,
jnr1.PROD_LN_DESC as PROD_LN_DESC,
jnr1.TOT_WRTN_PREM_AMT as TOT_WRTN_PREM_AMT,
jnr1.ANULZD_TOT_WRTN_PREM_AMT as ANULZD_TOT_WRTN_PREM_AMT,
jnr1.PLCY_TOT_COST_AMT as PLCY_TOT_COST_AMT,
jnr1.PREM_DUE_AMT as PREM_DUE_AMT,
jnr1.PLCY_CNCLTN_SRC_DESC as PLCY_CNCLTN_SRC_DESC,
jnr1.RNEWL_STS as RNEWL_STS,
jnr1.AUTO_LATE_PAY_NUM as AUTO_LATE_PAY_NUM,
jnr1.PLCY_ACCNTG_DT as PLCY_ACCNTG_DT,
jnr1.EXCLN_WAIVD_RSN_DESC as EXCLN_WAIVD_RSN_DESC,
jnr1.PREM_BILD_AMT as PREM_BILD_AMT,
row_number() over (order by 1) AS source_record_id
FROM
SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL
INNER JOIN jnr1 ON jnr1.QUOTN_ID1 = SQ_QUOTES_AGMT_ASSET_LEVEL_DETAIL.QUOTN_ID
);


-- Component TGT_QUOTES_AGMT_INTRM, Type TARGET 
INSERT INTO DB_T_PROD_CORE.QUOTES_AGMT_INTRM
(
RISK_LOC_CITY_NAME,
RISK_LOC_CTRY_NAME,
RISK_LOC_CNTY_NAME,
CVGE_CD,
CVGE_AMT,
CVGE_DESC,
PRMRY_INSRD_ADDR_DESC,
PRMRY_INSRD_NAME,
LOB,
RNEWL_STS,
PLCY_ACCNTG_DT,
PLCY_ASGND_DT,
PLCY_EFF_DT,
PLCY_TERM_EXPN_DT,
PLCY_ISSU_DT,
PLCY_NUM,
PLCY_RJCTN_RSN_DESC,
SCNDRY_INSRD_NAME,
ADDL_INSRD_NAME,
PLCY_ADDL_INSRD_NAME,
VEH_ADDL_INSRD_NAME,
SLS_SRVC_CTR_ADDR,
PLCY_ORIG_ST_NAME,
PLCY_WRTN_ST_NAME,
TOT_WRTN_PREM_AMT,
TRANS_TYPE_DESC,
TRANS_DT,
DEDCTB_AMT,
MORTGAGEE,
PLCY_TYPE_DESC,
CNSTRCTN_DESC,
HTG_DESC,
COOLG_DESC,
CNSTRCTN_DT,
AUTO_LATE_PAY_NUM,
AUTO_PMT_FRQCY_DESC,
PRMRY_RSPNS_SRVC_DESC,
MH_RTG_CLAS_DESC,
MH_PRK_NAME,
MH_PRK_CD,
CLAS_OF_PRPTY_DESC,
BODILY_INJRY_LMT_AMT,
PLCY_DSCNT_NAME,
DRVR_CLAS_DESC,
EXCLN_WAIVD_RSN_DESC,
GNDR_TYPE_DESC,
LIABTY_ONLY_IND,
NO_PRIOR_INSRNC_IND,
PRPTY_DMG_LMT_AMT,
PLCY_INT_TYPE_DESC,
RATE_UPS_DESC,
RLTNSHP_DESC,
TAX_CITY_NAME,
VEH_SYMB_COLLISION_CD,
VEH_TYPE_DESC,
VEH_USE_DESC,
VEH_MODL_YR,
YRS_WTH_ALFA,
VEH_INDENTIFICATION_NUM,
PLCY_WRTN_ST_CD,
SLS_RGN_ST_NAME,
SLS_RGN_DSTRCT_NAME,
NAME_INSRD_MRTL_STS_DESC,
NAME_INSRD_AGE_DESC,
COMBO_DSCNT_IND,
MULT_CAR_DSCNT_IND,
VAL_CLNT_DSCNT_IND,
LIF_PLCY_DSCNT_IND,
HOME_OWNRSHP_DSCNT_IND,
AUTO_DSCNT_IND,
NEW_HOME_DSCNT_PCTG,
VAL_CLNT_DSCNT_PCTG,
HOME_ALRT_DSCNT_PCTG,
INSRD_PRPTY_CNTY_NAME,
DWLNG_CVGE_AMT,
PERSNL_PRPTY_CVGE_AMT,
CNSTRCTN_TYPE_DESC,
LATE_PMT_PCTG,
PLCY_PRD_STRT_DT,
PLCY_PRD_END_DT,
TERM_NUM,
INSRD_EML_TXT,
INSRD_TLPHN_NUM,
TOT_UNITS_CNT,
ENDRSMT_DESC,
ANULZD_TOT_WRTN_PREM_AMT,
PRTCTN_CLAS_DESC,
PLCY_CNCLTN_SRC_DESC,
PREM_DUE_AMT,
MBR_NUM,
PLCY_INCPTN_DT,
PLCY_AGE,
PREM_BILD_AMT,
ENCMCE_CD,
RSDNC_TYEP_DESC,
VEH_GARGD_LOC_NAME,
ROOF_YR,
CNTNUS_SRVC_DT,
DWLNG_VAL_AMT,
DRVR_PNT_DESC,
ARS_SCR,
AGE_OF_HOME,
TOT_UNEARND_PREM_AMT,
DWLNG_APRSL_DT,
DWLNG_SQUAR_FOOTGE,
VEH_BODY_TYPE_DESC,
VEH_COLOR_DESC,
VEH_MAKE_DESC,
VEH_MODL_DESC,
VEH_PRCH_DT,
DWLNG_PRCH_DT,
DWLNG_NUM_OF_STORIES_CNT,
TRANS_CLSD_DT,
GAR_CRPT_DESC,
SCREENED_POOL_IND,
DWLNG_FIRE_DEPT_CD,
PLCY_FRST_ISSU_DT,
DWLNG_FNDTN_TYPE,
DWLNG_USE_DESC,
DWLNG_OCPYD_DESC,
FIRE_HYDRANT_1000_FEET_IND,
FIRE_HYDRANT_5_MILE_IND,
SWIMMING_POOL_IND,
WIND_AND_HAIL_EXCLDD_IND,
DWLNG_LAT_MEAS,
DWLNG_LNGTD_MEAS,
INSRD_LIC_ST_NAME,
DWLNG_VALUT_METH_NAME,
DWLNG_CVGE_LMT_AMT,
PRPTY_VALUT_METH_DESC,
PERSNL_PRPTY_CVGE_LMT_AMT,
OTH_STRC_CVGE_LMT_AMT,
LOSS_OF_USE_CVGE_LMT_AMT,
PRPTY_ZN_DESC,
DWLNG_PRCH_AMT,
DWLNG_ROOF_TYPE_DESC,
PLCY_TERM_TYPE,
PLCY_TOT_COST_AMT,
EARND_PREM_AMT,
MBR_TYPE_DESC,
TOT_VEHICAL_UNIT_CNT,
PROD_LN_DESC,
CO_TO_CO_TFR_DESC,
PRD_ID,
NK_JOB_NBR,
QUOTN_ID,
AGMT_ID
)
SELECT
JNR2.RISK_LOC_CITY_NAME as RISK_LOC_CITY_NAME,
JNR2.RISK_LOC_CTRY_NAME as RISK_LOC_CTRY_NAME,
JNR2.RISK_LOC_CNTY_NAME as RISK_LOC_CNTY_NAME,
JNR2.CVGE_CD as CVGE_CD,
JNR2.CVGE_AMT as CVGE_AMT,
JNR2.CVGE_DESC as CVGE_DESC,
JNR2.PRMRY_INSRD_ADDR_DESC as PRMRY_INSRD_ADDR_DESC,
JNR2.PRMRY_INSRD_NAME as PRMRY_INSRD_NAME,
JNR2.LOB as LOB,
JNR2.RNEWL_STS as RNEWL_STS,
JNR2.PLCY_ACCNTG_DT as PLCY_ACCNTG_DT,
JNR2.PLCY_ASGND_DT as PLCY_ASGND_DT,
JNR2.PLCY_EFF_DT as PLCY_EFF_DT,
JNR2.PLCY_TERM_EXPN_DT as PLCY_TERM_EXPN_DT,
JNR2.PLCY_ISSU_DT as PLCY_ISSU_DT,
JNR2.PLCY_NUM as PLCY_NUM,
JNR2.PLCY_RJCTN_RSN_DESC as PLCY_RJCTN_RSN_DESC,
JNR2.SCNDRY_INSRD_NAME as SCNDRY_INSRD_NAME,
JNR2.ADDL_INSRD_NAME as ADDL_INSRD_NAME,
JNR2.PLCY_ADDL_INSRD_NAME as PLCY_ADDL_INSRD_NAME,
JNR2.VEH_ADDL_INSRD_NAME as VEH_ADDL_INSRD_NAME,
JNR2.SLS_SRVC_CTR_ADDR as SLS_SRVC_CTR_ADDR,
JNR2.PLCY_ORIG_ST_NAME as PLCY_ORIG_ST_NAME,
JNR2.PLCY_WRTN_ST_NAME as PLCY_WRTN_ST_NAME,
JNR2.TOT_WRTN_PREM_AMT as TOT_WRTN_PREM_AMT,
JNR2.TRANS_TYPE_DESC as TRANS_TYPE_DESC,
JNR2.TRANS_DT as TRANS_DT,
JNR2.DEDCTB_AMT as DEDCTB_AMT,
JNR2.MORTGAGEE as MORTGAGEE,
JNR2.PLCY_TYPE_DESC as PLCY_TYPE_DESC,
JNR2.CNSTRCTN_DESC as CNSTRCTN_DESC,
JNR2.HTG_DESC as HTG_DESC,
JNR2.COOLG_DESC as COOLG_DESC,
JNR2.CNSTRCTN_DT as CNSTRCTN_DT,
JNR2.AUTO_LATE_PAY_NUM as AUTO_LATE_PAY_NUM,
JNR2.AUTO_PMT_FRQCY_DESC as AUTO_PMT_FRQCY_DESC,
JNR2.PRMRY_RSPNS_SRVC_DESC as PRMRY_RSPNS_SRVC_DESC,
JNR2.MH_RTG_CLAS_DESC as MH_RTG_CLAS_DESC,
JNR2.MH_PRK_NAME as MH_PRK_NAME,
JNR2.MH_PRK_CD as MH_PRK_CD,
JNR2.CLAS_OF_PRPTY_DESC as CLAS_OF_PRPTY_DESC,
JNR2.BODILY_INJRY_LMT_AMT as BODILY_INJRY_LMT_AMT,
JNR2.PLCY_DSCNT_NAME as PLCY_DSCNT_NAME,
JNR2.DRVR_CLAS_DESC as DRVR_CLAS_DESC,
JNR2.EXCLN_WAIVD_RSN_DESC as EXCLN_WAIVD_RSN_DESC,
JNR2.GNDR_TYPE_DESC as GNDR_TYPE_DESC,
JNR2.LIABTY_ONLY_IND as LIABTY_ONLY_IND,
JNR2.NO_PRIOR_INSRNC_IND as NO_PRIOR_INSRNC_IND,
JNR2.PRPTY_DMG_LMT_AMT as PRPTY_DMG_LMT_AMT,
JNR2.PLCY_INT_TYPE_DESC as PLCY_INT_TYPE_DESC,
JNR2.RATE_UPS_DESC as RATE_UPS_DESC,
JNR2.RLTNSHP_DESC as RLTNSHP_DESC,
JNR2.TAX_CITY_NAME as TAX_CITY_NAME,
JNR2.VEH_SYMB_COLLISION_CD as VEH_SYMB_COLLISION_CD,
JNR2.VEH_TYPE_DESC as VEH_TYPE_DESC,
JNR2.VEH_USE_DESC as VEH_USE_DESC,
JNR2.VEH_MODL_YR as VEH_MODL_YR,
JNR2.YRS_WTH_ALFA as YRS_WTH_ALFA,
JNR2.VEH_INDENTIFICATION_NUM as VEH_INDENTIFICATION_NUM,
JNR2.PLCY_WRTN_ST_CD as PLCY_WRTN_ST_CD,
JNR2.SLS_RGN_ST_NAME as SLS_RGN_ST_NAME,
JNR2.SLS_RGN_DSTRCT_NAME as SLS_RGN_DSTRCT_NAME,
JNR2.NAME_INSRD_MRTL_STS_DESC as NAME_INSRD_MRTL_STS_DESC,
JNR2.NAME_INSRD_AGE_DESC as NAME_INSRD_AGE_DESC,
JNR2.COMBO_DSCNT_IND as COMBO_DSCNT_IND,
JNR2.MULT_CAR_DSCNT_IND as MULT_CAR_DSCNT_IND,
JNR2.VAL_CLNT_DSCNT_IND as VAL_CLNT_DSCNT_IND,
JNR2.LIF_PLCY_DSCNT_IND as LIF_PLCY_DSCNT_IND,
JNR2.HOME_OWNRSHP_DSCNT_IND as HOME_OWNRSHP_DSCNT_IND,
JNR2.AUTO_DSCNT_IND as AUTO_DSCNT_IND,
JNR2.NEW_HOME_DSCNT_PCTG as NEW_HOME_DSCNT_PCTG,
JNR2.VAL_CLNT_DSCNT_PCTG as VAL_CLNT_DSCNT_PCTG,
JNR2.HOME_ALRT_DSCNT_PCTG as HOME_ALRT_DSCNT_PCTG,
JNR2.INSRD_PRPTY_CNTY_NAME as INSRD_PRPTY_CNTY_NAME,
JNR2.DWLNG_CVGE_AMT as DWLNG_CVGE_AMT,
JNR2.PERSNL_PRPTY_CVGE_AMT as PERSNL_PRPTY_CVGE_AMT,
JNR2.CNSTRCTN_TYPE_DESC as CNSTRCTN_TYPE_DESC,
JNR2.LATE_PMT_PCTG as LATE_PMT_PCTG,
JNR2.PLCY_PRD_STRT_DT as PLCY_PRD_STRT_DT,
JNR2.PLCY_PRD_END_DT as PLCY_PRD_END_DT,
JNR2.TERM_NUM as TERM_NUM,
JNR2.INSRD_EML_TXT as INSRD_EML_TXT,
JNR2.INSRD_TLPHN_NUM as INSRD_TLPHN_NUM,
JNR2.TOT_UNITS_CNT as TOT_UNITS_CNT,
JNR2.ENDRSMT_DESC as ENDRSMT_DESC,
JNR2.ANULZD_TOT_WRTN_PREM_AMT as ANULZD_TOT_WRTN_PREM_AMT,
JNR2.PRTCTN_CLAS_DESC as PRTCTN_CLAS_DESC,
JNR2.PLCY_CNCLTN_SRC_DESC as PLCY_CNCLTN_SRC_DESC,
JNR2.PREM_DUE_AMT as PREM_DUE_AMT,
JNR2.MBR_NUM as MBR_NUM,
JNR2.PLCY_INCPTN_DT as PLCY_INCPTN_DT,
JNR2.PLCY_AGE as PLCY_AGE,
JNR2.PREM_BILD_AMT as PREM_BILD_AMT,
JNR2.ENCMCE_CD as ENCMCE_CD,
JNR2.RSDNC_TYEP_DESC as RSDNC_TYEP_DESC,
JNR2.VEH_GARGD_LOC_NAME as VEH_GARGD_LOC_NAME,
JNR2.ROOF_YR as ROOF_YR,
JNR2.CNTNUS_SRVC_DT as CNTNUS_SRVC_DT,
JNR2.DWLNG_VAL_AMT as DWLNG_VAL_AMT,
JNR2.DRVR_PNT_DESC as DRVR_PNT_DESC,
JNR2.ARS_SCR as ARS_SCR,
JNR2.AGE_OF_HOME as AGE_OF_HOME,
JNR2.TOT_UNEARND_PREM_AMT as TOT_UNEARND_PREM_AMT,
JNR2.DWLNG_APRSL_DT as DWLNG_APRSL_DT,
JNR2.DWLNG_SQUAR_FOOTGE as DWLNG_SQUAR_FOOTGE,
JNR2.VEH_BODY_TYPE_DESC as VEH_BODY_TYPE_DESC,
JNR2.VEH_COLOR_DESC as VEH_COLOR_DESC,
JNR2.VEH_MAKE_DESC as VEH_MAKE_DESC,
JNR2.VEH_MODL_DESC as VEH_MODL_DESC,
JNR2.VEH_PRCH_DT as VEH_PRCH_DT,
JNR2.DWLNG_PRCH_DT as DWLNG_PRCH_DT,
JNR2.DWLNG_NUM_OF_STORIES_CNT as DWLNG_NUM_OF_STORIES_CNT,
JNR2.TRANS_CLSD_DT as TRANS_CLSD_DT,
JNR2.GAR_CRPT_DESC as GAR_CRPT_DESC,
JNR2.SCREENED_POOL_IND as SCREENED_POOL_IND,
JNR2.DWLNG_FIRE_DEPT_CD as DWLNG_FIRE_DEPT_CD,
JNR2.PLCY_FRST_ISSU_DT as PLCY_FRST_ISSU_DT,
JNR2.DWLNG_FNDTN_TYPE as DWLNG_FNDTN_TYPE,
JNR2.DWLNG_USE_DESC as DWLNG_USE_DESC,
JNR2.DWLNG_OCPYD_DESC as DWLNG_OCPYD_DESC,
JNR2.FIRE_HYDRANT_1000_FEET_IND as FIRE_HYDRANT_1000_FEET_IND,
JNR2.FIRE_HYDRANT_5_MILE_IND as FIRE_HYDRANT_5_MILE_IND,
JNR2.SWIMMING_POOL_IND as SWIMMING_POOL_IND,
JNR2.WIND_AND_HAIL_EXCLDD_IND as WIND_AND_HAIL_EXCLDD_IND,
JNR2.DWLNG_LAT_MEAS as DWLNG_LAT_MEAS,
JNR2.DWLNG_LNGTD_MEAS as DWLNG_LNGTD_MEAS,
JNR2.INSRD_LIC_ST_NAME as INSRD_LIC_ST_NAME,
JNR2.DWLNG_VALUT_METH_NAME as DWLNG_VALUT_METH_NAME,
JNR2.DWLNG_CVGE_LMT_AMT as DWLNG_CVGE_LMT_AMT,
JNR2.PRPTY_VALUT_METH_DESC as PRPTY_VALUT_METH_DESC,
JNR2.PERSNL_PRPTY_CVGE_LMT_AMT as PERSNL_PRPTY_CVGE_LMT_AMT,
JNR2.OTH_STRC_CVGE_LMT_AMT as OTH_STRC_CVGE_LMT_AMT,
JNR2.LOSS_OF_USE_CVGE_LMT_AMT as LOSS_OF_USE_CVGE_LMT_AMT,
JNR2.PRPTY_ZN_DESC as PRPTY_ZN_DESC,
JNR2.DWLNG_PRCH_AMT as DWLNG_PRCH_AMT,
JNR2.DWLNG_ROOF_TYPE_DESC as DWLNG_ROOF_TYPE_DESC,
JNR2.PLCY_TERM_TYPE as PLCY_TERM_TYPE,
JNR2.PLCY_TOT_COST_AMT as PLCY_TOT_COST_AMT,
JNR2.EARND_PREM_AMT as EARND_PREM_AMT,
JNR2.MBR_TYPE_DESC as MBR_TYPE_DESC,
JNR2.TOT_VEHICAL_UNIT_CNT as TOT_VEHICAL_UNIT_CNT,
JNR2.PROD_LN_DESC as PROD_LN_DESC,
JNR2.CO_TO_CO_TFR_DESC as CO_TO_CO_TFR_DESC,
JNR2.PRD_ID as PRD_ID,
JNR2.NK_JOB_NBR as NK_JOB_NBR,
JNR2.QUOTN_ID as QUOTN_ID,
JNR2.AGMT_ID as AGMT_ID
FROM
JNR2;


END; ';